{"remainingRequest":"D:\\GitHub\\Vectory\\vectory\\node_modules\\babel-loader\\lib\\index.js!D:\\GitHub\\Vectory\\vectory\\node_modules\\eslint-loader\\index.js??ref--13-0!D:\\GitHub\\Vectory\\vectory\\src\\libraries\\paper-full.js","dependencies":[{"path":"D:\\GitHub\\Vectory\\vectory\\src\\libraries\\paper-full.js","mtime":1552939656646},{"path":"D:\\GitHub\\Vectory\\vectory\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\GitHub\\Vectory\\vectory\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\GitHub\\Vectory\\vectory\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.regexp.constructor\";\nimport _Date$now from \"D:\\\\GitHub\\\\Vectory\\\\vectory\\\\node_modules\\\\@babel\\\\runtime-corejs2/core-js/date/now\";\nimport _parseInt from \"D:\\\\GitHub\\\\Vectory\\\\vectory\\\\node_modules\\\\@babel\\\\runtime-corejs2/core-js/parse-int\";\nimport \"core-js/modules/es6.array.sort\";\nimport \"core-js/modules/es6.array.fill\";\nimport \"core-js/modules/es6.regexp.to-string\";\nimport \"core-js/modules/es6.regexp.split\";\nimport \"core-js/modules/es6.math.log2\";\nimport _parseFloat from \"D:\\\\GitHub\\\\Vectory\\\\vectory\\\\node_modules\\\\@babel\\\\runtime-corejs2/core-js/parse-float\";\nimport \"core-js/modules/es6.regexp.replace\";\nimport _JSON$stringify from \"D:\\\\GitHub\\\\Vectory\\\\vectory\\\\node_modules\\\\@babel\\\\runtime-corejs2/core-js/json/stringify\";\nimport \"core-js/modules/web.dom.iterable\";\nimport _Object$keys from \"D:\\\\GitHub\\\\Vectory\\\\vectory\\\\node_modules\\\\@babel\\\\runtime-corejs2/core-js/object/keys\";\nimport _Array$isArray from \"D:\\\\GitHub\\\\Vectory\\\\vectory\\\\node_modules\\\\@babel\\\\runtime-corejs2/core-js/array/is-array\";\nimport _typeof from \"D:\\\\GitHub\\\\Vectory\\\\vectory\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/typeof\";\nimport \"core-js/modules/es6.regexp.match\";\nimport \"core-js/modules/es6.function.name\";\nimport _Object$assign from \"D:\\\\GitHub\\\\Vectory\\\\vectory\\\\node_modules\\\\@babel\\\\runtime-corejs2/core-js/object/assign\";\nimport _Object$defineProperty from \"D:\\\\GitHub\\\\Vectory\\\\vectory\\\\node_modules\\\\@babel\\\\runtime-corejs2/core-js/object/define-property\";\nimport _Object$getOwnPropertyDescriptor from \"D:\\\\GitHub\\\\Vectory\\\\vectory\\\\node_modules\\\\@babel\\\\runtime-corejs2/core-js/object/get-own-property-descriptor\";\nimport _Object$create from \"D:\\\\GitHub\\\\Vectory\\\\vectory\\\\node_modules\\\\@babel\\\\runtime-corejs2/core-js/object/create\";\n\n/*!\n * Paper.js v0.12.0 - The Swiss Army Knife of Vector Graphics Scripting.\n * http://paperjs.org/\n *\n * Copyright (c) 2011 - 2016, Juerg Lehni & Jonathan Puckey\n * http://scratchdisk.com/ & https://puckey.studio/\n *\n * Distributed under the MIT license. See LICENSE file for details.\n *\n * All rights reserved.\n *\n * Date: Mon Dec 3 14:19:11 2018 +0100\n *\n ***\n *\n * Straps.js - Class inheritance library with support for bean-style accessors\n *\n * Copyright (c) 2006 - 2016 Juerg Lehni\n * http://scratchdisk.com/\n *\n * Distributed under the MIT license.\n *\n ***\n *\n * Acorn.js\n * https://marijnhaverbeke.nl/acorn/\n *\n * Acorn is a tiny, fast JavaScript parser written in JavaScript,\n * created by Marijn Haverbeke and released under an MIT license.\n *\n */\nvar paper = function (self, undefined) {\n  self = self || require('./node/self.js');\n  var window = self.window,\n      document = self.document;\n  var Base = new function () {\n    var hidden = /^(statics|enumerable|beans|preserve)$/,\n        array = [],\n        _slice = array.slice,\n        create = _Object$create,\n        describe = _Object$getOwnPropertyDescriptor,\n        define = _Object$defineProperty,\n        forEach = array.forEach || function (iter, bind) {\n      for (var i = 0, l = this.length; i < l; i++) {\n        iter.call(bind, this[i], i, this);\n      }\n    },\n        forIn = function forIn(iter, bind) {\n      for (var i in this) {\n        if (this.hasOwnProperty(i)) iter.call(bind, this[i], i, this);\n      }\n    },\n        set = _Object$assign || function (dst) {\n      for (var i = 1, l = arguments.length; i < l; i++) {\n        var src = arguments[i];\n\n        for (var key in src) {\n          if (src.hasOwnProperty(key)) dst[key] = src[key];\n        }\n      }\n\n      return dst;\n    },\n        _each = function each(obj, iter, bind) {\n      if (obj) {\n        var desc = describe(obj, 'length');\n        (desc && typeof desc.value === 'number' ? forEach : forIn).call(obj, iter, bind = bind || obj);\n      }\n\n      return bind;\n    };\n\n    function _inject(dest, src, enumerable, beans, preserve) {\n      var beansNames = {};\n\n      function field(name, val) {\n        val = val || (val = describe(src, name)) && (val.get ? val : val.value);\n        if (typeof val === 'string' && val[0] === '#') val = dest[val.substring(1)] || val;\n        var isFunc = typeof val === 'function',\n            res = val,\n            prev = preserve || isFunc && !val.base ? val && val.get ? name in dest : dest[name] : null,\n            bean;\n\n        if (!preserve || !prev) {\n          if (isFunc && prev) val.base = prev;\n          if (isFunc && beans !== false && (bean = name.match(/^([gs]et|is)(([A-Z])(.*))$/))) beansNames[bean[3].toLowerCase() + bean[4]] = bean[2];\n\n          if (!res || isFunc || !res.get || typeof res.get !== 'function' || !Base.isPlainObject(res)) {\n            res = {\n              value: res,\n              writable: true\n            };\n          }\n\n          if ((describe(dest, name) || {\n            configurable: true\n          }).configurable) {\n            res.configurable = true;\n            res.enumerable = enumerable != null ? enumerable : !bean;\n          }\n\n          define(dest, name, res);\n        }\n      }\n\n      if (src) {\n        for (var name in src) {\n          if (src.hasOwnProperty(name) && !hidden.test(name)) field(name);\n        }\n\n        for (var name in beansNames) {\n          var part = beansNames[name],\n              set = dest['set' + part],\n              get = dest['get' + part] || set && dest['is' + part];\n          if (get && (beans === true || get.length === 0)) field(name, {\n            get: get,\n            set: set\n          });\n        }\n      }\n\n      return dest;\n    }\n\n    function Base() {\n      for (var i = 0, l = arguments.length; i < l; i++) {\n        var src = arguments[i];\n        if (src) set(this, src);\n      }\n\n      return this;\n    }\n\n    return _inject(Base, {\n      inject: function inject(src) {\n        if (src) {\n          var statics = src.statics === true ? src : src.statics,\n              beans = src.beans,\n              preserve = src.preserve;\n          if (statics !== src) _inject(this.prototype, src, src.enumerable, beans, preserve);\n\n          _inject(this, statics, null, beans, preserve);\n        }\n\n        for (var i = 1, l = arguments.length; i < l; i++) {\n          this.inject(arguments[i]);\n        }\n\n        return this;\n      },\n      extend: function extend() {\n        var base = this,\n            ctor,\n            proto;\n\n        for (var i = 0, obj, l = arguments.length; i < l && !(ctor && proto); i++) {\n          obj = arguments[i];\n          ctor = ctor || obj.initialize;\n          proto = proto || obj.prototype;\n        }\n\n        ctor = ctor || function () {\n          base.apply(this, arguments);\n        };\n\n        proto = ctor.prototype = proto || create(this.prototype);\n        define(proto, 'constructor', {\n          value: ctor,\n          writable: true,\n          configurable: true\n        });\n\n        _inject(ctor, this);\n\n        if (arguments.length) this.inject.apply(ctor, arguments);\n        ctor.base = base;\n        return ctor;\n      }\n    }).inject({\n      enumerable: false,\n      initialize: Base,\n      set: Base,\n      inject: function inject() {\n        for (var i = 0, l = arguments.length; i < l; i++) {\n          var src = arguments[i];\n\n          if (src) {\n            _inject(this, src, src.enumerable, src.beans, src.preserve);\n          }\n        }\n\n        return this;\n      },\n      extend: function extend() {\n        var res = create(this);\n        return res.inject.apply(res, arguments);\n      },\n      each: function each(iter, bind) {\n        return _each(this, iter, bind);\n      },\n      clone: function clone() {\n        return new this.constructor(this);\n      },\n      statics: {\n        set: set,\n        each: _each,\n        create: create,\n        define: define,\n        describe: describe,\n        clone: function clone(obj) {\n          return set(new obj.constructor(), obj);\n        },\n        isPlainObject: function isPlainObject(obj) {\n          var ctor = obj != null && obj.constructor;\n          return ctor && (ctor === Object || ctor === Base || ctor.name === 'Object');\n        },\n        pick: function pick(a, b) {\n          return a !== undefined ? a : b;\n        },\n        slice: function slice(list, begin, end) {\n          return _slice.call(list, begin, end);\n        }\n      }\n    });\n  }();\n  if (typeof module !== 'undefined') module.exports = Base;\n  Base.inject({\n    enumerable: false,\n    toString: function toString() {\n      return this._id != null ? (this._class || 'Object') + (this._name ? \" '\" + this._name + \"'\" : ' @' + this._id) : '{ ' + Base.each(this, function (value, key) {\n        if (!/^_/.test(key)) {\n          var type = _typeof(value);\n\n          this.push(key + ': ' + (type === 'number' ? Formatter.instance.number(value) : type === 'string' ? \"'\" + value + \"'\" : value));\n        }\n      }, []).join(', ') + ' }';\n    },\n    getClassName: function getClassName() {\n      return this._class || '';\n    },\n    importJSON: function importJSON(json) {\n      return Base.importJSON(json, this);\n    },\n    exportJSON: function exportJSON(options) {\n      return Base.exportJSON(this, options);\n    },\n    toJSON: function toJSON() {\n      return Base.serialize(this);\n    },\n    set: function set(props, exclude) {\n      if (props) Base.filter(this, props, exclude, this._prioritize);\n      return this;\n    }\n  }, {\n    beans: false,\n    statics: {\n      exports: {},\n      extend: function extend() {\n        var res = extend.base.apply(this, arguments),\n            name = res.prototype._class;\n        if (name && !Base.exports[name]) Base.exports[name] = res;\n        return res;\n      },\n      equals: function equals(obj1, obj2) {\n        if (obj1 === obj2) return true;\n        if (obj1 && obj1.equals) return obj1.equals(obj2);\n        if (obj2 && obj2.equals) return obj2.equals(obj1);\n\n        if (obj1 && obj2 && _typeof(obj1) === 'object' && _typeof(obj2) === 'object') {\n          if (_Array$isArray(obj1) && _Array$isArray(obj2)) {\n            var length = obj1.length;\n            if (length !== obj2.length) return false;\n\n            while (length--) {\n              if (!Base.equals(obj1[length], obj2[length])) return false;\n            }\n          } else {\n            var keys = _Object$keys(obj1),\n                length = keys.length;\n\n            if (length !== _Object$keys(obj2).length) return false;\n\n            while (length--) {\n              var key = keys[length];\n              if (!(obj2.hasOwnProperty(key) && Base.equals(obj1[key], obj2[key]))) return false;\n            }\n          }\n\n          return true;\n        }\n\n        return false;\n      },\n      read: function read(list, start, options, amount) {\n        if (this === Base) {\n          var value = this.peek(list, start);\n          list.__index++;\n          return value;\n        }\n\n        var proto = this.prototype,\n            readIndex = proto._readIndex,\n            begin = start || readIndex && list.__index || 0,\n            length = list.length,\n            obj = list[begin];\n        amount = amount || length - begin;\n\n        if (obj instanceof this || options && options.readNull && obj == null && amount <= 1) {\n          if (readIndex) list.__index = begin + 1;\n          return obj && options && options.clone ? obj.clone() : obj;\n        }\n\n        obj = Base.create(proto);\n        if (readIndex) obj.__read = true;\n        obj = obj.initialize.apply(obj, begin > 0 || begin + amount < length ? Base.slice(list, begin, begin + amount) : list) || obj;\n\n        if (readIndex) {\n          list.__index = begin + obj.__read;\n          var filtered = obj.__filtered;\n\n          if (filtered) {\n            list.__filtered = filtered;\n            obj.__filtered = undefined;\n          }\n\n          obj.__read = undefined;\n        }\n\n        return obj;\n      },\n      peek: function peek(list, start) {\n        return list[list.__index = start || list.__index || 0];\n      },\n      remain: function remain(list) {\n        return list.length - (list.__index || 0);\n      },\n      readList: function readList(list, start, options, amount) {\n        var res = [],\n            entry,\n            begin = start || 0,\n            end = amount ? begin + amount : list.length;\n\n        for (var i = begin; i < end; i++) {\n          res.push(_Array$isArray(entry = list[i]) ? this.read(entry, 0, options) : this.read(list, i, options, 1));\n        }\n\n        return res;\n      },\n      readNamed: function readNamed(list, name, start, options, amount) {\n        var value = this.getNamed(list, name),\n            hasObject = value !== undefined;\n\n        if (hasObject) {\n          var filtered = list.__filtered;\n\n          if (!filtered) {\n            filtered = list.__filtered = Base.create(list[0]);\n            filtered.__unfiltered = list[0];\n          }\n\n          filtered[name] = undefined;\n        }\n\n        var l = hasObject ? [value] : list,\n            res = this.read(l, start, options, amount);\n        return res;\n      },\n      getNamed: function getNamed(list, name) {\n        var arg = list[0];\n        if (list._hasObject === undefined) list._hasObject = list.length === 1 && Base.isPlainObject(arg);\n        if (list._hasObject) return name ? arg[name] : list.__filtered || arg;\n      },\n      hasNamed: function hasNamed(list, name) {\n        return !!this.getNamed(list, name);\n      },\n      filter: function filter(dest, source, exclude, prioritize) {\n        var processed;\n\n        function handleKey(key) {\n          if (!(exclude && key in exclude) && !(processed && key in processed)) {\n            var value = source[key];\n            if (value !== undefined) dest[key] = value;\n          }\n        }\n\n        if (prioritize) {\n          var keys = {};\n\n          for (var i = 0, key, l = prioritize.length; i < l; i++) {\n            if ((key = prioritize[i]) in source) {\n              handleKey(key);\n              keys[key] = true;\n            }\n          }\n\n          processed = keys;\n        }\n\n        _Object$keys(source.__unfiltered || source).forEach(handleKey);\n\n        return dest;\n      },\n      isPlainValue: function isPlainValue(obj, asString) {\n        return Base.isPlainObject(obj) || _Array$isArray(obj) || asString && typeof obj === 'string';\n      },\n      serialize: function serialize(obj, options, compact, dictionary) {\n        options = options || {};\n        var isRoot = !dictionary,\n            res;\n\n        if (isRoot) {\n          options.formatter = new Formatter(options.precision);\n          dictionary = {\n            length: 0,\n            definitions: {},\n            references: {},\n            add: function add(item, create) {\n              var id = '#' + item._id,\n                  ref = this.references[id];\n\n              if (!ref) {\n                this.length++;\n                var res = create.call(item),\n                    name = item._class;\n                if (name && res[0] !== name) res.unshift(name);\n                this.definitions[id] = res;\n                ref = this.references[id] = [id];\n              }\n\n              return ref;\n            }\n          };\n        }\n\n        if (obj && obj._serialize) {\n          res = obj._serialize(options, dictionary);\n          var name = obj._class;\n\n          if (name && !obj._compactSerialize && (isRoot || !compact) && res[0] !== name) {\n            res.unshift(name);\n          }\n        } else if (_Array$isArray(obj)) {\n          res = [];\n\n          for (var i = 0, l = obj.length; i < l; i++) {\n            res[i] = Base.serialize(obj[i], options, compact, dictionary);\n          }\n        } else if (Base.isPlainObject(obj)) {\n          res = {};\n\n          var keys = _Object$keys(obj);\n\n          for (var i = 0, l = keys.length; i < l; i++) {\n            var key = keys[i];\n            res[key] = Base.serialize(obj[key], options, compact, dictionary);\n          }\n        } else if (typeof obj === 'number') {\n          res = options.formatter.number(obj, options.precision);\n        } else {\n          res = obj;\n        }\n\n        return isRoot && dictionary.length > 0 ? [['dictionary', dictionary.definitions], res] : res;\n      },\n      deserialize: function deserialize(json, create, _data, _setDictionary, _isRoot) {\n        var res = json,\n            isFirst = !_data,\n            hasDictionary = isFirst && json && json.length && json[0][0] === 'dictionary';\n        _data = _data || {};\n\n        if (_Array$isArray(json)) {\n          var type = json[0],\n              isDictionary = type === 'dictionary';\n\n          if (json.length == 1 && /^#/.test(type)) {\n            return _data.dictionary[type];\n          }\n\n          type = Base.exports[type];\n          res = [];\n\n          for (var i = type ? 1 : 0, l = json.length; i < l; i++) {\n            res.push(Base.deserialize(json[i], create, _data, isDictionary, hasDictionary));\n          }\n\n          if (type) {\n            var args = res;\n\n            if (create) {\n              res = create(type, args, isFirst || _isRoot);\n            } else {\n              res = new type(args);\n            }\n          }\n        } else if (Base.isPlainObject(json)) {\n          res = {};\n          if (_setDictionary) _data.dictionary = res;\n\n          for (var key in json) {\n            res[key] = Base.deserialize(json[key], create, _data);\n          }\n        }\n\n        return hasDictionary ? res[1] : res;\n      },\n      exportJSON: function exportJSON(obj, options) {\n        var json = Base.serialize(obj, options);\n        return options && options.asString == false ? json : _JSON$stringify(json);\n      },\n      importJSON: function importJSON(json, target) {\n        return Base.deserialize(typeof json === 'string' ? JSON.parse(json) : json, function (ctor, args, isRoot) {\n          var useTarget = isRoot && target && target.constructor === ctor,\n              obj = useTarget ? target : Base.create(ctor.prototype);\n\n          if (args.length === 1 && obj instanceof Item && (useTarget || !(obj instanceof Layer))) {\n            var arg = args[0];\n            if (Base.isPlainObject(arg)) arg.insert = false;\n          }\n\n          (useTarget ? obj.set : ctor).apply(obj, args);\n          if (useTarget) target = null;\n          return obj;\n        });\n      },\n      push: function push(list, items) {\n        var itemsLength = items.length;\n\n        if (itemsLength < 4096) {\n          list.push.apply(list, items);\n        } else {\n          var startLength = list.length;\n          list.length += itemsLength;\n\n          for (var i = 0; i < itemsLength; i++) {\n            list[startLength + i] = items[i];\n          }\n        }\n\n        return list;\n      },\n      splice: function splice(list, items, index, remove) {\n        var amount = items && items.length,\n            append = index === undefined;\n        index = append ? list.length : index;\n        if (index > list.length) index = list.length;\n\n        for (var i = 0; i < amount; i++) {\n          items[i]._index = index + i;\n        }\n\n        if (append) {\n          Base.push(list, items);\n          return [];\n        } else {\n          var args = [index, remove];\n          if (items) Base.push(args, items);\n          var removed = list.splice.apply(list, args);\n\n          for (var i = 0, l = removed.length; i < l; i++) {\n            removed[i]._index = undefined;\n          }\n\n          for (var i = index + amount, l = list.length; i < l; i++) {\n            list[i]._index = i;\n          }\n\n          return removed;\n        }\n      },\n      capitalize: function capitalize(str) {\n        return str.replace(/\\b[a-z]/g, function (match) {\n          return match.toUpperCase();\n        });\n      },\n      camelize: function camelize(str) {\n        return str.replace(/-(.)/g, function (match, chr) {\n          return chr.toUpperCase();\n        });\n      },\n      hyphenate: function hyphenate(str) {\n        return str.replace(/([a-z])([A-Z])/g, '$1-$2').toLowerCase();\n      }\n    }\n  });\n  var Emitter = {\n    on: function on(type, func) {\n      if (typeof type !== 'string') {\n        Base.each(type, function (value, key) {\n          this.on(key, value);\n        }, this);\n      } else {\n        var types = this._eventTypes,\n            entry = types && types[type],\n            handlers = this._callbacks = this._callbacks || {};\n        handlers = handlers[type] = handlers[type] || [];\n\n        if (handlers.indexOf(func) === -1) {\n          handlers.push(func);\n          if (entry && entry.install && handlers.length === 1) entry.install.call(this, type);\n        }\n      }\n\n      return this;\n    },\n    off: function off(type, func) {\n      if (typeof type !== 'string') {\n        Base.each(type, function (value, key) {\n          this.off(key, value);\n        }, this);\n        return;\n      }\n\n      var types = this._eventTypes,\n          entry = types && types[type],\n          handlers = this._callbacks && this._callbacks[type],\n          index;\n\n      if (handlers) {\n        if (!func || (index = handlers.indexOf(func)) !== -1 && handlers.length === 1) {\n          if (entry && entry.uninstall) entry.uninstall.call(this, type);\n          delete this._callbacks[type];\n        } else if (index !== -1) {\n          handlers.splice(index, 1);\n        }\n      }\n\n      return this;\n    },\n    once: function once(type, func) {\n      return this.on(type, function handler() {\n        func.apply(this, arguments);\n        this.off(type, handler);\n      });\n    },\n    emit: function emit(type, event) {\n      var handlers = this._callbacks && this._callbacks[type];\n      if (!handlers) return false;\n      var args = Base.slice(arguments, 1),\n          setTarget = event && event.target && !event.currentTarget;\n      handlers = handlers.slice();\n      if (setTarget) event.currentTarget = this;\n\n      for (var i = 0, l = handlers.length; i < l; i++) {\n        if (handlers[i].apply(this, args) == false) {\n          if (event && event.stop) event.stop();\n          break;\n        }\n      }\n\n      if (setTarget) delete event.currentTarget;\n      return true;\n    },\n    responds: function responds(type) {\n      return !!(this._callbacks && this._callbacks[type]);\n    },\n    attach: '#on',\n    detach: '#off',\n    fire: '#emit',\n    _installEvents: function _installEvents(install) {\n      var types = this._eventTypes,\n          handlers = this._callbacks,\n          key = install ? 'install' : 'uninstall';\n\n      if (types) {\n        for (var type in handlers) {\n          if (handlers[type].length > 0) {\n            var entry = types[type],\n                func = entry && entry[key];\n            if (func) func.call(this, type);\n          }\n        }\n      }\n    },\n    statics: {\n      inject: function inject(src) {\n        var events = src._events;\n\n        if (events) {\n          var types = {};\n          Base.each(events, function (entry, key) {\n            var isString = typeof entry === 'string',\n                name = isString ? entry : key,\n                part = Base.capitalize(name),\n                type = name.substring(2).toLowerCase();\n            types[type] = isString ? {} : entry;\n            name = '_' + name;\n\n            src['get' + part] = function () {\n              return this[name];\n            };\n\n            src['set' + part] = function (func) {\n              var prev = this[name];\n              if (prev) this.off(type, prev);\n              if (func) this.on(type, func);\n              this[name] = func;\n            };\n          });\n          src._eventTypes = types;\n        }\n\n        return inject.base.apply(this, arguments);\n      }\n    }\n  };\n  var PaperScope = Base.extend({\n    _class: 'PaperScope',\n    initialize: function PaperScope() {\n      paper = this;\n      this.settings = new Base({\n        applyMatrix: true,\n        insertItems: true,\n        handleSize: 4,\n        hitTolerance: 0\n      });\n      this.project = null;\n      this.projects = [];\n      this.tools = [];\n      this._id = PaperScope._id++;\n      PaperScope._scopes[this._id] = this;\n      var proto = PaperScope.prototype;\n\n      if (!this.support) {\n        var ctx = CanvasProvider.getContext(1, 1) || {};\n        proto.support = {\n          nativeDash: 'setLineDash' in ctx || 'mozDash' in ctx,\n          nativeBlendModes: BlendMode.nativeModes\n        };\n        CanvasProvider.release(ctx);\n      }\n\n      if (!this.agent) {\n        var user = self.navigator.userAgent.toLowerCase(),\n            os = (/(darwin|win|mac|linux|freebsd|sunos)/.exec(user) || [])[0],\n            platform = os === 'darwin' ? 'mac' : os,\n            agent = proto.agent = proto.browser = {\n          platform: platform\n        };\n        if (platform) agent[platform] = true;\n        user.replace(/(opera|chrome|safari|webkit|firefox|msie|trident|atom|node)\\/?\\s*([.\\d]+)(?:.*version\\/([.\\d]+))?(?:.*rv\\:v?([.\\d]+))?/g, function (match, n, v1, v2, rv) {\n          if (!agent.chrome) {\n            var v = n === 'opera' ? v2 : /^(node|trident)$/.test(n) ? rv : v1;\n            agent.version = v;\n            agent.versionNumber = _parseFloat(v);\n            n = n === 'trident' ? 'msie' : n;\n            agent.name = n;\n            agent[n] = true;\n          }\n        });\n        if (agent.chrome) delete agent.webkit;\n        if (agent.atom) delete agent.chrome;\n      }\n    },\n    version: \"0.12.0\",\n    getView: function getView() {\n      var project = this.project;\n      return project && project._view;\n    },\n    getPaper: function getPaper() {\n      return this;\n    },\n    execute: function execute(code, options) {\n      var exports = paper.PaperScript.execute(code, this, options);\n      View.updateFocus();\n      return exports;\n    },\n    install: function install(scope) {\n      var that = this;\n      Base.each(['project', 'view', 'tool'], function (key) {\n        Base.define(scope, key, {\n          configurable: true,\n          get: function get() {\n            return that[key];\n          }\n        });\n      });\n\n      for (var key in this) {\n        if (!/^_/.test(key) && this[key]) scope[key] = this[key];\n      }\n    },\n    setup: function setup(element) {\n      paper = this;\n      this.project = new Project(element);\n      return this;\n    },\n    createCanvas: function createCanvas(width, height) {\n      return CanvasProvider.getCanvas(width, height);\n    },\n    activate: function activate() {\n      paper = this;\n    },\n    clear: function clear() {\n      var projects = this.projects,\n          tools = this.tools;\n\n      for (var i = projects.length - 1; i >= 0; i--) {\n        projects[i].remove();\n      }\n\n      for (var i = tools.length - 1; i >= 0; i--) {\n        tools[i].remove();\n      }\n    },\n    remove: function remove() {\n      this.clear();\n      delete PaperScope._scopes[this._id];\n    },\n    statics: new function () {\n      function handleAttribute(name) {\n        name += 'Attribute';\n        return function (el, attr) {\n          return el[name](attr) || el[name]('data-paper-' + attr);\n        };\n      }\n\n      return {\n        _scopes: {},\n        _id: 0,\n        get: function get(id) {\n          return this._scopes[id] || null;\n        },\n        getAttribute: handleAttribute('get'),\n        hasAttribute: handleAttribute('has')\n      };\n    }()\n  });\n  var PaperScopeItem = Base.extend(Emitter, {\n    initialize: function initialize(activate) {\n      this._scope = paper;\n      this._index = this._scope[this._list].push(this) - 1;\n      if (activate || !this._scope[this._reference]) this.activate();\n    },\n    activate: function activate() {\n      if (!this._scope) return false;\n      var prev = this._scope[this._reference];\n      if (prev && prev !== this) prev.emit('deactivate');\n      this._scope[this._reference] = this;\n      this.emit('activate', prev);\n      return true;\n    },\n    isActive: function isActive() {\n      return this._scope[this._reference] === this;\n    },\n    remove: function remove() {\n      if (this._index == null) return false;\n      Base.splice(this._scope[this._list], null, this._index, 1);\n      if (this._scope[this._reference] == this) this._scope[this._reference] = null;\n      this._scope = null;\n      return true;\n    },\n    getView: function getView() {\n      return this._scope.getView();\n    }\n  });\n  var Formatter = Base.extend({\n    initialize: function initialize(precision) {\n      this.precision = Base.pick(precision, 5);\n      this.multiplier = Math.pow(10, this.precision);\n    },\n    number: function number(val) {\n      return this.precision < 16 ? Math.round(val * this.multiplier) / this.multiplier : val;\n    },\n    pair: function pair(val1, val2, separator) {\n      return this.number(val1) + (separator || ',') + this.number(val2);\n    },\n    point: function point(val, separator) {\n      return this.number(val.x) + (separator || ',') + this.number(val.y);\n    },\n    size: function size(val, separator) {\n      return this.number(val.width) + (separator || ',') + this.number(val.height);\n    },\n    rectangle: function rectangle(val, separator) {\n      return this.point(val, separator) + (separator || ',') + this.size(val, separator);\n    }\n  });\n  Formatter.instance = new Formatter();\n  var Numerical = new function () {\n    var abscissas = [[0.5773502691896257645091488], [0, 0.7745966692414833770358531], [0.3399810435848562648026658, 0.8611363115940525752239465], [0, 0.5384693101056830910363144, 0.9061798459386639927976269], [0.2386191860831969086305017, 0.6612093864662645136613996, 0.9324695142031520278123016], [0, 0.4058451513773971669066064, 0.7415311855993944398638648, 0.9491079123427585245261897], [0.1834346424956498049394761, 0.5255324099163289858177390, 0.7966664774136267395915539, 0.9602898564975362316835609], [0, 0.3242534234038089290385380, 0.6133714327005903973087020, 0.8360311073266357942994298, 0.9681602395076260898355762], [0.1488743389816312108848260, 0.4333953941292471907992659, 0.6794095682990244062343274, 0.8650633666889845107320967, 0.9739065285171717200779640], [0, 0.2695431559523449723315320, 0.5190961292068118159257257, 0.7301520055740493240934163, 0.8870625997680952990751578, 0.9782286581460569928039380], [0.1252334085114689154724414, 0.3678314989981801937526915, 0.5873179542866174472967024, 0.7699026741943046870368938, 0.9041172563704748566784659, 0.9815606342467192506905491], [0, 0.2304583159551347940655281, 0.4484927510364468528779129, 0.6423493394403402206439846, 0.8015780907333099127942065, 0.9175983992229779652065478, 0.9841830547185881494728294], [0.1080549487073436620662447, 0.3191123689278897604356718, 0.5152486363581540919652907, 0.6872929048116854701480198, 0.8272013150697649931897947, 0.9284348836635735173363911, 0.9862838086968123388415973], [0, 0.2011940939974345223006283, 0.3941513470775633698972074, 0.5709721726085388475372267, 0.7244177313601700474161861, 0.8482065834104272162006483, 0.9372733924007059043077589, 0.9879925180204854284895657], [0.0950125098376374401853193, 0.2816035507792589132304605, 0.4580167776572273863424194, 0.6178762444026437484466718, 0.7554044083550030338951012, 0.8656312023878317438804679, 0.9445750230732325760779884, 0.9894009349916499325961542]];\n    var weights = [[1], [0.8888888888888888888888889, 0.5555555555555555555555556], [0.6521451548625461426269361, 0.3478548451374538573730639], [0.5688888888888888888888889, 0.4786286704993664680412915, 0.2369268850561890875142640], [0.4679139345726910473898703, 0.3607615730481386075698335, 0.1713244923791703450402961], [0.4179591836734693877551020, 0.3818300505051189449503698, 0.2797053914892766679014678, 0.1294849661688696932706114], [0.3626837833783619829651504, 0.3137066458778872873379622, 0.2223810344533744705443560, 0.1012285362903762591525314], [0.3302393550012597631645251, 0.3123470770400028400686304, 0.2606106964029354623187429, 0.1806481606948574040584720, 0.0812743883615744119718922], [0.2955242247147528701738930, 0.2692667193099963550912269, 0.2190863625159820439955349, 0.1494513491505805931457763, 0.0666713443086881375935688], [0.2729250867779006307144835, 0.2628045445102466621806889, 0.2331937645919904799185237, 0.1862902109277342514260976, 0.1255803694649046246346943, 0.0556685671161736664827537], [0.2491470458134027850005624, 0.2334925365383548087608499, 0.2031674267230659217490645, 0.1600783285433462263346525, 0.1069393259953184309602547, 0.0471753363865118271946160], [0.2325515532308739101945895, 0.2262831802628972384120902, 0.2078160475368885023125232, 0.1781459807619457382800467, 0.1388735102197872384636018, 0.0921214998377284479144218, 0.0404840047653158795200216], [0.2152638534631577901958764, 0.2051984637212956039659241, 0.1855383974779378137417166, 0.1572031671581935345696019, 0.1215185706879031846894148, 0.0801580871597602098056333, 0.0351194603317518630318329], [0.2025782419255612728806202, 0.1984314853271115764561183, 0.1861610000155622110268006, 0.1662692058169939335532009, 0.1395706779261543144478048, 0.1071592204671719350118695, 0.0703660474881081247092674, 0.0307532419961172683546284], [0.1894506104550684962853967, 0.1826034150449235888667637, 0.1691565193950025381893121, 0.1495959888165767320815017, 0.1246289712555338720524763, 0.0951585116824927848099251, 0.0622535239386478928628438, 0.0271524594117540948517806]];\n\n    var abs = Math.abs,\n        sqrt = Math.sqrt,\n        pow = Math.pow,\n        log2 = Math.log2 || function (x) {\n      return Math.log(x) * Math.LOG2E;\n    },\n        EPSILON = 1e-12,\n        MACHINE_EPSILON = 1.12e-16;\n\n    function clamp(value, min, max) {\n      return value < min ? min : value > max ? max : value;\n    }\n\n    function getDiscriminant(a, b, c) {\n      function split(v) {\n        var x = v * 134217729,\n            y = v - x,\n            hi = y + x,\n            lo = v - hi;\n        return [hi, lo];\n      }\n\n      var D = b * b - a * c,\n          E = b * b + a * c;\n\n      if (abs(D) * 3 < E) {\n        var ad = split(a),\n            bd = split(b),\n            cd = split(c),\n            p = b * b,\n            dp = bd[0] * bd[0] - p + 2 * bd[0] * bd[1] + bd[1] * bd[1],\n            q = a * c,\n            dq = ad[0] * cd[0] - q + ad[0] * cd[1] + ad[1] * cd[0] + ad[1] * cd[1];\n        D = p - q + (dp - dq);\n      }\n\n      return D;\n    }\n\n    function getNormalizationFactor() {\n      var norm = Math.max.apply(Math, arguments);\n      return norm && (norm < 1e-8 || norm > 1e8) ? pow(2, -Math.round(log2(norm))) : 0;\n    }\n\n    return {\n      EPSILON: EPSILON,\n      MACHINE_EPSILON: MACHINE_EPSILON,\n      CURVETIME_EPSILON: 1e-8,\n      GEOMETRIC_EPSILON: 1e-7,\n      TRIGONOMETRIC_EPSILON: 1e-8,\n      KAPPA: 4 * (sqrt(2) - 1) / 3,\n      isZero: function isZero(val) {\n        return val >= -EPSILON && val <= EPSILON;\n      },\n      clamp: clamp,\n      integrate: function integrate(f, a, b, n) {\n        var x = abscissas[n - 2],\n            w = weights[n - 2],\n            A = (b - a) * 0.5,\n            B = A + a,\n            i = 0,\n            m = n + 1 >> 1,\n            sum = n & 1 ? w[i++] * f(B) : 0;\n\n        while (i < m) {\n          var Ax = A * x[i];\n          sum += w[i++] * (f(B + Ax) + f(B - Ax));\n        }\n\n        return A * sum;\n      },\n      findRoot: function findRoot(f, df, x, a, b, n, tolerance) {\n        for (var i = 0; i < n; i++) {\n          var fx = f(x),\n              dx = fx / df(x),\n              nx = x - dx;\n\n          if (abs(dx) < tolerance) {\n            x = nx;\n            break;\n          }\n\n          if (fx > 0) {\n            b = x;\n            x = nx <= a ? (a + b) * 0.5 : nx;\n          } else {\n            a = x;\n            x = nx >= b ? (a + b) * 0.5 : nx;\n          }\n        }\n\n        return clamp(x, a, b);\n      },\n      solveQuadratic: function solveQuadratic(a, b, c, roots, min, max) {\n        var x1,\n            x2 = Infinity;\n\n        if (abs(a) < EPSILON) {\n          if (abs(b) < EPSILON) return abs(c) < EPSILON ? -1 : 0;\n          x1 = -c / b;\n        } else {\n          b *= -0.5;\n          var D = getDiscriminant(a, b, c);\n\n          if (D && abs(D) < MACHINE_EPSILON) {\n            var f = getNormalizationFactor(abs(a), abs(b), abs(c));\n\n            if (f) {\n              a *= f;\n              b *= f;\n              c *= f;\n              D = getDiscriminant(a, b, c);\n            }\n          }\n\n          if (D >= -MACHINE_EPSILON) {\n            var Q = D < 0 ? 0 : sqrt(D),\n                R = b + (b < 0 ? -Q : Q);\n\n            if (R === 0) {\n              x1 = c / a;\n              x2 = -x1;\n            } else {\n              x1 = R / a;\n              x2 = c / R;\n            }\n          }\n        }\n\n        var count = 0,\n            boundless = min == null,\n            minB = min - EPSILON,\n            maxB = max + EPSILON;\n        if (isFinite(x1) && (boundless || x1 > minB && x1 < maxB)) roots[count++] = boundless ? x1 : clamp(x1, min, max);\n        if (x2 !== x1 && isFinite(x2) && (boundless || x2 > minB && x2 < maxB)) roots[count++] = boundless ? x2 : clamp(x2, min, max);\n        return count;\n      },\n      solveCubic: function solveCubic(a, b, c, d, roots, min, max) {\n        var f = getNormalizationFactor(abs(a), abs(b), abs(c), abs(d)),\n            x,\n            b1,\n            c2,\n            qd,\n            q;\n\n        if (f) {\n          a *= f;\n          b *= f;\n          c *= f;\n          d *= f;\n        }\n\n        function evaluate(x0) {\n          x = x0;\n          var tmp = a * x;\n          b1 = tmp + b;\n          c2 = b1 * x + c;\n          qd = (tmp + b1) * x + c2;\n          q = c2 * x + d;\n        }\n\n        if (abs(a) < EPSILON) {\n          a = b;\n          b1 = c;\n          c2 = d;\n          x = Infinity;\n        } else if (abs(d) < EPSILON) {\n          b1 = b;\n          c2 = c;\n          x = 0;\n        } else {\n          evaluate(-(b / a) / 3);\n          var t = q / a,\n              r = pow(abs(t), 1 / 3),\n              s = t < 0 ? -1 : 1,\n              td = -qd / a,\n              rd = td > 0 ? 1.324717957244746 * Math.max(r, sqrt(td)) : r,\n              x0 = x - s * rd;\n\n          if (x0 !== x) {\n            do {\n              evaluate(x0);\n              x0 = qd === 0 ? x : x - q / qd / (1 + MACHINE_EPSILON);\n            } while (s * x0 > s * x);\n\n            if (abs(a) * x * x > abs(d / x)) {\n              c2 = -d / x;\n              b1 = (c2 - c) / x;\n            }\n          }\n        }\n\n        var count = Numerical.solveQuadratic(a, b1, c2, roots, min, max),\n            boundless = min == null;\n        if (isFinite(x) && (count === 0 || count > 0 && x !== roots[0] && x !== roots[1]) && (boundless || x > min - EPSILON && x < max + EPSILON)) roots[count++] = boundless ? x : clamp(x, min, max);\n        return count;\n      }\n    };\n  }();\n  var UID = {\n    _id: 1,\n    _pools: {},\n    get: function get(name) {\n      if (name) {\n        var pool = this._pools[name];\n        if (!pool) pool = this._pools[name] = {\n          _id: 1\n        };\n        return pool._id++;\n      } else {\n        return this._id++;\n      }\n    }\n  };\n  var Point = Base.extend({\n    _class: 'Point',\n    _readIndex: true,\n    initialize: function Point(arg0, arg1) {\n      var type = _typeof(arg0),\n          reading = this.__read,\n          read = 0;\n\n      if (type === 'number') {\n        var hasY = typeof arg1 === 'number';\n\n        this._set(arg0, hasY ? arg1 : arg0);\n\n        if (reading) read = hasY ? 2 : 1;\n      } else if (type === 'undefined' || arg0 === null) {\n        this._set(0, 0);\n\n        if (reading) read = arg0 === null ? 1 : 0;\n      } else {\n        var obj = type === 'string' ? arg0.split(/[\\s,]+/) || [] : arg0;\n        read = 1;\n\n        if (_Array$isArray(obj)) {\n          this._set(+obj[0], +(obj.length > 1 ? obj[1] : obj[0]));\n        } else if ('x' in obj) {\n          this._set(obj.x || 0, obj.y || 0);\n        } else if ('width' in obj) {\n          this._set(obj.width || 0, obj.height || 0);\n        } else if ('angle' in obj) {\n          this._set(obj.length || 0, 0);\n\n          this.setAngle(obj.angle || 0);\n        } else {\n          this._set(0, 0);\n\n          read = 0;\n        }\n      }\n\n      if (reading) this.__read = read;\n      return this;\n    },\n    set: '#initialize',\n    _set: function _set(x, y) {\n      this.x = x;\n      this.y = y;\n      return this;\n    },\n    equals: function equals(point) {\n      return this === point || point && (this.x === point.x && this.y === point.y || _Array$isArray(point) && this.x === point[0] && this.y === point[1]) || false;\n    },\n    clone: function clone() {\n      return new Point(this.x, this.y);\n    },\n    toString: function toString() {\n      var f = Formatter.instance;\n      return '{ x: ' + f.number(this.x) + ', y: ' + f.number(this.y) + ' }';\n    },\n    _serialize: function _serialize(options) {\n      var f = options.formatter;\n      return [f.number(this.x), f.number(this.y)];\n    },\n    getLength: function getLength() {\n      return Math.sqrt(this.x * this.x + this.y * this.y);\n    },\n    setLength: function setLength(length) {\n      if (this.isZero()) {\n        var angle = this._angle || 0;\n\n        this._set(Math.cos(angle) * length, Math.sin(angle) * length);\n      } else {\n        var scale = length / this.getLength();\n        if (Numerical.isZero(scale)) this.getAngle();\n\n        this._set(this.x * scale, this.y * scale);\n      }\n    },\n    getAngle: function getAngle() {\n      return this.getAngleInRadians.apply(this, arguments) * 180 / Math.PI;\n    },\n    setAngle: function setAngle(angle) {\n      this.setAngleInRadians.call(this, angle * Math.PI / 180);\n    },\n    getAngleInDegrees: '#getAngle',\n    setAngleInDegrees: '#setAngle',\n    getAngleInRadians: function getAngleInRadians() {\n      if (!arguments.length) {\n        return this.isZero() ? this._angle || 0 : this._angle = Math.atan2(this.y, this.x);\n      } else {\n        var point = Point.read(arguments),\n            div = this.getLength() * point.getLength();\n\n        if (Numerical.isZero(div)) {\n          return NaN;\n        } else {\n          var a = this.dot(point) / div;\n          return Math.acos(a < -1 ? -1 : a > 1 ? 1 : a);\n        }\n      }\n    },\n    setAngleInRadians: function setAngleInRadians(angle) {\n      this._angle = angle;\n\n      if (!this.isZero()) {\n        var length = this.getLength();\n\n        this._set(Math.cos(angle) * length, Math.sin(angle) * length);\n      }\n    },\n    getQuadrant: function getQuadrant() {\n      return this.x >= 0 ? this.y >= 0 ? 1 : 4 : this.y >= 0 ? 2 : 3;\n    }\n  }, {\n    beans: false,\n    getDirectedAngle: function getDirectedAngle() {\n      var point = Point.read(arguments);\n      return Math.atan2(this.cross(point), this.dot(point)) * 180 / Math.PI;\n    },\n    getDistance: function getDistance() {\n      var point = Point.read(arguments),\n          x = point.x - this.x,\n          y = point.y - this.y,\n          d = x * x + y * y,\n          squared = Base.read(arguments);\n      return squared ? d : Math.sqrt(d);\n    },\n    normalize: function normalize(length) {\n      if (length === undefined) length = 1;\n      var current = this.getLength(),\n          scale = current !== 0 ? length / current : 0,\n          point = new Point(this.x * scale, this.y * scale);\n      if (scale >= 0) point._angle = this._angle;\n      return point;\n    },\n    rotate: function rotate(angle, center) {\n      if (angle === 0) return this.clone();\n      angle = angle * Math.PI / 180;\n      var point = center ? this.subtract(center) : this,\n          sin = Math.sin(angle),\n          cos = Math.cos(angle);\n      point = new Point(point.x * cos - point.y * sin, point.x * sin + point.y * cos);\n      return center ? point.add(center) : point;\n    },\n    transform: function transform(matrix) {\n      return matrix ? matrix._transformPoint(this) : this;\n    },\n    add: function add() {\n      var point = Point.read(arguments);\n      return new Point(this.x + point.x, this.y + point.y);\n    },\n    subtract: function subtract() {\n      var point = Point.read(arguments);\n      return new Point(this.x - point.x, this.y - point.y);\n    },\n    multiply: function multiply() {\n      var point = Point.read(arguments);\n      return new Point(this.x * point.x, this.y * point.y);\n    },\n    divide: function divide() {\n      var point = Point.read(arguments);\n      return new Point(this.x / point.x, this.y / point.y);\n    },\n    modulo: function modulo() {\n      var point = Point.read(arguments);\n      return new Point(this.x % point.x, this.y % point.y);\n    },\n    negate: function negate() {\n      return new Point(-this.x, -this.y);\n    },\n    isInside: function isInside() {\n      return _Rectangle.read(arguments).contains(this);\n    },\n    isClose: function isClose() {\n      var point = Point.read(arguments),\n          tolerance = Base.read(arguments);\n      return this.getDistance(point) <= tolerance;\n    },\n    isCollinear: function isCollinear() {\n      var point = Point.read(arguments);\n      return Point.isCollinear(this.x, this.y, point.x, point.y);\n    },\n    isColinear: '#isCollinear',\n    isOrthogonal: function isOrthogonal() {\n      var point = Point.read(arguments);\n      return Point.isOrthogonal(this.x, this.y, point.x, point.y);\n    },\n    isZero: function isZero() {\n      var isZero = Numerical.isZero;\n      return isZero(this.x) && isZero(this.y);\n    },\n    isNaN: function (_isNaN) {\n      function isNaN() {\n        return _isNaN.apply(this, arguments);\n      }\n\n      isNaN.toString = function () {\n        return _isNaN.toString();\n      };\n\n      return isNaN;\n    }(function () {\n      return isNaN(this.x) || isNaN(this.y);\n    }),\n    isInQuadrant: function isInQuadrant(q) {\n      return this.x * (q > 1 && q < 4 ? -1 : 1) >= 0 && this.y * (q > 2 ? -1 : 1) >= 0;\n    },\n    dot: function dot() {\n      var point = Point.read(arguments);\n      return this.x * point.x + this.y * point.y;\n    },\n    cross: function cross() {\n      var point = Point.read(arguments);\n      return this.x * point.y - this.y * point.x;\n    },\n    project: function project() {\n      var point = Point.read(arguments),\n          scale = point.isZero() ? 0 : this.dot(point) / point.dot(point);\n      return new Point(point.x * scale, point.y * scale);\n    },\n    statics: {\n      min: function min() {\n        var point1 = Point.read(arguments),\n            point2 = Point.read(arguments);\n        return new Point(Math.min(point1.x, point2.x), Math.min(point1.y, point2.y));\n      },\n      max: function max() {\n        var point1 = Point.read(arguments),\n            point2 = Point.read(arguments);\n        return new Point(Math.max(point1.x, point2.x), Math.max(point1.y, point2.y));\n      },\n      random: function random() {\n        return new Point(Math.random(), Math.random());\n      },\n      isCollinear: function isCollinear(x1, y1, x2, y2) {\n        return Math.abs(x1 * y2 - y1 * x2) <= Math.sqrt((x1 * x1 + y1 * y1) * (x2 * x2 + y2 * y2)) * 1e-8;\n      },\n      isOrthogonal: function isOrthogonal(x1, y1, x2, y2) {\n        return Math.abs(x1 * x2 + y1 * y2) <= Math.sqrt((x1 * x1 + y1 * y1) * (x2 * x2 + y2 * y2)) * 1e-8;\n      }\n    }\n  }, Base.each(['round', 'ceil', 'floor', 'abs'], function (key) {\n    var op = Math[key];\n\n    this[key] = function () {\n      return new Point(op(this.x), op(this.y));\n    };\n  }, {}));\n  var LinkedPoint = Point.extend({\n    initialize: function Point(x, y, owner, setter) {\n      this._x = x;\n      this._y = y;\n      this._owner = owner;\n      this._setter = setter;\n    },\n    _set: function _set(x, y, _dontNotify) {\n      this._x = x;\n      this._y = y;\n      if (!_dontNotify) this._owner[this._setter](this);\n      return this;\n    },\n    getX: function getX() {\n      return this._x;\n    },\n    setX: function setX(x) {\n      this._x = x;\n\n      this._owner[this._setter](this);\n    },\n    getY: function getY() {\n      return this._y;\n    },\n    setY: function setY(y) {\n      this._y = y;\n\n      this._owner[this._setter](this);\n    },\n    isSelected: function isSelected() {\n      return !!(this._owner._selection & this._getSelection());\n    },\n    setSelected: function setSelected(selected) {\n      this._owner._changeSelection(this._getSelection(), selected);\n    },\n    _getSelection: function _getSelection() {\n      return this._setter === 'setPosition' ? 4 : 0;\n    }\n  });\n  var Size = Base.extend({\n    _class: 'Size',\n    _readIndex: true,\n    initialize: function Size(arg0, arg1) {\n      var type = _typeof(arg0),\n          reading = this.__read,\n          read = 0;\n\n      if (type === 'number') {\n        var hasHeight = typeof arg1 === 'number';\n\n        this._set(arg0, hasHeight ? arg1 : arg0);\n\n        if (reading) read = hasHeight ? 2 : 1;\n      } else if (type === 'undefined' || arg0 === null) {\n        this._set(0, 0);\n\n        if (reading) read = arg0 === null ? 1 : 0;\n      } else {\n        var obj = type === 'string' ? arg0.split(/[\\s,]+/) || [] : arg0;\n        read = 1;\n\n        if (_Array$isArray(obj)) {\n          this._set(+obj[0], +(obj.length > 1 ? obj[1] : obj[0]));\n        } else if ('width' in obj) {\n          this._set(obj.width || 0, obj.height || 0);\n        } else if ('x' in obj) {\n          this._set(obj.x || 0, obj.y || 0);\n        } else {\n          this._set(0, 0);\n\n          read = 0;\n        }\n      }\n\n      if (reading) this.__read = read;\n      return this;\n    },\n    set: '#initialize',\n    _set: function _set(width, height) {\n      this.width = width;\n      this.height = height;\n      return this;\n    },\n    equals: function equals(size) {\n      return size === this || size && (this.width === size.width && this.height === size.height || _Array$isArray(size) && this.width === size[0] && this.height === size[1]) || false;\n    },\n    clone: function clone() {\n      return new Size(this.width, this.height);\n    },\n    toString: function toString() {\n      var f = Formatter.instance;\n      return '{ width: ' + f.number(this.width) + ', height: ' + f.number(this.height) + ' }';\n    },\n    _serialize: function _serialize(options) {\n      var f = options.formatter;\n      return [f.number(this.width), f.number(this.height)];\n    },\n    add: function add() {\n      var size = Size.read(arguments);\n      return new Size(this.width + size.width, this.height + size.height);\n    },\n    subtract: function subtract() {\n      var size = Size.read(arguments);\n      return new Size(this.width - size.width, this.height - size.height);\n    },\n    multiply: function multiply() {\n      var size = Size.read(arguments);\n      return new Size(this.width * size.width, this.height * size.height);\n    },\n    divide: function divide() {\n      var size = Size.read(arguments);\n      return new Size(this.width / size.width, this.height / size.height);\n    },\n    modulo: function modulo() {\n      var size = Size.read(arguments);\n      return new Size(this.width % size.width, this.height % size.height);\n    },\n    negate: function negate() {\n      return new Size(-this.width, -this.height);\n    },\n    isZero: function isZero() {\n      var isZero = Numerical.isZero;\n      return isZero(this.width) && isZero(this.height);\n    },\n    isNaN: function (_isNaN2) {\n      function isNaN() {\n        return _isNaN2.apply(this, arguments);\n      }\n\n      isNaN.toString = function () {\n        return _isNaN2.toString();\n      };\n\n      return isNaN;\n    }(function () {\n      return isNaN(this.width) || isNaN(this.height);\n    }),\n    statics: {\n      min: function min(size1, size2) {\n        return new Size(Math.min(size1.width, size2.width), Math.min(size1.height, size2.height));\n      },\n      max: function max(size1, size2) {\n        return new Size(Math.max(size1.width, size2.width), Math.max(size1.height, size2.height));\n      },\n      random: function random() {\n        return new Size(Math.random(), Math.random());\n      }\n    }\n  }, Base.each(['round', 'ceil', 'floor', 'abs'], function (key) {\n    var op = Math[key];\n\n    this[key] = function () {\n      return new Size(op(this.width), op(this.height));\n    };\n  }, {}));\n  var LinkedSize = Size.extend({\n    initialize: function Size(width, height, owner, setter) {\n      this._width = width;\n      this._height = height;\n      this._owner = owner;\n      this._setter = setter;\n    },\n    _set: function _set(width, height, _dontNotify) {\n      this._width = width;\n      this._height = height;\n      if (!_dontNotify) this._owner[this._setter](this);\n      return this;\n    },\n    getWidth: function getWidth() {\n      return this._width;\n    },\n    setWidth: function setWidth(width) {\n      this._width = width;\n\n      this._owner[this._setter](this);\n    },\n    getHeight: function getHeight() {\n      return this._height;\n    },\n    setHeight: function setHeight(height) {\n      this._height = height;\n\n      this._owner[this._setter](this);\n    }\n  });\n\n  var _Rectangle = Base.extend({\n    _class: 'Rectangle',\n    _readIndex: true,\n    beans: true,\n    initialize: function Rectangle(arg0, arg1, arg2, arg3) {\n      var type = _typeof(arg0),\n          read;\n\n      if (type === 'number') {\n        this._set(arg0, arg1, arg2, arg3);\n\n        read = 4;\n      } else if (type === 'undefined' || arg0 === null) {\n        this._set(0, 0, 0, 0);\n\n        read = arg0 === null ? 1 : 0;\n      } else if (arguments.length === 1) {\n        if (_Array$isArray(arg0)) {\n          this._set.apply(this, arg0);\n\n          read = 1;\n        } else if (arg0.x !== undefined || arg0.width !== undefined) {\n          this._set(arg0.x || 0, arg0.y || 0, arg0.width || 0, arg0.height || 0);\n\n          read = 1;\n        } else if (arg0.from === undefined && arg0.to === undefined) {\n          this._set(0, 0, 0, 0);\n\n          Base.filter(this, arg0);\n          read = 1;\n        }\n      }\n\n      if (read === undefined) {\n        var frm = Point.readNamed(arguments, 'from'),\n            next = Base.peek(arguments),\n            x = frm.x,\n            y = frm.y,\n            width,\n            height;\n\n        if (next && next.x !== undefined || Base.hasNamed(arguments, 'to')) {\n          var to = Point.readNamed(arguments, 'to');\n          width = to.x - x;\n          height = to.y - y;\n\n          if (width < 0) {\n            x = to.x;\n            width = -width;\n          }\n\n          if (height < 0) {\n            y = to.y;\n            height = -height;\n          }\n        } else {\n          var size = Size.read(arguments);\n          width = size.width;\n          height = size.height;\n        }\n\n        this._set(x, y, width, height);\n\n        read = arguments.__index;\n        var filtered = arguments.__filtered;\n        if (filtered) this.__filtered = filtered;\n      }\n\n      if (this.__read) this.__read = read;\n      return this;\n    },\n    set: '#initialize',\n    _set: function _set(x, y, width, height) {\n      this.x = x;\n      this.y = y;\n      this.width = width;\n      this.height = height;\n      return this;\n    },\n    clone: function clone() {\n      return new _Rectangle(this.x, this.y, this.width, this.height);\n    },\n    equals: function equals(rect) {\n      var rt = Base.isPlainValue(rect) ? _Rectangle.read(arguments) : rect;\n      return rt === this || rt && this.x === rt.x && this.y === rt.y && this.width === rt.width && this.height === rt.height || false;\n    },\n    toString: function toString() {\n      var f = Formatter.instance;\n      return '{ x: ' + f.number(this.x) + ', y: ' + f.number(this.y) + ', width: ' + f.number(this.width) + ', height: ' + f.number(this.height) + ' }';\n    },\n    _serialize: function _serialize(options) {\n      var f = options.formatter;\n      return [f.number(this.x), f.number(this.y), f.number(this.width), f.number(this.height)];\n    },\n    getPoint: function getPoint(_dontLink) {\n      var ctor = _dontLink ? Point : LinkedPoint;\n      return new ctor(this.x, this.y, this, 'setPoint');\n    },\n    setPoint: function setPoint() {\n      var point = Point.read(arguments);\n      this.x = point.x;\n      this.y = point.y;\n    },\n    getSize: function getSize(_dontLink) {\n      var ctor = _dontLink ? Size : LinkedSize;\n      return new ctor(this.width, this.height, this, 'setSize');\n    },\n    _fw: 1,\n    _fh: 1,\n    setSize: function setSize() {\n      var size = Size.read(arguments),\n          sx = this._sx,\n          sy = this._sy,\n          w = size.width,\n          h = size.height;\n\n      if (sx) {\n        this.x += (this.width - w) * sx;\n      }\n\n      if (sy) {\n        this.y += (this.height - h) * sy;\n      }\n\n      this.width = w;\n      this.height = h;\n      this._fw = this._fh = 1;\n    },\n    getLeft: function getLeft() {\n      return this.x;\n    },\n    setLeft: function setLeft(left) {\n      if (!this._fw) {\n        var amount = left - this.x;\n        this.width -= this._sx === 0.5 ? amount * 2 : amount;\n      }\n\n      this.x = left;\n      this._sx = this._fw = 0;\n    },\n    getTop: function getTop() {\n      return this.y;\n    },\n    setTop: function setTop(top) {\n      if (!this._fh) {\n        var amount = top - this.y;\n        this.height -= this._sy === 0.5 ? amount * 2 : amount;\n      }\n\n      this.y = top;\n      this._sy = this._fh = 0;\n    },\n    getRight: function getRight() {\n      return this.x + this.width;\n    },\n    setRight: function setRight(right) {\n      if (!this._fw) {\n        var amount = right - this.x;\n        this.width = this._sx === 0.5 ? amount * 2 : amount;\n      }\n\n      this.x = right - this.width;\n      this._sx = 1;\n      this._fw = 0;\n    },\n    getBottom: function getBottom() {\n      return this.y + this.height;\n    },\n    setBottom: function setBottom(bottom) {\n      if (!this._fh) {\n        var amount = bottom - this.y;\n        this.height = this._sy === 0.5 ? amount * 2 : amount;\n      }\n\n      this.y = bottom - this.height;\n      this._sy = 1;\n      this._fh = 0;\n    },\n    getCenterX: function getCenterX() {\n      return this.x + this.width / 2;\n    },\n    setCenterX: function setCenterX(x) {\n      if (this._fw || this._sx === 0.5) {\n        this.x = x - this.width / 2;\n      } else {\n        if (this._sx) {\n          this.x += (x - this.x) * 2 * this._sx;\n        }\n\n        this.width = (x - this.x) * 2;\n      }\n\n      this._sx = 0.5;\n      this._fw = 0;\n    },\n    getCenterY: function getCenterY() {\n      return this.y + this.height / 2;\n    },\n    setCenterY: function setCenterY(y) {\n      if (this._fh || this._sy === 0.5) {\n        this.y = y - this.height / 2;\n      } else {\n        if (this._sy) {\n          this.y += (y - this.y) * 2 * this._sy;\n        }\n\n        this.height = (y - this.y) * 2;\n      }\n\n      this._sy = 0.5;\n      this._fh = 0;\n    },\n    getCenter: function getCenter(_dontLink) {\n      var ctor = _dontLink ? Point : LinkedPoint;\n      return new ctor(this.getCenterX(), this.getCenterY(), this, 'setCenter');\n    },\n    setCenter: function setCenter() {\n      var point = Point.read(arguments);\n      this.setCenterX(point.x);\n      this.setCenterY(point.y);\n      return this;\n    },\n    getArea: function getArea() {\n      return this.width * this.height;\n    },\n    isEmpty: function isEmpty() {\n      return this.width === 0 || this.height === 0;\n    },\n    contains: function contains(arg) {\n      return arg && arg.width !== undefined || (_Array$isArray(arg) ? arg : arguments).length === 4 ? this._containsRectangle(_Rectangle.read(arguments)) : this._containsPoint(Point.read(arguments));\n    },\n    _containsPoint: function _containsPoint(point) {\n      var x = point.x,\n          y = point.y;\n      return x >= this.x && y >= this.y && x <= this.x + this.width && y <= this.y + this.height;\n    },\n    _containsRectangle: function _containsRectangle(rect) {\n      var x = rect.x,\n          y = rect.y;\n      return x >= this.x && y >= this.y && x + rect.width <= this.x + this.width && y + rect.height <= this.y + this.height;\n    },\n    intersects: function intersects() {\n      var rect = _Rectangle.read(arguments),\n          epsilon = Base.read(arguments) || 0;\n\n      return rect.x + rect.width > this.x - epsilon && rect.y + rect.height > this.y - epsilon && rect.x < this.x + this.width + epsilon && rect.y < this.y + this.height + epsilon;\n    },\n    intersect: function intersect() {\n      var rect = _Rectangle.read(arguments),\n          x1 = Math.max(this.x, rect.x),\n          y1 = Math.max(this.y, rect.y),\n          x2 = Math.min(this.x + this.width, rect.x + rect.width),\n          y2 = Math.min(this.y + this.height, rect.y + rect.height);\n\n      return new _Rectangle(x1, y1, x2 - x1, y2 - y1);\n    },\n    unite: function unite() {\n      var rect = _Rectangle.read(arguments),\n          x1 = Math.min(this.x, rect.x),\n          y1 = Math.min(this.y, rect.y),\n          x2 = Math.max(this.x + this.width, rect.x + rect.width),\n          y2 = Math.max(this.y + this.height, rect.y + rect.height);\n\n      return new _Rectangle(x1, y1, x2 - x1, y2 - y1);\n    },\n    include: function include() {\n      var point = Point.read(arguments);\n      var x1 = Math.min(this.x, point.x),\n          y1 = Math.min(this.y, point.y),\n          x2 = Math.max(this.x + this.width, point.x),\n          y2 = Math.max(this.y + this.height, point.y);\n      return new _Rectangle(x1, y1, x2 - x1, y2 - y1);\n    },\n    expand: function expand() {\n      var amount = Size.read(arguments),\n          hor = amount.width,\n          ver = amount.height;\n      return new _Rectangle(this.x - hor / 2, this.y - ver / 2, this.width + hor, this.height + ver);\n    },\n    scale: function scale(hor, ver) {\n      return this.expand(this.width * hor - this.width, this.height * (ver === undefined ? hor : ver) - this.height);\n    }\n  }, Base.each([['Top', 'Left'], ['Top', 'Right'], ['Bottom', 'Left'], ['Bottom', 'Right'], ['Left', 'Center'], ['Top', 'Center'], ['Right', 'Center'], ['Bottom', 'Center']], function (parts, index) {\n    var part = parts.join(''),\n        xFirst = /^[RL]/.test(part);\n    if (index >= 4) parts[1] += xFirst ? 'Y' : 'X';\n    var x = parts[xFirst ? 0 : 1],\n        y = parts[xFirst ? 1 : 0],\n        getX = 'get' + x,\n        getY = 'get' + y,\n        setX = 'set' + x,\n        setY = 'set' + y,\n        get = 'get' + part,\n        set = 'set' + part;\n\n    this[get] = function (_dontLink) {\n      var ctor = _dontLink ? Point : LinkedPoint;\n      return new ctor(this[getX](), this[getY](), this, set);\n    };\n\n    this[set] = function () {\n      var point = Point.read(arguments);\n      this[setX](point.x);\n      this[setY](point.y);\n    };\n  }, {\n    beans: true\n  }));\n\n  var LinkedRectangle = _Rectangle.extend({\n    initialize: function Rectangle(x, y, width, height, owner, setter) {\n      this._set(x, y, width, height, true);\n\n      this._owner = owner;\n      this._setter = setter;\n    },\n    _set: function _set(x, y, width, height, _dontNotify) {\n      this._x = x;\n      this._y = y;\n      this._width = width;\n      this._height = height;\n      if (!_dontNotify) this._owner[this._setter](this);\n      return this;\n    }\n  }, new function () {\n    var proto = _Rectangle.prototype;\n    return Base.each(['x', 'y', 'width', 'height'], function (key) {\n      var part = Base.capitalize(key),\n          internal = '_' + key;\n\n      this['get' + part] = function () {\n        return this[internal];\n      };\n\n      this['set' + part] = function (value) {\n        this[internal] = value;\n        if (!this._dontNotify) this._owner[this._setter](this);\n      };\n    }, Base.each(['Point', 'Size', 'Center', 'Left', 'Top', 'Right', 'Bottom', 'CenterX', 'CenterY', 'TopLeft', 'TopRight', 'BottomLeft', 'BottomRight', 'LeftCenter', 'TopCenter', 'RightCenter', 'BottomCenter'], function (key) {\n      var name = 'set' + key;\n\n      this[name] = function () {\n        this._dontNotify = true;\n        proto[name].apply(this, arguments);\n        this._dontNotify = false;\n\n        this._owner[this._setter](this);\n      };\n    }, {\n      isSelected: function isSelected() {\n        return !!(this._owner._selection & 2);\n      },\n      setSelected: function setSelected(selected) {\n        var owner = this._owner;\n\n        if (owner._changeSelection) {\n          owner._changeSelection(2, selected);\n        }\n      }\n    }));\n  }());\n\n  var Matrix = Base.extend({\n    _class: 'Matrix',\n    initialize: function Matrix(arg, _dontNotify) {\n      var count = arguments.length,\n          ok = true;\n\n      if (count >= 6) {\n        this._set.apply(this, arguments);\n      } else if (count === 1 || count === 2) {\n        if (arg instanceof Matrix) {\n          this._set(arg._a, arg._b, arg._c, arg._d, arg._tx, arg._ty, _dontNotify);\n        } else if (_Array$isArray(arg)) {\n          this._set.apply(this, _dontNotify ? arg.concat([_dontNotify]) : arg);\n        } else {\n          ok = false;\n        }\n      } else if (!count) {\n        this.reset();\n      } else {\n        ok = false;\n      }\n\n      if (!ok) {\n        throw new Error('Unsupported matrix parameters');\n      }\n\n      return this;\n    },\n    set: '#initialize',\n    _set: function _set(a, b, c, d, tx, ty, _dontNotify) {\n      this._a = a;\n      this._b = b;\n      this._c = c;\n      this._d = d;\n      this._tx = tx;\n      this._ty = ty;\n      if (!_dontNotify) this._changed();\n      return this;\n    },\n    _serialize: function _serialize(options, dictionary) {\n      return Base.serialize(this.getValues(), options, true, dictionary);\n    },\n    _changed: function _changed() {\n      var owner = this._owner;\n\n      if (owner) {\n        if (owner._applyMatrix) {\n          owner.transform(null, true);\n        } else {\n          owner._changed(25);\n        }\n      }\n    },\n    clone: function clone() {\n      return new Matrix(this._a, this._b, this._c, this._d, this._tx, this._ty);\n    },\n    equals: function equals(mx) {\n      return mx === this || mx && this._a === mx._a && this._b === mx._b && this._c === mx._c && this._d === mx._d && this._tx === mx._tx && this._ty === mx._ty;\n    },\n    toString: function toString() {\n      var f = Formatter.instance;\n      return '[[' + [f.number(this._a), f.number(this._c), f.number(this._tx)].join(', ') + '], [' + [f.number(this._b), f.number(this._d), f.number(this._ty)].join(', ') + ']]';\n    },\n    reset: function reset(_dontNotify) {\n      this._a = this._d = 1;\n      this._b = this._c = this._tx = this._ty = 0;\n      if (!_dontNotify) this._changed();\n      return this;\n    },\n    apply: function apply(recursively, _setApplyMatrix) {\n      var owner = this._owner;\n\n      if (owner) {\n        owner.transform(null, true, Base.pick(recursively, true), _setApplyMatrix);\n        return this.isIdentity();\n      }\n\n      return false;\n    },\n    translate: function translate() {\n      var point = Point.read(arguments),\n          x = point.x,\n          y = point.y;\n      this._tx += x * this._a + y * this._c;\n      this._ty += x * this._b + y * this._d;\n\n      this._changed();\n\n      return this;\n    },\n    scale: function scale() {\n      var scale = Point.read(arguments),\n          center = Point.read(arguments, 0, {\n        readNull: true\n      });\n      if (center) this.translate(center);\n      this._a *= scale.x;\n      this._b *= scale.x;\n      this._c *= scale.y;\n      this._d *= scale.y;\n      if (center) this.translate(center.negate());\n\n      this._changed();\n\n      return this;\n    },\n    rotate: function rotate(angle) {\n      angle *= Math.PI / 180;\n      var center = Point.read(arguments, 1),\n          x = center.x,\n          y = center.y,\n          cos = Math.cos(angle),\n          sin = Math.sin(angle),\n          tx = x - x * cos + y * sin,\n          ty = y - x * sin - y * cos,\n          a = this._a,\n          b = this._b,\n          c = this._c,\n          d = this._d;\n      this._a = cos * a + sin * c;\n      this._b = cos * b + sin * d;\n      this._c = -sin * a + cos * c;\n      this._d = -sin * b + cos * d;\n      this._tx += tx * a + ty * c;\n      this._ty += tx * b + ty * d;\n\n      this._changed();\n\n      return this;\n    },\n    shear: function shear() {\n      var shear = Point.read(arguments),\n          center = Point.read(arguments, 0, {\n        readNull: true\n      });\n      if (center) this.translate(center);\n      var a = this._a,\n          b = this._b;\n      this._a += shear.y * this._c;\n      this._b += shear.y * this._d;\n      this._c += shear.x * a;\n      this._d += shear.x * b;\n      if (center) this.translate(center.negate());\n\n      this._changed();\n\n      return this;\n    },\n    skew: function skew() {\n      var skew = Point.read(arguments),\n          center = Point.read(arguments, 0, {\n        readNull: true\n      }),\n          toRadians = Math.PI / 180,\n          shear = new Point(Math.tan(skew.x * toRadians), Math.tan(skew.y * toRadians));\n      return this.shear(shear, center);\n    },\n    append: function append(mx, _dontNotify) {\n      if (mx) {\n        var a1 = this._a,\n            b1 = this._b,\n            c1 = this._c,\n            d1 = this._d,\n            a2 = mx._a,\n            b2 = mx._c,\n            c2 = mx._b,\n            d2 = mx._d,\n            tx2 = mx._tx,\n            ty2 = mx._ty;\n        this._a = a2 * a1 + c2 * c1;\n        this._c = b2 * a1 + d2 * c1;\n        this._b = a2 * b1 + c2 * d1;\n        this._d = b2 * b1 + d2 * d1;\n        this._tx += tx2 * a1 + ty2 * c1;\n        this._ty += tx2 * b1 + ty2 * d1;\n        if (!_dontNotify) this._changed();\n      }\n\n      return this;\n    },\n    prepend: function prepend(mx, _dontNotify) {\n      if (mx) {\n        var a1 = this._a,\n            b1 = this._b,\n            c1 = this._c,\n            d1 = this._d,\n            tx1 = this._tx,\n            ty1 = this._ty,\n            a2 = mx._a,\n            b2 = mx._c,\n            c2 = mx._b,\n            d2 = mx._d,\n            tx2 = mx._tx,\n            ty2 = mx._ty;\n        this._a = a2 * a1 + b2 * b1;\n        this._c = a2 * c1 + b2 * d1;\n        this._b = c2 * a1 + d2 * b1;\n        this._d = c2 * c1 + d2 * d1;\n        this._tx = a2 * tx1 + b2 * ty1 + tx2;\n        this._ty = c2 * tx1 + d2 * ty1 + ty2;\n        if (!_dontNotify) this._changed();\n      }\n\n      return this;\n    },\n    appended: function appended(mx) {\n      return this.clone().append(mx);\n    },\n    prepended: function prepended(mx) {\n      return this.clone().prepend(mx);\n    },\n    invert: function invert() {\n      var a = this._a,\n          b = this._b,\n          c = this._c,\n          d = this._d,\n          tx = this._tx,\n          ty = this._ty,\n          det = a * d - b * c,\n          res = null;\n\n      if (det && !isNaN(det) && isFinite(tx) && isFinite(ty)) {\n        this._a = d / det;\n        this._b = -b / det;\n        this._c = -c / det;\n        this._d = a / det;\n        this._tx = (c * ty - d * tx) / det;\n        this._ty = (b * tx - a * ty) / det;\n        res = this;\n      }\n\n      return res;\n    },\n    inverted: function inverted() {\n      return this.clone().invert();\n    },\n    concatenate: '#append',\n    preConcatenate: '#prepend',\n    chain: '#appended',\n    _shiftless: function _shiftless() {\n      return new Matrix(this._a, this._b, this._c, this._d, 0, 0);\n    },\n    _orNullIfIdentity: function _orNullIfIdentity() {\n      return this.isIdentity() ? null : this;\n    },\n    isIdentity: function isIdentity() {\n      return this._a === 1 && this._b === 0 && this._c === 0 && this._d === 1 && this._tx === 0 && this._ty === 0;\n    },\n    isInvertible: function isInvertible() {\n      var det = this._a * this._d - this._c * this._b;\n      return det && !isNaN(det) && isFinite(this._tx) && isFinite(this._ty);\n    },\n    isSingular: function isSingular() {\n      return !this.isInvertible();\n    },\n    transform: function transform(src, dst, count) {\n      return arguments.length < 3 ? this._transformPoint(Point.read(arguments)) : this._transformCoordinates(src, dst, count);\n    },\n    _transformPoint: function _transformPoint(point, dest, _dontNotify) {\n      var x = point.x,\n          y = point.y;\n      if (!dest) dest = new Point();\n      return dest._set(x * this._a + y * this._c + this._tx, x * this._b + y * this._d + this._ty, _dontNotify);\n    },\n    _transformCoordinates: function _transformCoordinates(src, dst, count) {\n      for (var i = 0, max = 2 * count; i < max; i += 2) {\n        var x = src[i],\n            y = src[i + 1];\n        dst[i] = x * this._a + y * this._c + this._tx;\n        dst[i + 1] = x * this._b + y * this._d + this._ty;\n      }\n\n      return dst;\n    },\n    _transformCorners: function _transformCorners(rect) {\n      var x1 = rect.x,\n          y1 = rect.y,\n          x2 = x1 + rect.width,\n          y2 = y1 + rect.height,\n          coords = [x1, y1, x2, y1, x2, y2, x1, y2];\n      return this._transformCoordinates(coords, coords, 4);\n    },\n    _transformBounds: function _transformBounds(bounds, dest, _dontNotify) {\n      var coords = this._transformCorners(bounds),\n          min = coords.slice(0, 2),\n          max = min.slice();\n\n      for (var i = 2; i < 8; i++) {\n        var val = coords[i],\n            j = i & 1;\n\n        if (val < min[j]) {\n          min[j] = val;\n        } else if (val > max[j]) {\n          max[j] = val;\n        }\n      }\n\n      if (!dest) dest = new _Rectangle();\n      return dest._set(min[0], min[1], max[0] - min[0], max[1] - min[1], _dontNotify);\n    },\n    inverseTransform: function inverseTransform() {\n      return this._inverseTransform(Point.read(arguments));\n    },\n    _inverseTransform: function _inverseTransform(point, dest, _dontNotify) {\n      var a = this._a,\n          b = this._b,\n          c = this._c,\n          d = this._d,\n          tx = this._tx,\n          ty = this._ty,\n          det = a * d - b * c,\n          res = null;\n\n      if (det && !isNaN(det) && isFinite(tx) && isFinite(ty)) {\n        var x = point.x - this._tx,\n            y = point.y - this._ty;\n        if (!dest) dest = new Point();\n        res = dest._set((x * d - y * c) / det, (y * a - x * b) / det, _dontNotify);\n      }\n\n      return res;\n    },\n    decompose: function decompose() {\n      var a = this._a,\n          b = this._b,\n          c = this._c,\n          d = this._d,\n          det = a * d - b * c,\n          sqrt = Math.sqrt,\n          atan2 = Math.atan2,\n          degrees = 180 / Math.PI,\n          rotate,\n          scale,\n          skew;\n\n      if (a !== 0 || b !== 0) {\n        var r = sqrt(a * a + b * b);\n        rotate = Math.acos(a / r) * (b > 0 ? 1 : -1);\n        scale = [r, det / r];\n        skew = [atan2(a * c + b * d, r * r), 0];\n      } else if (c !== 0 || d !== 0) {\n        var s = sqrt(c * c + d * d);\n        rotate = Math.asin(c / s) * (d > 0 ? 1 : -1);\n        scale = [det / s, s];\n        skew = [0, atan2(a * c + b * d, s * s)];\n      } else {\n        rotate = 0;\n        skew = scale = [0, 0];\n      }\n\n      return {\n        translation: this.getTranslation(),\n        rotation: rotate * degrees,\n        scaling: new Point(scale),\n        skewing: new Point(skew[0] * degrees, skew[1] * degrees)\n      };\n    },\n    getValues: function getValues() {\n      return [this._a, this._b, this._c, this._d, this._tx, this._ty];\n    },\n    getTranslation: function getTranslation() {\n      return new Point(this._tx, this._ty);\n    },\n    getScaling: function getScaling() {\n      return this.decompose().scaling;\n    },\n    getRotation: function getRotation() {\n      return this.decompose().rotation;\n    },\n    applyToContext: function applyToContext(ctx) {\n      if (!this.isIdentity()) {\n        ctx.transform(this._a, this._b, this._c, this._d, this._tx, this._ty);\n      }\n    }\n  }, Base.each(['a', 'b', 'c', 'd', 'tx', 'ty'], function (key) {\n    var part = Base.capitalize(key),\n        prop = '_' + key;\n\n    this['get' + part] = function () {\n      return this[prop];\n    };\n\n    this['set' + part] = function (value) {\n      this[prop] = value;\n\n      this._changed();\n    };\n  }, {}));\n  var Line = Base.extend({\n    _class: 'Line',\n    initialize: function Line(arg0, arg1, arg2, arg3, arg4) {\n      var asVector = false;\n\n      if (arguments.length >= 4) {\n        this._px = arg0;\n        this._py = arg1;\n        this._vx = arg2;\n        this._vy = arg3;\n        asVector = arg4;\n      } else {\n        this._px = arg0.x;\n        this._py = arg0.y;\n        this._vx = arg1.x;\n        this._vy = arg1.y;\n        asVector = arg2;\n      }\n\n      if (!asVector) {\n        this._vx -= this._px;\n        this._vy -= this._py;\n      }\n    },\n    getPoint: function getPoint() {\n      return new Point(this._px, this._py);\n    },\n    getVector: function getVector() {\n      return new Point(this._vx, this._vy);\n    },\n    getLength: function getLength() {\n      return this.getVector().getLength();\n    },\n    intersect: function intersect(line, isInfinite) {\n      return Line.intersect(this._px, this._py, this._vx, this._vy, line._px, line._py, line._vx, line._vy, true, isInfinite);\n    },\n    getSide: function getSide(point, isInfinite) {\n      return Line.getSide(this._px, this._py, this._vx, this._vy, point.x, point.y, true, isInfinite);\n    },\n    getDistance: function getDistance(point) {\n      return Math.abs(this.getSignedDistance(point));\n    },\n    getSignedDistance: function getSignedDistance(point) {\n      return Line.getSignedDistance(this._px, this._py, this._vx, this._vy, point.x, point.y, true);\n    },\n    isCollinear: function isCollinear(line) {\n      return Point.isCollinear(this._vx, this._vy, line._vx, line._vy);\n    },\n    isOrthogonal: function isOrthogonal(line) {\n      return Point.isOrthogonal(this._vx, this._vy, line._vx, line._vy);\n    },\n    statics: {\n      intersect: function intersect(p1x, p1y, v1x, v1y, p2x, p2y, v2x, v2y, asVector, isInfinite) {\n        if (!asVector) {\n          v1x -= p1x;\n          v1y -= p1y;\n          v2x -= p2x;\n          v2y -= p2y;\n        }\n\n        var cross = v1x * v2y - v1y * v2x;\n\n        if (!Numerical.isZero(cross)) {\n          var dx = p1x - p2x,\n              dy = p1y - p2y,\n              u1 = (v2x * dy - v2y * dx) / cross,\n              u2 = (v1x * dy - v1y * dx) / cross,\n              epsilon = 1e-12,\n              uMin = -epsilon,\n              uMax = 1 + epsilon;\n\n          if (isInfinite || uMin < u1 && u1 < uMax && uMin < u2 && u2 < uMax) {\n            if (!isInfinite) {\n              u1 = u1 <= 0 ? 0 : u1 >= 1 ? 1 : u1;\n            }\n\n            return new Point(p1x + u1 * v1x, p1y + u1 * v1y);\n          }\n        }\n      },\n      getSide: function getSide(px, py, vx, vy, x, y, asVector, isInfinite) {\n        if (!asVector) {\n          vx -= px;\n          vy -= py;\n        }\n\n        var v2x = x - px,\n            v2y = y - py,\n            ccw = v2x * vy - v2y * vx;\n\n        if (!isInfinite && Numerical.isZero(ccw)) {\n          ccw = (v2x * vx + v2x * vx) / (vx * vx + vy * vy);\n          if (ccw >= 0 && ccw <= 1) ccw = 0;\n        }\n\n        return ccw < 0 ? -1 : ccw > 0 ? 1 : 0;\n      },\n      getSignedDistance: function getSignedDistance(px, py, vx, vy, x, y, asVector) {\n        if (!asVector) {\n          vx -= px;\n          vy -= py;\n        }\n\n        return vx === 0 ? vy > 0 ? x - px : px - x : vy === 0 ? vx < 0 ? y - py : py - y : ((x - px) * vy - (y - py) * vx) / Math.sqrt(vx * vx + vy * vy);\n      },\n      getDistance: function getDistance(px, py, vx, vy, x, y, asVector) {\n        return Math.abs(Line.getSignedDistance(px, py, vx, vy, x, y, asVector));\n      }\n    }\n  });\n  var Project = PaperScopeItem.extend({\n    _class: 'Project',\n    _list: 'projects',\n    _reference: 'project',\n    _compactSerialize: true,\n    initialize: function Project(element) {\n      PaperScopeItem.call(this, true);\n      this._children = [];\n      this._namedChildren = {};\n      this._activeLayer = null;\n      this._currentStyle = new Style(null, null, this);\n      this._view = View.create(this, element || CanvasProvider.getCanvas(1, 1));\n      this._selectionItems = {};\n      this._selectionCount = 0;\n      this._updateVersion = 0;\n    },\n    _serialize: function _serialize(options, dictionary) {\n      return Base.serialize(this._children, options, true, dictionary);\n    },\n    _changed: function _changed(flags, item) {\n      if (flags & 1) {\n        var view = this._view;\n\n        if (view) {\n          view._needsUpdate = true;\n          if (!view._requested && view._autoUpdate) view.requestUpdate();\n        }\n      }\n\n      var changes = this._changes;\n\n      if (changes && item) {\n        var changesById = this._changesById,\n            id = item._id,\n            entry = changesById[id];\n\n        if (entry) {\n          entry.flags |= flags;\n        } else {\n          changes.push(changesById[id] = {\n            item: item,\n            flags: flags\n          });\n        }\n      }\n    },\n    clear: function clear() {\n      var children = this._children;\n\n      for (var i = children.length - 1; i >= 0; i--) {\n        children[i].remove();\n      }\n    },\n    isEmpty: function isEmpty() {\n      return !this._children.length;\n    },\n    remove: function remove() {\n      if (!remove.base.call(this)) return false;\n      if (this._view) this._view.remove();\n      return true;\n    },\n    getView: function getView() {\n      return this._view;\n    },\n    getCurrentStyle: function getCurrentStyle() {\n      return this._currentStyle;\n    },\n    setCurrentStyle: function setCurrentStyle(style) {\n      this._currentStyle.set(style);\n    },\n    getIndex: function getIndex() {\n      return this._index;\n    },\n    getOptions: function getOptions() {\n      return this._scope.settings;\n    },\n    getLayers: function getLayers() {\n      return this._children;\n    },\n    getActiveLayer: function getActiveLayer() {\n      return this._activeLayer || new Layer({\n        project: this,\n        insert: true\n      });\n    },\n    getSymbolDefinitions: function getSymbolDefinitions() {\n      var definitions = [],\n          ids = {};\n      this.getItems({\n        class: SymbolItem,\n        match: function match(item) {\n          var definition = item._definition,\n              id = definition._id;\n\n          if (!ids[id]) {\n            ids[id] = true;\n            definitions.push(definition);\n          }\n\n          return false;\n        }\n      });\n      return definitions;\n    },\n    getSymbols: 'getSymbolDefinitions',\n    getSelectedItems: function getSelectedItems() {\n      var selectionItems = this._selectionItems,\n          items = [];\n\n      for (var id in selectionItems) {\n        var item = selectionItems[id],\n            selection = item._selection;\n\n        if (selection & 1 && item.isInserted()) {\n          items.push(item);\n        } else if (!selection) {\n          this._updateSelection(item);\n        }\n      }\n\n      return items;\n    },\n    _updateSelection: function _updateSelection(item) {\n      var id = item._id,\n          selectionItems = this._selectionItems;\n\n      if (item._selection) {\n        if (selectionItems[id] !== item) {\n          this._selectionCount++;\n          selectionItems[id] = item;\n        }\n      } else if (selectionItems[id] === item) {\n        this._selectionCount--;\n        delete selectionItems[id];\n      }\n    },\n    selectAll: function selectAll() {\n      var children = this._children;\n\n      for (var i = 0, l = children.length; i < l; i++) {\n        children[i].setFullySelected(true);\n      }\n    },\n    deselectAll: function deselectAll() {\n      var selectionItems = this._selectionItems;\n\n      for (var i in selectionItems) {\n        selectionItems[i].setFullySelected(false);\n      }\n    },\n    addLayer: function addLayer(layer) {\n      return this.insertLayer(undefined, layer);\n    },\n    insertLayer: function insertLayer(index, layer) {\n      if (layer instanceof Layer) {\n        layer._remove(false, true);\n\n        Base.splice(this._children, [layer], index, 0);\n\n        layer._setProject(this, true);\n\n        var name = layer._name;\n        if (name) layer.setName(name);\n        if (this._changes) layer._changed(5);\n        if (!this._activeLayer) this._activeLayer = layer;\n      } else {\n        layer = null;\n      }\n\n      return layer;\n    },\n    _insertItem: function _insertItem(index, item, _created) {\n      item = this.insertLayer(index, item) || (this._activeLayer || this._insertItem(undefined, new Layer(Item.NO_INSERT), true)).insertChild(index, item);\n      if (_created && item.activate) item.activate();\n      return item;\n    },\n    getItems: function getItems(options) {\n      return Item._getItems(this, options);\n    },\n    getItem: function getItem(options) {\n      return Item._getItems(this, options, null, null, true)[0] || null;\n    },\n    importJSON: function importJSON(json) {\n      this.activate();\n      var layer = this._activeLayer;\n      return Base.importJSON(json, layer && layer.isEmpty() && layer);\n    },\n    removeOn: function removeOn(type) {\n      var sets = this._removeSets;\n\n      if (sets) {\n        if (type === 'mouseup') sets.mousedrag = null;\n        var set = sets[type];\n\n        if (set) {\n          for (var id in set) {\n            var item = set[id];\n\n            for (var key in sets) {\n              var other = sets[key];\n              if (other && other != set) delete other[item._id];\n            }\n\n            item.remove();\n          }\n\n          sets[type] = null;\n        }\n      }\n    },\n    draw: function draw(ctx, matrix, pixelRatio) {\n      this._updateVersion++;\n      ctx.save();\n      matrix.applyToContext(ctx);\n      var children = this._children,\n          param = new Base({\n        offset: new Point(0, 0),\n        pixelRatio: pixelRatio,\n        viewMatrix: matrix.isIdentity() ? null : matrix,\n        matrices: [new Matrix()],\n        updateMatrix: true\n      });\n\n      for (var i = 0, l = children.length; i < l; i++) {\n        children[i].draw(ctx, param);\n      }\n\n      ctx.restore();\n\n      if (this._selectionCount > 0) {\n        ctx.save();\n        ctx.strokeWidth = 1;\n        var items = this._selectionItems,\n            size = this._scope.settings.handleSize,\n            version = this._updateVersion;\n\n        for (var id in items) {\n          items[id]._drawSelection(ctx, matrix, size, items, version);\n        }\n\n        ctx.restore();\n      }\n    }\n  });\n  var Item = Base.extend(Emitter, {\n    statics: {\n      extend: function extend(src) {\n        if (src._serializeFields) src._serializeFields = Base.set({}, this.prototype._serializeFields, src._serializeFields);\n        return extend.base.apply(this, arguments);\n      },\n      NO_INSERT: {\n        insert: false\n      }\n    },\n    _class: 'Item',\n    _name: null,\n    _applyMatrix: true,\n    _canApplyMatrix: true,\n    _canScaleStroke: false,\n    _pivot: null,\n    _visible: true,\n    _blendMode: 'normal',\n    _opacity: 1,\n    _locked: false,\n    _guide: false,\n    _clipMask: false,\n    _selection: 0,\n    _selectBounds: true,\n    _selectChildren: false,\n    _serializeFields: {\n      name: null,\n      applyMatrix: null,\n      matrix: new Matrix(),\n      pivot: null,\n      visible: true,\n      blendMode: 'normal',\n      opacity: 1,\n      locked: false,\n      guide: false,\n      clipMask: false,\n      selected: false,\n      data: {}\n    },\n    _prioritize: ['applyMatrix']\n  }, new function () {\n    var handlers = ['onMouseDown', 'onMouseUp', 'onMouseDrag', 'onClick', 'onDoubleClick', 'onMouseMove', 'onMouseEnter', 'onMouseLeave'];\n    return Base.each(handlers, function (name) {\n      this._events[name] = {\n        install: function install(type) {\n          this.getView()._countItemEvent(type, 1);\n        },\n        uninstall: function uninstall(type) {\n          this.getView()._countItemEvent(type, -1);\n        }\n      };\n    }, {\n      _events: {\n        onFrame: {\n          install: function install() {\n            this.getView()._animateItem(this, true);\n          },\n          uninstall: function uninstall() {\n            this.getView()._animateItem(this, false);\n          }\n        },\n        onLoad: {},\n        onError: {}\n      },\n      statics: {\n        _itemHandlers: handlers\n      }\n    });\n  }(), {\n    initialize: function Item() {},\n    _initialize: function _initialize(props, point) {\n      var hasProps = props && Base.isPlainObject(props),\n          internal = hasProps && props.internal === true,\n          matrix = this._matrix = new Matrix(),\n          project = hasProps && props.project || paper.project,\n          settings = paper.settings;\n      this._id = internal ? null : UID.get();\n      this._parent = this._index = null;\n      this._applyMatrix = this._canApplyMatrix && settings.applyMatrix;\n      if (point) matrix.translate(point);\n      matrix._owner = this;\n      this._style = new Style(project._currentStyle, this, project);\n\n      if (internal || hasProps && props.insert == false || !settings.insertItems && !(hasProps && props.insert === true)) {\n        this._setProject(project);\n      } else {\n        (hasProps && props.parent || project)._insertItem(undefined, this, true);\n      }\n\n      if (hasProps && props !== Item.NO_INSERT) {\n        this.set(props, {\n          internal: true,\n          insert: true,\n          project: true,\n          parent: true\n        });\n      }\n\n      return hasProps;\n    },\n    _serialize: function _serialize(options, dictionary) {\n      var props = {},\n          that = this;\n\n      function serialize(fields) {\n        for (var key in fields) {\n          var value = that[key];\n\n          if (!Base.equals(value, key === 'leading' ? fields.fontSize * 1.2 : fields[key])) {\n            props[key] = Base.serialize(value, options, key !== 'data', dictionary);\n          }\n        }\n      }\n\n      serialize(this._serializeFields);\n      if (!(this instanceof Group)) serialize(this._style._defaults);\n      return [this._class, props];\n    },\n    _changed: function _changed(flags) {\n      var symbol = this._symbol,\n          cacheParent = this._parent || symbol,\n          project = this._project;\n\n      if (flags & 8) {\n        this._bounds = this._position = this._decomposed = undefined;\n      }\n\n      if (flags & 16) {\n        this._globalMatrix = undefined;\n      }\n\n      if (cacheParent && flags & 72) {\n        Item._clearBoundsCache(cacheParent);\n      }\n\n      if (flags & 2) {\n        Item._clearBoundsCache(this);\n      }\n\n      if (project) project._changed(flags, this);\n      if (symbol) symbol._changed(flags);\n    },\n    getId: function getId() {\n      return this._id;\n    },\n    getName: function getName() {\n      return this._name;\n    },\n    setName: function setName(name) {\n      if (this._name) this._removeNamed();\n      if (name === +name + '') throw new Error('Names consisting only of numbers are not supported.');\n\n      var owner = this._getOwner();\n\n      if (name && owner) {\n        var children = owner._children,\n            namedChildren = owner._namedChildren;\n        (namedChildren[name] = namedChildren[name] || []).push(this);\n        if (!(name in children)) children[name] = this;\n      }\n\n      this._name = name || undefined;\n\n      this._changed(256);\n    },\n    getStyle: function getStyle() {\n      return this._style;\n    },\n    setStyle: function setStyle(style) {\n      this.getStyle().set(style);\n    }\n  }, Base.each(['locked', 'visible', 'blendMode', 'opacity', 'guide'], function (name) {\n    var part = Base.capitalize(name),\n        key = '_' + name,\n        flags = {\n      locked: 256,\n      visible: 265\n    };\n\n    this['get' + part] = function () {\n      return this[key];\n    };\n\n    this['set' + part] = function (value) {\n      if (value != this[key]) {\n        this[key] = value;\n\n        this._changed(flags[name] || 257);\n      }\n    };\n  }, {}), {\n    beans: true,\n    getSelection: function getSelection() {\n      return this._selection;\n    },\n    setSelection: function setSelection(selection) {\n      if (selection !== this._selection) {\n        this._selection = selection;\n        var project = this._project;\n\n        if (project) {\n          project._updateSelection(this);\n\n          this._changed(257);\n        }\n      }\n    },\n    _changeSelection: function _changeSelection(flag, selected) {\n      var selection = this._selection;\n      this.setSelection(selected ? selection | flag : selection & ~flag);\n    },\n    isSelected: function isSelected() {\n      if (this._selectChildren) {\n        var children = this._children;\n\n        for (var i = 0, l = children.length; i < l; i++) {\n          if (children[i].isSelected()) return true;\n        }\n      }\n\n      return !!(this._selection & 1);\n    },\n    setSelected: function setSelected(selected) {\n      if (this._selectChildren) {\n        var children = this._children;\n\n        for (var i = 0, l = children.length; i < l; i++) {\n          children[i].setSelected(selected);\n        }\n      }\n\n      this._changeSelection(1, selected);\n    },\n    isFullySelected: function isFullySelected() {\n      var children = this._children,\n          selected = !!(this._selection & 1);\n\n      if (children && selected) {\n        for (var i = 0, l = children.length; i < l; i++) {\n          if (!children[i].isFullySelected()) return false;\n        }\n\n        return true;\n      }\n\n      return selected;\n    },\n    setFullySelected: function setFullySelected(selected) {\n      var children = this._children;\n\n      if (children) {\n        for (var i = 0, l = children.length; i < l; i++) {\n          children[i].setFullySelected(selected);\n        }\n      }\n\n      this._changeSelection(1, selected);\n    },\n    isClipMask: function isClipMask() {\n      return this._clipMask;\n    },\n    setClipMask: function setClipMask(clipMask) {\n      if (this._clipMask != (clipMask = !!clipMask)) {\n        this._clipMask = clipMask;\n\n        if (clipMask) {\n          this.setFillColor(null);\n          this.setStrokeColor(null);\n        }\n\n        this._changed(257);\n\n        if (this._parent) this._parent._changed(2048);\n      }\n    },\n    getData: function getData() {\n      if (!this._data) this._data = {};\n      return this._data;\n    },\n    setData: function setData(data) {\n      this._data = data;\n    },\n    getPosition: function getPosition(_dontLink) {\n      var ctor = _dontLink ? Point : LinkedPoint;\n\n      var position = this._position || (this._position = this._getPositionFromBounds());\n\n      return new ctor(position.x, position.y, this, 'setPosition');\n    },\n    setPosition: function setPosition() {\n      this.translate(Point.read(arguments).subtract(this.getPosition(true)));\n    },\n    _getPositionFromBounds: function _getPositionFromBounds(bounds) {\n      return this._pivot ? this._matrix._transformPoint(this._pivot) : (bounds || this.getBounds()).getCenter(true);\n    },\n    getPivot: function getPivot() {\n      var pivot = this._pivot;\n      return pivot ? new LinkedPoint(pivot.x, pivot.y, this, 'setPivot') : null;\n    },\n    setPivot: function setPivot() {\n      this._pivot = Point.read(arguments, 0, {\n        clone: true,\n        readNull: true\n      });\n      this._position = undefined;\n    }\n  }, Base.each({\n    getStrokeBounds: {\n      stroke: true\n    },\n    getHandleBounds: {\n      handle: true\n    },\n    getInternalBounds: {\n      internal: true\n    }\n  }, function (options, key) {\n    this[key] = function (matrix) {\n      return this.getBounds(matrix, options);\n    };\n  }, {\n    beans: true,\n    getBounds: function getBounds(matrix, options) {\n      var hasMatrix = options || matrix instanceof Matrix,\n          opts = Base.set({}, hasMatrix ? options : matrix, this._boundsOptions);\n      if (!opts.stroke || this.getStrokeScaling()) opts.cacheItem = this;\n\n      var rect = this._getCachedBounds(hasMatrix && matrix, opts).rect;\n\n      return !arguments.length ? new LinkedRectangle(rect.x, rect.y, rect.width, rect.height, this, 'setBounds') : rect;\n    },\n    setBounds: function setBounds() {\n      var rect = _Rectangle.read(arguments),\n          bounds = this.getBounds(),\n          _matrix = this._matrix,\n          matrix = new Matrix(),\n          center = rect.getCenter();\n\n      matrix.translate(center);\n\n      if (rect.width != bounds.width || rect.height != bounds.height) {\n        if (!_matrix.isInvertible()) {\n          _matrix.set(_matrix._backup || new Matrix().translate(_matrix.getTranslation()));\n\n          bounds = this.getBounds();\n        }\n\n        matrix.scale(bounds.width !== 0 ? rect.width / bounds.width : 0, bounds.height !== 0 ? rect.height / bounds.height : 0);\n      }\n\n      center = bounds.getCenter();\n      matrix.translate(-center.x, -center.y);\n      this.transform(matrix);\n    },\n    _getBounds: function _getBounds(matrix, options) {\n      var children = this._children;\n      if (!children || !children.length) return new _Rectangle();\n\n      Item._updateBoundsCache(this, options.cacheItem);\n\n      return Item._getBounds(children, matrix, options);\n    },\n    _getBoundsCacheKey: function _getBoundsCacheKey(options, internal) {\n      return [options.stroke ? 1 : 0, options.handle ? 1 : 0, internal ? 1 : 0].join('');\n    },\n    _getCachedBounds: function _getCachedBounds(matrix, options, noInternal) {\n      matrix = matrix && matrix._orNullIfIdentity();\n\n      var internal = options.internal && !noInternal,\n          cacheItem = options.cacheItem,\n          _matrix = internal ? null : this._matrix._orNullIfIdentity(),\n          cacheKey = cacheItem && (!matrix || matrix.equals(_matrix)) && this._getBoundsCacheKey(options, internal),\n          bounds = this._bounds;\n\n      Item._updateBoundsCache(this._parent || this._symbol, cacheItem);\n\n      if (cacheKey && bounds && cacheKey in bounds) {\n        var cached = bounds[cacheKey];\n        return {\n          rect: cached.rect.clone(),\n          nonscaling: cached.nonscaling\n        };\n      }\n\n      var res = this._getBounds(matrix || _matrix, options),\n          rect = res.rect || res,\n          style = this._style,\n          nonscaling = res.nonscaling || style.hasStroke() && !style.getStrokeScaling();\n\n      if (cacheKey) {\n        if (!bounds) {\n          this._bounds = bounds = {};\n        }\n\n        var cached = bounds[cacheKey] = {\n          rect: rect.clone(),\n          nonscaling: nonscaling,\n          internal: internal\n        };\n      }\n\n      return {\n        rect: rect,\n        nonscaling: nonscaling\n      };\n    },\n    _getStrokeMatrix: function _getStrokeMatrix(matrix, options) {\n      var parent = this.getStrokeScaling() ? null : options && options.internal ? this : this._parent || this._symbol && this._symbol._item,\n          mx = parent ? parent.getViewMatrix().invert() : matrix;\n      return mx && mx._shiftless();\n    },\n    statics: {\n      _updateBoundsCache: function _updateBoundsCache(parent, item) {\n        if (parent && item) {\n          var id = item._id,\n              ref = parent._boundsCache = parent._boundsCache || {\n            ids: {},\n            list: []\n          };\n\n          if (!ref.ids[id]) {\n            ref.list.push(item);\n            ref.ids[id] = item;\n          }\n        }\n      },\n      _clearBoundsCache: function _clearBoundsCache(item) {\n        var cache = item._boundsCache;\n\n        if (cache) {\n          item._bounds = item._position = item._boundsCache = undefined;\n\n          for (var i = 0, list = cache.list, l = list.length; i < l; i++) {\n            var other = list[i];\n\n            if (other !== item) {\n              other._bounds = other._position = undefined;\n              if (other._boundsCache) Item._clearBoundsCache(other);\n            }\n          }\n        }\n      },\n      _getBounds: function _getBounds(items, matrix, options) {\n        var x1 = Infinity,\n            x2 = -x1,\n            y1 = x1,\n            y2 = x2,\n            nonscaling = false;\n        options = options || {};\n\n        for (var i = 0, l = items.length; i < l; i++) {\n          var item = items[i];\n\n          if (item._visible && !item.isEmpty()) {\n            var bounds = item._getCachedBounds(matrix && matrix.appended(item._matrix), options, true),\n                rect = bounds.rect;\n\n            x1 = Math.min(rect.x, x1);\n            y1 = Math.min(rect.y, y1);\n            x2 = Math.max(rect.x + rect.width, x2);\n            y2 = Math.max(rect.y + rect.height, y2);\n            if (bounds.nonscaling) nonscaling = true;\n          }\n        }\n\n        return {\n          rect: isFinite(x1) ? new _Rectangle(x1, y1, x2 - x1, y2 - y1) : new _Rectangle(),\n          nonscaling: nonscaling\n        };\n      }\n    }\n  }), {\n    beans: true,\n    _decompose: function _decompose() {\n      return this._applyMatrix ? null : this._decomposed || (this._decomposed = this._matrix.decompose());\n    },\n    getRotation: function getRotation() {\n      var decomposed = this._decompose();\n\n      return decomposed ? decomposed.rotation : 0;\n    },\n    setRotation: function setRotation(rotation) {\n      var current = this.getRotation();\n\n      if (current != null && rotation != null) {\n        var decomposed = this._decomposed;\n        this.rotate(rotation - current);\n\n        if (decomposed) {\n          decomposed.rotation = rotation;\n          this._decomposed = decomposed;\n        }\n      }\n    },\n    getScaling: function getScaling() {\n      var decomposed = this._decompose(),\n          s = decomposed && decomposed.scaling;\n\n      return new LinkedPoint(s ? s.x : 1, s ? s.y : 1, this, 'setScaling');\n    },\n    setScaling: function setScaling() {\n      var current = this.getScaling(),\n          scaling = Point.read(arguments, 0, {\n        clone: true,\n        readNull: true\n      });\n\n      if (current && scaling && !current.equals(scaling)) {\n        var rotation = this.getRotation(),\n            decomposed = this._decomposed,\n            matrix = new Matrix(),\n            center = this.getPosition(true);\n        matrix.translate(center);\n        if (rotation) matrix.rotate(rotation);\n        matrix.scale(scaling.x / current.x, scaling.y / current.y);\n        if (rotation) matrix.rotate(-rotation);\n        matrix.translate(center.negate());\n        this.transform(matrix);\n\n        if (decomposed) {\n          decomposed.scaling = scaling;\n          this._decomposed = decomposed;\n        }\n      }\n    },\n    getMatrix: function getMatrix() {\n      return this._matrix;\n    },\n    setMatrix: function setMatrix() {\n      var matrix = this._matrix;\n      matrix.initialize.apply(matrix, arguments);\n    },\n    getGlobalMatrix: function getGlobalMatrix(_dontClone) {\n      var matrix = this._globalMatrix;\n\n      if (matrix) {\n        var parent = this._parent;\n        var parents = [];\n\n        while (parent) {\n          if (!parent._globalMatrix) {\n            matrix = null;\n\n            for (var i = 0, l = parents.length; i < l; i++) {\n              parents[i]._globalMatrix = null;\n            }\n\n            break;\n          }\n\n          parents.push(parent);\n          parent = parent._parent;\n        }\n      }\n\n      if (!matrix) {\n        matrix = this._globalMatrix = this._matrix.clone();\n        var parent = this._parent;\n        if (parent) matrix.prepend(parent.getGlobalMatrix(true));\n      }\n\n      return _dontClone ? matrix : matrix.clone();\n    },\n    getViewMatrix: function getViewMatrix() {\n      return this.getGlobalMatrix().prepend(this.getView()._matrix);\n    },\n    getApplyMatrix: function getApplyMatrix() {\n      return this._applyMatrix;\n    },\n    setApplyMatrix: function setApplyMatrix(apply) {\n      if (this._applyMatrix = this._canApplyMatrix && !!apply) this.transform(null, true);\n    },\n    getTransformContent: '#getApplyMatrix',\n    setTransformContent: '#setApplyMatrix'\n  }, {\n    getProject: function getProject() {\n      return this._project;\n    },\n    _setProject: function _setProject(project, installEvents) {\n      if (this._project !== project) {\n        if (this._project) this._installEvents(false);\n        this._project = project;\n        var children = this._children;\n\n        for (var i = 0, l = children && children.length; i < l; i++) {\n          children[i]._setProject(project);\n        }\n\n        installEvents = true;\n      }\n\n      if (installEvents) this._installEvents(true);\n    },\n    getView: function getView() {\n      return this._project._view;\n    },\n    _installEvents: function _installEvents(install) {\n      _installEvents.base.call(this, install);\n\n      var children = this._children;\n\n      for (var i = 0, l = children && children.length; i < l; i++) {\n        children[i]._installEvents(install);\n      }\n    },\n    getLayer: function getLayer() {\n      var parent = this;\n\n      while (parent = parent._parent) {\n        if (parent instanceof Layer) return parent;\n      }\n\n      return null;\n    },\n    getParent: function getParent() {\n      return this._parent;\n    },\n    setParent: function setParent(item) {\n      return item.addChild(this);\n    },\n    _getOwner: '#getParent',\n    getChildren: function getChildren() {\n      return this._children;\n    },\n    setChildren: function setChildren(items) {\n      this.removeChildren();\n      this.addChildren(items);\n    },\n    getFirstChild: function getFirstChild() {\n      return this._children && this._children[0] || null;\n    },\n    getLastChild: function getLastChild() {\n      return this._children && this._children[this._children.length - 1] || null;\n    },\n    getNextSibling: function getNextSibling() {\n      var owner = this._getOwner();\n\n      return owner && owner._children[this._index + 1] || null;\n    },\n    getPreviousSibling: function getPreviousSibling() {\n      var owner = this._getOwner();\n\n      return owner && owner._children[this._index - 1] || null;\n    },\n    getIndex: function getIndex() {\n      return this._index;\n    },\n    equals: function equals(item) {\n      return item === this || item && this._class === item._class && this._style.equals(item._style) && this._matrix.equals(item._matrix) && this._locked === item._locked && this._visible === item._visible && this._blendMode === item._blendMode && this._opacity === item._opacity && this._clipMask === item._clipMask && this._guide === item._guide && this._equals(item) || false;\n    },\n    _equals: function _equals(item) {\n      return Base.equals(this._children, item._children);\n    },\n    clone: function clone(options) {\n      var copy = new this.constructor(Item.NO_INSERT),\n          children = this._children,\n          insert = Base.pick(options ? options.insert : undefined, options === undefined || options === true),\n          deep = Base.pick(options ? options.deep : undefined, true);\n      if (children) copy.copyAttributes(this);\n      if (!children || deep) copy.copyContent(this);\n      if (!children) copy.copyAttributes(this);\n      if (insert) copy.insertAbove(this);\n      var name = this._name,\n          parent = this._parent;\n\n      if (name && parent) {\n        var children = parent._children,\n            orig = name,\n            i = 1;\n\n        while (children[name]) {\n          name = orig + ' ' + i++;\n        }\n\n        if (name !== orig) copy.setName(name);\n      }\n\n      return copy;\n    },\n    copyContent: function copyContent(source) {\n      var children = source._children;\n\n      for (var i = 0, l = children && children.length; i < l; i++) {\n        this.addChild(children[i].clone(false), true);\n      }\n    },\n    copyAttributes: function copyAttributes(source, excludeMatrix) {\n      this.setStyle(source._style);\n      var keys = ['_locked', '_visible', '_blendMode', '_opacity', '_clipMask', '_guide'];\n\n      for (var i = 0, l = keys.length; i < l; i++) {\n        var key = keys[i];\n        if (source.hasOwnProperty(key)) this[key] = source[key];\n      }\n\n      if (!excludeMatrix) this._matrix.set(source._matrix, true);\n      this.setApplyMatrix(source._applyMatrix);\n      this.setPivot(source._pivot);\n      this.setSelection(source._selection);\n      var data = source._data,\n          name = source._name;\n      this._data = data ? Base.clone(data) : null;\n      if (name) this.setName(name);\n    },\n    rasterize: function rasterize(resolution, insert) {\n      var bounds = this.getStrokeBounds(),\n          scale = (resolution || this.getView().getResolution()) / 72,\n          topLeft = bounds.getTopLeft().floor(),\n          bottomRight = bounds.getBottomRight().ceil(),\n          size = new Size(bottomRight.subtract(topLeft)),\n          raster = new Raster(Item.NO_INSERT);\n\n      if (!size.isZero()) {\n        var canvas = CanvasProvider.getCanvas(size.multiply(scale)),\n            ctx = canvas.getContext('2d'),\n            matrix = new Matrix().scale(scale).translate(topLeft.negate());\n        ctx.save();\n        matrix.applyToContext(ctx);\n        this.draw(ctx, new Base({\n          matrices: [matrix]\n        }));\n        ctx.restore();\n        raster.setCanvas(canvas);\n      }\n\n      raster.transform(new Matrix().translate(topLeft.add(size.divide(2))).scale(1 / scale));\n      if (insert === undefined || insert) raster.insertAbove(this);\n      return raster;\n    },\n    contains: function contains() {\n      return !!this._contains(this._matrix._inverseTransform(Point.read(arguments)));\n    },\n    _contains: function _contains(point) {\n      var children = this._children;\n\n      if (children) {\n        for (var i = children.length - 1; i >= 0; i--) {\n          if (children[i].contains(point)) return true;\n        }\n\n        return false;\n      }\n\n      return point.isInside(this.getInternalBounds());\n    },\n    isInside: function isInside() {\n      return _Rectangle.read(arguments).contains(this.getBounds());\n    },\n    _asPathItem: function _asPathItem() {\n      return new Path.Rectangle({\n        rectangle: this.getInternalBounds(),\n        matrix: this._matrix,\n        insert: false\n      });\n    },\n    intersects: function intersects(item, _matrix) {\n      if (!(item instanceof Item)) return false;\n      return this._asPathItem().getIntersections(item._asPathItem(), null, _matrix, true).length > 0;\n    }\n  }, new function () {\n    function hitTest() {\n      return this._hitTest(Point.read(arguments), HitResult.getOptions(arguments));\n    }\n\n    function hitTestAll() {\n      var point = Point.read(arguments),\n          options = HitResult.getOptions(arguments),\n          all = [];\n\n      this._hitTest(point, Base.set({\n        all: all\n      }, options));\n\n      return all;\n    }\n\n    function hitTestChildren(point, options, viewMatrix, _exclude) {\n      var children = this._children;\n\n      if (children) {\n        for (var i = children.length - 1; i >= 0; i--) {\n          var child = children[i];\n\n          var res = child !== _exclude && child._hitTest(point, options, viewMatrix);\n\n          if (res && !options.all) return res;\n        }\n      }\n\n      return null;\n    }\n\n    Project.inject({\n      hitTest: hitTest,\n      hitTestAll: hitTestAll,\n      _hitTest: hitTestChildren\n    });\n    return {\n      hitTest: hitTest,\n      hitTestAll: hitTestAll,\n      _hitTestChildren: hitTestChildren\n    };\n  }(), {\n    _hitTest: function _hitTest(point, options, parentViewMatrix) {\n      if (this._locked || !this._visible || this._guide && !options.guides || this.isEmpty()) {\n        return null;\n      }\n\n      var matrix = this._matrix,\n          viewMatrix = parentViewMatrix ? parentViewMatrix.appended(matrix) : this.getGlobalMatrix().prepend(this.getView()._matrix),\n          tolerance = Math.max(options.tolerance, 1e-12),\n          tolerancePadding = options._tolerancePadding = new Size(Path._getStrokePadding(tolerance, matrix._shiftless().invert()));\n      point = matrix._inverseTransform(point);\n\n      if (!point || !this._children && !this.getBounds({\n        internal: true,\n        stroke: true,\n        handle: true\n      }).expand(tolerancePadding.multiply(2))._containsPoint(point)) {\n        return null;\n      }\n\n      var checkSelf = !(options.guides && !this._guide || options.selected && !this.isSelected() || options.type && options.type !== Base.hyphenate(this._class) || options.class && !(this instanceof options.class)),\n          match = options.match,\n          that = this,\n          bounds,\n          res;\n\n      function filter(hit) {\n        if (hit && match && !match(hit)) hit = null;\n        if (hit && options.all) options.all.push(hit);\n        return hit;\n      }\n\n      function checkPoint(type, part) {\n        var pt = part ? bounds['get' + part]() : that.getPosition();\n\n        if (point.subtract(pt).divide(tolerancePadding).length <= 1) {\n          return new HitResult(type, that, {\n            name: part ? Base.hyphenate(part) : type,\n            point: pt\n          });\n        }\n      }\n\n      var checkPosition = options.position,\n          checkCenter = options.center,\n          checkBounds = options.bounds;\n\n      if (checkSelf && this._parent && (checkPosition || checkCenter || checkBounds)) {\n        if (checkCenter || checkBounds) {\n          bounds = this.getInternalBounds();\n        }\n\n        res = checkPosition && checkPoint('position') || checkCenter && checkPoint('center', 'Center');\n\n        if (!res && checkBounds) {\n          var points = ['TopLeft', 'TopRight', 'BottomLeft', 'BottomRight', 'LeftCenter', 'TopCenter', 'RightCenter', 'BottomCenter'];\n\n          for (var i = 0; i < 8 && !res; i++) {\n            res = checkPoint('bounds', points[i]);\n          }\n        }\n\n        res = filter(res);\n      }\n\n      if (!res) {\n        res = this._hitTestChildren(point, options, viewMatrix) || checkSelf && filter(this._hitTestSelf(point, options, viewMatrix, this.getStrokeScaling() ? null : viewMatrix._shiftless().invert())) || null;\n      }\n\n      if (res && res.point) {\n        res.point = matrix.transform(res.point);\n      }\n\n      return res;\n    },\n    _hitTestSelf: function _hitTestSelf(point, options) {\n      if (options.fill && this.hasFill() && this._contains(point)) return new HitResult('fill', this);\n    },\n    matches: function matches(name, compare) {\n      function matchObject(obj1, obj2) {\n        for (var i in obj1) {\n          if (obj1.hasOwnProperty(i)) {\n            var val1 = obj1[i],\n                val2 = obj2[i];\n\n            if (Base.isPlainObject(val1) && Base.isPlainObject(val2)) {\n              if (!matchObject(val1, val2)) return false;\n            } else if (!Base.equals(val1, val2)) {\n              return false;\n            }\n          }\n        }\n\n        return true;\n      }\n\n      var type = _typeof(name);\n\n      if (type === 'object') {\n        for (var key in name) {\n          if (name.hasOwnProperty(key) && !this.matches(key, name[key])) return false;\n        }\n\n        return true;\n      } else if (type === 'function') {\n        return name(this);\n      } else if (name === 'match') {\n        return compare(this);\n      } else {\n        var value = /^(empty|editable)$/.test(name) ? this['is' + Base.capitalize(name)]() : name === 'type' ? Base.hyphenate(this._class) : this[name];\n\n        if (name === 'class') {\n          if (typeof compare === 'function') return this instanceof compare;\n          value = this._class;\n        }\n\n        if (typeof compare === 'function') {\n          return !!compare(value);\n        } else if (compare) {\n          if (compare.test) {\n            return compare.test(value);\n          } else if (Base.isPlainObject(compare)) {\n            return matchObject(compare, value);\n          }\n        }\n\n        return Base.equals(value, compare);\n      }\n    },\n    getItems: function getItems(options) {\n      return Item._getItems(this, options, this._matrix);\n    },\n    getItem: function getItem(options) {\n      return Item._getItems(this, options, this._matrix, null, true)[0] || null;\n    },\n    statics: {\n      _getItems: function _getItems(item, options, matrix, param, firstOnly) {\n        if (!param) {\n          var obj = _typeof(options) === 'object' && options,\n              overlapping = obj && obj.overlapping,\n              inside = obj && obj.inside,\n              bounds = overlapping || inside,\n              rect = bounds && _Rectangle.read([bounds]);\n\n          param = {\n            items: [],\n            recursive: obj && obj.recursive !== false,\n            inside: !!inside,\n            overlapping: !!overlapping,\n            rect: rect,\n            path: overlapping && new Path.Rectangle({\n              rectangle: rect,\n              insert: false\n            })\n          };\n\n          if (obj) {\n            options = Base.filter({}, options, {\n              recursive: true,\n              inside: true,\n              overlapping: true\n            });\n          }\n        }\n\n        var children = item._children,\n            items = param.items,\n            rect = param.rect;\n        matrix = rect && (matrix || new Matrix());\n\n        for (var i = 0, l = children && children.length; i < l; i++) {\n          var child = children[i],\n              childMatrix = matrix && matrix.appended(child._matrix),\n              add = true;\n\n          if (rect) {\n            var bounds = child.getBounds(childMatrix);\n            if (!rect.intersects(bounds)) continue;\n            if (!(rect.contains(bounds) || param.overlapping && (bounds.contains(rect) || param.path.intersects(child, childMatrix)))) add = false;\n          }\n\n          if (add && child.matches(options)) {\n            items.push(child);\n            if (firstOnly) break;\n          }\n\n          if (param.recursive !== false) {\n            _getItems(child, options, childMatrix, param, firstOnly);\n          }\n\n          if (firstOnly && items.length > 0) break;\n        }\n\n        return items;\n      }\n    }\n  }, {\n    importJSON: function importJSON(json) {\n      var res = Base.importJSON(json, this);\n      return res !== this ? this.addChild(res) : res;\n    },\n    addChild: function addChild(item) {\n      return this.insertChild(undefined, item);\n    },\n    insertChild: function insertChild(index, item) {\n      var res = item ? this.insertChildren(index, [item]) : null;\n      return res && res[0];\n    },\n    addChildren: function addChildren(items) {\n      return this.insertChildren(this._children.length, items);\n    },\n    insertChildren: function insertChildren(index, items) {\n      var children = this._children;\n\n      if (children && items && items.length > 0) {\n        items = Base.slice(items);\n        var inserted = {};\n\n        for (var i = items.length - 1; i >= 0; i--) {\n          var item = items[i],\n              id = item && item._id;\n\n          if (!item || inserted[id]) {\n            items.splice(i, 1);\n          } else {\n            item._remove(false, true);\n\n            inserted[id] = true;\n          }\n        }\n\n        Base.splice(children, items, index, 0);\n        var project = this._project,\n            notifySelf = project._changes;\n\n        for (var i = 0, l = items.length; i < l; i++) {\n          var item = items[i],\n              name = item._name;\n          item._parent = this;\n\n          item._setProject(project, true);\n\n          if (name) item.setName(name);\n          if (notifySelf) item._changed(5);\n        }\n\n        this._changed(11);\n      } else {\n        items = null;\n      }\n\n      return items;\n    },\n    _insertItem: '#insertChild',\n    _insertAt: function _insertAt(item, offset) {\n      var owner = item && item._getOwner(),\n          res = item !== this && owner ? this : null;\n\n      if (res) {\n        res._remove(false, true);\n\n        owner._insertItem(item._index + offset, res);\n      }\n\n      return res;\n    },\n    insertAbove: function insertAbove(item) {\n      return this._insertAt(item, 1);\n    },\n    insertBelow: function insertBelow(item) {\n      return this._insertAt(item, 0);\n    },\n    sendToBack: function sendToBack() {\n      var owner = this._getOwner();\n\n      return owner ? owner._insertItem(0, this) : null;\n    },\n    bringToFront: function bringToFront() {\n      var owner = this._getOwner();\n\n      return owner ? owner._insertItem(undefined, this) : null;\n    },\n    appendTop: '#addChild',\n    appendBottom: function appendBottom(item) {\n      return this.insertChild(0, item);\n    },\n    moveAbove: '#insertAbove',\n    moveBelow: '#insertBelow',\n    addTo: function addTo(owner) {\n      return owner._insertItem(undefined, this);\n    },\n    copyTo: function copyTo(owner) {\n      return this.clone(false).addTo(owner);\n    },\n    reduce: function reduce(options) {\n      var children = this._children;\n\n      if (children && children.length === 1) {\n        var child = children[0].reduce(options);\n\n        if (this._parent) {\n          child.insertAbove(this);\n          this.remove();\n        } else {\n          child.remove();\n        }\n\n        return child;\n      }\n\n      return this;\n    },\n    _removeNamed: function _removeNamed() {\n      var owner = this._getOwner();\n\n      if (owner) {\n        var children = owner._children,\n            namedChildren = owner._namedChildren,\n            name = this._name,\n            namedArray = namedChildren[name],\n            index = namedArray ? namedArray.indexOf(this) : -1;\n\n        if (index !== -1) {\n          if (children[name] == this) delete children[name];\n          namedArray.splice(index, 1);\n\n          if (namedArray.length) {\n            children[name] = namedArray[0];\n          } else {\n            delete namedChildren[name];\n          }\n        }\n      }\n    },\n    _remove: function _remove(notifySelf, notifyParent) {\n      var owner = this._getOwner(),\n          project = this._project,\n          index = this._index;\n\n      if (this._style) this._style._dispose();\n\n      if (owner) {\n        if (this._name) this._removeNamed();\n\n        if (index != null) {\n          if (project._activeLayer === this) project._activeLayer = this.getNextSibling() || this.getPreviousSibling();\n          Base.splice(owner._children, null, index, 1);\n        }\n\n        this._installEvents(false);\n\n        if (notifySelf && project._changes) this._changed(5);\n        if (notifyParent) owner._changed(11, this);\n        this._parent = null;\n        return true;\n      }\n\n      return false;\n    },\n    remove: function remove() {\n      return this._remove(true, true);\n    },\n    replaceWith: function replaceWith(item) {\n      var ok = item && item.insertBelow(this);\n      if (ok) this.remove();\n      return ok;\n    },\n    removeChildren: function removeChildren(start, end) {\n      if (!this._children) return null;\n      start = start || 0;\n      end = Base.pick(end, this._children.length);\n      var removed = Base.splice(this._children, null, start, end - start);\n\n      for (var i = removed.length - 1; i >= 0; i--) {\n        removed[i]._remove(true, false);\n      }\n\n      if (removed.length > 0) this._changed(11);\n      return removed;\n    },\n    clear: '#removeChildren',\n    reverseChildren: function reverseChildren() {\n      if (this._children) {\n        this._children.reverse();\n\n        for (var i = 0, l = this._children.length; i < l; i++) {\n          this._children[i]._index = i;\n        }\n\n        this._changed(11);\n      }\n    },\n    isEmpty: function isEmpty() {\n      var children = this._children;\n      return !children || !children.length;\n    },\n    isEditable: function isEditable() {\n      var item = this;\n\n      while (item) {\n        if (!item._visible || item._locked) return false;\n        item = item._parent;\n      }\n\n      return true;\n    },\n    hasFill: function hasFill() {\n      return this.getStyle().hasFill();\n    },\n    hasStroke: function hasStroke() {\n      return this.getStyle().hasStroke();\n    },\n    hasShadow: function hasShadow() {\n      return this.getStyle().hasShadow();\n    },\n    _getOrder: function _getOrder(item) {\n      function getList(item) {\n        var list = [];\n\n        do {\n          list.unshift(item);\n        } while (item = item._parent);\n\n        return list;\n      }\n\n      var list1 = getList(this),\n          list2 = getList(item);\n\n      for (var i = 0, l = Math.min(list1.length, list2.length); i < l; i++) {\n        if (list1[i] != list2[i]) {\n          return list1[i]._index < list2[i]._index ? 1 : -1;\n        }\n      }\n\n      return 0;\n    },\n    hasChildren: function hasChildren() {\n      return this._children && this._children.length > 0;\n    },\n    isInserted: function isInserted() {\n      return this._parent ? this._parent.isInserted() : false;\n    },\n    isAbove: function isAbove(item) {\n      return this._getOrder(item) === -1;\n    },\n    isBelow: function isBelow(item) {\n      return this._getOrder(item) === 1;\n    },\n    isParent: function isParent(item) {\n      return this._parent === item;\n    },\n    isChild: function isChild(item) {\n      return item && item._parent === this;\n    },\n    isDescendant: function isDescendant(item) {\n      var parent = this;\n\n      while (parent = parent._parent) {\n        if (parent === item) return true;\n      }\n\n      return false;\n    },\n    isAncestor: function isAncestor(item) {\n      return item ? item.isDescendant(this) : false;\n    },\n    isSibling: function isSibling(item) {\n      return this._parent === item._parent;\n    },\n    isGroupedWith: function isGroupedWith(item) {\n      var parent = this._parent;\n\n      while (parent) {\n        if (parent._parent && /^(Group|Layer|CompoundPath)$/.test(parent._class) && item.isDescendant(parent)) return true;\n        parent = parent._parent;\n      }\n\n      return false;\n    }\n  }, Base.each(['rotate', 'scale', 'shear', 'skew'], function (key) {\n    var rotate = key === 'rotate';\n\n    this[key] = function () {\n      var value = (rotate ? Base : Point).read(arguments),\n          center = Point.read(arguments, 0, {\n        readNull: true\n      });\n      return this.transform(new Matrix()[key](value, center || this.getPosition(true)));\n    };\n  }, {\n    translate: function translate() {\n      var mx = new Matrix();\n      return this.transform(mx.translate.apply(mx, arguments));\n    },\n    transform: function transform(matrix, _applyMatrix, _applyRecursively, _setApplyMatrix) {\n      var _matrix = this._matrix,\n          transformMatrix = matrix && !matrix.isIdentity(),\n          applyMatrix = (_applyMatrix || this._applyMatrix) && (!_matrix.isIdentity() || transformMatrix || _applyMatrix && _applyRecursively && this._children);\n      if (!transformMatrix && !applyMatrix) return this;\n\n      if (transformMatrix) {\n        if (!matrix.isInvertible() && _matrix.isInvertible()) _matrix._backup = _matrix.getValues();\n\n        _matrix.prepend(matrix, true);\n\n        var style = this._style,\n            fillColor = style.getFillColor(true),\n            strokeColor = style.getStrokeColor(true);\n        if (fillColor) fillColor.transform(matrix);\n        if (strokeColor) strokeColor.transform(matrix);\n      }\n\n      if (applyMatrix && (applyMatrix = this._transformContent(_matrix, _applyRecursively, _setApplyMatrix))) {\n        var pivot = this._pivot;\n        if (pivot) _matrix._transformPoint(pivot, pivot, true);\n\n        _matrix.reset(true);\n\n        if (_setApplyMatrix && this._canApplyMatrix) this._applyMatrix = true;\n      }\n\n      var bounds = this._bounds,\n          position = this._position;\n\n      if (transformMatrix || applyMatrix) {\n        this._changed(25);\n      }\n\n      var decomp = transformMatrix && bounds && matrix.decompose();\n\n      if (decomp && decomp.skewing.isZero() && decomp.rotation % 90 === 0) {\n        for (var key in bounds) {\n          var cache = bounds[key];\n\n          if (cache.nonscaling) {\n            delete bounds[key];\n          } else if (applyMatrix || !cache.internal) {\n            var rect = cache.rect;\n\n            matrix._transformBounds(rect, rect);\n          }\n        }\n\n        this._bounds = bounds;\n\n        var cached = bounds[this._getBoundsCacheKey(this._boundsOptions || {})];\n\n        if (cached) {\n          this._position = this._getPositionFromBounds(cached.rect);\n        }\n      } else if (transformMatrix && position && this._pivot) {\n        this._position = matrix._transformPoint(position, position);\n      }\n\n      return this;\n    },\n    _transformContent: function _transformContent(matrix, applyRecursively, setApplyMatrix) {\n      var children = this._children;\n\n      if (children) {\n        for (var i = 0, l = children.length; i < l; i++) {\n          children[i].transform(matrix, true, applyRecursively, setApplyMatrix);\n        }\n\n        return true;\n      }\n    },\n    globalToLocal: function globalToLocal() {\n      return this.getGlobalMatrix(true)._inverseTransform(Point.read(arguments));\n    },\n    localToGlobal: function localToGlobal() {\n      return this.getGlobalMatrix(true)._transformPoint(Point.read(arguments));\n    },\n    parentToLocal: function parentToLocal() {\n      return this._matrix._inverseTransform(Point.read(arguments));\n    },\n    localToParent: function localToParent() {\n      return this._matrix._transformPoint(Point.read(arguments));\n    },\n    fitBounds: function fitBounds(rectangle, fill) {\n      rectangle = _Rectangle.read(arguments);\n      var bounds = this.getBounds(),\n          itemRatio = bounds.height / bounds.width,\n          rectRatio = rectangle.height / rectangle.width,\n          scale = (fill ? itemRatio > rectRatio : itemRatio < rectRatio) ? rectangle.width / bounds.width : rectangle.height / bounds.height,\n          newBounds = new _Rectangle(new Point(), new Size(bounds.width * scale, bounds.height * scale));\n      newBounds.setCenter(rectangle.getCenter());\n      this.setBounds(newBounds);\n    }\n  }), {\n    _setStyles: function _setStyles(ctx, param, viewMatrix) {\n      var style = this._style,\n          matrix = this._matrix;\n\n      if (style.hasFill()) {\n        ctx.fillStyle = style.getFillColor().toCanvasStyle(ctx, matrix);\n      }\n\n      if (style.hasStroke()) {\n        ctx.strokeStyle = style.getStrokeColor().toCanvasStyle(ctx, matrix);\n        ctx.lineWidth = style.getStrokeWidth();\n        var strokeJoin = style.getStrokeJoin(),\n            strokeCap = style.getStrokeCap(),\n            miterLimit = style.getMiterLimit();\n        if (strokeJoin) ctx.lineJoin = strokeJoin;\n        if (strokeCap) ctx.lineCap = strokeCap;\n        if (miterLimit) ctx.miterLimit = miterLimit;\n\n        if (paper.support.nativeDash) {\n          var dashArray = style.getDashArray(),\n              dashOffset = style.getDashOffset();\n\n          if (dashArray && dashArray.length) {\n            if ('setLineDash' in ctx) {\n              ctx.setLineDash(dashArray);\n              ctx.lineDashOffset = dashOffset;\n            } else {\n              ctx.mozDash = dashArray;\n              ctx.mozDashOffset = dashOffset;\n            }\n          }\n        }\n      }\n\n      if (style.hasShadow()) {\n        var pixelRatio = param.pixelRatio || 1,\n            mx = viewMatrix._shiftless().prepend(new Matrix().scale(pixelRatio, pixelRatio)),\n            blur = mx.transform(new Point(style.getShadowBlur(), 0)),\n            offset = mx.transform(this.getShadowOffset());\n\n        ctx.shadowColor = style.getShadowColor().toCanvasStyle(ctx);\n        ctx.shadowBlur = blur.getLength();\n        ctx.shadowOffsetX = offset.x;\n        ctx.shadowOffsetY = offset.y;\n      }\n    },\n    draw: function draw(ctx, param, parentStrokeMatrix) {\n      var updateVersion = this._updateVersion = this._project._updateVersion;\n      if (!this._visible || this._opacity === 0) return;\n      var matrices = param.matrices,\n          viewMatrix = param.viewMatrix,\n          matrix = this._matrix,\n          globalMatrix = matrices[matrices.length - 1].appended(matrix);\n      if (!globalMatrix.isInvertible()) return;\n      viewMatrix = viewMatrix ? viewMatrix.appended(globalMatrix) : globalMatrix;\n      matrices.push(globalMatrix);\n\n      if (param.updateMatrix) {\n        this._globalMatrix = globalMatrix;\n      }\n\n      var blendMode = this._blendMode,\n          opacity = this._opacity,\n          normalBlend = blendMode === 'normal',\n          nativeBlend = BlendMode.nativeModes[blendMode],\n          direct = normalBlend && opacity === 1 || param.dontStart || param.clip || (nativeBlend || normalBlend && opacity < 1) && this._canComposite(),\n          pixelRatio = param.pixelRatio || 1,\n          mainCtx,\n          itemOffset,\n          prevOffset;\n\n      if (!direct) {\n        var bounds = this.getStrokeBounds(viewMatrix);\n\n        if (!bounds.width || !bounds.height) {\n          matrices.pop();\n          return;\n        }\n\n        prevOffset = param.offset;\n        itemOffset = param.offset = bounds.getTopLeft().floor();\n        mainCtx = ctx;\n        ctx = CanvasProvider.getContext(bounds.getSize().ceil().add(1).multiply(pixelRatio));\n        if (pixelRatio !== 1) ctx.scale(pixelRatio, pixelRatio);\n      }\n\n      ctx.save();\n      var strokeMatrix = parentStrokeMatrix ? parentStrokeMatrix.appended(matrix) : this._canScaleStroke && !this.getStrokeScaling(true) && viewMatrix,\n          clip = !direct && param.clipItem,\n          transform = !strokeMatrix || clip;\n\n      if (direct) {\n        ctx.globalAlpha = opacity;\n        if (nativeBlend) ctx.globalCompositeOperation = blendMode;\n      } else if (transform) {\n        ctx.translate(-itemOffset.x, -itemOffset.y);\n      }\n\n      if (transform) {\n        (direct ? matrix : viewMatrix).applyToContext(ctx);\n      }\n\n      if (clip) {\n        param.clipItem.draw(ctx, param.extend({\n          clip: true\n        }));\n      }\n\n      if (strokeMatrix) {\n        ctx.setTransform(pixelRatio, 0, 0, pixelRatio, 0, 0);\n        var offset = param.offset;\n        if (offset) ctx.translate(-offset.x, -offset.y);\n      }\n\n      this._draw(ctx, param, viewMatrix, strokeMatrix);\n\n      ctx.restore();\n      matrices.pop();\n      if (param.clip && !param.dontFinish) ctx.clip();\n\n      if (!direct) {\n        BlendMode.process(blendMode, ctx, mainCtx, opacity, itemOffset.subtract(prevOffset).multiply(pixelRatio));\n        CanvasProvider.release(ctx);\n        param.offset = prevOffset;\n      }\n    },\n    _isUpdated: function _isUpdated(updateVersion) {\n      var parent = this._parent;\n      if (parent instanceof CompoundPath) return parent._isUpdated(updateVersion);\n      var updated = this._updateVersion === updateVersion;\n\n      if (!updated && parent && parent._visible && parent._isUpdated(updateVersion)) {\n        this._updateVersion = updateVersion;\n        updated = true;\n      }\n\n      return updated;\n    },\n    _drawSelection: function _drawSelection(ctx, matrix, size, selectionItems, updateVersion) {\n      var selection = this._selection,\n          itemSelected = selection & 1,\n          boundsSelected = selection & 2 || itemSelected && this._selectBounds,\n          positionSelected = selection & 4;\n      if (!this._drawSelected) itemSelected = false;\n\n      if ((itemSelected || boundsSelected || positionSelected) && this._isUpdated(updateVersion)) {\n        var layer,\n            color = this.getSelectedColor(true) || (layer = this.getLayer()) && layer.getSelectedColor(true),\n            mx = matrix.appended(this.getGlobalMatrix(true)),\n            half = size / 2;\n        ctx.strokeStyle = ctx.fillStyle = color ? color.toCanvasStyle(ctx) : '#009dec';\n        if (itemSelected) this._drawSelected(ctx, mx, selectionItems);\n\n        if (positionSelected) {\n          var pos = this.getPosition(true),\n              parent = this._parent,\n              point = parent ? parent.localToGlobal(pos) : pos,\n              x = point.x,\n              y = point.y;\n          ctx.beginPath();\n          ctx.arc(x, y, half, 0, Math.PI * 2, true);\n          ctx.stroke();\n          var deltas = [[0, -1], [1, 0], [0, 1], [-1, 0]],\n              start = half,\n              end = size + 1;\n\n          for (var i = 0; i < 4; i++) {\n            var delta = deltas[i],\n                dx = delta[0],\n                dy = delta[1];\n            ctx.moveTo(x + dx * start, y + dy * start);\n            ctx.lineTo(x + dx * end, y + dy * end);\n            ctx.stroke();\n          }\n        }\n\n        if (boundsSelected) {\n          var coords = mx._transformCorners(this.getInternalBounds());\n\n          ctx.beginPath();\n\n          for (var i = 0; i < 8; i++) {\n            ctx[!i ? 'moveTo' : 'lineTo'](coords[i], coords[++i]);\n          }\n\n          ctx.closePath();\n          ctx.stroke();\n\n          for (var i = 0; i < 8; i++) {\n            ctx.fillRect(coords[i] - half, coords[++i] - half, size, size);\n          }\n        }\n      }\n    },\n    _canComposite: function _canComposite() {\n      return false;\n    }\n  }, Base.each(['down', 'drag', 'up', 'move'], function (key) {\n    this['removeOn' + Base.capitalize(key)] = function () {\n      var hash = {};\n      hash[key] = true;\n      return this.removeOn(hash);\n    };\n  }, {\n    removeOn: function removeOn(obj) {\n      for (var name in obj) {\n        if (obj[name]) {\n          var key = 'mouse' + name,\n              project = this._project,\n              sets = project._removeSets = project._removeSets || {};\n          sets[key] = sets[key] || {};\n          sets[key][this._id] = this;\n        }\n      }\n\n      return this;\n    }\n  }), {\n    tween: function tween(from, to, options) {\n      if (!options) {\n        options = to;\n        to = from;\n        from = null;\n\n        if (!options) {\n          options = to;\n          to = null;\n        }\n      }\n\n      var easing = options && options.easing,\n          start = options && options.start,\n          duration = options != null && (typeof options === 'number' ? options : options.duration),\n          tween = new Tween(this, from, to, duration, easing, start);\n\n      function onFrame(event) {\n        tween._handleFrame(event.time * 1000);\n\n        if (!tween.running) {\n          this.off('frame', onFrame);\n        }\n      }\n\n      if (duration) {\n        this.on('frame', onFrame);\n      }\n\n      return tween;\n    },\n    tweenTo: function tweenTo(to, options) {\n      return this.tween(null, to, options);\n    },\n    tweenFrom: function tweenFrom(from, options) {\n      return this.tween(from, null, options);\n    }\n  });\n  var Group = Item.extend({\n    _class: 'Group',\n    _selectBounds: false,\n    _selectChildren: true,\n    _serializeFields: {\n      children: []\n    },\n    initialize: function Group(arg) {\n      this._children = [];\n      this._namedChildren = {};\n      if (!this._initialize(arg)) this.addChildren(_Array$isArray(arg) ? arg : arguments);\n    },\n    _changed: function _changed(flags) {\n      _changed.base.call(this, flags);\n\n      if (flags & 2050) {\n        this._clipItem = undefined;\n      }\n    },\n    _getClipItem: function _getClipItem() {\n      var clipItem = this._clipItem;\n\n      if (clipItem === undefined) {\n        clipItem = null;\n        var children = this._children;\n\n        for (var i = 0, l = children.length; i < l; i++) {\n          if (children[i]._clipMask) {\n            clipItem = children[i];\n            break;\n          }\n        }\n\n        this._clipItem = clipItem;\n      }\n\n      return clipItem;\n    },\n    isClipped: function isClipped() {\n      return !!this._getClipItem();\n    },\n    setClipped: function setClipped(clipped) {\n      var child = this.getFirstChild();\n      if (child) child.setClipMask(clipped);\n    },\n    _getBounds: function _getBounds(matrix, options) {\n      var clipItem = this._getClipItem();\n\n      return clipItem ? clipItem._getCachedBounds(matrix && matrix.appended(clipItem._matrix), Base.set({}, options, {\n        stroke: false\n      })) : _getBounds.base.call(this, matrix, options);\n    },\n    _hitTestChildren: function _hitTestChildren(point, options, viewMatrix) {\n      var clipItem = this._getClipItem();\n\n      return (!clipItem || clipItem.contains(point)) && _hitTestChildren.base.call(this, point, options, viewMatrix, clipItem);\n    },\n    _draw: function _draw(ctx, param) {\n      var clip = param.clip,\n          clipItem = !clip && this._getClipItem();\n\n      param = param.extend({\n        clipItem: clipItem,\n        clip: false\n      });\n\n      if (clip) {\n        ctx.beginPath();\n        param.dontStart = param.dontFinish = true;\n      } else if (clipItem) {\n        clipItem.draw(ctx, param.extend({\n          clip: true\n        }));\n      }\n\n      var children = this._children;\n\n      for (var i = 0, l = children.length; i < l; i++) {\n        var item = children[i];\n        if (item !== clipItem) item.draw(ctx, param);\n      }\n    }\n  });\n  var Layer = Group.extend({\n    _class: 'Layer',\n    initialize: function Layer() {\n      Group.apply(this, arguments);\n    },\n    _getOwner: function _getOwner() {\n      return this._parent || this._index != null && this._project;\n    },\n    isInserted: function isInserted() {\n      return this._parent ? isInserted.base.call(this) : this._index != null;\n    },\n    activate: function activate() {\n      this._project._activeLayer = this;\n    },\n    _hitTestSelf: function _hitTestSelf() {}\n  });\n  var Shape = Item.extend({\n    _class: 'Shape',\n    _applyMatrix: false,\n    _canApplyMatrix: false,\n    _canScaleStroke: true,\n    _serializeFields: {\n      type: null,\n      size: null,\n      radius: null\n    },\n    initialize: function Shape(props, point) {\n      this._initialize(props, point);\n    },\n    _equals: function _equals(item) {\n      return this._type === item._type && this._size.equals(item._size) && Base.equals(this._radius, item._radius);\n    },\n    copyContent: function copyContent(source) {\n      this.setType(source._type);\n      this.setSize(source._size);\n      this.setRadius(source._radius);\n    },\n    getType: function getType() {\n      return this._type;\n    },\n    setType: function setType(type) {\n      this._type = type;\n    },\n    getShape: '#getType',\n    setShape: '#setType',\n    getSize: function getSize() {\n      var size = this._size;\n      return new LinkedSize(size.width, size.height, this, 'setSize');\n    },\n    setSize: function setSize() {\n      var size = Size.read(arguments);\n\n      if (!this._size) {\n        this._size = size.clone();\n      } else if (!this._size.equals(size)) {\n        var type = this._type,\n            width = size.width,\n            height = size.height;\n\n        if (type === 'rectangle') {\n          this._radius.set(Size.min(this._radius, size.divide(2)));\n        } else if (type === 'circle') {\n          width = height = (width + height) / 2;\n          this._radius = width / 2;\n        } else if (type === 'ellipse') {\n          this._radius._set(width / 2, height / 2);\n        }\n\n        this._size._set(width, height);\n\n        this._changed(9);\n      }\n    },\n    getRadius: function getRadius() {\n      var rad = this._radius;\n      return this._type === 'circle' ? rad : new LinkedSize(rad.width, rad.height, this, 'setRadius');\n    },\n    setRadius: function setRadius(radius) {\n      var type = this._type;\n\n      if (type === 'circle') {\n        if (radius === this._radius) return;\n        var size = radius * 2;\n        this._radius = radius;\n\n        this._size._set(size, size);\n      } else {\n        radius = Size.read(arguments);\n\n        if (!this._radius) {\n          this._radius = radius.clone();\n        } else {\n          if (this._radius.equals(radius)) return;\n\n          this._radius.set(radius);\n\n          if (type === 'rectangle') {\n            var size = Size.max(this._size, radius.multiply(2));\n\n            this._size.set(size);\n          } else if (type === 'ellipse') {\n            this._size._set(radius.width * 2, radius.height * 2);\n          }\n        }\n      }\n\n      this._changed(9);\n    },\n    isEmpty: function isEmpty() {\n      return false;\n    },\n    toPath: function toPath(insert) {\n      var path = new Path[Base.capitalize(this._type)]({\n        center: new Point(),\n        size: this._size,\n        radius: this._radius,\n        insert: false\n      });\n      path.copyAttributes(this);\n      if (paper.settings.applyMatrix) path.setApplyMatrix(true);\n      if (insert === undefined || insert) path.insertAbove(this);\n      return path;\n    },\n    toShape: '#clone',\n    _asPathItem: function _asPathItem() {\n      return this.toPath(false);\n    },\n    _draw: function _draw(ctx, param, viewMatrix, strokeMatrix) {\n      var style = this._style,\n          hasFill = style.hasFill(),\n          hasStroke = style.hasStroke(),\n          dontPaint = param.dontFinish || param.clip,\n          untransformed = !strokeMatrix;\n\n      if (hasFill || hasStroke || dontPaint) {\n        var type = this._type,\n            radius = this._radius,\n            isCircle = type === 'circle';\n        if (!param.dontStart) ctx.beginPath();\n\n        if (untransformed && isCircle) {\n          ctx.arc(0, 0, radius, 0, Math.PI * 2, true);\n        } else {\n          var rx = isCircle ? radius : radius.width,\n              ry = isCircle ? radius : radius.height,\n              size = this._size,\n              width = size.width,\n              height = size.height;\n\n          if (untransformed && type === 'rectangle' && rx === 0 && ry === 0) {\n            ctx.rect(-width / 2, -height / 2, width, height);\n          } else {\n            var x = width / 2,\n                y = height / 2,\n                kappa = 1 - 0.5522847498307936,\n                cx = rx * kappa,\n                cy = ry * kappa,\n                c = [-x, -y + ry, -x, -y + cy, -x + cx, -y, -x + rx, -y, x - rx, -y, x - cx, -y, x, -y + cy, x, -y + ry, x, y - ry, x, y - cy, x - cx, y, x - rx, y, -x + rx, y, -x + cx, y, -x, y - cy, -x, y - ry];\n            if (strokeMatrix) strokeMatrix.transform(c, c, 32);\n            ctx.moveTo(c[0], c[1]);\n            ctx.bezierCurveTo(c[2], c[3], c[4], c[5], c[6], c[7]);\n            if (x !== rx) ctx.lineTo(c[8], c[9]);\n            ctx.bezierCurveTo(c[10], c[11], c[12], c[13], c[14], c[15]);\n            if (y !== ry) ctx.lineTo(c[16], c[17]);\n            ctx.bezierCurveTo(c[18], c[19], c[20], c[21], c[22], c[23]);\n            if (x !== rx) ctx.lineTo(c[24], c[25]);\n            ctx.bezierCurveTo(c[26], c[27], c[28], c[29], c[30], c[31]);\n          }\n        }\n\n        ctx.closePath();\n      }\n\n      if (!dontPaint && (hasFill || hasStroke)) {\n        this._setStyles(ctx, param, viewMatrix);\n\n        if (hasFill) {\n          ctx.fill(style.getFillRule());\n          ctx.shadowColor = 'rgba(0,0,0,0)';\n        }\n\n        if (hasStroke) ctx.stroke();\n      }\n    },\n    _canComposite: function _canComposite() {\n      return !(this.hasFill() && this.hasStroke());\n    },\n    _getBounds: function _getBounds(matrix, options) {\n      var rect = new _Rectangle(this._size).setCenter(0, 0),\n          style = this._style,\n          strokeWidth = options.stroke && style.hasStroke() && style.getStrokeWidth();\n      if (matrix) rect = matrix._transformBounds(rect);\n      return strokeWidth ? rect.expand(Path._getStrokePadding(strokeWidth, this._getStrokeMatrix(matrix, options))) : rect;\n    }\n  }, new function () {\n    function getCornerCenter(that, point, expand) {\n      var radius = that._radius;\n\n      if (!radius.isZero()) {\n        var halfSize = that._size.divide(2);\n\n        for (var q = 1; q <= 4; q++) {\n          var dir = new Point(q > 1 && q < 4 ? -1 : 1, q > 2 ? -1 : 1),\n              corner = dir.multiply(halfSize),\n              center = corner.subtract(dir.multiply(radius)),\n              rect = new _Rectangle(expand ? corner.add(dir.multiply(expand)) : corner, center);\n          if (rect.contains(point)) return {\n            point: center,\n            quadrant: q\n          };\n        }\n      }\n    }\n\n    function isOnEllipseStroke(point, radius, padding, quadrant) {\n      var vector = point.divide(radius);\n      return (!quadrant || vector.isInQuadrant(quadrant)) && vector.subtract(vector.normalize()).multiply(radius).divide(padding).length <= 1;\n    }\n\n    return {\n      _contains: function _contains(point) {\n        if (this._type === 'rectangle') {\n          var center = getCornerCenter(this, point);\n          return center ? point.subtract(center.point).divide(this._radius).getLength() <= 1 : _contains.base.call(this, point);\n        } else {\n          return point.divide(this.size).getLength() <= 0.5;\n        }\n      },\n      _hitTestSelf: function _hitTestSelf(point, options, viewMatrix, strokeMatrix) {\n        var hit = false,\n            style = this._style,\n            hitStroke = options.stroke && style.hasStroke(),\n            hitFill = options.fill && style.hasFill();\n\n        if (hitStroke || hitFill) {\n          var type = this._type,\n              radius = this._radius,\n              strokeRadius = hitStroke ? style.getStrokeWidth() / 2 : 0,\n              strokePadding = options._tolerancePadding.add(Path._getStrokePadding(strokeRadius, !style.getStrokeScaling() && strokeMatrix));\n\n          if (type === 'rectangle') {\n            var padding = strokePadding.multiply(2),\n                center = getCornerCenter(this, point, padding);\n\n            if (center) {\n              hit = isOnEllipseStroke(point.subtract(center.point), radius, strokePadding, center.quadrant);\n            } else {\n              var rect = new _Rectangle(this._size).setCenter(0, 0),\n                  outer = rect.expand(padding),\n                  inner = rect.expand(padding.negate());\n              hit = outer._containsPoint(point) && !inner._containsPoint(point);\n            }\n          } else {\n            hit = isOnEllipseStroke(point, radius, strokePadding);\n          }\n        }\n\n        return hit ? new HitResult(hitStroke ? 'stroke' : 'fill', this) : _hitTestSelf.base.apply(this, arguments);\n      }\n    };\n  }(), {\n    statics: new function () {\n      function createShape(type, point, size, radius, args) {\n        var item = new Shape(Base.getNamed(args), point);\n        item._type = type;\n        item._size = size;\n        item._radius = radius;\n        return item;\n      }\n\n      return {\n        Circle: function Circle() {\n          var center = Point.readNamed(arguments, 'center'),\n              radius = Base.readNamed(arguments, 'radius');\n          return createShape('circle', center, new Size(radius * 2), radius, arguments);\n        },\n        Rectangle: function Rectangle() {\n          var rect = _Rectangle.readNamed(arguments, 'rectangle'),\n              radius = Size.min(Size.readNamed(arguments, 'radius'), rect.getSize(true).divide(2));\n\n          return createShape('rectangle', rect.getCenter(true), rect.getSize(true), radius, arguments);\n        },\n        Ellipse: function Ellipse() {\n          var ellipse = Shape._readEllipse(arguments),\n              radius = ellipse.radius;\n\n          return createShape('ellipse', ellipse.center, radius.multiply(2), radius, arguments);\n        },\n        _readEllipse: function _readEllipse(args) {\n          var center, radius;\n\n          if (Base.hasNamed(args, 'radius')) {\n            center = Point.readNamed(args, 'center');\n            radius = Size.readNamed(args, 'radius');\n          } else {\n            var rect = _Rectangle.readNamed(args, 'rectangle');\n\n            center = rect.getCenter(true);\n            radius = rect.getSize(true).divide(2);\n          }\n\n          return {\n            center: center,\n            radius: radius\n          };\n        }\n      };\n    }()\n  });\n  var Raster = Item.extend({\n    _class: 'Raster',\n    _applyMatrix: false,\n    _canApplyMatrix: false,\n    _boundsOptions: {\n      stroke: false,\n      handle: false\n    },\n    _serializeFields: {\n      crossOrigin: null,\n      source: null\n    },\n    _prioritize: ['crossOrigin'],\n    _smoothing: true,\n    initialize: function Raster(object, position) {\n      if (!this._initialize(object, position !== undefined && Point.read(arguments, 1))) {\n        var image = typeof object === 'string' ? document.getElementById(object) : object;\n\n        if (image) {\n          this.setImage(image);\n        } else {\n          this.setSource(object);\n        }\n      }\n\n      if (!this._size) {\n        this._size = new Size();\n        this._loaded = false;\n      }\n    },\n    _equals: function _equals(item) {\n      return this.getSource() === item.getSource();\n    },\n    copyContent: function copyContent(source) {\n      var image = source._image,\n          canvas = source._canvas;\n\n      if (image) {\n        this._setImage(image);\n      } else if (canvas) {\n        var copyCanvas = CanvasProvider.getCanvas(source._size);\n        copyCanvas.getContext('2d').drawImage(canvas, 0, 0);\n\n        this._setImage(copyCanvas);\n      }\n\n      this._crossOrigin = source._crossOrigin;\n    },\n    getSize: function getSize() {\n      var size = this._size;\n      return new LinkedSize(size ? size.width : 0, size ? size.height : 0, this, 'setSize');\n    },\n    setSize: function setSize() {\n      var size = Size.read(arguments);\n\n      if (!size.equals(this._size)) {\n        if (size.width > 0 && size.height > 0) {\n          var element = this.getElement();\n\n          this._setImage(CanvasProvider.getCanvas(size));\n\n          if (element) this.getContext(true).drawImage(element, 0, 0, size.width, size.height);\n        } else {\n          if (this._canvas) CanvasProvider.release(this._canvas);\n          this._size = size.clone();\n        }\n      }\n    },\n    getWidth: function getWidth() {\n      return this._size ? this._size.width : 0;\n    },\n    setWidth: function setWidth(width) {\n      this.setSize(width, this.getHeight());\n    },\n    getHeight: function getHeight() {\n      return this._size ? this._size.height : 0;\n    },\n    setHeight: function setHeight(height) {\n      this.setSize(this.getWidth(), height);\n    },\n    getLoaded: function getLoaded() {\n      return this._loaded;\n    },\n    isEmpty: function isEmpty() {\n      var size = this._size;\n      return !size || size.width === 0 && size.height === 0;\n    },\n    getResolution: function getResolution() {\n      var matrix = this._matrix,\n          orig = new Point(0, 0).transform(matrix),\n          u = new Point(1, 0).transform(matrix).subtract(orig),\n          v = new Point(0, 1).transform(matrix).subtract(orig);\n      return new Size(72 / u.getLength(), 72 / v.getLength());\n    },\n    getPpi: '#getResolution',\n    getImage: function getImage() {\n      return this._image;\n    },\n    setImage: function setImage(image) {\n      var that = this;\n\n      function emit(event) {\n        var view = that.getView(),\n            type = event && event.type || 'load';\n\n        if (view && that.responds(type)) {\n          paper = view._scope;\n          that.emit(type, new Event(event));\n        }\n      }\n\n      this._setImage(image);\n\n      if (this._loaded) {\n        setTimeout(emit, 0);\n      } else if (image) {\n        DomEvent.add(image, {\n          load: function load(event) {\n            that._setImage(image);\n\n            emit(event);\n          },\n          error: emit\n        });\n      }\n    },\n    _setImage: function _setImage(image) {\n      if (this._canvas) CanvasProvider.release(this._canvas);\n\n      if (image && image.getContext) {\n        this._image = null;\n        this._canvas = image;\n        this._loaded = true;\n      } else {\n        this._image = image;\n        this._canvas = null;\n        this._loaded = !!(image && image.src && image.complete);\n      }\n\n      this._size = new Size(image ? image.naturalWidth || image.width : 0, image ? image.naturalHeight || image.height : 0);\n      this._context = null;\n\n      this._changed(1033);\n    },\n    getCanvas: function getCanvas() {\n      if (!this._canvas) {\n        var ctx = CanvasProvider.getContext(this._size);\n\n        try {\n          if (this._image) ctx.drawImage(this._image, 0, 0);\n          this._canvas = ctx.canvas;\n        } catch (e) {\n          CanvasProvider.release(ctx);\n        }\n      }\n\n      return this._canvas;\n    },\n    setCanvas: '#setImage',\n    getContext: function getContext(modify) {\n      if (!this._context) this._context = this.getCanvas().getContext('2d');\n\n      if (modify) {\n        this._image = null;\n\n        this._changed(1025);\n      }\n\n      return this._context;\n    },\n    setContext: function setContext(context) {\n      this._context = context;\n    },\n    getSource: function getSource() {\n      var image = this._image;\n      return image && image.src || this.toDataURL();\n    },\n    setSource: function setSource(src) {\n      var image = new self.Image(),\n          crossOrigin = this._crossOrigin;\n      if (crossOrigin) image.crossOrigin = crossOrigin;\n      image.src = src;\n      this.setImage(image);\n    },\n    getCrossOrigin: function getCrossOrigin() {\n      var image = this._image;\n      return image && image.crossOrigin || this._crossOrigin || '';\n    },\n    setCrossOrigin: function setCrossOrigin(crossOrigin) {\n      this._crossOrigin = crossOrigin;\n      var image = this._image;\n      if (image) image.crossOrigin = crossOrigin;\n    },\n    getSmoothing: function getSmoothing() {\n      return this._smoothing;\n    },\n    setSmoothing: function setSmoothing(smoothing) {\n      this._smoothing = smoothing;\n\n      this._changed(257);\n    },\n    getElement: function getElement() {\n      return this._canvas || this._loaded && this._image;\n    }\n  }, {\n    beans: false,\n    getSubCanvas: function getSubCanvas() {\n      var rect = _Rectangle.read(arguments),\n          ctx = CanvasProvider.getContext(rect.getSize());\n\n      ctx.drawImage(this.getCanvas(), rect.x, rect.y, rect.width, rect.height, 0, 0, rect.width, rect.height);\n      return ctx.canvas;\n    },\n    getSubRaster: function getSubRaster() {\n      var rect = _Rectangle.read(arguments),\n          raster = new Raster(Item.NO_INSERT);\n\n      raster._setImage(this.getSubCanvas(rect));\n\n      raster.translate(rect.getCenter().subtract(this.getSize().divide(2)));\n\n      raster._matrix.prepend(this._matrix);\n\n      raster.insertAbove(this);\n      return raster;\n    },\n    toDataURL: function toDataURL() {\n      var image = this._image,\n          src = image && image.src;\n      if (/^data:/.test(src)) return src;\n      var canvas = this.getCanvas();\n      return canvas ? canvas.toDataURL.apply(canvas, arguments) : null;\n    },\n    drawImage: function drawImage(image) {\n      var point = Point.read(arguments, 1);\n      this.getContext(true).drawImage(image, point.x, point.y);\n    },\n    getAverageColor: function getAverageColor(object) {\n      var bounds, path;\n\n      if (!object) {\n        bounds = this.getBounds();\n      } else if (object instanceof PathItem) {\n        path = object;\n        bounds = object.getBounds();\n      } else if (_typeof(object) === 'object') {\n        if ('width' in object) {\n          bounds = new _Rectangle(object);\n        } else if ('x' in object) {\n          bounds = new _Rectangle(object.x - 0.5, object.y - 0.5, 1, 1);\n        }\n      }\n\n      if (!bounds) return null;\n      var sampleSize = 32,\n          width = Math.min(bounds.width, sampleSize),\n          height = Math.min(bounds.height, sampleSize);\n      var ctx = Raster._sampleContext;\n\n      if (!ctx) {\n        ctx = Raster._sampleContext = CanvasProvider.getContext(new Size(sampleSize));\n      } else {\n        ctx.clearRect(0, 0, sampleSize + 1, sampleSize + 1);\n      }\n\n      ctx.save();\n      var matrix = new Matrix().scale(width / bounds.width, height / bounds.height).translate(-bounds.x, -bounds.y);\n      matrix.applyToContext(ctx);\n      if (path) path.draw(ctx, new Base({\n        clip: true,\n        matrices: [matrix]\n      }));\n\n      this._matrix.applyToContext(ctx);\n\n      var element = this.getElement(),\n          size = this._size;\n      if (element) ctx.drawImage(element, -size.width / 2, -size.height / 2);\n      ctx.restore();\n      var pixels = ctx.getImageData(0.5, 0.5, Math.ceil(width), Math.ceil(height)).data,\n          channels = [0, 0, 0],\n          total = 0;\n\n      for (var i = 0, l = pixels.length; i < l; i += 4) {\n        var alpha = pixels[i + 3];\n        total += alpha;\n        alpha /= 255;\n        channels[0] += pixels[i] * alpha;\n        channels[1] += pixels[i + 1] * alpha;\n        channels[2] += pixels[i + 2] * alpha;\n      }\n\n      for (var i = 0; i < 3; i++) {\n        channels[i] /= total;\n      }\n\n      return total ? Color.read(channels) : null;\n    },\n    getPixel: function getPixel() {\n      var point = Point.read(arguments);\n      var data = this.getContext().getImageData(point.x, point.y, 1, 1).data;\n      return new Color('rgb', [data[0] / 255, data[1] / 255, data[2] / 255], data[3] / 255);\n    },\n    setPixel: function setPixel() {\n      var point = Point.read(arguments),\n          color = Color.read(arguments),\n          components = color._convert('rgb'),\n          alpha = color._alpha,\n          ctx = this.getContext(true),\n          imageData = ctx.createImageData(1, 1),\n          data = imageData.data;\n\n      data[0] = components[0] * 255;\n      data[1] = components[1] * 255;\n      data[2] = components[2] * 255;\n      data[3] = alpha != null ? alpha * 255 : 255;\n      ctx.putImageData(imageData, point.x, point.y);\n    },\n    createImageData: function createImageData() {\n      var size = Size.read(arguments);\n      return this.getContext().createImageData(size.width, size.height);\n    },\n    getImageData: function getImageData() {\n      var rect = _Rectangle.read(arguments);\n\n      if (rect.isEmpty()) rect = new _Rectangle(this._size);\n      return this.getContext().getImageData(rect.x, rect.y, rect.width, rect.height);\n    },\n    setImageData: function setImageData(data) {\n      var point = Point.read(arguments, 1);\n      this.getContext(true).putImageData(data, point.x, point.y);\n    },\n    _getBounds: function _getBounds(matrix, options) {\n      var rect = new _Rectangle(this._size).setCenter(0, 0);\n      return matrix ? matrix._transformBounds(rect) : rect;\n    },\n    _hitTestSelf: function _hitTestSelf(point) {\n      if (this._contains(point)) {\n        var that = this;\n        return new HitResult('pixel', that, {\n          offset: point.add(that._size.divide(2)).round(),\n          color: {\n            get: function get() {\n              return that.getPixel(this.offset);\n            }\n          }\n        });\n      }\n    },\n    _draw: function _draw(ctx, param, viewMatrix) {\n      var element = this.getElement();\n\n      if (element && element.width > 0 && element.height > 0) {\n        ctx.globalAlpha = this._opacity;\n\n        this._setStyles(ctx, param, viewMatrix);\n\n        DomElement.setPrefixed(ctx, 'imageSmoothingEnabled', this._smoothing);\n        ctx.drawImage(element, -this._size.width / 2, -this._size.height / 2);\n      }\n    },\n    _canComposite: function _canComposite() {\n      return true;\n    }\n  });\n  var SymbolItem = Item.extend({\n    _class: 'SymbolItem',\n    _applyMatrix: false,\n    _canApplyMatrix: false,\n    _boundsOptions: {\n      stroke: true\n    },\n    _serializeFields: {\n      symbol: null\n    },\n    initialize: function SymbolItem(arg0, arg1) {\n      if (!this._initialize(arg0, arg1 !== undefined && Point.read(arguments, 1))) this.setDefinition(arg0 instanceof SymbolDefinition ? arg0 : new SymbolDefinition(arg0));\n    },\n    _equals: function _equals(item) {\n      return this._definition === item._definition;\n    },\n    copyContent: function copyContent(source) {\n      this.setDefinition(source._definition);\n    },\n    getDefinition: function getDefinition() {\n      return this._definition;\n    },\n    setDefinition: function setDefinition(definition) {\n      this._definition = definition;\n\n      this._changed(9);\n    },\n    getSymbol: '#getDefinition',\n    setSymbol: '#setDefinition',\n    isEmpty: function isEmpty() {\n      return this._definition._item.isEmpty();\n    },\n    _getBounds: function _getBounds(matrix, options) {\n      var item = this._definition._item;\n      return item._getCachedBounds(item._matrix.prepended(matrix), options);\n    },\n    _hitTestSelf: function _hitTestSelf(point, options, viewMatrix) {\n      var res = this._definition._item._hitTest(point, options, viewMatrix);\n\n      if (res) res.item = this;\n      return res;\n    },\n    _draw: function _draw(ctx, param) {\n      this._definition._item.draw(ctx, param);\n    }\n  });\n  var SymbolDefinition = Base.extend({\n    _class: 'SymbolDefinition',\n    initialize: function SymbolDefinition(item, dontCenter) {\n      this._id = UID.get();\n      this.project = paper.project;\n      if (item) this.setItem(item, dontCenter);\n    },\n    _serialize: function _serialize(options, dictionary) {\n      return dictionary.add(this, function () {\n        return Base.serialize([this._class, this._item], options, false, dictionary);\n      });\n    },\n    _changed: function _changed(flags) {\n      if (flags & 8) Item._clearBoundsCache(this);\n      if (flags & 1) this.project._changed(flags);\n    },\n    getItem: function getItem() {\n      return this._item;\n    },\n    setItem: function setItem(item, _dontCenter) {\n      if (item._symbol) item = item.clone();\n      if (this._item) this._item._symbol = null;\n      this._item = item;\n      item.remove();\n      item.setSelected(false);\n      if (!_dontCenter) item.setPosition(new Point());\n      item._symbol = this;\n\n      this._changed(9);\n    },\n    getDefinition: '#getItem',\n    setDefinition: '#setItem',\n    place: function place(position) {\n      return new SymbolItem(this, position);\n    },\n    clone: function clone() {\n      return new SymbolDefinition(this._item.clone(false));\n    },\n    equals: function equals(symbol) {\n      return symbol === this || symbol && this._item.equals(symbol._item) || false;\n    }\n  });\n  var HitResult = Base.extend({\n    _class: 'HitResult',\n    initialize: function HitResult(type, item, values) {\n      this.type = type;\n      this.item = item;\n      if (values) this.inject(values);\n    },\n    statics: {\n      getOptions: function getOptions(args) {\n        var options = args && Base.read(args);\n        return Base.set({\n          type: null,\n          tolerance: paper.settings.hitTolerance,\n          fill: !options,\n          stroke: !options,\n          segments: !options,\n          handles: false,\n          ends: false,\n          position: false,\n          center: false,\n          bounds: false,\n          guides: false,\n          selected: false\n        }, options);\n      }\n    }\n  });\n  var Segment = Base.extend({\n    _class: 'Segment',\n    beans: true,\n    _selection: 0,\n    initialize: function Segment(arg0, arg1, arg2, arg3, arg4, arg5) {\n      var count = arguments.length,\n          point,\n          handleIn,\n          handleOut,\n          selection;\n\n      if (count > 0) {\n        if (arg0 == null || _typeof(arg0) === 'object') {\n          if (count === 1 && arg0 && 'point' in arg0) {\n            point = arg0.point;\n            handleIn = arg0.handleIn;\n            handleOut = arg0.handleOut;\n            selection = arg0.selection;\n          } else {\n            point = arg0;\n            handleIn = arg1;\n            handleOut = arg2;\n            selection = arg3;\n          }\n        } else {\n          point = [arg0, arg1];\n          handleIn = arg2 !== undefined ? [arg2, arg3] : null;\n          handleOut = arg4 !== undefined ? [arg4, arg5] : null;\n        }\n      }\n\n      new SegmentPoint(point, this, '_point');\n      new SegmentPoint(handleIn, this, '_handleIn');\n      new SegmentPoint(handleOut, this, '_handleOut');\n      if (selection) this.setSelection(selection);\n    },\n    _serialize: function _serialize(options, dictionary) {\n      var point = this._point,\n          selection = this._selection,\n          obj = selection || this.hasHandles() ? [point, this._handleIn, this._handleOut] : point;\n      if (selection) obj.push(selection);\n      return Base.serialize(obj, options, true, dictionary);\n    },\n    _changed: function _changed(point) {\n      var path = this._path;\n      if (!path) return;\n      var curves = path._curves,\n          index = this._index,\n          curve;\n\n      if (curves) {\n        if ((!point || point === this._point || point === this._handleIn) && (curve = index > 0 ? curves[index - 1] : path._closed ? curves[curves.length - 1] : null)) curve._changed();\n        if ((!point || point === this._point || point === this._handleOut) && (curve = curves[index])) curve._changed();\n      }\n\n      path._changed(41);\n    },\n    getPoint: function getPoint() {\n      return this._point;\n    },\n    setPoint: function setPoint() {\n      this._point.set(Point.read(arguments));\n    },\n    getHandleIn: function getHandleIn() {\n      return this._handleIn;\n    },\n    setHandleIn: function setHandleIn() {\n      this._handleIn.set(Point.read(arguments));\n    },\n    getHandleOut: function getHandleOut() {\n      return this._handleOut;\n    },\n    setHandleOut: function setHandleOut() {\n      this._handleOut.set(Point.read(arguments));\n    },\n    hasHandles: function hasHandles() {\n      return !this._handleIn.isZero() || !this._handleOut.isZero();\n    },\n    isSmooth: function isSmooth() {\n      var handleIn = this._handleIn,\n          handleOut = this._handleOut;\n      return !handleIn.isZero() && !handleOut.isZero() && handleIn.isCollinear(handleOut);\n    },\n    clearHandles: function clearHandles() {\n      this._handleIn._set(0, 0);\n\n      this._handleOut._set(0, 0);\n    },\n    getSelection: function getSelection() {\n      return this._selection;\n    },\n    setSelection: function setSelection(selection) {\n      var oldSelection = this._selection,\n          path = this._path;\n      this._selection = selection = selection || 0;\n\n      if (path && selection !== oldSelection) {\n        path._updateSelection(this, oldSelection, selection);\n\n        path._changed(257);\n      }\n    },\n    _changeSelection: function _changeSelection(flag, selected) {\n      var selection = this._selection;\n      this.setSelection(selected ? selection | flag : selection & ~flag);\n    },\n    isSelected: function isSelected() {\n      return !!(this._selection & 7);\n    },\n    setSelected: function setSelected(selected) {\n      this._changeSelection(7, selected);\n    },\n    getIndex: function getIndex() {\n      return this._index !== undefined ? this._index : null;\n    },\n    getPath: function getPath() {\n      return this._path || null;\n    },\n    getCurve: function getCurve() {\n      var path = this._path,\n          index = this._index;\n\n      if (path) {\n        if (index > 0 && !path._closed && index === path._segments.length - 1) index--;\n        return path.getCurves()[index] || null;\n      }\n\n      return null;\n    },\n    getLocation: function getLocation() {\n      var curve = this.getCurve();\n      return curve ? new CurveLocation(curve, this === curve._segment1 ? 0 : 1) : null;\n    },\n    getNext: function getNext() {\n      var segments = this._path && this._path._segments;\n      return segments && (segments[this._index + 1] || this._path._closed && segments[0]) || null;\n    },\n    smooth: function smooth(options, _first, _last) {\n      var opts = options || {},\n          type = opts.type,\n          factor = opts.factor,\n          prev = this.getPrevious(),\n          next = this.getNext(),\n          p0 = (prev || this)._point,\n          p1 = this._point,\n          p2 = (next || this)._point,\n          d1 = p0.getDistance(p1),\n          d2 = p1.getDistance(p2);\n\n      if (!type || type === 'catmull-rom') {\n        var a = factor === undefined ? 0.5 : factor,\n            d1_a = Math.pow(d1, a),\n            d1_2a = d1_a * d1_a,\n            d2_a = Math.pow(d2, a),\n            d2_2a = d2_a * d2_a;\n\n        if (!_first && prev) {\n          var A = 2 * d2_2a + 3 * d2_a * d1_a + d1_2a,\n              N = 3 * d2_a * (d2_a + d1_a);\n          this.setHandleIn(N !== 0 ? new Point((d2_2a * p0._x + A * p1._x - d1_2a * p2._x) / N - p1._x, (d2_2a * p0._y + A * p1._y - d1_2a * p2._y) / N - p1._y) : new Point());\n        }\n\n        if (!_last && next) {\n          var A = 2 * d1_2a + 3 * d1_a * d2_a + d2_2a,\n              N = 3 * d1_a * (d1_a + d2_a);\n          this.setHandleOut(N !== 0 ? new Point((d1_2a * p2._x + A * p1._x - d2_2a * p0._x) / N - p1._x, (d1_2a * p2._y + A * p1._y - d2_2a * p0._y) / N - p1._y) : new Point());\n        }\n      } else if (type === 'geometric') {\n        if (prev && next) {\n          var vector = p0.subtract(p2),\n              t = factor === undefined ? 0.4 : factor,\n              k = t * d1 / (d1 + d2);\n          if (!_first) this.setHandleIn(vector.multiply(k));\n          if (!_last) this.setHandleOut(vector.multiply(k - t));\n        }\n      } else {\n        throw new Error('Smoothing method \\'' + type + '\\' not supported.');\n      }\n    },\n    getPrevious: function getPrevious() {\n      var segments = this._path && this._path._segments;\n      return segments && (segments[this._index - 1] || this._path._closed && segments[segments.length - 1]) || null;\n    },\n    isFirst: function isFirst() {\n      return !this._index;\n    },\n    isLast: function isLast() {\n      var path = this._path;\n      return path && this._index === path._segments.length - 1 || false;\n    },\n    reverse: function reverse() {\n      var handleIn = this._handleIn,\n          handleOut = this._handleOut,\n          tmp = handleIn.clone();\n      handleIn.set(handleOut);\n      handleOut.set(tmp);\n    },\n    reversed: function reversed() {\n      return new Segment(this._point, this._handleOut, this._handleIn);\n    },\n    remove: function remove() {\n      return this._path ? !!this._path.removeSegment(this._index) : false;\n    },\n    clone: function clone() {\n      return new Segment(this._point, this._handleIn, this._handleOut);\n    },\n    equals: function equals(segment) {\n      return segment === this || segment && this._class === segment._class && this._point.equals(segment._point) && this._handleIn.equals(segment._handleIn) && this._handleOut.equals(segment._handleOut) || false;\n    },\n    toString: function toString() {\n      var parts = ['point: ' + this._point];\n      if (!this._handleIn.isZero()) parts.push('handleIn: ' + this._handleIn);\n      if (!this._handleOut.isZero()) parts.push('handleOut: ' + this._handleOut);\n      return '{ ' + parts.join(', ') + ' }';\n    },\n    transform: function transform(matrix) {\n      this._transformCoordinates(matrix, new Array(6), true);\n\n      this._changed();\n    },\n    interpolate: function interpolate(from, to, factor) {\n      var u = 1 - factor,\n          v = factor,\n          point1 = from._point,\n          point2 = to._point,\n          handleIn1 = from._handleIn,\n          handleIn2 = to._handleIn,\n          handleOut2 = to._handleOut,\n          handleOut1 = from._handleOut;\n\n      this._point._set(u * point1._x + v * point2._x, u * point1._y + v * point2._y, true);\n\n      this._handleIn._set(u * handleIn1._x + v * handleIn2._x, u * handleIn1._y + v * handleIn2._y, true);\n\n      this._handleOut._set(u * handleOut1._x + v * handleOut2._x, u * handleOut1._y + v * handleOut2._y, true);\n\n      this._changed();\n    },\n    _transformCoordinates: function _transformCoordinates(matrix, coords, change) {\n      var point = this._point,\n          handleIn = !change || !this._handleIn.isZero() ? this._handleIn : null,\n          handleOut = !change || !this._handleOut.isZero() ? this._handleOut : null,\n          x = point._x,\n          y = point._y,\n          i = 2;\n      coords[0] = x;\n      coords[1] = y;\n\n      if (handleIn) {\n        coords[i++] = handleIn._x + x;\n        coords[i++] = handleIn._y + y;\n      }\n\n      if (handleOut) {\n        coords[i++] = handleOut._x + x;\n        coords[i++] = handleOut._y + y;\n      }\n\n      if (matrix) {\n        matrix._transformCoordinates(coords, coords, i / 2);\n\n        x = coords[0];\n        y = coords[1];\n\n        if (change) {\n          point._x = x;\n          point._y = y;\n          i = 2;\n\n          if (handleIn) {\n            handleIn._x = coords[i++] - x;\n            handleIn._y = coords[i++] - y;\n          }\n\n          if (handleOut) {\n            handleOut._x = coords[i++] - x;\n            handleOut._y = coords[i++] - y;\n          }\n        } else {\n          if (!handleIn) {\n            coords[i++] = x;\n            coords[i++] = y;\n          }\n\n          if (!handleOut) {\n            coords[i++] = x;\n            coords[i++] = y;\n          }\n        }\n      }\n\n      return coords;\n    }\n  });\n  var SegmentPoint = Point.extend({\n    initialize: function SegmentPoint(point, owner, key) {\n      var x, y, selected;\n\n      if (!point) {\n        x = y = 0;\n      } else if ((x = point[0]) !== undefined) {\n        y = point[1];\n      } else {\n        var pt = point;\n\n        if ((x = pt.x) === undefined) {\n          pt = Point.read(arguments);\n          x = pt.x;\n        }\n\n        y = pt.y;\n        selected = pt.selected;\n      }\n\n      this._x = x;\n      this._y = y;\n      this._owner = owner;\n      owner[key] = this;\n      if (selected) this.setSelected(true);\n    },\n    _set: function _set(x, y) {\n      this._x = x;\n      this._y = y;\n\n      this._owner._changed(this);\n\n      return this;\n    },\n    getX: function getX() {\n      return this._x;\n    },\n    setX: function setX(x) {\n      this._x = x;\n\n      this._owner._changed(this);\n    },\n    getY: function getY() {\n      return this._y;\n    },\n    setY: function setY(y) {\n      this._y = y;\n\n      this._owner._changed(this);\n    },\n    isZero: function isZero() {\n      var isZero = Numerical.isZero;\n      return isZero(this._x) && isZero(this._y);\n    },\n    isSelected: function isSelected() {\n      return !!(this._owner._selection & this._getSelection());\n    },\n    setSelected: function setSelected(selected) {\n      this._owner._changeSelection(this._getSelection(), selected);\n    },\n    _getSelection: function _getSelection() {\n      var owner = this._owner;\n      return this === owner._point ? 1 : this === owner._handleIn ? 2 : this === owner._handleOut ? 4 : 0;\n    }\n  });\n  var Curve = Base.extend({\n    _class: 'Curve',\n    beans: true,\n    initialize: function Curve(arg0, arg1, arg2, arg3, arg4, arg5, arg6, arg7) {\n      var count = arguments.length,\n          seg1,\n          seg2,\n          point1,\n          point2,\n          handle1,\n          handle2;\n\n      if (count === 3) {\n        this._path = arg0;\n        seg1 = arg1;\n        seg2 = arg2;\n      } else if (!count) {\n        seg1 = new Segment();\n        seg2 = new Segment();\n      } else if (count === 1) {\n        if ('segment1' in arg0) {\n          seg1 = new Segment(arg0.segment1);\n          seg2 = new Segment(arg0.segment2);\n        } else if ('point1' in arg0) {\n          point1 = arg0.point1;\n          handle1 = arg0.handle1;\n          handle2 = arg0.handle2;\n          point2 = arg0.point2;\n        } else if (_Array$isArray(arg0)) {\n          point1 = [arg0[0], arg0[1]];\n          point2 = [arg0[6], arg0[7]];\n          handle1 = [arg0[2] - arg0[0], arg0[3] - arg0[1]];\n          handle2 = [arg0[4] - arg0[6], arg0[5] - arg0[7]];\n        }\n      } else if (count === 2) {\n        seg1 = new Segment(arg0);\n        seg2 = new Segment(arg1);\n      } else if (count === 4) {\n        point1 = arg0;\n        handle1 = arg1;\n        handle2 = arg2;\n        point2 = arg3;\n      } else if (count === 8) {\n        point1 = [arg0, arg1];\n        point2 = [arg6, arg7];\n        handle1 = [arg2 - arg0, arg3 - arg1];\n        handle2 = [arg4 - arg6, arg5 - arg7];\n      }\n\n      this._segment1 = seg1 || new Segment(point1, null, handle1);\n      this._segment2 = seg2 || new Segment(point2, handle2, null);\n    },\n    _serialize: function _serialize(options, dictionary) {\n      return Base.serialize(this.hasHandles() ? [this.getPoint1(), this.getHandle1(), this.getHandle2(), this.getPoint2()] : [this.getPoint1(), this.getPoint2()], options, true, dictionary);\n    },\n    _changed: function _changed() {\n      this._length = this._bounds = undefined;\n    },\n    clone: function clone() {\n      return new Curve(this._segment1, this._segment2);\n    },\n    toString: function toString() {\n      var parts = ['point1: ' + this._segment1._point];\n      if (!this._segment1._handleOut.isZero()) parts.push('handle1: ' + this._segment1._handleOut);\n      if (!this._segment2._handleIn.isZero()) parts.push('handle2: ' + this._segment2._handleIn);\n      parts.push('point2: ' + this._segment2._point);\n      return '{ ' + parts.join(', ') + ' }';\n    },\n    classify: function classify() {\n      return Curve.classify(this.getValues());\n    },\n    remove: function remove() {\n      var removed = false;\n\n      if (this._path) {\n        var segment2 = this._segment2,\n            handleOut = segment2._handleOut;\n        removed = segment2.remove();\n        if (removed) this._segment1._handleOut.set(handleOut);\n      }\n\n      return removed;\n    },\n    getPoint1: function getPoint1() {\n      return this._segment1._point;\n    },\n    setPoint1: function setPoint1() {\n      this._segment1._point.set(Point.read(arguments));\n    },\n    getPoint2: function getPoint2() {\n      return this._segment2._point;\n    },\n    setPoint2: function setPoint2() {\n      this._segment2._point.set(Point.read(arguments));\n    },\n    getHandle1: function getHandle1() {\n      return this._segment1._handleOut;\n    },\n    setHandle1: function setHandle1() {\n      this._segment1._handleOut.set(Point.read(arguments));\n    },\n    getHandle2: function getHandle2() {\n      return this._segment2._handleIn;\n    },\n    setHandle2: function setHandle2() {\n      this._segment2._handleIn.set(Point.read(arguments));\n    },\n    getSegment1: function getSegment1() {\n      return this._segment1;\n    },\n    getSegment2: function getSegment2() {\n      return this._segment2;\n    },\n    getPath: function getPath() {\n      return this._path;\n    },\n    getIndex: function getIndex() {\n      return this._segment1._index;\n    },\n    getNext: function getNext() {\n      var curves = this._path && this._path._curves;\n      return curves && (curves[this._segment1._index + 1] || this._path._closed && curves[0]) || null;\n    },\n    getPrevious: function getPrevious() {\n      var curves = this._path && this._path._curves;\n      return curves && (curves[this._segment1._index - 1] || this._path._closed && curves[curves.length - 1]) || null;\n    },\n    isFirst: function isFirst() {\n      return !this._segment1._index;\n    },\n    isLast: function isLast() {\n      var path = this._path;\n      return path && this._segment1._index === path._curves.length - 1 || false;\n    },\n    isSelected: function isSelected() {\n      return this.getPoint1().isSelected() && this.getHandle1().isSelected() && this.getHandle2().isSelected() && this.getPoint2().isSelected();\n    },\n    setSelected: function setSelected(selected) {\n      this.getPoint1().setSelected(selected);\n      this.getHandle1().setSelected(selected);\n      this.getHandle2().setSelected(selected);\n      this.getPoint2().setSelected(selected);\n    },\n    getValues: function getValues(matrix) {\n      return Curve.getValues(this._segment1, this._segment2, matrix);\n    },\n    getPoints: function getPoints() {\n      var coords = this.getValues(),\n          points = [];\n\n      for (var i = 0; i < 8; i += 2) {\n        points.push(new Point(coords[i], coords[i + 1]));\n      }\n\n      return points;\n    }\n  }, {\n    getLength: function getLength() {\n      if (this._length == null) this._length = Curve.getLength(this.getValues(), 0, 1);\n      return this._length;\n    },\n    getArea: function getArea() {\n      return Curve.getArea(this.getValues());\n    },\n    getLine: function getLine() {\n      return new Line(this._segment1._point, this._segment2._point);\n    },\n    getPart: function getPart(from, to) {\n      return new Curve(Curve.getPart(this.getValues(), from, to));\n    },\n    getPartLength: function getPartLength(from, to) {\n      return Curve.getLength(this.getValues(), from, to);\n    },\n    divideAt: function divideAt(location) {\n      return this.divideAtTime(location && location.curve === this ? location.time : this.getTimeAt(location));\n    },\n    divideAtTime: function divideAtTime(time, _setHandles) {\n      var tMin = 1e-8,\n          tMax = 1 - tMin,\n          res = null;\n\n      if (time >= tMin && time <= tMax) {\n        var parts = Curve.subdivide(this.getValues(), time),\n            left = parts[0],\n            right = parts[1],\n            setHandles = _setHandles || this.hasHandles(),\n            seg1 = this._segment1,\n            seg2 = this._segment2,\n            path = this._path;\n\n        if (setHandles) {\n          seg1._handleOut._set(left[2] - left[0], left[3] - left[1]);\n\n          seg2._handleIn._set(right[4] - right[6], right[5] - right[7]);\n        }\n\n        var x = left[6],\n            y = left[7],\n            segment = new Segment(new Point(x, y), setHandles && new Point(left[4] - x, left[5] - y), setHandles && new Point(right[2] - x, right[3] - y));\n\n        if (path) {\n          path.insert(seg1._index + 1, segment);\n          res = this.getNext();\n        } else {\n          this._segment2 = segment;\n\n          this._changed();\n\n          res = new Curve(segment, seg2);\n        }\n      }\n\n      return res;\n    },\n    splitAt: function splitAt(location) {\n      var path = this._path;\n      return path ? path.splitAt(location) : null;\n    },\n    splitAtTime: function splitAtTime(time) {\n      return this.splitAt(this.getLocationAtTime(time));\n    },\n    divide: function divide(offset, isTime) {\n      return this.divideAtTime(offset === undefined ? 0.5 : isTime ? offset : this.getTimeAt(offset));\n    },\n    split: function split(offset, isTime) {\n      return this.splitAtTime(offset === undefined ? 0.5 : isTime ? offset : this.getTimeAt(offset));\n    },\n    reversed: function reversed() {\n      return new Curve(this._segment2.reversed(), this._segment1.reversed());\n    },\n    clearHandles: function clearHandles() {\n      this._segment1._handleOut._set(0, 0);\n\n      this._segment2._handleIn._set(0, 0);\n    },\n    statics: {\n      getValues: function getValues(segment1, segment2, matrix, straight) {\n        var p1 = segment1._point,\n            h1 = segment1._handleOut,\n            h2 = segment2._handleIn,\n            p2 = segment2._point,\n            x1 = p1.x,\n            y1 = p1.y,\n            x2 = p2.x,\n            y2 = p2.y,\n            values = straight ? [x1, y1, x1, y1, x2, y2, x2, y2] : [x1, y1, x1 + h1._x, y1 + h1._y, x2 + h2._x, y2 + h2._y, x2, y2];\n        if (matrix) matrix._transformCoordinates(values, values, 4);\n        return values;\n      },\n      subdivide: function subdivide(v, t) {\n        var x0 = v[0],\n            y0 = v[1],\n            x1 = v[2],\n            y1 = v[3],\n            x2 = v[4],\n            y2 = v[5],\n            x3 = v[6],\n            y3 = v[7];\n        if (t === undefined) t = 0.5;\n        var u = 1 - t,\n            x4 = u * x0 + t * x1,\n            y4 = u * y0 + t * y1,\n            x5 = u * x1 + t * x2,\n            y5 = u * y1 + t * y2,\n            x6 = u * x2 + t * x3,\n            y6 = u * y2 + t * y3,\n            x7 = u * x4 + t * x5,\n            y7 = u * y4 + t * y5,\n            x8 = u * x5 + t * x6,\n            y8 = u * y5 + t * y6,\n            x9 = u * x7 + t * x8,\n            y9 = u * y7 + t * y8;\n        return [[x0, y0, x4, y4, x7, y7, x9, y9], [x9, y9, x8, y8, x6, y6, x3, y3]];\n      },\n      getMonoCurves: function getMonoCurves(v, dir) {\n        var curves = [],\n            io = dir ? 0 : 1,\n            o0 = v[io + 0],\n            o1 = v[io + 2],\n            o2 = v[io + 4],\n            o3 = v[io + 6];\n\n        if (o0 >= o1 === o1 >= o2 && o1 >= o2 === o2 >= o3 || Curve.isStraight(v)) {\n          curves.push(v);\n        } else {\n          var a = 3 * (o1 - o2) - o0 + o3,\n              b = 2 * (o0 + o2) - 4 * o1,\n              c = o1 - o0,\n              tMin = 1e-8,\n              tMax = 1 - tMin,\n              roots = [],\n              n = Numerical.solveQuadratic(a, b, c, roots, tMin, tMax);\n\n          if (!n) {\n            curves.push(v);\n          } else {\n            roots.sort();\n            var t = roots[0],\n                parts = Curve.subdivide(v, t);\n            curves.push(parts[0]);\n\n            if (n > 1) {\n              t = (roots[1] - t) / (1 - t);\n              parts = Curve.subdivide(parts[1], t);\n              curves.push(parts[0]);\n            }\n\n            curves.push(parts[1]);\n          }\n        }\n\n        return curves;\n      },\n      solveCubic: function solveCubic(v, coord, val, roots, min, max) {\n        var v0 = v[coord],\n            v1 = v[coord + 2],\n            v2 = v[coord + 4],\n            v3 = v[coord + 6],\n            res = 0;\n\n        if (!(v0 < val && v3 < val && v1 < val && v2 < val || v0 > val && v3 > val && v1 > val && v2 > val)) {\n          var c = 3 * (v1 - v0),\n              b = 3 * (v2 - v1) - c,\n              a = v3 - v0 - c - b;\n          res = Numerical.solveCubic(a, b, c, v0 - val, roots, min, max);\n        }\n\n        return res;\n      },\n      getTimeOf: function getTimeOf(v, point) {\n        var p0 = new Point(v[0], v[1]),\n            p3 = new Point(v[6], v[7]),\n            epsilon = 1e-12,\n            geomEpsilon = 1e-7,\n            t = point.isClose(p0, epsilon) ? 0 : point.isClose(p3, epsilon) ? 1 : null;\n\n        if (t === null) {\n          var coords = [point.x, point.y],\n              roots = [];\n\n          for (var c = 0; c < 2; c++) {\n            var count = Curve.solveCubic(v, c, coords[c], roots, 0, 1);\n\n            for (var i = 0; i < count; i++) {\n              var u = roots[i];\n              if (point.isClose(Curve.getPoint(v, u), geomEpsilon)) return u;\n            }\n          }\n        }\n\n        return point.isClose(p0, geomEpsilon) ? 0 : point.isClose(p3, geomEpsilon) ? 1 : null;\n      },\n      getNearestTime: function getNearestTime(v, point) {\n        if (Curve.isStraight(v)) {\n          var x0 = v[0],\n              y0 = v[1],\n              x3 = v[6],\n              y3 = v[7],\n              vx = x3 - x0,\n              vy = y3 - y0,\n              det = vx * vx + vy * vy;\n          if (det === 0) return 0;\n          var u = ((point.x - x0) * vx + (point.y - y0) * vy) / det;\n          return u < 1e-12 ? 0 : u > 0.999999999999 ? 1 : Curve.getTimeOf(v, new Point(x0 + u * vx, y0 + u * vy));\n        }\n\n        var count = 100,\n            minDist = Infinity,\n            minT = 0;\n\n        function refine(t) {\n          if (t >= 0 && t <= 1) {\n            var dist = point.getDistance(Curve.getPoint(v, t), true);\n\n            if (dist < minDist) {\n              minDist = dist;\n              minT = t;\n              return true;\n            }\n          }\n        }\n\n        for (var i = 0; i <= count; i++) {\n          refine(i / count);\n        }\n\n        var step = 1 / (count * 2);\n\n        while (step > 1e-8) {\n          if (!refine(minT - step) && !refine(minT + step)) step /= 2;\n        }\n\n        return minT;\n      },\n      getPart: function getPart(v, from, to) {\n        var flip = from > to;\n\n        if (flip) {\n          var tmp = from;\n          from = to;\n          to = tmp;\n        }\n\n        if (from > 0) v = Curve.subdivide(v, from)[1];\n        if (to < 1) v = Curve.subdivide(v, (to - from) / (1 - from))[0];\n        return flip ? [v[6], v[7], v[4], v[5], v[2], v[3], v[0], v[1]] : v;\n      },\n      isFlatEnough: function isFlatEnough(v, flatness) {\n        var x0 = v[0],\n            y0 = v[1],\n            x1 = v[2],\n            y1 = v[3],\n            x2 = v[4],\n            y2 = v[5],\n            x3 = v[6],\n            y3 = v[7],\n            ux = 3 * x1 - 2 * x0 - x3,\n            uy = 3 * y1 - 2 * y0 - y3,\n            vx = 3 * x2 - 2 * x3 - x0,\n            vy = 3 * y2 - 2 * y3 - y0;\n        return Math.max(ux * ux, vx * vx) + Math.max(uy * uy, vy * vy) <= 16 * flatness * flatness;\n      },\n      getArea: function getArea(v) {\n        var x0 = v[0],\n            y0 = v[1],\n            x1 = v[2],\n            y1 = v[3],\n            x2 = v[4],\n            y2 = v[5],\n            x3 = v[6],\n            y3 = v[7];\n        return 3 * ((y3 - y0) * (x1 + x2) - (x3 - x0) * (y1 + y2) + y1 * (x0 - x2) - x1 * (y0 - y2) + y3 * (x2 + x0 / 3) - x3 * (y2 + y0 / 3)) / 20;\n      },\n      getBounds: function getBounds(v) {\n        var min = v.slice(0, 2),\n            max = min.slice(),\n            roots = [0, 0];\n\n        for (var i = 0; i < 2; i++) {\n          Curve._addBounds(v[i], v[i + 2], v[i + 4], v[i + 6], i, 0, min, max, roots);\n        }\n\n        return new _Rectangle(min[0], min[1], max[0] - min[0], max[1] - min[1]);\n      },\n      _addBounds: function _addBounds(v0, v1, v2, v3, coord, padding, min, max, roots) {\n        function add(value, padding) {\n          var left = value - padding,\n              right = value + padding;\n          if (left < min[coord]) min[coord] = left;\n          if (right > max[coord]) max[coord] = right;\n        }\n\n        padding /= 2;\n        var minPad = min[coord] - padding,\n            maxPad = max[coord] + padding;\n\n        if (v0 < minPad || v1 < minPad || v2 < minPad || v3 < minPad || v0 > maxPad || v1 > maxPad || v2 > maxPad || v3 > maxPad) {\n          if (v1 < v0 != v1 < v3 && v2 < v0 != v2 < v3) {\n            add(v0, padding);\n            add(v3, padding);\n          } else {\n            var a = 3 * (v1 - v2) - v0 + v3,\n                b = 2 * (v0 + v2) - 4 * v1,\n                c = v1 - v0,\n                count = Numerical.solveQuadratic(a, b, c, roots),\n                tMin = 1e-8,\n                tMax = 1 - tMin;\n            add(v3, 0);\n\n            for (var i = 0; i < count; i++) {\n              var t = roots[i],\n                  u = 1 - t;\n              if (tMin <= t && t <= tMax) add(u * u * u * v0 + 3 * u * u * t * v1 + 3 * u * t * t * v2 + t * t * t * v3, padding);\n            }\n          }\n        }\n      }\n    }\n  }, Base.each(['getBounds', 'getStrokeBounds', 'getHandleBounds'], function (name) {\n    this[name] = function () {\n      if (!this._bounds) this._bounds = {};\n      var bounds = this._bounds[name];\n\n      if (!bounds) {\n        bounds = this._bounds[name] = Path[name]([this._segment1, this._segment2], false, this._path);\n      }\n\n      return bounds.clone();\n    };\n  }, {}), Base.each({\n    isStraight: function isStraight(p1, h1, h2, p2) {\n      if (h1.isZero() && h2.isZero()) {\n        return true;\n      } else {\n        var v = p2.subtract(p1);\n\n        if (v.isZero()) {\n          return false;\n        } else if (v.isCollinear(h1) && v.isCollinear(h2)) {\n          var l = new Line(p1, p2),\n              epsilon = 1e-7;\n\n          if (l.getDistance(p1.add(h1)) < epsilon && l.getDistance(p2.add(h2)) < epsilon) {\n            var div = v.dot(v),\n                s1 = v.dot(h1) / div,\n                s2 = v.dot(h2) / div;\n            return s1 >= 0 && s1 <= 1 && s2 <= 0 && s2 >= -1;\n          }\n        }\n      }\n\n      return false;\n    },\n    isLinear: function isLinear(p1, h1, h2, p2) {\n      var third = p2.subtract(p1).divide(3);\n      return h1.equals(third) && h2.negate().equals(third);\n    }\n  }, function (test, name) {\n    this[name] = function (epsilon) {\n      var seg1 = this._segment1,\n          seg2 = this._segment2;\n      return test(seg1._point, seg1._handleOut, seg2._handleIn, seg2._point, epsilon);\n    };\n\n    this.statics[name] = function (v, epsilon) {\n      var x0 = v[0],\n          y0 = v[1],\n          x3 = v[6],\n          y3 = v[7];\n      return test(new Point(x0, y0), new Point(v[2] - x0, v[3] - y0), new Point(v[4] - x3, v[5] - y3), new Point(x3, y3), epsilon);\n    };\n  }, {\n    statics: {},\n    hasHandles: function hasHandles() {\n      return !this._segment1._handleOut.isZero() || !this._segment2._handleIn.isZero();\n    },\n    hasLength: function hasLength(epsilon) {\n      return (!this.getPoint1().equals(this.getPoint2()) || this.hasHandles()) && this.getLength() > (epsilon || 0);\n    },\n    isCollinear: function isCollinear(curve) {\n      return curve && this.isStraight() && curve.isStraight() && this.getLine().isCollinear(curve.getLine());\n    },\n    isHorizontal: function isHorizontal() {\n      return this.isStraight() && Math.abs(this.getTangentAtTime(0.5).y) < 1e-8;\n    },\n    isVertical: function isVertical() {\n      return this.isStraight() && Math.abs(this.getTangentAtTime(0.5).x) < 1e-8;\n    }\n  }), {\n    beans: false,\n    getLocationAt: function getLocationAt(offset, _isTime) {\n      return this.getLocationAtTime(_isTime ? offset : this.getTimeAt(offset));\n    },\n    getLocationAtTime: function getLocationAtTime(t) {\n      return t != null && t >= 0 && t <= 1 ? new CurveLocation(this, t) : null;\n    },\n    getTimeAt: function getTimeAt(offset, start) {\n      return Curve.getTimeAt(this.getValues(), offset, start);\n    },\n    getParameterAt: '#getTimeAt',\n    getTimesWithTangent: function getTimesWithTangent() {\n      var tangent = Point.read(arguments);\n      return tangent.isZero() ? [] : Curve.getTimesWithTangent(this.getValues(), tangent);\n    },\n    getOffsetAtTime: function getOffsetAtTime(t) {\n      return this.getPartLength(0, t);\n    },\n    getLocationOf: function getLocationOf() {\n      return this.getLocationAtTime(this.getTimeOf(Point.read(arguments)));\n    },\n    getOffsetOf: function getOffsetOf() {\n      var loc = this.getLocationOf.apply(this, arguments);\n      return loc ? loc.getOffset() : null;\n    },\n    getTimeOf: function getTimeOf() {\n      return Curve.getTimeOf(this.getValues(), Point.read(arguments));\n    },\n    getParameterOf: '#getTimeOf',\n    getNearestLocation: function getNearestLocation() {\n      var point = Point.read(arguments),\n          values = this.getValues(),\n          t = Curve.getNearestTime(values, point),\n          pt = Curve.getPoint(values, t);\n      return new CurveLocation(this, t, pt, null, point.getDistance(pt));\n    },\n    getNearestPoint: function getNearestPoint() {\n      var loc = this.getNearestLocation.apply(this, arguments);\n      return loc ? loc.getPoint() : loc;\n    }\n  }, new function () {\n    var methods = ['getPoint', 'getTangent', 'getNormal', 'getWeightedTangent', 'getWeightedNormal', 'getCurvature'];\n    return Base.each(methods, function (name) {\n      this[name + 'At'] = function (location, _isTime) {\n        var values = this.getValues();\n        return Curve[name](values, _isTime ? location : Curve.getTimeAt(values, location));\n      };\n\n      this[name + 'AtTime'] = function (time) {\n        return Curve[name](this.getValues(), time);\n      };\n    }, {\n      statics: {\n        _evaluateMethods: methods\n      }\n    });\n  }(), new function () {\n    function getLengthIntegrand(v) {\n      var x0 = v[0],\n          y0 = v[1],\n          x1 = v[2],\n          y1 = v[3],\n          x2 = v[4],\n          y2 = v[5],\n          x3 = v[6],\n          y3 = v[7],\n          ax = 9 * (x1 - x2) + 3 * (x3 - x0),\n          bx = 6 * (x0 + x2) - 12 * x1,\n          cx = 3 * (x1 - x0),\n          ay = 9 * (y1 - y2) + 3 * (y3 - y0),\n          by = 6 * (y0 + y2) - 12 * y1,\n          cy = 3 * (y1 - y0);\n      return function (t) {\n        var dx = (ax * t + bx) * t + cx,\n            dy = (ay * t + by) * t + cy;\n        return Math.sqrt(dx * dx + dy * dy);\n      };\n    }\n\n    function getIterations(a, b) {\n      return Math.max(2, Math.min(16, Math.ceil(Math.abs(b - a) * 32)));\n    }\n\n    function evaluate(v, t, type, normalized) {\n      if (t == null || t < 0 || t > 1) return null;\n      var x0 = v[0],\n          y0 = v[1],\n          x1 = v[2],\n          y1 = v[3],\n          x2 = v[4],\n          y2 = v[5],\n          x3 = v[6],\n          y3 = v[7],\n          isZero = Numerical.isZero;\n\n      if (isZero(x1 - x0) && isZero(y1 - y0)) {\n        x1 = x0;\n        y1 = y0;\n      }\n\n      if (isZero(x2 - x3) && isZero(y2 - y3)) {\n        x2 = x3;\n        y2 = y3;\n      }\n\n      var cx = 3 * (x1 - x0),\n          bx = 3 * (x2 - x1) - cx,\n          ax = x3 - x0 - cx - bx,\n          cy = 3 * (y1 - y0),\n          by = 3 * (y2 - y1) - cy,\n          ay = y3 - y0 - cy - by,\n          x,\n          y;\n\n      if (type === 0) {\n        x = t === 0 ? x0 : t === 1 ? x3 : ((ax * t + bx) * t + cx) * t + x0;\n        y = t === 0 ? y0 : t === 1 ? y3 : ((ay * t + by) * t + cy) * t + y0;\n      } else {\n        var tMin = 1e-8,\n            tMax = 1 - tMin;\n\n        if (t < tMin) {\n          x = cx;\n          y = cy;\n        } else if (t > tMax) {\n          x = 3 * (x3 - x2);\n          y = 3 * (y3 - y2);\n        } else {\n          x = (3 * ax * t + 2 * bx) * t + cx;\n          y = (3 * ay * t + 2 * by) * t + cy;\n        }\n\n        if (normalized) {\n          if (x === 0 && y === 0 && (t < tMin || t > tMax)) {\n            x = x2 - x1;\n            y = y2 - y1;\n          }\n\n          var len = Math.sqrt(x * x + y * y);\n\n          if (len) {\n            x /= len;\n            y /= len;\n          }\n        }\n\n        if (type === 3) {\n          var x2 = 6 * ax * t + 2 * bx,\n              y2 = 6 * ay * t + 2 * by,\n              d = Math.pow(x * x + y * y, 3 / 2);\n          x = d !== 0 ? (x * y2 - y * x2) / d : 0;\n          y = 0;\n        }\n      }\n\n      return type === 2 ? new Point(y, -x) : new Point(x, y);\n    }\n\n    return {\n      statics: {\n        classify: function classify(v) {\n          var x0 = v[0],\n              y0 = v[1],\n              x1 = v[2],\n              y1 = v[3],\n              x2 = v[4],\n              y2 = v[5],\n              x3 = v[6],\n              y3 = v[7],\n              a1 = x0 * (y3 - y2) + y0 * (x2 - x3) + x3 * y2 - y3 * x2,\n              a2 = x1 * (y0 - y3) + y1 * (x3 - x0) + x0 * y3 - y0 * x3,\n              a3 = x2 * (y1 - y0) + y2 * (x0 - x1) + x1 * y0 - y1 * x0,\n              d3 = 3 * a3,\n              d2 = d3 - a2,\n              d1 = d2 - a2 + a1,\n              l = Math.sqrt(d1 * d1 + d2 * d2 + d3 * d3),\n              s = l !== 0 ? 1 / l : 0,\n              isZero = Numerical.isZero,\n              serpentine = 'serpentine';\n          d1 *= s;\n          d2 *= s;\n          d3 *= s;\n\n          function type(type, t1, t2) {\n            var hasRoots = t1 !== undefined,\n                t1Ok = hasRoots && t1 > 0 && t1 < 1,\n                t2Ok = hasRoots && t2 > 0 && t2 < 1;\n\n            if (hasRoots && (!(t1Ok || t2Ok) || type === 'loop' && !(t1Ok && t2Ok))) {\n              type = 'arch';\n              t1Ok = t2Ok = false;\n            }\n\n            return {\n              type: type,\n              roots: t1Ok || t2Ok ? t1Ok && t2Ok ? t1 < t2 ? [t1, t2] : [t2, t1] : [t1Ok ? t1 : t2] : null\n            };\n          }\n\n          if (isZero(d1)) {\n            return isZero(d2) ? type(isZero(d3) ? 'line' : 'quadratic') : type(serpentine, d3 / (3 * d2));\n          }\n\n          var d = 3 * d2 * d2 - 4 * d1 * d3;\n\n          if (isZero(d)) {\n            return type('cusp', d2 / (2 * d1));\n          }\n\n          var f1 = d > 0 ? Math.sqrt(d / 3) : Math.sqrt(-d),\n              f2 = 2 * d1;\n          return type(d > 0 ? serpentine : 'loop', (d2 + f1) / f2, (d2 - f1) / f2);\n        },\n        getLength: function getLength(v, a, b, ds) {\n          if (a === undefined) a = 0;\n          if (b === undefined) b = 1;\n\n          if (Curve.isStraight(v)) {\n            var c = v;\n\n            if (b < 1) {\n              c = Curve.subdivide(c, b)[0];\n              a /= b;\n            }\n\n            if (a > 0) {\n              c = Curve.subdivide(c, a)[1];\n            }\n\n            var dx = c[6] - c[0],\n                dy = c[7] - c[1];\n            return Math.sqrt(dx * dx + dy * dy);\n          }\n\n          return Numerical.integrate(ds || getLengthIntegrand(v), a, b, getIterations(a, b));\n        },\n        getTimeAt: function getTimeAt(v, offset, start) {\n          if (start === undefined) start = offset < 0 ? 1 : 0;\n          if (offset === 0) return start;\n          var abs = Math.abs,\n              epsilon = 1e-12,\n              forward = offset > 0,\n              a = forward ? start : 0,\n              b = forward ? 1 : start,\n              ds = getLengthIntegrand(v),\n              rangeLength = Curve.getLength(v, a, b, ds),\n              diff = abs(offset) - rangeLength;\n\n          if (abs(diff) < epsilon) {\n            return forward ? b : a;\n          } else if (diff > epsilon) {\n            return null;\n          }\n\n          var guess = offset / rangeLength,\n              length = 0;\n\n          function f(t) {\n            length += Numerical.integrate(ds, start, t, getIterations(start, t));\n            start = t;\n            return length - offset;\n          }\n\n          return Numerical.findRoot(f, ds, start + guess, a, b, 32, 1e-12);\n        },\n        getPoint: function getPoint(v, t) {\n          return evaluate(v, t, 0, false);\n        },\n        getTangent: function getTangent(v, t) {\n          return evaluate(v, t, 1, true);\n        },\n        getWeightedTangent: function getWeightedTangent(v, t) {\n          return evaluate(v, t, 1, false);\n        },\n        getNormal: function getNormal(v, t) {\n          return evaluate(v, t, 2, true);\n        },\n        getWeightedNormal: function getWeightedNormal(v, t) {\n          return evaluate(v, t, 2, false);\n        },\n        getCurvature: function getCurvature(v, t) {\n          return evaluate(v, t, 3, false).x;\n        },\n        getPeaks: function getPeaks(v) {\n          var x0 = v[0],\n              y0 = v[1],\n              x1 = v[2],\n              y1 = v[3],\n              x2 = v[4],\n              y2 = v[5],\n              x3 = v[6],\n              y3 = v[7],\n              ax = -x0 + 3 * x1 - 3 * x2 + x3,\n              bx = 3 * x0 - 6 * x1 + 3 * x2,\n              cx = -3 * x0 + 3 * x1,\n              ay = -y0 + 3 * y1 - 3 * y2 + y3,\n              by = 3 * y0 - 6 * y1 + 3 * y2,\n              cy = -3 * y0 + 3 * y1,\n              tMin = 1e-8,\n              tMax = 1 - tMin,\n              roots = [];\n          Numerical.solveCubic(9 * (ax * ax + ay * ay), 9 * (ax * bx + by * ay), 2 * (bx * bx + by * by) + 3 * (cx * ax + cy * ay), cx * bx + by * cy, roots, tMin, tMax);\n          return roots.sort();\n        }\n      }\n    };\n  }(), new function () {\n    function addLocation(locations, include, c1, t1, c2, t2, overlap) {\n      var excludeStart = !overlap && c1.getPrevious() === c2,\n          excludeEnd = !overlap && c1 !== c2 && c1.getNext() === c2,\n          tMin = 1e-8,\n          tMax = 1 - tMin;\n\n      if (t1 !== null && t1 >= (excludeStart ? tMin : 0) && t1 <= (excludeEnd ? tMax : 1)) {\n        if (t2 !== null && t2 >= (excludeEnd ? tMin : 0) && t2 <= (excludeStart ? tMax : 1)) {\n          var loc1 = new CurveLocation(c1, t1, null, overlap),\n              loc2 = new CurveLocation(c2, t2, null, overlap);\n          loc1._intersection = loc2;\n          loc2._intersection = loc1;\n\n          if (!include || include(loc1)) {\n            CurveLocation.insert(locations, loc1, true);\n          }\n        }\n      }\n    }\n\n    function addCurveIntersections(v1, v2, c1, c2, locations, include, flip, recursion, calls, tMin, tMax, uMin, uMax) {\n      if (++calls >= 4096 || ++recursion >= 40) return calls;\n      var fatLineEpsilon = 1e-9,\n          q0x = v2[0],\n          q0y = v2[1],\n          q3x = v2[6],\n          q3y = v2[7],\n          getSignedDistance = Line.getSignedDistance,\n          d1 = getSignedDistance(q0x, q0y, q3x, q3y, v2[2], v2[3]),\n          d2 = getSignedDistance(q0x, q0y, q3x, q3y, v2[4], v2[5]),\n          factor = d1 * d2 > 0 ? 3 / 4 : 4 / 9,\n          dMin = factor * Math.min(0, d1, d2),\n          dMax = factor * Math.max(0, d1, d2),\n          dp0 = getSignedDistance(q0x, q0y, q3x, q3y, v1[0], v1[1]),\n          dp1 = getSignedDistance(q0x, q0y, q3x, q3y, v1[2], v1[3]),\n          dp2 = getSignedDistance(q0x, q0y, q3x, q3y, v1[4], v1[5]),\n          dp3 = getSignedDistance(q0x, q0y, q3x, q3y, v1[6], v1[7]),\n          hull = getConvexHull(dp0, dp1, dp2, dp3),\n          top = hull[0],\n          bottom = hull[1],\n          tMinClip,\n          tMaxClip;\n      if (d1 === 0 && d2 === 0 && dp0 === 0 && dp1 === 0 && dp2 === 0 && dp3 === 0 || (tMinClip = clipConvexHull(top, bottom, dMin, dMax)) == null || (tMaxClip = clipConvexHull(top.reverse(), bottom.reverse(), dMin, dMax)) == null) return calls;\n      var tMinNew = tMin + (tMax - tMin) * tMinClip,\n          tMaxNew = tMin + (tMax - tMin) * tMaxClip;\n\n      if (Math.max(uMax - uMin, tMaxNew - tMinNew) < fatLineEpsilon) {\n        var t = (tMinNew + tMaxNew) / 2,\n            u = (uMin + uMax) / 2;\n        addLocation(locations, include, flip ? c2 : c1, flip ? u : t, flip ? c1 : c2, flip ? t : u);\n      } else {\n        v1 = Curve.getPart(v1, tMinClip, tMaxClip);\n\n        if (tMaxClip - tMinClip > 0.8) {\n          if (tMaxNew - tMinNew > uMax - uMin) {\n            var parts = Curve.subdivide(v1, 0.5),\n                t = (tMinNew + tMaxNew) / 2;\n            calls = addCurveIntersections(v2, parts[0], c2, c1, locations, include, !flip, recursion, calls, uMin, uMax, tMinNew, t);\n            calls = addCurveIntersections(v2, parts[1], c2, c1, locations, include, !flip, recursion, calls, uMin, uMax, t, tMaxNew);\n          } else {\n            var parts = Curve.subdivide(v2, 0.5),\n                u = (uMin + uMax) / 2;\n            calls = addCurveIntersections(parts[0], v1, c2, c1, locations, include, !flip, recursion, calls, uMin, u, tMinNew, tMaxNew);\n            calls = addCurveIntersections(parts[1], v1, c2, c1, locations, include, !flip, recursion, calls, u, uMax, tMinNew, tMaxNew);\n          }\n        } else {\n          if (uMax - uMin >= fatLineEpsilon) {\n            calls = addCurveIntersections(v2, v1, c2, c1, locations, include, !flip, recursion, calls, uMin, uMax, tMinNew, tMaxNew);\n          } else {\n            calls = addCurveIntersections(v1, v2, c1, c2, locations, include, flip, recursion, calls, tMinNew, tMaxNew, uMin, uMax);\n          }\n        }\n      }\n\n      return calls;\n    }\n\n    function getConvexHull(dq0, dq1, dq2, dq3) {\n      var p0 = [0, dq0],\n          p1 = [1 / 3, dq1],\n          p2 = [2 / 3, dq2],\n          p3 = [1, dq3],\n          dist1 = dq1 - (2 * dq0 + dq3) / 3,\n          dist2 = dq2 - (dq0 + 2 * dq3) / 3,\n          hull;\n\n      if (dist1 * dist2 < 0) {\n        hull = [[p0, p1, p3], [p0, p2, p3]];\n      } else {\n        var distRatio = dist1 / dist2;\n        hull = [distRatio >= 2 ? [p0, p1, p3] : distRatio <= 0.5 ? [p0, p2, p3] : [p0, p1, p2, p3], [p0, p3]];\n      }\n\n      return (dist1 || dist2) < 0 ? hull.reverse() : hull;\n    }\n\n    function clipConvexHull(hullTop, hullBottom, dMin, dMax) {\n      if (hullTop[0][1] < dMin) {\n        return clipConvexHullPart(hullTop, true, dMin);\n      } else if (hullBottom[0][1] > dMax) {\n        return clipConvexHullPart(hullBottom, false, dMax);\n      } else {\n        return hullTop[0][0];\n      }\n    }\n\n    function clipConvexHullPart(part, top, threshold) {\n      var px = part[0][0],\n          py = part[0][1];\n\n      for (var i = 1, l = part.length; i < l; i++) {\n        var qx = part[i][0],\n            qy = part[i][1];\n\n        if (top ? qy >= threshold : qy <= threshold) {\n          return qy === threshold ? qx : px + (threshold - py) * (qx - px) / (qy - py);\n        }\n\n        px = qx;\n        py = qy;\n      }\n\n      return null;\n    }\n\n    function getCurveLineIntersections(v, px, py, vx, vy) {\n      var isZero = Numerical.isZero;\n\n      if (isZero(vx) && isZero(vy)) {\n        var t = Curve.getTimeOf(v, new Point(px, py));\n        return t === null ? [] : [t];\n      }\n\n      var angle = Math.atan2(-vy, vx),\n          sin = Math.sin(angle),\n          cos = Math.cos(angle),\n          rv = [],\n          roots = [];\n\n      for (var i = 0; i < 8; i += 2) {\n        var x = v[i] - px,\n            y = v[i + 1] - py;\n        rv.push(x * cos - y * sin, x * sin + y * cos);\n      }\n\n      Curve.solveCubic(rv, 1, 0, roots, 0, 1);\n      return roots;\n    }\n\n    function addCurveLineIntersections(v1, v2, c1, c2, locations, include, flip) {\n      var x1 = v2[0],\n          y1 = v2[1],\n          x2 = v2[6],\n          y2 = v2[7],\n          roots = getCurveLineIntersections(v1, x1, y1, x2 - x1, y2 - y1);\n\n      for (var i = 0, l = roots.length; i < l; i++) {\n        var t1 = roots[i],\n            p1 = Curve.getPoint(v1, t1),\n            t2 = Curve.getTimeOf(v2, p1);\n\n        if (t2 !== null) {\n          addLocation(locations, include, flip ? c2 : c1, flip ? t2 : t1, flip ? c1 : c2, flip ? t1 : t2);\n        }\n      }\n    }\n\n    function addLineIntersection(v1, v2, c1, c2, locations, include) {\n      var pt = Line.intersect(v1[0], v1[1], v1[6], v1[7], v2[0], v2[1], v2[6], v2[7]);\n\n      if (pt) {\n        addLocation(locations, include, c1, Curve.getTimeOf(v1, pt), c2, Curve.getTimeOf(v2, pt));\n      }\n    }\n\n    function getCurveIntersections(v1, v2, c1, c2, locations, include) {\n      var epsilon = 1e-12,\n          min = Math.min,\n          max = Math.max;\n\n      if (max(v1[0], v1[2], v1[4], v1[6]) + epsilon > min(v2[0], v2[2], v2[4], v2[6]) && min(v1[0], v1[2], v1[4], v1[6]) - epsilon < max(v2[0], v2[2], v2[4], v2[6]) && max(v1[1], v1[3], v1[5], v1[7]) + epsilon > min(v2[1], v2[3], v2[5], v2[7]) && min(v1[1], v1[3], v1[5], v1[7]) - epsilon < max(v2[1], v2[3], v2[5], v2[7])) {\n        var overlaps = getOverlaps(v1, v2);\n\n        if (overlaps) {\n          for (var i = 0; i < 2; i++) {\n            var overlap = overlaps[i];\n            addLocation(locations, include, c1, overlap[0], c2, overlap[1], true);\n          }\n        } else {\n          var straight1 = Curve.isStraight(v1),\n              straight2 = Curve.isStraight(v2),\n              straight = straight1 && straight2,\n              flip = straight1 && !straight2,\n              before = locations.length;\n          (straight ? addLineIntersection : straight1 || straight2 ? addCurveLineIntersections : addCurveIntersections)(flip ? v2 : v1, flip ? v1 : v2, flip ? c2 : c1, flip ? c1 : c2, locations, include, flip, 0, 0, 0, 1, 0, 1);\n\n          if (!straight || locations.length === before) {\n            for (var i = 0; i < 4; i++) {\n              var t1 = i >> 1,\n                  t2 = i & 1,\n                  i1 = t1 * 6,\n                  i2 = t2 * 6,\n                  p1 = new Point(v1[i1], v1[i1 + 1]),\n                  p2 = new Point(v2[i2], v2[i2 + 1]);\n\n              if (p1.isClose(p2, epsilon)) {\n                addLocation(locations, include, c1, t1, c2, t2);\n              }\n            }\n          }\n        }\n      }\n\n      return locations;\n    }\n\n    function getLoopIntersection(v1, c1, locations, include) {\n      var info = Curve.classify(v1);\n\n      if (info.type === 'loop') {\n        var roots = info.roots;\n        addLocation(locations, include, c1, roots[0], c1, roots[1]);\n      }\n\n      return locations;\n    }\n\n    function getIntersections(curves1, curves2, include, matrix1, matrix2, _returnFirst) {\n      var self = !curves2;\n      if (self) curves2 = curves1;\n      var length1 = curves1.length,\n          length2 = curves2.length,\n          values2 = [],\n          arrays = [],\n          locations,\n          current;\n\n      for (var i = 0; i < length2; i++) {\n        values2[i] = curves2[i].getValues(matrix2);\n      }\n\n      for (var i = 0; i < length1; i++) {\n        var curve1 = curves1[i],\n            values1 = self ? values2[i] : curve1.getValues(matrix1),\n            path1 = curve1.getPath();\n\n        if (path1 !== current) {\n          current = path1;\n          locations = [];\n          arrays.push(locations);\n        }\n\n        if (self) {\n          getLoopIntersection(values1, curve1, locations, include);\n        }\n\n        for (var j = self ? i + 1 : 0; j < length2; j++) {\n          if (_returnFirst && locations.length) return locations;\n          getCurveIntersections(values1, values2[j], curve1, curves2[j], locations, include);\n        }\n      }\n\n      locations = [];\n\n      for (var i = 0, l = arrays.length; i < l; i++) {\n        Base.push(locations, arrays[i]);\n      }\n\n      return locations;\n    }\n\n    function getOverlaps(v1, v2) {\n      function getSquaredLineLength(v) {\n        var x = v[6] - v[0],\n            y = v[7] - v[1];\n        return x * x + y * y;\n      }\n\n      var abs = Math.abs,\n          getDistance = Line.getDistance,\n          timeEpsilon = 1e-8,\n          geomEpsilon = 1e-7,\n          straight1 = Curve.isStraight(v1),\n          straight2 = Curve.isStraight(v2),\n          straightBoth = straight1 && straight2,\n          flip = getSquaredLineLength(v1) < getSquaredLineLength(v2),\n          l1 = flip ? v2 : v1,\n          l2 = flip ? v1 : v2,\n          px = l1[0],\n          py = l1[1],\n          vx = l1[6] - px,\n          vy = l1[7] - py;\n\n      if (getDistance(px, py, vx, vy, l2[0], l2[1], true) < geomEpsilon && getDistance(px, py, vx, vy, l2[6], l2[7], true) < geomEpsilon) {\n        if (!straightBoth && getDistance(px, py, vx, vy, l1[2], l1[3], true) < geomEpsilon && getDistance(px, py, vx, vy, l1[4], l1[5], true) < geomEpsilon && getDistance(px, py, vx, vy, l2[2], l2[3], true) < geomEpsilon && getDistance(px, py, vx, vy, l2[4], l2[5], true) < geomEpsilon) {\n          straight1 = straight2 = straightBoth = true;\n        }\n      } else if (straightBoth) {\n        return null;\n      }\n\n      if (straight1 ^ straight2) {\n        return null;\n      }\n\n      var v = [v1, v2],\n          pairs = [];\n\n      for (var i = 0; i < 4 && pairs.length < 2; i++) {\n        var i1 = i & 1,\n            i2 = i1 ^ 1,\n            t1 = i >> 1,\n            t2 = Curve.getTimeOf(v[i1], new Point(v[i2][t1 ? 6 : 0], v[i2][t1 ? 7 : 1]));\n\n        if (t2 != null) {\n          var pair = i1 ? [t1, t2] : [t2, t1];\n\n          if (!pairs.length || abs(pair[0] - pairs[0][0]) > timeEpsilon && abs(pair[1] - pairs[0][1]) > timeEpsilon) {\n            pairs.push(pair);\n          }\n        }\n\n        if (i > 2 && !pairs.length) break;\n      }\n\n      if (pairs.length !== 2) {\n        pairs = null;\n      } else if (!straightBoth) {\n        var o1 = Curve.getPart(v1, pairs[0][0], pairs[1][0]),\n            o2 = Curve.getPart(v2, pairs[0][1], pairs[1][1]);\n        if (abs(o2[2] - o1[2]) > geomEpsilon || abs(o2[3] - o1[3]) > geomEpsilon || abs(o2[4] - o1[4]) > geomEpsilon || abs(o2[5] - o1[5]) > geomEpsilon) pairs = null;\n      }\n\n      return pairs;\n    }\n\n    function getTimesWithTangent(v, tangent) {\n      var x0 = v[0],\n          y0 = v[1],\n          x1 = v[2],\n          y1 = v[3],\n          x2 = v[4],\n          y2 = v[5],\n          x3 = v[6],\n          y3 = v[7],\n          normalized = tangent.normalize(),\n          tx = normalized.x,\n          ty = normalized.y,\n          ax = 3 * x3 - 9 * x2 + 9 * x1 - 3 * x0,\n          ay = 3 * y3 - 9 * y2 + 9 * y1 - 3 * y0,\n          bx = 6 * x2 - 12 * x1 + 6 * x0,\n          by = 6 * y2 - 12 * y1 + 6 * y0,\n          cx = 3 * x1 - 3 * x0,\n          cy = 3 * y1 - 3 * y0,\n          den = 2 * ax * ty - 2 * ay * tx,\n          times = [];\n\n      if (Math.abs(den) < Numerical.CURVETIME_EPSILON) {\n        var num = ax * cy - ay * cx,\n            den = ax * by - ay * bx;\n\n        if (den != 0) {\n          var t = -num / den;\n          if (t >= 0 && t <= 1) times.push(t);\n        }\n      } else {\n        var delta = (bx * bx - 4 * ax * cx) * ty * ty + (-2 * bx * by + 4 * ay * cx + 4 * ax * cy) * tx * ty + (by * by - 4 * ay * cy) * tx * tx,\n            k = bx * ty - by * tx;\n\n        if (delta >= 0 && den != 0) {\n          var d = Math.sqrt(delta),\n              t0 = -(k + d) / den,\n              t1 = (-k + d) / den;\n          if (t0 >= 0 && t0 <= 1) times.push(t0);\n          if (t1 >= 0 && t1 <= 1) times.push(t1);\n        }\n      }\n\n      return times;\n    }\n\n    return {\n      getIntersections: function getIntersections(curve) {\n        var v1 = this.getValues(),\n            v2 = curve && curve !== this && curve.getValues();\n        return v2 ? getCurveIntersections(v1, v2, this, curve, []) : getLoopIntersection(v1, this, []);\n      },\n      statics: {\n        getOverlaps: getOverlaps,\n        getIntersections: getIntersections,\n        getCurveLineIntersections: getCurveLineIntersections,\n        getTimesWithTangent: getTimesWithTangent\n      }\n    };\n  }());\n  var CurveLocation = Base.extend({\n    _class: 'CurveLocation',\n    initialize: function CurveLocation(curve, time, point, _overlap, _distance) {\n      if (time >= 0.99999999) {\n        var next = curve.getNext();\n\n        if (next) {\n          time = 0;\n          curve = next;\n        }\n      }\n\n      this._setCurve(curve);\n\n      this._time = time;\n      this._point = point || curve.getPointAtTime(time);\n      this._overlap = _overlap;\n      this._distance = _distance;\n      this._intersection = this._next = this._previous = null;\n    },\n    _setCurve: function _setCurve(curve) {\n      var path = curve._path;\n      this._path = path;\n      this._version = path ? path._version : 0;\n      this._curve = curve;\n      this._segment = null;\n      this._segment1 = curve._segment1;\n      this._segment2 = curve._segment2;\n    },\n    _setSegment: function _setSegment(segment) {\n      this._setCurve(segment.getCurve());\n\n      this._segment = segment;\n      this._time = segment === this._segment1 ? 0 : 1;\n      this._point = segment._point.clone();\n    },\n    getSegment: function getSegment() {\n      var segment = this._segment;\n\n      if (!segment) {\n        var curve = this.getCurve(),\n            time = this.getTime();\n\n        if (time === 0) {\n          segment = curve._segment1;\n        } else if (time === 1) {\n          segment = curve._segment2;\n        } else if (time != null) {\n          segment = curve.getPartLength(0, time) < curve.getPartLength(time, 1) ? curve._segment1 : curve._segment2;\n        }\n\n        this._segment = segment;\n      }\n\n      return segment;\n    },\n    getCurve: function getCurve() {\n      var path = this._path,\n          that = this;\n\n      if (path && path._version !== this._version) {\n        this._time = this._offset = this._curveOffset = this._curve = null;\n      }\n\n      function trySegment(segment) {\n        var curve = segment && segment.getCurve();\n\n        if (curve && (that._time = curve.getTimeOf(that._point)) != null) {\n          that._setCurve(curve);\n\n          return curve;\n        }\n      }\n\n      return this._curve || trySegment(this._segment) || trySegment(this._segment1) || trySegment(this._segment2.getPrevious());\n    },\n    getPath: function getPath() {\n      var curve = this.getCurve();\n      return curve && curve._path;\n    },\n    getIndex: function getIndex() {\n      var curve = this.getCurve();\n      return curve && curve.getIndex();\n    },\n    getTime: function getTime() {\n      var curve = this.getCurve(),\n          time = this._time;\n      return curve && time == null ? this._time = curve.getTimeOf(this._point) : time;\n    },\n    getParameter: '#getTime',\n    getPoint: function getPoint() {\n      return this._point;\n    },\n    getOffset: function getOffset() {\n      var offset = this._offset;\n\n      if (offset == null) {\n        offset = 0;\n        var path = this.getPath(),\n            index = this.getIndex();\n\n        if (path && index != null) {\n          var curves = path.getCurves();\n\n          for (var i = 0; i < index; i++) {\n            offset += curves[i].getLength();\n          }\n        }\n\n        this._offset = offset += this.getCurveOffset();\n      }\n\n      return offset;\n    },\n    getCurveOffset: function getCurveOffset() {\n      var offset = this._curveOffset;\n\n      if (offset == null) {\n        var curve = this.getCurve(),\n            time = this.getTime();\n        this._curveOffset = offset = time != null && curve && curve.getPartLength(0, time);\n      }\n\n      return offset;\n    },\n    getIntersection: function getIntersection() {\n      return this._intersection;\n    },\n    getDistance: function getDistance() {\n      return this._distance;\n    },\n    divide: function divide() {\n      var curve = this.getCurve(),\n          res = curve && curve.divideAtTime(this.getTime());\n\n      if (res) {\n        this._setSegment(res._segment1);\n      }\n\n      return res;\n    },\n    split: function split() {\n      var curve = this.getCurve(),\n          path = curve._path,\n          res = curve && curve.splitAtTime(this.getTime());\n\n      if (res) {\n        this._setSegment(path.getLastSegment());\n      }\n\n      return res;\n    },\n    equals: function equals(loc, _ignoreOther) {\n      var res = this === loc;\n\n      if (!res && loc instanceof CurveLocation) {\n        var c1 = this.getCurve(),\n            c2 = loc.getCurve(),\n            p1 = c1._path,\n            p2 = c2._path;\n\n        if (p1 === p2) {\n          var abs = Math.abs,\n              epsilon = 1e-7,\n              diff = abs(this.getOffset() - loc.getOffset()),\n              i1 = !_ignoreOther && this._intersection,\n              i2 = !_ignoreOther && loc._intersection;\n          res = (diff < epsilon || p1 && abs(p1.getLength() - diff) < epsilon) && (!i1 && !i2 || i1 && i2 && i1.equals(i2, true));\n        }\n      }\n\n      return res;\n    },\n    toString: function toString() {\n      var parts = [],\n          point = this.getPoint(),\n          f = Formatter.instance;\n      if (point) parts.push('point: ' + point);\n      var index = this.getIndex();\n      if (index != null) parts.push('index: ' + index);\n      var time = this.getTime();\n      if (time != null) parts.push('time: ' + f.number(time));\n      if (this._distance != null) parts.push('distance: ' + f.number(this._distance));\n      return '{ ' + parts.join(', ') + ' }';\n    },\n    isTouching: function isTouching() {\n      var inter = this._intersection;\n\n      if (inter && this.getTangent().isCollinear(inter.getTangent())) {\n        var curve1 = this.getCurve(),\n            curve2 = inter.getCurve();\n        return !(curve1.isStraight() && curve2.isStraight() && curve1.getLine().intersect(curve2.getLine()));\n      }\n\n      return false;\n    },\n    isCrossing: function isCrossing() {\n      var inter = this._intersection;\n      if (!inter) return false;\n      var t1 = this.getTime(),\n          t2 = inter.getTime(),\n          tMin = 1e-8,\n          tMax = 1 - tMin,\n          t1Inside = t1 >= tMin && t1 <= tMax,\n          t2Inside = t2 >= tMin && t2 <= tMax;\n      if (t1Inside && t2Inside) return !this.isTouching();\n      var c2 = this.getCurve(),\n          c1 = t1 < tMin ? c2.getPrevious() : c2,\n          c4 = inter.getCurve(),\n          c3 = t2 < tMin ? c4.getPrevious() : c4;\n      if (t1 > tMax) c2 = c2.getNext();\n      if (t2 > tMax) c4 = c4.getNext();\n      if (!c1 || !c2 || !c3 || !c4) return false;\n      var offsets = [];\n\n      function addOffsets(curve, end) {\n        var v = curve.getValues(),\n            roots = Curve.classify(v).roots || Curve.getPeaks(v),\n            count = roots.length,\n            t = end && count > 1 ? roots[count - 1] : count > 0 ? roots[0] : 0.5;\n        offsets.push(Curve.getLength(v, end ? t : 0, end ? 1 : t) / 2);\n      }\n\n      function isInRange(angle, min, max) {\n        return min < max ? angle > min && angle < max : angle > min || angle < max;\n      }\n\n      if (!t1Inside) {\n        addOffsets(c1, true);\n        addOffsets(c2, false);\n      }\n\n      if (!t2Inside) {\n        addOffsets(c3, true);\n        addOffsets(c4, false);\n      }\n\n      var pt = this.getPoint(),\n          offset = Math.min.apply(Math, offsets),\n          v2 = t1Inside ? c2.getTangentAtTime(t1) : c2.getPointAt(offset).subtract(pt),\n          v1 = t1Inside ? v2.negate() : c1.getPointAt(-offset).subtract(pt),\n          v4 = t2Inside ? c4.getTangentAtTime(t2) : c4.getPointAt(offset).subtract(pt),\n          v3 = t2Inside ? v4.negate() : c3.getPointAt(-offset).subtract(pt),\n          a1 = v1.getAngle(),\n          a2 = v2.getAngle(),\n          a3 = v3.getAngle(),\n          a4 = v4.getAngle();\n      return !!(t1Inside ? isInRange(a1, a3, a4) ^ isInRange(a2, a3, a4) && isInRange(a1, a4, a3) ^ isInRange(a2, a4, a3) : isInRange(a3, a1, a2) ^ isInRange(a4, a1, a2) && isInRange(a3, a2, a1) ^ isInRange(a4, a2, a1));\n    },\n    hasOverlap: function hasOverlap() {\n      return !!this._overlap;\n    }\n  }, Base.each(Curve._evaluateMethods, function (name) {\n    var get = name + 'At';\n\n    this[name] = function () {\n      var curve = this.getCurve(),\n          time = this.getTime();\n      return time != null && curve && curve[get](time, true);\n    };\n  }, {\n    preserve: true\n  }), new function () {\n    function insert(locations, loc, merge) {\n      var length = locations.length,\n          l = 0,\n          r = length - 1;\n\n      function search(index, dir) {\n        for (var i = index + dir; i >= -1 && i <= length; i += dir) {\n          var loc2 = locations[(i % length + length) % length];\n          if (!loc.getPoint().isClose(loc2.getPoint(), 1e-7)) break;\n          if (loc.equals(loc2)) return loc2;\n        }\n\n        return null;\n      }\n\n      while (l <= r) {\n        var m = l + r >>> 1,\n            loc2 = locations[m],\n            found;\n\n        if (merge && (found = loc.equals(loc2) ? loc2 : search(m, -1) || search(m, 1))) {\n          if (loc._overlap) {\n            found._overlap = found._intersection._overlap = true;\n          }\n\n          return found;\n        }\n\n        var path1 = loc.getPath(),\n            path2 = loc2.getPath(),\n            diff = path1 !== path2 ? path1._id - path2._id : loc.getIndex() + loc.getTime() - (loc2.getIndex() + loc2.getTime());\n\n        if (diff < 0) {\n          r = m - 1;\n        } else {\n          l = m + 1;\n        }\n      }\n\n      locations.splice(l, 0, loc);\n      return loc;\n    }\n\n    return {\n      statics: {\n        insert: insert,\n        expand: function expand(locations) {\n          var expanded = locations.slice();\n\n          for (var i = locations.length - 1; i >= 0; i--) {\n            insert(expanded, locations[i]._intersection, false);\n          }\n\n          return expanded;\n        }\n      }\n    };\n  }());\n  var PathItem = Item.extend({\n    _class: 'PathItem',\n    _selectBounds: false,\n    _canScaleStroke: true,\n    beans: true,\n    initialize: function PathItem() {},\n    statics: {\n      create: function create(arg) {\n        var data, segments, compound;\n\n        if (Base.isPlainObject(arg)) {\n          segments = arg.segments;\n          data = arg.pathData;\n        } else if (_Array$isArray(arg)) {\n          segments = arg;\n        } else if (typeof arg === 'string') {\n          data = arg;\n        }\n\n        if (segments) {\n          var first = segments[0];\n          compound = first && _Array$isArray(first[0]);\n        } else if (data) {\n          compound = (data.match(/m/gi) || []).length > 1 || /z\\s*\\S+/i.test(data);\n        }\n\n        var ctor = compound ? CompoundPath : Path;\n        return new ctor(arg);\n      }\n    },\n    _asPathItem: function _asPathItem() {\n      return this;\n    },\n    isClockwise: function isClockwise() {\n      return this.getArea() >= 0;\n    },\n    setClockwise: function setClockwise(clockwise) {\n      if (this.isClockwise() != (clockwise = !!clockwise)) this.reverse();\n    },\n    setPathData: function setPathData(data) {\n      var parts = data && data.match(/[mlhvcsqtaz][^mlhvcsqtaz]*/ig),\n          coords,\n          relative = false,\n          previous,\n          control,\n          current = new Point(),\n          start = new Point();\n\n      function getCoord(index, coord) {\n        var val = +coords[index];\n        if (relative) val += current[coord];\n        return val;\n      }\n\n      function getPoint(index) {\n        return new Point(getCoord(index, 'x'), getCoord(index + 1, 'y'));\n      }\n\n      this.clear();\n\n      for (var i = 0, l = parts && parts.length; i < l; i++) {\n        var part = parts[i],\n            command = part[0],\n            lower = command.toLowerCase();\n        coords = part.match(/[+-]?(?:\\d*\\.\\d+|\\d+\\.?)(?:[eE][+-]?\\d+)?/g);\n        var length = coords && coords.length;\n        relative = command === lower;\n        if (previous === 'z' && !/[mz]/.test(lower)) this.moveTo(current);\n\n        switch (lower) {\n          case 'm':\n          case 'l':\n            var move = lower === 'm';\n\n            for (var j = 0; j < length; j += 2) {\n              this[move ? 'moveTo' : 'lineTo'](current = getPoint(j));\n\n              if (move) {\n                start = current;\n                move = false;\n              }\n            }\n\n            control = current;\n            break;\n\n          case 'h':\n          case 'v':\n            var coord = lower === 'h' ? 'x' : 'y';\n            current = current.clone();\n\n            for (var j = 0; j < length; j++) {\n              current[coord] = getCoord(j, coord);\n              this.lineTo(current);\n            }\n\n            control = current;\n            break;\n\n          case 'c':\n            for (var j = 0; j < length; j += 6) {\n              this.cubicCurveTo(getPoint(j), control = getPoint(j + 2), current = getPoint(j + 4));\n            }\n\n            break;\n\n          case 's':\n            for (var j = 0; j < length; j += 4) {\n              this.cubicCurveTo(/[cs]/.test(previous) ? current.multiply(2).subtract(control) : current, control = getPoint(j), current = getPoint(j + 2));\n              previous = lower;\n            }\n\n            break;\n\n          case 'q':\n            for (var j = 0; j < length; j += 4) {\n              this.quadraticCurveTo(control = getPoint(j), current = getPoint(j + 2));\n            }\n\n            break;\n\n          case 't':\n            for (var j = 0; j < length; j += 2) {\n              this.quadraticCurveTo(control = /[qt]/.test(previous) ? current.multiply(2).subtract(control) : current, current = getPoint(j));\n              previous = lower;\n            }\n\n            break;\n\n          case 'a':\n            for (var j = 0; j < length; j += 7) {\n              this.arcTo(current = getPoint(j + 5), new Size(+coords[j], +coords[j + 1]), +coords[j + 2], +coords[j + 4], +coords[j + 3]);\n            }\n\n            break;\n\n          case 'z':\n            this.closePath(1e-12);\n            current = start;\n            break;\n        }\n\n        previous = lower;\n      }\n    },\n    _canComposite: function _canComposite() {\n      return !(this.hasFill() && this.hasStroke());\n    },\n    _contains: function _contains(point) {\n      var winding = point.isInside(this.getBounds({\n        internal: true,\n        handle: true\n      })) ? this._getWinding(point) : {};\n      return winding.onPath || !!(this.getFillRule() === 'evenodd' ? winding.windingL & 1 || winding.windingR & 1 : winding.winding);\n    },\n    getIntersections: function getIntersections(path, include, _matrix, _returnFirst) {\n      var self = this === path || !path,\n          matrix1 = this._matrix._orNullIfIdentity(),\n          matrix2 = self ? matrix1 : (_matrix || path._matrix)._orNullIfIdentity();\n\n      return self || this.getBounds(matrix1).intersects(path.getBounds(matrix2), 1e-12) ? Curve.getIntersections(this.getCurves(), !self && path.getCurves(), include, matrix1, matrix2, _returnFirst) : [];\n    },\n    getCrossings: function getCrossings(path) {\n      return this.getIntersections(path, function (inter) {\n        return inter.hasOverlap() || inter.isCrossing();\n      });\n    },\n    getNearestLocation: function getNearestLocation() {\n      var point = Point.read(arguments),\n          curves = this.getCurves(),\n          minDist = Infinity,\n          minLoc = null;\n\n      for (var i = 0, l = curves.length; i < l; i++) {\n        var loc = curves[i].getNearestLocation(point);\n\n        if (loc._distance < minDist) {\n          minDist = loc._distance;\n          minLoc = loc;\n        }\n      }\n\n      return minLoc;\n    },\n    getNearestPoint: function getNearestPoint() {\n      var loc = this.getNearestLocation.apply(this, arguments);\n      return loc ? loc.getPoint() : loc;\n    },\n    interpolate: function interpolate(from, to, factor) {\n      var isPath = !this._children,\n          name = isPath ? '_segments' : '_children',\n          itemsFrom = from[name],\n          itemsTo = to[name],\n          items = this[name];\n\n      if (!itemsFrom || !itemsTo || itemsFrom.length !== itemsTo.length) {\n        throw new Error('Invalid operands in interpolate() call: ' + from + ', ' + to);\n      }\n\n      var current = items.length,\n          length = itemsTo.length;\n\n      if (current < length) {\n        var ctor = isPath ? Segment : Path;\n\n        for (var i = current; i < length; i++) {\n          this.add(new ctor());\n        }\n      } else if (current > length) {\n        this[isPath ? 'removeSegments' : 'removeChildren'](length, current);\n      }\n\n      for (var i = 0; i < length; i++) {\n        items[i].interpolate(itemsFrom[i], itemsTo[i], factor);\n      }\n\n      if (isPath) {\n        this.setClosed(from._closed);\n\n        this._changed(9);\n      }\n    },\n    compare: function compare(path) {\n      var ok = false;\n\n      if (path) {\n        var paths1 = this._children || [this],\n            paths2 = path._children ? path._children.slice() : [path],\n            length1 = paths1.length,\n            length2 = paths2.length,\n            matched = [],\n            count = 0;\n        ok = true;\n\n        for (var i1 = length1 - 1; i1 >= 0 && ok; i1--) {\n          var path1 = paths1[i1];\n          ok = false;\n\n          for (var i2 = length2 - 1; i2 >= 0 && !ok; i2--) {\n            if (path1.compare(paths2[i2])) {\n              if (!matched[i2]) {\n                matched[i2] = true;\n                count++;\n              }\n\n              ok = true;\n            }\n          }\n        }\n\n        ok = ok && count === length2;\n      }\n\n      return ok;\n    }\n  });\n  var Path = PathItem.extend({\n    _class: 'Path',\n    _serializeFields: {\n      segments: [],\n      closed: false\n    },\n    initialize: function Path(arg) {\n      this._closed = false;\n      this._segments = [];\n      this._version = 0;\n      var segments = _Array$isArray(arg) ? _typeof(arg[0]) === 'object' ? arg : arguments : arg && arg.size === undefined && (arg.x !== undefined || arg.point !== undefined) ? arguments : null;\n\n      if (segments && segments.length > 0) {\n        this.setSegments(segments);\n      } else {\n        this._curves = undefined;\n        this._segmentSelection = 0;\n\n        if (!segments && typeof arg === 'string') {\n          this.setPathData(arg);\n          arg = null;\n        }\n      }\n\n      this._initialize(!segments && arg);\n    },\n    _equals: function _equals(item) {\n      return this._closed === item._closed && Base.equals(this._segments, item._segments);\n    },\n    copyContent: function copyContent(source) {\n      this.setSegments(source._segments);\n      this._closed = source._closed;\n    },\n    _changed: function _changed(flags) {\n      _changed.base.call(this, flags);\n\n      if (flags & 8) {\n        this._length = this._area = undefined;\n\n        if (flags & 32) {\n          this._version++;\n        } else if (this._curves) {\n          for (var i = 0, l = this._curves.length; i < l; i++) {\n            this._curves[i]._changed();\n          }\n        }\n      } else if (flags & 64) {\n        this._bounds = undefined;\n      }\n    },\n    getStyle: function getStyle() {\n      var parent = this._parent;\n      return (parent instanceof CompoundPath ? parent : this)._style;\n    },\n    getSegments: function getSegments() {\n      return this._segments;\n    },\n    setSegments: function setSegments(segments) {\n      var fullySelected = this.isFullySelected(),\n          length = segments && segments.length;\n      this._segments.length = 0;\n      this._segmentSelection = 0;\n      this._curves = undefined;\n\n      if (length) {\n        var last = segments[length - 1];\n\n        if (typeof last === 'boolean') {\n          this.setClosed(last);\n          length--;\n        }\n\n        this._add(Segment.readList(segments, 0, {}, length));\n      }\n\n      if (fullySelected) this.setFullySelected(true);\n    },\n    getFirstSegment: function getFirstSegment() {\n      return this._segments[0];\n    },\n    getLastSegment: function getLastSegment() {\n      return this._segments[this._segments.length - 1];\n    },\n    getCurves: function getCurves() {\n      var curves = this._curves,\n          segments = this._segments;\n\n      if (!curves) {\n        var length = this._countCurves();\n\n        curves = this._curves = new Array(length);\n\n        for (var i = 0; i < length; i++) {\n          curves[i] = new Curve(this, segments[i], segments[i + 1] || segments[0]);\n        }\n      }\n\n      return curves;\n    },\n    getFirstCurve: function getFirstCurve() {\n      return this.getCurves()[0];\n    },\n    getLastCurve: function getLastCurve() {\n      var curves = this.getCurves();\n      return curves[curves.length - 1];\n    },\n    isClosed: function isClosed() {\n      return this._closed;\n    },\n    setClosed: function setClosed(closed) {\n      if (this._closed != (closed = !!closed)) {\n        this._closed = closed;\n\n        if (this._curves) {\n          var length = this._curves.length = this._countCurves();\n\n          if (closed) this._curves[length - 1] = new Curve(this, this._segments[length - 1], this._segments[0]);\n        }\n\n        this._changed(41);\n      }\n    }\n  }, {\n    beans: true,\n    getPathData: function getPathData(_matrix, _precision) {\n      var segments = this._segments,\n          length = segments.length,\n          f = new Formatter(_precision),\n          coords = new Array(6),\n          first = true,\n          curX,\n          curY,\n          prevX,\n          prevY,\n          inX,\n          inY,\n          outX,\n          outY,\n          parts = [];\n\n      function addSegment(segment, skipLine) {\n        segment._transformCoordinates(_matrix, coords);\n\n        curX = coords[0];\n        curY = coords[1];\n\n        if (first) {\n          parts.push('M' + f.pair(curX, curY));\n          first = false;\n        } else {\n          inX = coords[2];\n          inY = coords[3];\n\n          if (inX === curX && inY === curY && outX === prevX && outY === prevY) {\n            if (!skipLine) {\n              var dx = curX - prevX,\n                  dy = curY - prevY;\n              parts.push(dx === 0 ? 'v' + f.number(dy) : dy === 0 ? 'h' + f.number(dx) : 'l' + f.pair(dx, dy));\n            }\n          } else {\n            parts.push('c' + f.pair(outX - prevX, outY - prevY) + ' ' + f.pair(inX - prevX, inY - prevY) + ' ' + f.pair(curX - prevX, curY - prevY));\n          }\n        }\n\n        prevX = curX;\n        prevY = curY;\n        outX = coords[4];\n        outY = coords[5];\n      }\n\n      if (!length) return '';\n\n      for (var i = 0; i < length; i++) {\n        addSegment(segments[i]);\n      }\n\n      if (this._closed && length > 0) {\n        addSegment(segments[0], true);\n        parts.push('z');\n      }\n\n      return parts.join('');\n    },\n    isEmpty: function isEmpty() {\n      return !this._segments.length;\n    },\n    _transformContent: function _transformContent(matrix) {\n      var segments = this._segments,\n          coords = new Array(6);\n\n      for (var i = 0, l = segments.length; i < l; i++) {\n        segments[i]._transformCoordinates(matrix, coords, true);\n      }\n\n      return true;\n    },\n    _add: function _add(segs, index) {\n      var segments = this._segments,\n          curves = this._curves,\n          amount = segs.length,\n          append = index == null,\n          index = append ? segments.length : index;\n\n      for (var i = 0; i < amount; i++) {\n        var segment = segs[i];\n        if (segment._path) segment = segs[i] = segment.clone();\n        segment._path = this;\n        segment._index = index + i;\n        if (segment._selection) this._updateSelection(segment, 0, segment._selection);\n      }\n\n      if (append) {\n        Base.push(segments, segs);\n      } else {\n        segments.splice.apply(segments, [index, 0].concat(segs));\n\n        for (var i = index + amount, l = segments.length; i < l; i++) {\n          segments[i]._index = i;\n        }\n      }\n\n      if (curves) {\n        var total = this._countCurves(),\n            start = index > 0 && index + amount - 1 === total ? index - 1 : index,\n            insert = start,\n            end = Math.min(start + amount, total);\n\n        if (segs._curves) {\n          curves.splice.apply(curves, [start, 0].concat(segs._curves));\n          insert += segs._curves.length;\n        }\n\n        for (var i = insert; i < end; i++) {\n          curves.splice(i, 0, new Curve(this, null, null));\n        }\n\n        this._adjustCurves(start, end);\n      }\n\n      this._changed(41);\n\n      return segs;\n    },\n    _adjustCurves: function _adjustCurves(start, end) {\n      var segments = this._segments,\n          curves = this._curves,\n          curve;\n\n      for (var i = start; i < end; i++) {\n        curve = curves[i];\n        curve._path = this;\n        curve._segment1 = segments[i];\n        curve._segment2 = segments[i + 1] || segments[0];\n\n        curve._changed();\n      }\n\n      if (curve = curves[this._closed && !start ? segments.length - 1 : start - 1]) {\n        curve._segment2 = segments[start] || segments[0];\n\n        curve._changed();\n      }\n\n      if (curve = curves[end]) {\n        curve._segment1 = segments[end];\n\n        curve._changed();\n      }\n    },\n    _countCurves: function _countCurves() {\n      var length = this._segments.length;\n      return !this._closed && length > 0 ? length - 1 : length;\n    },\n    add: function add(segment1) {\n      return arguments.length > 1 && typeof segment1 !== 'number' ? this._add(Segment.readList(arguments)) : this._add([Segment.read(arguments)])[0];\n    },\n    insert: function insert(index, segment1) {\n      return arguments.length > 2 && typeof segment1 !== 'number' ? this._add(Segment.readList(arguments, 1), index) : this._add([Segment.read(arguments, 1)], index)[0];\n    },\n    addSegment: function addSegment() {\n      return this._add([Segment.read(arguments)])[0];\n    },\n    insertSegment: function insertSegment(index) {\n      return this._add([Segment.read(arguments, 1)], index)[0];\n    },\n    addSegments: function addSegments(segments) {\n      return this._add(Segment.readList(segments));\n    },\n    insertSegments: function insertSegments(index, segments) {\n      return this._add(Segment.readList(segments), index);\n    },\n    removeSegment: function removeSegment(index) {\n      return this.removeSegments(index, index + 1)[0] || null;\n    },\n    removeSegments: function removeSegments(start, end, _includeCurves) {\n      start = start || 0;\n      end = Base.pick(end, this._segments.length);\n      var segments = this._segments,\n          curves = this._curves,\n          count = segments.length,\n          removed = segments.splice(start, end - start),\n          amount = removed.length;\n      if (!amount) return removed;\n\n      for (var i = 0; i < amount; i++) {\n        var segment = removed[i];\n        if (segment._selection) this._updateSelection(segment, segment._selection, 0);\n        segment._index = segment._path = null;\n      }\n\n      for (var i = start, l = segments.length; i < l; i++) {\n        segments[i]._index = i;\n      }\n\n      if (curves) {\n        var index = start > 0 && end === count + (this._closed ? 1 : 0) ? start - 1 : start,\n            curves = curves.splice(index, amount);\n\n        for (var i = curves.length - 1; i >= 0; i--) {\n          curves[i]._path = null;\n        }\n\n        if (_includeCurves) removed._curves = curves.slice(1);\n\n        this._adjustCurves(index, index);\n      }\n\n      this._changed(41);\n\n      return removed;\n    },\n    clear: '#removeSegments',\n    hasHandles: function hasHandles() {\n      var segments = this._segments;\n\n      for (var i = 0, l = segments.length; i < l; i++) {\n        if (segments[i].hasHandles()) return true;\n      }\n\n      return false;\n    },\n    clearHandles: function clearHandles() {\n      var segments = this._segments;\n\n      for (var i = 0, l = segments.length; i < l; i++) {\n        segments[i].clearHandles();\n      }\n    },\n    getLength: function getLength() {\n      if (this._length == null) {\n        var curves = this.getCurves(),\n            length = 0;\n\n        for (var i = 0, l = curves.length; i < l; i++) {\n          length += curves[i].getLength();\n        }\n\n        this._length = length;\n      }\n\n      return this._length;\n    },\n    getArea: function getArea() {\n      var area = this._area;\n\n      if (area == null) {\n        var segments = this._segments,\n            closed = this._closed;\n        area = 0;\n\n        for (var i = 0, l = segments.length; i < l; i++) {\n          var last = i + 1 === l;\n          area += Curve.getArea(Curve.getValues(segments[i], segments[last ? 0 : i + 1], null, last && !closed));\n        }\n\n        this._area = area;\n      }\n\n      return area;\n    },\n    isFullySelected: function isFullySelected() {\n      var length = this._segments.length;\n      return this.isSelected() && length > 0 && this._segmentSelection === length * 7;\n    },\n    setFullySelected: function setFullySelected(selected) {\n      if (selected) this._selectSegments(true);\n      this.setSelected(selected);\n    },\n    setSelection: function setSelection(selection) {\n      if (!(selection & 1)) this._selectSegments(false);\n      setSelection.base.call(this, selection);\n    },\n    _selectSegments: function _selectSegments(selected) {\n      var segments = this._segments,\n          length = segments.length,\n          selection = selected ? 7 : 0;\n      this._segmentSelection = selection * length;\n\n      for (var i = 0; i < length; i++) {\n        segments[i]._selection = selection;\n      }\n    },\n    _updateSelection: function _updateSelection(segment, oldSelection, newSelection) {\n      segment._selection = newSelection;\n      var selection = this._segmentSelection += newSelection - oldSelection;\n      if (selection > 0) this.setSelected(true);\n    },\n    divideAt: function divideAt(location) {\n      var loc = this.getLocationAt(location),\n          curve;\n      return loc && (curve = loc.getCurve().divideAt(loc.getCurveOffset())) ? curve._segment1 : null;\n    },\n    splitAt: function splitAt(location) {\n      var loc = this.getLocationAt(location),\n          index = loc && loc.index,\n          time = loc && loc.time,\n          tMin = 1e-8,\n          tMax = 1 - tMin;\n\n      if (time > tMax) {\n        index++;\n        time = 0;\n      }\n\n      var curves = this.getCurves();\n\n      if (index >= 0 && index < curves.length) {\n        if (time >= tMin) {\n          curves[index++].divideAtTime(time);\n        }\n\n        var segs = this.removeSegments(index, this._segments.length, true),\n            path;\n\n        if (this._closed) {\n          this.setClosed(false);\n          path = this;\n        } else {\n          path = new Path(Item.NO_INSERT);\n          path.insertAbove(this);\n          path.copyAttributes(this);\n        }\n\n        path._add(segs, 0);\n\n        this.addSegment(segs[0]);\n        return path;\n      }\n\n      return null;\n    },\n    split: function split(index, time) {\n      var curve,\n          location = time === undefined ? index : (curve = this.getCurves()[index]) && curve.getLocationAtTime(time);\n      return location != null ? this.splitAt(location) : null;\n    },\n    join: function join(path, tolerance) {\n      var epsilon = tolerance || 0;\n\n      if (path && path !== this) {\n        var segments = path._segments,\n            last1 = this.getLastSegment(),\n            last2 = path.getLastSegment();\n        if (!last2) return this;\n        if (last1 && last1._point.isClose(last2._point, epsilon)) path.reverse();\n        var first2 = path.getFirstSegment();\n\n        if (last1 && last1._point.isClose(first2._point, epsilon)) {\n          last1.setHandleOut(first2._handleOut);\n\n          this._add(segments.slice(1));\n        } else {\n          var first1 = this.getFirstSegment();\n          if (first1 && first1._point.isClose(first2._point, epsilon)) path.reverse();\n          last2 = path.getLastSegment();\n\n          if (first1 && first1._point.isClose(last2._point, epsilon)) {\n            first1.setHandleIn(last2._handleIn);\n\n            this._add(segments.slice(0, segments.length - 1), 0);\n          } else {\n            this._add(segments.slice());\n          }\n        }\n\n        if (path._closed) this._add([segments[0]]);\n        path.remove();\n      }\n\n      var first = this.getFirstSegment(),\n          last = this.getLastSegment();\n\n      if (first !== last && first._point.isClose(last._point, epsilon)) {\n        first.setHandleIn(last._handleIn);\n        last.remove();\n        this.setClosed(true);\n      }\n\n      return this;\n    },\n    reduce: function reduce(options) {\n      var curves = this.getCurves(),\n          simplify = options && options.simplify,\n          tolerance = simplify ? 1e-7 : 0;\n\n      for (var i = curves.length - 1; i >= 0; i--) {\n        var curve = curves[i];\n        if (!curve.hasHandles() && (!curve.hasLength(tolerance) || simplify && curve.isCollinear(curve.getNext()))) curve.remove();\n      }\n\n      return this;\n    },\n    reverse: function reverse() {\n      this._segments.reverse();\n\n      for (var i = 0, l = this._segments.length; i < l; i++) {\n        var segment = this._segments[i];\n        var handleIn = segment._handleIn;\n        segment._handleIn = segment._handleOut;\n        segment._handleOut = handleIn;\n        segment._index = i;\n      }\n\n      this._curves = null;\n\n      this._changed(9);\n    },\n    flatten: function flatten(flatness) {\n      var flattener = new PathFlattener(this, flatness || 0.25, 256, true),\n          parts = flattener.parts,\n          length = parts.length,\n          segments = [];\n\n      for (var i = 0; i < length; i++) {\n        segments.push(new Segment(parts[i].curve.slice(0, 2)));\n      }\n\n      if (!this._closed && length > 0) {\n        segments.push(new Segment(parts[length - 1].curve.slice(6)));\n      }\n\n      this.setSegments(segments);\n    },\n    simplify: function simplify(tolerance) {\n      var segments = new PathFitter(this).fit(tolerance || 2.5);\n      if (segments) this.setSegments(segments);\n      return !!segments;\n    },\n    smooth: function smooth(options) {\n      var that = this,\n          opts = options || {},\n          type = opts.type || 'asymmetric',\n          segments = this._segments,\n          length = segments.length,\n          closed = this._closed;\n\n      function getIndex(value, _default) {\n        var index = value && value.index;\n\n        if (index != null) {\n          var path = value.path;\n          if (path && path !== that) throw new Error(value._class + ' ' + index + ' of ' + path + ' is not part of ' + that);\n          if (_default && value instanceof Curve) index++;\n        } else {\n          index = typeof value === 'number' ? value : _default;\n        }\n\n        return Math.min(index < 0 && closed ? index % length : index < 0 ? index + length : index, length - 1);\n      }\n\n      var loop = closed && opts.from === undefined && opts.to === undefined,\n          from = getIndex(opts.from, 0),\n          to = getIndex(opts.to, length - 1);\n\n      if (from > to) {\n        if (closed) {\n          from -= length;\n        } else {\n          var tmp = from;\n          from = to;\n          to = tmp;\n        }\n      }\n\n      if (/^(?:asymmetric|continuous)$/.test(type)) {\n        var asymmetric = type === 'asymmetric',\n            min = Math.min,\n            amount = to - from + 1,\n            n = amount - 1,\n            padding = loop ? min(amount, 4) : 1,\n            paddingLeft = padding,\n            paddingRight = padding,\n            knots = [];\n\n        if (!closed) {\n          paddingLeft = min(1, from);\n          paddingRight = min(1, length - to - 1);\n        }\n\n        n += paddingLeft + paddingRight;\n        if (n <= 1) return;\n\n        for (var i = 0, j = from - paddingLeft; i <= n; i++, j++) {\n          knots[i] = segments[(j < 0 ? j + length : j) % length]._point;\n        }\n\n        var x = knots[0]._x + 2 * knots[1]._x,\n            y = knots[0]._y + 2 * knots[1]._y,\n            f = 2,\n            n_1 = n - 1,\n            rx = [x],\n            ry = [y],\n            rf = [f],\n            px = [],\n            py = [];\n\n        for (var i = 1; i < n; i++) {\n          var internal = i < n_1,\n              a = internal ? 1 : asymmetric ? 1 : 2,\n              b = internal ? 4 : asymmetric ? 2 : 7,\n              u = internal ? 4 : asymmetric ? 3 : 8,\n              v = internal ? 2 : asymmetric ? 0 : 1,\n              m = a / f;\n          f = rf[i] = b - m;\n          x = rx[i] = u * knots[i]._x + v * knots[i + 1]._x - m * x;\n          y = ry[i] = u * knots[i]._y + v * knots[i + 1]._y - m * y;\n        }\n\n        px[n_1] = rx[n_1] / rf[n_1];\n        py[n_1] = ry[n_1] / rf[n_1];\n\n        for (var i = n - 2; i >= 0; i--) {\n          px[i] = (rx[i] - px[i + 1]) / rf[i];\n          py[i] = (ry[i] - py[i + 1]) / rf[i];\n        }\n\n        px[n] = (3 * knots[n]._x - px[n_1]) / 2;\n        py[n] = (3 * knots[n]._y - py[n_1]) / 2;\n\n        for (var i = paddingLeft, max = n - paddingRight, j = from; i <= max; i++, j++) {\n          var segment = segments[j < 0 ? j + length : j],\n              pt = segment._point,\n              hx = px[i] - pt._x,\n              hy = py[i] - pt._y;\n          if (loop || i < max) segment.setHandleOut(hx, hy);\n          if (loop || i > paddingLeft) segment.setHandleIn(-hx, -hy);\n        }\n      } else {\n        for (var i = from; i <= to; i++) {\n          segments[i < 0 ? i + length : i].smooth(opts, !loop && i === from, !loop && i === to);\n        }\n      }\n    },\n    toShape: function toShape(insert) {\n      if (!this._closed) return null;\n      var segments = this._segments,\n          type,\n          size,\n          radius,\n          topCenter;\n\n      function isCollinear(i, j) {\n        var seg1 = segments[i],\n            seg2 = seg1.getNext(),\n            seg3 = segments[j],\n            seg4 = seg3.getNext();\n        return seg1._handleOut.isZero() && seg2._handleIn.isZero() && seg3._handleOut.isZero() && seg4._handleIn.isZero() && seg2._point.subtract(seg1._point).isCollinear(seg4._point.subtract(seg3._point));\n      }\n\n      function isOrthogonal(i) {\n        var seg2 = segments[i],\n            seg1 = seg2.getPrevious(),\n            seg3 = seg2.getNext();\n        return seg1._handleOut.isZero() && seg2._handleIn.isZero() && seg2._handleOut.isZero() && seg3._handleIn.isZero() && seg2._point.subtract(seg1._point).isOrthogonal(seg3._point.subtract(seg2._point));\n      }\n\n      function isArc(i) {\n        var seg1 = segments[i],\n            seg2 = seg1.getNext(),\n            handle1 = seg1._handleOut,\n            handle2 = seg2._handleIn,\n            kappa = 0.5522847498307936;\n\n        if (handle1.isOrthogonal(handle2)) {\n          var pt1 = seg1._point,\n              pt2 = seg2._point,\n              corner = new Line(pt1, handle1, true).intersect(new Line(pt2, handle2, true), true);\n          return corner && Numerical.isZero(handle1.getLength() / corner.subtract(pt1).getLength() - kappa) && Numerical.isZero(handle2.getLength() / corner.subtract(pt2).getLength() - kappa);\n        }\n\n        return false;\n      }\n\n      function getDistance(i, j) {\n        return segments[i]._point.getDistance(segments[j]._point);\n      }\n\n      if (!this.hasHandles() && segments.length === 4 && isCollinear(0, 2) && isCollinear(1, 3) && isOrthogonal(1)) {\n        type = Shape.Rectangle;\n        size = new Size(getDistance(0, 3), getDistance(0, 1));\n        topCenter = segments[1]._point.add(segments[2]._point).divide(2);\n      } else if (segments.length === 8 && isArc(0) && isArc(2) && isArc(4) && isArc(6) && isCollinear(1, 5) && isCollinear(3, 7)) {\n        type = Shape.Rectangle;\n        size = new Size(getDistance(1, 6), getDistance(0, 3));\n        radius = size.subtract(new Size(getDistance(0, 7), getDistance(1, 2))).divide(2);\n        topCenter = segments[3]._point.add(segments[4]._point).divide(2);\n      } else if (segments.length === 4 && isArc(0) && isArc(1) && isArc(2) && isArc(3)) {\n        if (Numerical.isZero(getDistance(0, 2) - getDistance(1, 3))) {\n          type = Shape.Circle;\n          radius = getDistance(0, 2) / 2;\n        } else {\n          type = Shape.Ellipse;\n          radius = new Size(getDistance(2, 0) / 2, getDistance(3, 1) / 2);\n        }\n\n        topCenter = segments[1]._point;\n      }\n\n      if (type) {\n        var center = this.getPosition(true),\n            shape = new type({\n          center: center,\n          size: size,\n          radius: radius,\n          insert: false\n        });\n        shape.copyAttributes(this, true);\n\n        shape._matrix.prepend(this._matrix);\n\n        shape.rotate(topCenter.subtract(center).getAngle() + 90);\n        if (insert === undefined || insert) shape.insertAbove(this);\n        return shape;\n      }\n\n      return null;\n    },\n    toPath: '#clone',\n    compare: function compare(path) {\n      if (!path || path instanceof CompoundPath) return compare.base.call(this, path);\n      var curves1 = this.getCurves(),\n          curves2 = path.getCurves(),\n          length1 = curves1.length,\n          length2 = curves2.length;\n\n      if (!length1 || !length2) {\n        return length1 == length2;\n      }\n\n      var v1 = curves1[0].getValues(),\n          values2 = [],\n          pos1 = 0,\n          pos2,\n          end1 = 0,\n          end2;\n\n      for (var i = 0; i < length2; i++) {\n        var v2 = curves2[i].getValues();\n        values2.push(v2);\n        var overlaps = Curve.getOverlaps(v1, v2);\n\n        if (overlaps) {\n          pos2 = !i && overlaps[0][0] > 0 ? length2 - 1 : i;\n          end2 = overlaps[0][1];\n          break;\n        }\n      }\n\n      var abs = Math.abs,\n          epsilon = 1e-8,\n          v2 = values2[pos2],\n          start2;\n\n      while (v1 && v2) {\n        var overlaps = Curve.getOverlaps(v1, v2);\n\n        if (overlaps) {\n          var t1 = overlaps[0][0];\n\n          if (abs(t1 - end1) < epsilon) {\n            end1 = overlaps[1][0];\n\n            if (end1 === 1) {\n              v1 = ++pos1 < length1 ? curves1[pos1].getValues() : null;\n              end1 = 0;\n            }\n\n            var t2 = overlaps[0][1];\n\n            if (abs(t2 - end2) < epsilon) {\n              if (!start2) start2 = [pos2, t2];\n              end2 = overlaps[1][1];\n\n              if (end2 === 1) {\n                if (++pos2 >= length2) pos2 = 0;\n                v2 = values2[pos2] || curves2[pos2].getValues();\n                end2 = 0;\n              }\n\n              if (!v1) {\n                return start2[0] === pos2 && start2[1] === end2;\n              }\n\n              continue;\n            }\n          }\n        }\n\n        break;\n      }\n\n      return false;\n    },\n    _hitTestSelf: function _hitTestSelf(point, options, viewMatrix, strokeMatrix) {\n      var that = this,\n          style = this.getStyle(),\n          segments = this._segments,\n          numSegments = segments.length,\n          closed = this._closed,\n          tolerancePadding = options._tolerancePadding,\n          strokePadding = tolerancePadding,\n          join,\n          cap,\n          miterLimit,\n          area,\n          loc,\n          res,\n          hitStroke = options.stroke && style.hasStroke(),\n          hitFill = options.fill && style.hasFill(),\n          hitCurves = options.curves,\n          strokeRadius = hitStroke ? style.getStrokeWidth() / 2 : hitFill && options.tolerance > 0 || hitCurves ? 0 : null;\n\n      if (strokeRadius !== null) {\n        if (strokeRadius > 0) {\n          join = style.getStrokeJoin();\n          cap = style.getStrokeCap();\n          miterLimit = style.getMiterLimit();\n          strokePadding = strokePadding.add(Path._getStrokePadding(strokeRadius, strokeMatrix));\n        } else {\n          join = cap = 'round';\n        }\n      }\n\n      function isCloseEnough(pt, padding) {\n        return point.subtract(pt).divide(padding).length <= 1;\n      }\n\n      function checkSegmentPoint(seg, pt, name) {\n        if (!options.selected || pt.isSelected()) {\n          var anchor = seg._point;\n          if (pt !== anchor) pt = pt.add(anchor);\n\n          if (isCloseEnough(pt, strokePadding)) {\n            return new HitResult(name, that, {\n              segment: seg,\n              point: pt\n            });\n          }\n        }\n      }\n\n      function checkSegmentPoints(seg, ends) {\n        return (ends || options.segments) && checkSegmentPoint(seg, seg._point, 'segment') || !ends && options.handles && (checkSegmentPoint(seg, seg._handleIn, 'handle-in') || checkSegmentPoint(seg, seg._handleOut, 'handle-out'));\n      }\n\n      function addToArea(point) {\n        area.add(point);\n      }\n\n      function checkSegmentStroke(segment) {\n        var isJoin = closed || segment._index > 0 && segment._index < numSegments - 1;\n\n        if ((isJoin ? join : cap) === 'round') {\n          return isCloseEnough(segment._point, strokePadding);\n        } else {\n          area = new Path({\n            internal: true,\n            closed: true\n          });\n\n          if (isJoin) {\n            if (!segment.isSmooth()) {\n              Path._addBevelJoin(segment, join, strokeRadius, miterLimit, null, strokeMatrix, addToArea, true);\n            }\n          } else if (cap === 'square') {\n            Path._addSquareCap(segment, cap, strokeRadius, null, strokeMatrix, addToArea, true);\n          }\n\n          if (!area.isEmpty()) {\n            var loc;\n            return area.contains(point) || (loc = area.getNearestLocation(point)) && isCloseEnough(loc.getPoint(), tolerancePadding);\n          }\n        }\n      }\n\n      if (options.ends && !options.segments && !closed) {\n        if (res = checkSegmentPoints(segments[0], true) || checkSegmentPoints(segments[numSegments - 1], true)) return res;\n      } else if (options.segments || options.handles) {\n        for (var i = 0; i < numSegments; i++) {\n          if (res = checkSegmentPoints(segments[i])) return res;\n        }\n      }\n\n      if (strokeRadius !== null) {\n        loc = this.getNearestLocation(point);\n\n        if (loc) {\n          var time = loc.getTime();\n\n          if (time === 0 || time === 1 && numSegments > 1) {\n            if (!checkSegmentStroke(loc.getSegment())) loc = null;\n          } else if (!isCloseEnough(loc.getPoint(), strokePadding)) {\n            loc = null;\n          }\n        }\n\n        if (!loc && join === 'miter' && numSegments > 1) {\n          for (var i = 0; i < numSegments; i++) {\n            var segment = segments[i];\n\n            if (point.getDistance(segment._point) <= miterLimit * strokeRadius && checkSegmentStroke(segment)) {\n              loc = segment.getLocation();\n              break;\n            }\n          }\n        }\n      }\n\n      return !loc && hitFill && this._contains(point) || loc && !hitStroke && !hitCurves ? new HitResult('fill', this) : loc ? new HitResult(hitStroke ? 'stroke' : 'curve', this, {\n        location: loc,\n        point: loc.getPoint()\n      }) : null;\n    }\n  }, Base.each(Curve._evaluateMethods, function (name) {\n    this[name + 'At'] = function (offset) {\n      var loc = this.getLocationAt(offset);\n      return loc && loc[name]();\n    };\n  }, {\n    beans: false,\n    getLocationOf: function getLocationOf() {\n      var point = Point.read(arguments),\n          curves = this.getCurves();\n\n      for (var i = 0, l = curves.length; i < l; i++) {\n        var loc = curves[i].getLocationOf(point);\n        if (loc) return loc;\n      }\n\n      return null;\n    },\n    getOffsetOf: function getOffsetOf() {\n      var loc = this.getLocationOf.apply(this, arguments);\n      return loc ? loc.getOffset() : null;\n    },\n    getLocationAt: function getLocationAt(offset) {\n      if (typeof offset === 'number') {\n        var curves = this.getCurves(),\n            length = 0;\n\n        for (var i = 0, l = curves.length; i < l; i++) {\n          var start = length,\n              curve = curves[i];\n          length += curve.getLength();\n\n          if (length > offset) {\n            return curve.getLocationAt(offset - start);\n          }\n        }\n\n        if (curves.length > 0 && offset <= this.getLength()) {\n          return new CurveLocation(curves[curves.length - 1], 1);\n        }\n      } else if (offset && offset.getPath && offset.getPath() === this) {\n        return offset;\n      }\n\n      return null;\n    },\n    getOffsetsWithTangent: function getOffsetsWithTangent() {\n      var tangent = Point.read(arguments);\n\n      if (tangent.isZero()) {\n        return [];\n      }\n\n      var offsets = [];\n      var curveStart = 0;\n      var curves = this.getCurves();\n\n      for (var i = 0, l = curves.length; i < l; i++) {\n        var curve = curves[i];\n        var curveTimes = curve.getTimesWithTangent(tangent);\n\n        for (var j = 0, m = curveTimes.length; j < m; j++) {\n          var offset = curveStart + curve.getOffsetAtTime(curveTimes[j]);\n\n          if (offsets.indexOf(offset) < 0) {\n            offsets.push(offset);\n          }\n        }\n\n        curveStart += curve.length;\n      }\n\n      return offsets;\n    }\n  }), new function () {\n    function drawHandles(ctx, segments, matrix, size) {\n      var half = size / 2,\n          coords = new Array(6),\n          pX,\n          pY;\n\n      function drawHandle(index) {\n        var hX = coords[index],\n            hY = coords[index + 1];\n\n        if (pX != hX || pY != hY) {\n          ctx.beginPath();\n          ctx.moveTo(pX, pY);\n          ctx.lineTo(hX, hY);\n          ctx.stroke();\n          ctx.beginPath();\n          ctx.arc(hX, hY, half, 0, Math.PI * 2, true);\n          ctx.fill();\n        }\n      }\n\n      for (var i = 0, l = segments.length; i < l; i++) {\n        var segment = segments[i],\n            selection = segment._selection;\n\n        segment._transformCoordinates(matrix, coords);\n\n        pX = coords[0];\n        pY = coords[1];\n        if (selection & 2) drawHandle(2);\n        if (selection & 4) drawHandle(4);\n        ctx.fillRect(pX - half, pY - half, size, size);\n\n        if (!(selection & 1)) {\n          var fillStyle = ctx.fillStyle;\n          ctx.fillStyle = '#ffffff';\n          ctx.fillRect(pX - half + 1, pY - half + 1, size - 2, size - 2);\n          ctx.fillStyle = fillStyle;\n        }\n      }\n    }\n\n    function drawSegments(ctx, path, matrix) {\n      var segments = path._segments,\n          length = segments.length,\n          coords = new Array(6),\n          first = true,\n          curX,\n          curY,\n          prevX,\n          prevY,\n          inX,\n          inY,\n          outX,\n          outY;\n\n      function drawSegment(segment) {\n        if (matrix) {\n          segment._transformCoordinates(matrix, coords);\n\n          curX = coords[0];\n          curY = coords[1];\n        } else {\n          var point = segment._point;\n          curX = point._x;\n          curY = point._y;\n        }\n\n        if (first) {\n          ctx.moveTo(curX, curY);\n          first = false;\n        } else {\n          if (matrix) {\n            inX = coords[2];\n            inY = coords[3];\n          } else {\n            var handle = segment._handleIn;\n            inX = curX + handle._x;\n            inY = curY + handle._y;\n          }\n\n          if (inX === curX && inY === curY && outX === prevX && outY === prevY) {\n            ctx.lineTo(curX, curY);\n          } else {\n            ctx.bezierCurveTo(outX, outY, inX, inY, curX, curY);\n          }\n        }\n\n        prevX = curX;\n        prevY = curY;\n\n        if (matrix) {\n          outX = coords[4];\n          outY = coords[5];\n        } else {\n          var handle = segment._handleOut;\n          outX = prevX + handle._x;\n          outY = prevY + handle._y;\n        }\n      }\n\n      for (var i = 0; i < length; i++) {\n        drawSegment(segments[i]);\n      }\n\n      if (path._closed && length > 0) drawSegment(segments[0]);\n    }\n\n    return {\n      _draw: function _draw(ctx, param, viewMatrix, strokeMatrix) {\n        var dontStart = param.dontStart,\n            dontPaint = param.dontFinish || param.clip,\n            style = this.getStyle(),\n            hasFill = style.hasFill(),\n            hasStroke = style.hasStroke(),\n            dashArray = style.getDashArray(),\n            dashLength = !paper.support.nativeDash && hasStroke && dashArray && dashArray.length;\n        if (!dontStart) ctx.beginPath();\n\n        if (hasFill || hasStroke && !dashLength || dontPaint) {\n          drawSegments(ctx, this, strokeMatrix);\n          if (this._closed) ctx.closePath();\n        }\n\n        function getOffset(i) {\n          return dashArray[(i % dashLength + dashLength) % dashLength];\n        }\n\n        if (!dontPaint && (hasFill || hasStroke)) {\n          this._setStyles(ctx, param, viewMatrix);\n\n          if (hasFill) {\n            ctx.fill(style.getFillRule());\n            ctx.shadowColor = 'rgba(0,0,0,0)';\n          }\n\n          if (hasStroke) {\n            if (dashLength) {\n              if (!dontStart) ctx.beginPath();\n              var flattener = new PathFlattener(this, 0.25, 32, false, strokeMatrix),\n                  length = flattener.length,\n                  from = -style.getDashOffset(),\n                  to,\n                  i = 0;\n              from = from % length;\n\n              while (from > 0) {\n                from -= getOffset(i--) + getOffset(i--);\n              }\n\n              while (from < length) {\n                to = from + getOffset(i++);\n                if (from > 0 || to > 0) flattener.drawPart(ctx, Math.max(from, 0), Math.max(to, 0));\n                from = to + getOffset(i++);\n              }\n            }\n\n            ctx.stroke();\n          }\n        }\n      },\n      _drawSelected: function _drawSelected(ctx, matrix) {\n        ctx.beginPath();\n        drawSegments(ctx, this, matrix);\n        ctx.stroke();\n        drawHandles(ctx, this._segments, matrix, paper.settings.handleSize);\n      }\n    };\n  }(), new function () {\n    function getCurrentSegment(that) {\n      var segments = that._segments;\n      if (!segments.length) throw new Error('Use a moveTo() command first');\n      return segments[segments.length - 1];\n    }\n\n    return {\n      moveTo: function moveTo() {\n        var segments = this._segments;\n        if (segments.length === 1) this.removeSegment(0);\n        if (!segments.length) this._add([new Segment(Point.read(arguments))]);\n      },\n      moveBy: function moveBy() {\n        throw new Error('moveBy() is unsupported on Path items.');\n      },\n      lineTo: function lineTo() {\n        this._add([new Segment(Point.read(arguments))]);\n      },\n      cubicCurveTo: function cubicCurveTo() {\n        var handle1 = Point.read(arguments),\n            handle2 = Point.read(arguments),\n            to = Point.read(arguments),\n            current = getCurrentSegment(this);\n        current.setHandleOut(handle1.subtract(current._point));\n\n        this._add([new Segment(to, handle2.subtract(to))]);\n      },\n      quadraticCurveTo: function quadraticCurveTo() {\n        var handle = Point.read(arguments),\n            to = Point.read(arguments),\n            current = getCurrentSegment(this)._point;\n\n        this.cubicCurveTo(handle.add(current.subtract(handle).multiply(1 / 3)), handle.add(to.subtract(handle).multiply(1 / 3)), to);\n      },\n      curveTo: function curveTo() {\n        var through = Point.read(arguments),\n            to = Point.read(arguments),\n            t = Base.pick(Base.read(arguments), 0.5),\n            t1 = 1 - t,\n            current = getCurrentSegment(this)._point,\n            handle = through.subtract(current.multiply(t1 * t1)).subtract(to.multiply(t * t)).divide(2 * t * t1);\n\n        if (handle.isNaN()) throw new Error('Cannot put a curve through points with parameter = ' + t);\n        this.quadraticCurveTo(handle, to);\n      },\n      arcTo: function arcTo() {\n        var abs = Math.abs,\n            sqrt = Math.sqrt,\n            current = getCurrentSegment(this),\n            from = current._point,\n            to = Point.read(arguments),\n            through,\n            peek = Base.peek(arguments),\n            clockwise = Base.pick(peek, true),\n            center,\n            extent,\n            vector,\n            matrix;\n\n        if (typeof clockwise === 'boolean') {\n          var middle = from.add(to).divide(2),\n              through = middle.add(middle.subtract(from).rotate(clockwise ? -90 : 90));\n        } else if (Base.remain(arguments) <= 2) {\n          through = to;\n          to = Point.read(arguments);\n        } else {\n          var radius = Size.read(arguments),\n              isZero = Numerical.isZero;\n          if (isZero(radius.width) || isZero(radius.height)) return this.lineTo(to);\n          var rotation = Base.read(arguments),\n              clockwise = !!Base.read(arguments),\n              large = !!Base.read(arguments),\n              middle = from.add(to).divide(2),\n              pt = from.subtract(middle).rotate(-rotation),\n              x = pt.x,\n              y = pt.y,\n              rx = abs(radius.width),\n              ry = abs(radius.height),\n              rxSq = rx * rx,\n              rySq = ry * ry,\n              xSq = x * x,\n              ySq = y * y;\n          var factor = sqrt(xSq / rxSq + ySq / rySq);\n\n          if (factor > 1) {\n            rx *= factor;\n            ry *= factor;\n            rxSq = rx * rx;\n            rySq = ry * ry;\n          }\n\n          factor = (rxSq * rySq - rxSq * ySq - rySq * xSq) / (rxSq * ySq + rySq * xSq);\n          if (abs(factor) < 1e-12) factor = 0;\n          if (factor < 0) throw new Error('Cannot create an arc with the given arguments');\n          center = new Point(rx * y / ry, -ry * x / rx).multiply((large === clockwise ? -1 : 1) * sqrt(factor)).rotate(rotation).add(middle);\n          matrix = new Matrix().translate(center).rotate(rotation).scale(rx, ry);\n          vector = matrix._inverseTransform(from);\n          extent = vector.getDirectedAngle(matrix._inverseTransform(to));\n          if (!clockwise && extent > 0) extent -= 360;else if (clockwise && extent < 0) extent += 360;\n        }\n\n        if (through) {\n          var l1 = new Line(from.add(through).divide(2), through.subtract(from).rotate(90), true),\n              l2 = new Line(through.add(to).divide(2), to.subtract(through).rotate(90), true),\n              line = new Line(from, to),\n              throughSide = line.getSide(through);\n          center = l1.intersect(l2, true);\n\n          if (!center) {\n            if (!throughSide) return this.lineTo(to);\n            throw new Error('Cannot create an arc with the given arguments');\n          }\n\n          vector = from.subtract(center);\n          extent = vector.getDirectedAngle(to.subtract(center));\n          var centerSide = line.getSide(center, true);\n\n          if (centerSide === 0) {\n            extent = throughSide * abs(extent);\n          } else if (throughSide === centerSide) {\n            extent += extent < 0 ? 360 : -360;\n          }\n        }\n\n        var epsilon = 1e-7,\n            ext = abs(extent),\n            count = ext >= 360 ? 4 : Math.ceil((ext - epsilon) / 90),\n            inc = extent / count,\n            half = inc * Math.PI / 360,\n            z = 4 / 3 * Math.sin(half) / (1 + Math.cos(half)),\n            segments = [];\n\n        for (var i = 0; i <= count; i++) {\n          var pt = to,\n              out = null;\n\n          if (i < count) {\n            out = vector.rotate(90).multiply(z);\n\n            if (matrix) {\n              pt = matrix._transformPoint(vector);\n              out = matrix._transformPoint(vector.add(out)).subtract(pt);\n            } else {\n              pt = center.add(vector);\n            }\n          }\n\n          if (!i) {\n            current.setHandleOut(out);\n          } else {\n            var _in = vector.rotate(-90).multiply(z);\n\n            if (matrix) {\n              _in = matrix._transformPoint(vector.add(_in)).subtract(pt);\n            }\n\n            segments.push(new Segment(pt, _in, out));\n          }\n\n          vector = vector.rotate(inc);\n        }\n\n        this._add(segments);\n      },\n      lineBy: function lineBy() {\n        var to = Point.read(arguments),\n            current = getCurrentSegment(this)._point;\n\n        this.lineTo(current.add(to));\n      },\n      curveBy: function curveBy() {\n        var through = Point.read(arguments),\n            to = Point.read(arguments),\n            parameter = Base.read(arguments),\n            current = getCurrentSegment(this)._point;\n\n        this.curveTo(current.add(through), current.add(to), parameter);\n      },\n      cubicCurveBy: function cubicCurveBy() {\n        var handle1 = Point.read(arguments),\n            handle2 = Point.read(arguments),\n            to = Point.read(arguments),\n            current = getCurrentSegment(this)._point;\n\n        this.cubicCurveTo(current.add(handle1), current.add(handle2), current.add(to));\n      },\n      quadraticCurveBy: function quadraticCurveBy() {\n        var handle = Point.read(arguments),\n            to = Point.read(arguments),\n            current = getCurrentSegment(this)._point;\n\n        this.quadraticCurveTo(current.add(handle), current.add(to));\n      },\n      arcBy: function arcBy() {\n        var current = getCurrentSegment(this)._point,\n            point = current.add(Point.read(arguments)),\n            clockwise = Base.pick(Base.peek(arguments), true);\n\n        if (typeof clockwise === 'boolean') {\n          this.arcTo(point, clockwise);\n        } else {\n          this.arcTo(point, current.add(Point.read(arguments)));\n        }\n      },\n      closePath: function closePath(tolerance) {\n        this.setClosed(true);\n        this.join(this, tolerance);\n      }\n    };\n  }(), {\n    _getBounds: function _getBounds(matrix, options) {\n      var method = options.handle ? 'getHandleBounds' : options.stroke ? 'getStrokeBounds' : 'getBounds';\n      return Path[method](this._segments, this._closed, this, matrix, options);\n    },\n    statics: {\n      getBounds: function getBounds(segments, closed, path, matrix, options, strokePadding) {\n        var first = segments[0];\n        if (!first) return new _Rectangle();\n\n        var coords = new Array(6),\n            prevCoords = first._transformCoordinates(matrix, new Array(6)),\n            min = prevCoords.slice(0, 2),\n            max = min.slice(),\n            roots = new Array(2);\n\n        function processSegment(segment) {\n          segment._transformCoordinates(matrix, coords);\n\n          for (var i = 0; i < 2; i++) {\n            Curve._addBounds(prevCoords[i], prevCoords[i + 4], coords[i + 2], coords[i], i, strokePadding ? strokePadding[i] : 0, min, max, roots);\n          }\n\n          var tmp = prevCoords;\n          prevCoords = coords;\n          coords = tmp;\n        }\n\n        for (var i = 1, l = segments.length; i < l; i++) {\n          processSegment(segments[i]);\n        }\n\n        if (closed) processSegment(first);\n        return new _Rectangle(min[0], min[1], max[0] - min[0], max[1] - min[1]);\n      },\n      getStrokeBounds: function getStrokeBounds(segments, closed, path, matrix, options) {\n        var style = path.getStyle(),\n            stroke = style.hasStroke(),\n            strokeWidth = style.getStrokeWidth(),\n            strokeMatrix = stroke && path._getStrokeMatrix(matrix, options),\n            strokePadding = stroke && Path._getStrokePadding(strokeWidth, strokeMatrix),\n            bounds = Path.getBounds(segments, closed, path, matrix, options, strokePadding);\n\n        if (!stroke) return bounds;\n        var strokeRadius = strokeWidth / 2,\n            join = style.getStrokeJoin(),\n            cap = style.getStrokeCap(),\n            miterLimit = style.getMiterLimit(),\n            joinBounds = new _Rectangle(new Size(strokePadding));\n\n        function addPoint(point) {\n          bounds = bounds.include(point);\n        }\n\n        function addRound(segment) {\n          bounds = bounds.unite(joinBounds.setCenter(segment._point.transform(matrix)));\n        }\n\n        function addJoin(segment, join) {\n          if (join === 'round' || segment.isSmooth()) {\n            addRound(segment);\n          } else {\n            Path._addBevelJoin(segment, join, strokeRadius, miterLimit, matrix, strokeMatrix, addPoint);\n          }\n        }\n\n        function addCap(segment, cap) {\n          if (cap === 'round') {\n            addRound(segment);\n          } else {\n            Path._addSquareCap(segment, cap, strokeRadius, matrix, strokeMatrix, addPoint);\n          }\n        }\n\n        var length = segments.length - (closed ? 0 : 1);\n\n        for (var i = 1; i < length; i++) {\n          addJoin(segments[i], join);\n        }\n\n        if (closed) {\n          addJoin(segments[0], join);\n        } else if (length > 0) {\n          addCap(segments[0], cap);\n          addCap(segments[segments.length - 1], cap);\n        }\n\n        return bounds;\n      },\n      _getStrokePadding: function _getStrokePadding(radius, matrix) {\n        if (!matrix) return [radius, radius];\n        var hor = new Point(radius, 0).transform(matrix),\n            ver = new Point(0, radius).transform(matrix),\n            phi = hor.getAngleInRadians(),\n            a = hor.getLength(),\n            b = ver.getLength();\n        var sin = Math.sin(phi),\n            cos = Math.cos(phi),\n            tan = Math.tan(phi),\n            tx = Math.atan2(b * tan, a),\n            ty = Math.atan2(b, tan * a);\n        return [Math.abs(a * Math.cos(tx) * cos + b * Math.sin(tx) * sin), Math.abs(b * Math.sin(ty) * cos + a * Math.cos(ty) * sin)];\n      },\n      _addBevelJoin: function _addBevelJoin(segment, join, radius, miterLimit, matrix, strokeMatrix, addPoint, isArea) {\n        var curve2 = segment.getCurve(),\n            curve1 = curve2.getPrevious(),\n            point = curve2.getPoint1().transform(matrix),\n            normal1 = curve1.getNormalAtTime(1).multiply(radius).transform(strokeMatrix),\n            normal2 = curve2.getNormalAtTime(0).multiply(radius).transform(strokeMatrix);\n\n        if (normal1.getDirectedAngle(normal2) < 0) {\n          normal1 = normal1.negate();\n          normal2 = normal2.negate();\n        }\n\n        if (isArea) addPoint(point);\n        addPoint(point.add(normal1));\n\n        if (join === 'miter') {\n          var corner = new Line(point.add(normal1), new Point(-normal1.y, normal1.x), true).intersect(new Line(point.add(normal2), new Point(-normal2.y, normal2.x), true), true);\n\n          if (corner && point.getDistance(corner) <= miterLimit * radius) {\n            addPoint(corner);\n          }\n        }\n\n        addPoint(point.add(normal2));\n      },\n      _addSquareCap: function _addSquareCap(segment, cap, radius, matrix, strokeMatrix, addPoint, isArea) {\n        var point = segment._point.transform(matrix),\n            loc = segment.getLocation(),\n            normal = loc.getNormal().multiply(loc.getTime() === 0 ? radius : -radius).transform(strokeMatrix);\n\n        if (cap === 'square') {\n          if (isArea) {\n            addPoint(point.subtract(normal));\n            addPoint(point.add(normal));\n          }\n\n          point = point.add(normal.rotate(-90));\n        }\n\n        addPoint(point.add(normal));\n        addPoint(point.subtract(normal));\n      },\n      getHandleBounds: function getHandleBounds(segments, closed, path, matrix, options) {\n        var style = path.getStyle(),\n            stroke = options.stroke && style.hasStroke(),\n            strokePadding,\n            joinPadding;\n\n        if (stroke) {\n          var strokeMatrix = path._getStrokeMatrix(matrix, options),\n              strokeRadius = style.getStrokeWidth() / 2,\n              joinRadius = strokeRadius;\n\n          if (style.getStrokeJoin() === 'miter') joinRadius = strokeRadius * style.getMiterLimit();\n          if (style.getStrokeCap() === 'square') joinRadius = Math.max(joinRadius, strokeRadius * Math.SQRT2);\n          strokePadding = Path._getStrokePadding(strokeRadius, strokeMatrix);\n          joinPadding = Path._getStrokePadding(joinRadius, strokeMatrix);\n        }\n\n        var coords = new Array(6),\n            x1 = Infinity,\n            x2 = -x1,\n            y1 = x1,\n            y2 = x2;\n\n        for (var i = 0, l = segments.length; i < l; i++) {\n          var segment = segments[i];\n\n          segment._transformCoordinates(matrix, coords);\n\n          for (var j = 0; j < 6; j += 2) {\n            var padding = !j ? joinPadding : strokePadding,\n                paddingX = padding ? padding[0] : 0,\n                paddingY = padding ? padding[1] : 0,\n                x = coords[j],\n                y = coords[j + 1],\n                xn = x - paddingX,\n                xx = x + paddingX,\n                yn = y - paddingY,\n                yx = y + paddingY;\n            if (xn < x1) x1 = xn;\n            if (xx > x2) x2 = xx;\n            if (yn < y1) y1 = yn;\n            if (yx > y2) y2 = yx;\n          }\n        }\n\n        return new _Rectangle(x1, y1, x2 - x1, y2 - y1);\n      }\n    }\n  });\n  Path.inject({\n    statics: new function () {\n      var kappa = 0.5522847498307936,\n          ellipseSegments = [new Segment([-1, 0], [0, kappa], [0, -kappa]), new Segment([0, -1], [-kappa, 0], [kappa, 0]), new Segment([1, 0], [0, -kappa], [0, kappa]), new Segment([0, 1], [kappa, 0], [-kappa, 0])];\n\n      function createPath(segments, closed, args) {\n        var props = Base.getNamed(args),\n            path = new Path(props && props.insert == false && Item.NO_INSERT);\n\n        path._add(segments);\n\n        path._closed = closed;\n        return path.set(props, {\n          insert: true\n        });\n      }\n\n      function createEllipse(center, radius, args) {\n        var segments = new Array(4);\n\n        for (var i = 0; i < 4; i++) {\n          var segment = ellipseSegments[i];\n          segments[i] = new Segment(segment._point.multiply(radius).add(center), segment._handleIn.multiply(radius), segment._handleOut.multiply(radius));\n        }\n\n        return createPath(segments, true, args);\n      }\n\n      return {\n        Line: function Line() {\n          return createPath([new Segment(Point.readNamed(arguments, 'from')), new Segment(Point.readNamed(arguments, 'to'))], false, arguments);\n        },\n        Circle: function Circle() {\n          var center = Point.readNamed(arguments, 'center'),\n              radius = Base.readNamed(arguments, 'radius');\n          return createEllipse(center, new Size(radius), arguments);\n        },\n        Rectangle: function Rectangle() {\n          var rect = _Rectangle.readNamed(arguments, 'rectangle'),\n              radius = Size.readNamed(arguments, 'radius', 0, {\n            readNull: true\n          }),\n              bl = rect.getBottomLeft(true),\n              tl = rect.getTopLeft(true),\n              tr = rect.getTopRight(true),\n              br = rect.getBottomRight(true),\n              segments;\n\n          if (!radius || radius.isZero()) {\n            segments = [new Segment(bl), new Segment(tl), new Segment(tr), new Segment(br)];\n          } else {\n            radius = Size.min(radius, rect.getSize(true).divide(2));\n            var rx = radius.width,\n                ry = radius.height,\n                hx = rx * kappa,\n                hy = ry * kappa;\n            segments = [new Segment(bl.add(rx, 0), null, [-hx, 0]), new Segment(bl.subtract(0, ry), [0, hy]), new Segment(tl.add(0, ry), null, [0, -hy]), new Segment(tl.add(rx, 0), [-hx, 0], null), new Segment(tr.subtract(rx, 0), null, [hx, 0]), new Segment(tr.add(0, ry), [0, -hy], null), new Segment(br.subtract(0, ry), null, [0, hy]), new Segment(br.subtract(rx, 0), [hx, 0])];\n          }\n\n          return createPath(segments, true, arguments);\n        },\n        RoundRectangle: '#Rectangle',\n        Ellipse: function Ellipse() {\n          var ellipse = Shape._readEllipse(arguments);\n\n          return createEllipse(ellipse.center, ellipse.radius, arguments);\n        },\n        Oval: '#Ellipse',\n        Arc: function Arc() {\n          var from = Point.readNamed(arguments, 'from'),\n              through = Point.readNamed(arguments, 'through'),\n              to = Point.readNamed(arguments, 'to'),\n              props = Base.getNamed(arguments),\n              path = new Path(props && props.insert == false && Item.NO_INSERT);\n          path.moveTo(from);\n          path.arcTo(through, to);\n          return path.set(props);\n        },\n        RegularPolygon: function RegularPolygon() {\n          var center = Point.readNamed(arguments, 'center'),\n              sides = Base.readNamed(arguments, 'sides'),\n              radius = Base.readNamed(arguments, 'radius'),\n              step = 360 / sides,\n              three = sides % 3 === 0,\n              vector = new Point(0, three ? -radius : radius),\n              offset = three ? -1 : 0.5,\n              segments = new Array(sides);\n\n          for (var i = 0; i < sides; i++) {\n            segments[i] = new Segment(center.add(vector.rotate((i + offset) * step)));\n          }\n\n          return createPath(segments, true, arguments);\n        },\n        Star: function Star() {\n          var center = Point.readNamed(arguments, 'center'),\n              points = Base.readNamed(arguments, 'points') * 2,\n              radius1 = Base.readNamed(arguments, 'radius1'),\n              radius2 = Base.readNamed(arguments, 'radius2'),\n              step = 360 / points,\n              vector = new Point(0, -1),\n              segments = new Array(points);\n\n          for (var i = 0; i < points; i++) {\n            segments[i] = new Segment(center.add(vector.rotate(step * i).multiply(i % 2 ? radius2 : radius1)));\n          }\n\n          return createPath(segments, true, arguments);\n        }\n      };\n    }()\n  });\n  var CompoundPath = PathItem.extend({\n    _class: 'CompoundPath',\n    _serializeFields: {\n      children: []\n    },\n    beans: true,\n    initialize: function CompoundPath(arg) {\n      this._children = [];\n      this._namedChildren = {};\n\n      if (!this._initialize(arg)) {\n        if (typeof arg === 'string') {\n          this.setPathData(arg);\n        } else {\n          this.addChildren(_Array$isArray(arg) ? arg : arguments);\n        }\n      }\n    },\n    insertChildren: function insertChildren(index, items) {\n      var list = items,\n          first = list[0];\n      if (first && typeof first[0] === 'number') list = [list];\n\n      for (var i = items.length - 1; i >= 0; i--) {\n        var item = list[i];\n        if (list === items && !(item instanceof Path)) list = Base.slice(list);\n\n        if (_Array$isArray(item)) {\n          list[i] = new Path({\n            segments: item,\n            insert: false\n          });\n        } else if (item instanceof CompoundPath) {\n          list.splice.apply(list, [i, 1].concat(item.removeChildren()));\n          item.remove();\n        }\n      }\n\n      return insertChildren.base.call(this, index, list);\n    },\n    reduce: function reduce(options) {\n      var children = this._children;\n\n      for (var i = children.length - 1; i >= 0; i--) {\n        var path = children[i].reduce(options);\n        if (path.isEmpty()) path.remove();\n      }\n\n      if (!children.length) {\n        var path = new Path(Item.NO_INSERT);\n        path.copyAttributes(this);\n        path.insertAbove(this);\n        this.remove();\n        return path;\n      }\n\n      return reduce.base.call(this);\n    },\n    isClosed: function isClosed() {\n      var children = this._children;\n\n      for (var i = 0, l = children.length; i < l; i++) {\n        if (!children[i]._closed) return false;\n      }\n\n      return true;\n    },\n    setClosed: function setClosed(closed) {\n      var children = this._children;\n\n      for (var i = 0, l = children.length; i < l; i++) {\n        children[i].setClosed(closed);\n      }\n    },\n    getFirstSegment: function getFirstSegment() {\n      var first = this.getFirstChild();\n      return first && first.getFirstSegment();\n    },\n    getLastSegment: function getLastSegment() {\n      var last = this.getLastChild();\n      return last && last.getLastSegment();\n    },\n    getCurves: function getCurves() {\n      var children = this._children,\n          curves = [];\n\n      for (var i = 0, l = children.length; i < l; i++) {\n        Base.push(curves, children[i].getCurves());\n      }\n\n      return curves;\n    },\n    getFirstCurve: function getFirstCurve() {\n      var first = this.getFirstChild();\n      return first && first.getFirstCurve();\n    },\n    getLastCurve: function getLastCurve() {\n      var last = this.getLastChild();\n      return last && last.getLastCurve();\n    },\n    getArea: function getArea() {\n      var children = this._children,\n          area = 0;\n\n      for (var i = 0, l = children.length; i < l; i++) {\n        area += children[i].getArea();\n      }\n\n      return area;\n    },\n    getLength: function getLength() {\n      var children = this._children,\n          length = 0;\n\n      for (var i = 0, l = children.length; i < l; i++) {\n        length += children[i].getLength();\n      }\n\n      return length;\n    },\n    getPathData: function getPathData(_matrix, _precision) {\n      var children = this._children,\n          paths = [];\n\n      for (var i = 0, l = children.length; i < l; i++) {\n        var child = children[i],\n            mx = child._matrix;\n        paths.push(child.getPathData(_matrix && !mx.isIdentity() ? _matrix.appended(mx) : _matrix, _precision));\n      }\n\n      return paths.join('');\n    },\n    _hitTestChildren: function _hitTestChildren(point, options, viewMatrix) {\n      return _hitTestChildren.base.call(this, point, options.class === Path || options.type === 'path' ? options : Base.set({}, options, {\n        fill: false\n      }), viewMatrix);\n    },\n    _draw: function _draw(ctx, param, viewMatrix, strokeMatrix) {\n      var children = this._children;\n      if (!children.length) return;\n      param = param.extend({\n        dontStart: true,\n        dontFinish: true\n      });\n      ctx.beginPath();\n\n      for (var i = 0, l = children.length; i < l; i++) {\n        children[i].draw(ctx, param, strokeMatrix);\n      }\n\n      if (!param.clip) {\n        this._setStyles(ctx, param, viewMatrix);\n\n        var style = this._style;\n\n        if (style.hasFill()) {\n          ctx.fill(style.getFillRule());\n          ctx.shadowColor = 'rgba(0,0,0,0)';\n        }\n\n        if (style.hasStroke()) ctx.stroke();\n      }\n    },\n    _drawSelected: function _drawSelected(ctx, matrix, selectionItems) {\n      var children = this._children;\n\n      for (var i = 0, l = children.length; i < l; i++) {\n        var child = children[i],\n            mx = child._matrix;\n\n        if (!selectionItems[child._id]) {\n          child._drawSelected(ctx, mx.isIdentity() ? matrix : matrix.appended(mx));\n        }\n      }\n    }\n  }, new function () {\n    function getCurrentPath(that, check) {\n      var children = that._children;\n      if (check && !children.length) throw new Error('Use a moveTo() command first');\n      return children[children.length - 1];\n    }\n\n    return Base.each(['lineTo', 'cubicCurveTo', 'quadraticCurveTo', 'curveTo', 'arcTo', 'lineBy', 'cubicCurveBy', 'quadraticCurveBy', 'curveBy', 'arcBy'], function (key) {\n      this[key] = function () {\n        var path = getCurrentPath(this, true);\n        path[key].apply(path, arguments);\n      };\n    }, {\n      moveTo: function moveTo() {\n        var current = getCurrentPath(this),\n            path = current && current.isEmpty() ? current : new Path(Item.NO_INSERT);\n        if (path !== current) this.addChild(path);\n        path.moveTo.apply(path, arguments);\n      },\n      moveBy: function moveBy() {\n        var current = getCurrentPath(this, true),\n            last = current && current.getLastSegment(),\n            point = Point.read(arguments);\n        this.moveTo(last ? point.add(last._point) : point);\n      },\n      closePath: function closePath(tolerance) {\n        getCurrentPath(this, true).closePath(tolerance);\n      }\n    });\n  }(), Base.each(['reverse', 'flatten', 'simplify', 'smooth'], function (key) {\n    this[key] = function (param) {\n      var children = this._children,\n          res;\n\n      for (var i = 0, l = children.length; i < l; i++) {\n        res = children[i][key](param) || res;\n      }\n\n      return res;\n    };\n  }, {}));\n  PathItem.inject(new function () {\n    var min = Math.min,\n        max = Math.max,\n        abs = Math.abs,\n        operators = {\n      unite: {\n        '1': true,\n        '2': true\n      },\n      intersect: {\n        '2': true\n      },\n      subtract: {\n        '1': true\n      },\n      exclude: {\n        '1': true,\n        '-1': true\n      }\n    };\n\n    function preparePath(path, resolve) {\n      var res = path.clone(false).reduce({\n        simplify: true\n      }).transform(null, true, true);\n      return resolve ? res.resolveCrossings().reorient(res.getFillRule() === 'nonzero', true) : res;\n    }\n\n    function createResult(paths, simplify, path1, path2, options) {\n      var result = new CompoundPath(Item.NO_INSERT);\n      result.addChildren(paths, true);\n      result = result.reduce({\n        simplify: simplify\n      });\n\n      if (!(options && options.insert == false)) {\n        result.insertAbove(path2 && path1.isSibling(path2) && path1.getIndex() < path2.getIndex() ? path2 : path1);\n      }\n\n      result.copyAttributes(path1, true);\n      return result;\n    }\n\n    function traceBoolean(path1, path2, operation, options) {\n      if (options && (options.trace == false || options.stroke) && /^(subtract|intersect)$/.test(operation)) return splitBoolean(path1, path2, operation);\n\n      var _path1 = preparePath(path1, true),\n          _path2 = path2 && path1 !== path2 && preparePath(path2, true),\n          operator = operators[operation];\n\n      operator[operation] = true;\n      if (_path2 && (operator.subtract || operator.exclude) ^ (_path2.isClockwise() ^ _path1.isClockwise())) _path2.reverse();\n      var crossings = divideLocations(CurveLocation.expand(_path1.getCrossings(_path2))),\n          paths1 = _path1._children || [_path1],\n          paths2 = _path2 && (_path2._children || [_path2]),\n          segments = [],\n          curves = [],\n          paths;\n\n      function collect(paths) {\n        for (var i = 0, l = paths.length; i < l; i++) {\n          var path = paths[i];\n          Base.push(segments, path._segments);\n          Base.push(curves, path.getCurves());\n          path._overlapsOnly = true;\n        }\n      }\n\n      if (crossings.length) {\n        collect(paths1);\n        if (paths2) collect(paths2);\n\n        for (var i = 0, l = crossings.length; i < l; i++) {\n          propagateWinding(crossings[i]._segment, _path1, _path2, curves, operator);\n        }\n\n        for (var i = 0, l = segments.length; i < l; i++) {\n          var segment = segments[i],\n              inter = segment._intersection;\n\n          if (!segment._winding) {\n            propagateWinding(segment, _path1, _path2, curves, operator);\n          }\n\n          if (!(inter && inter._overlap)) segment._path._overlapsOnly = false;\n        }\n\n        paths = tracePaths(segments, operator);\n      } else {\n        paths = reorientPaths(paths2 ? paths1.concat(paths2) : paths1.slice(), function (w) {\n          return !!operator[w];\n        });\n      }\n\n      return createResult(paths, true, path1, path2, options);\n    }\n\n    function splitBoolean(path1, path2, operation) {\n      var _path1 = preparePath(path1),\n          _path2 = preparePath(path2),\n          crossings = _path1.getCrossings(_path2),\n          subtract = operation === 'subtract',\n          divide = operation === 'divide',\n          added = {},\n          paths = [];\n\n      function addPath(path) {\n        if (!added[path._id] && (divide || _path2.contains(path.getPointAt(path.getLength() / 2)) ^ subtract)) {\n          paths.unshift(path);\n          return added[path._id] = true;\n        }\n      }\n\n      for (var i = crossings.length - 1; i >= 0; i--) {\n        var path = crossings[i].split();\n\n        if (path) {\n          if (addPath(path)) path.getFirstSegment().setHandleIn(0, 0);\n\n          _path1.getLastSegment().setHandleOut(0, 0);\n        }\n      }\n\n      addPath(_path1);\n      return createResult(paths, false, path1, path2);\n    }\n\n    function linkIntersections(from, to) {\n      var prev = from;\n\n      while (prev) {\n        if (prev === to) return;\n        prev = prev._previous;\n      }\n\n      while (from._next && from._next !== to) {\n        from = from._next;\n      }\n\n      if (!from._next) {\n        while (to._previous) {\n          to = to._previous;\n        }\n\n        from._next = to;\n        to._previous = from;\n      }\n    }\n\n    function clearCurveHandles(curves) {\n      for (var i = curves.length - 1; i >= 0; i--) {\n        curves[i].clearHandles();\n      }\n    }\n\n    function reorientPaths(paths, isInside, clockwise) {\n      var length = paths && paths.length;\n\n      if (length) {\n        var lookup = Base.each(paths, function (path, i) {\n          this[path._id] = {\n            container: null,\n            winding: path.isClockwise() ? 1 : -1,\n            index: i\n          };\n        }, {}),\n            sorted = paths.slice().sort(function (a, b) {\n          return abs(b.getArea()) - abs(a.getArea());\n        }),\n            first = sorted[0];\n        if (clockwise == null) clockwise = first.isClockwise();\n\n        for (var i = 0; i < length; i++) {\n          var path1 = sorted[i],\n              entry1 = lookup[path1._id],\n              point = path1.getInteriorPoint(),\n              containerWinding = 0;\n\n          for (var j = i - 1; j >= 0; j--) {\n            var path2 = sorted[j];\n\n            if (path2.contains(point)) {\n              var entry2 = lookup[path2._id];\n              containerWinding = entry2.winding;\n              entry1.winding += containerWinding;\n              entry1.container = entry2.exclude ? entry2.container : path2;\n              break;\n            }\n          }\n\n          if (isInside(entry1.winding) === isInside(containerWinding)) {\n            entry1.exclude = true;\n            paths[entry1.index] = null;\n          } else {\n            var container = entry1.container;\n            path1.setClockwise(container ? !container.isClockwise() : clockwise);\n          }\n        }\n      }\n\n      return paths;\n    }\n\n    function divideLocations(locations, include, clearLater) {\n      var results = include && [],\n          tMin = 1e-8,\n          tMax = 1 - tMin,\n          clearHandles = false,\n          clearCurves = clearLater || [],\n          clearLookup = clearLater && {},\n          renormalizeLocs,\n          prevCurve,\n          prevTime;\n\n      function getId(curve) {\n        return curve._path._id + '.' + curve._segment1._index;\n      }\n\n      for (var i = (clearLater && clearLater.length) - 1; i >= 0; i--) {\n        var curve = clearLater[i];\n        if (curve._path) clearLookup[getId(curve)] = true;\n      }\n\n      for (var i = locations.length - 1; i >= 0; i--) {\n        var loc = locations[i],\n            time = loc._time,\n            origTime = time,\n            exclude = include && !include(loc),\n            curve = loc._curve,\n            segment;\n\n        if (curve) {\n          if (curve !== prevCurve) {\n            clearHandles = !curve.hasHandles() || clearLookup && clearLookup[getId(curve)];\n            renormalizeLocs = [];\n            prevTime = null;\n            prevCurve = curve;\n          } else if (prevTime >= tMin) {\n            time /= prevTime;\n          }\n        }\n\n        if (exclude) {\n          if (renormalizeLocs) renormalizeLocs.push(loc);\n          continue;\n        } else if (include) {\n          results.unshift(loc);\n        }\n\n        prevTime = origTime;\n\n        if (time < tMin) {\n          segment = curve._segment1;\n        } else if (time > tMax) {\n          segment = curve._segment2;\n        } else {\n          var newCurve = curve.divideAtTime(time, true);\n          if (clearHandles) clearCurves.push(curve, newCurve);\n          segment = newCurve._segment1;\n\n          for (var j = renormalizeLocs.length - 1; j >= 0; j--) {\n            var l = renormalizeLocs[j];\n            l._time = (l._time - time) / (1 - time);\n          }\n        }\n\n        loc._setSegment(segment);\n\n        var inter = segment._intersection,\n            dest = loc._intersection;\n\n        if (inter) {\n          linkIntersections(inter, dest);\n          var other = inter;\n\n          while (other) {\n            linkIntersections(other._intersection, inter);\n            other = other._next;\n          }\n        } else {\n          segment._intersection = dest;\n        }\n      }\n\n      if (!clearLater) clearCurveHandles(clearCurves);\n      return results || locations;\n    }\n\n    function getWinding(point, curves, dir, closed, dontFlip) {\n      var ia = dir ? 1 : 0,\n          io = ia ^ 1,\n          pv = [point.x, point.y],\n          pa = pv[ia],\n          po = pv[io],\n          windingEpsilon = 1e-9,\n          qualityEpsilon = 1e-6,\n          paL = pa - windingEpsilon,\n          paR = pa + windingEpsilon,\n          windingL = 0,\n          windingR = 0,\n          pathWindingL = 0,\n          pathWindingR = 0,\n          onPath = false,\n          onAnyPath = false,\n          quality = 1,\n          roots = [],\n          vPrev,\n          vClose;\n\n      function addWinding(v) {\n        var o0 = v[io + 0],\n            o3 = v[io + 6];\n\n        if (po < min(o0, o3) || po > max(o0, o3)) {\n          return;\n        }\n\n        var a0 = v[ia + 0],\n            a1 = v[ia + 2],\n            a2 = v[ia + 4],\n            a3 = v[ia + 6];\n\n        if (o0 === o3) {\n          if (a0 < paR && a3 > paL || a3 < paR && a0 > paL) {\n            onPath = true;\n          }\n\n          return;\n        }\n\n        var t = po === o0 ? 0 : po === o3 ? 1 : paL > max(a0, a1, a2, a3) || paR < min(a0, a1, a2, a3) ? 1 : Curve.solveCubic(v, io, po, roots, 0, 1) > 0 ? roots[0] : 1,\n            a = t === 0 ? a0 : t === 1 ? a3 : Curve.getPoint(v, t)[dir ? 'y' : 'x'],\n            winding = o0 > o3 ? 1 : -1,\n            windingPrev = vPrev[io] > vPrev[io + 6] ? 1 : -1,\n            a3Prev = vPrev[ia + 6];\n\n        if (po !== o0) {\n          if (a < paL) {\n            pathWindingL += winding;\n          } else if (a > paR) {\n            pathWindingR += winding;\n          } else {\n            onPath = true;\n          }\n\n          if (a > pa - qualityEpsilon && a < pa + qualityEpsilon) quality /= 2;\n        } else {\n          if (winding !== windingPrev) {\n            if (a0 < paL) {\n              pathWindingL += winding;\n            } else if (a0 > paR) {\n              pathWindingR += winding;\n            }\n          } else if (a0 != a3Prev) {\n            if (a3Prev < paR && a > paR) {\n              pathWindingR += winding;\n              onPath = true;\n            } else if (a3Prev > paL && a < paL) {\n              pathWindingL += winding;\n              onPath = true;\n            }\n          }\n\n          quality = 0;\n        }\n\n        vPrev = v;\n        return !dontFlip && a > paL && a < paR && Curve.getTangent(v, t)[dir ? 'x' : 'y'] === 0 && getWinding(point, curves, !dir, closed, true);\n      }\n\n      function handleCurve(v) {\n        var o0 = v[io + 0],\n            o1 = v[io + 2],\n            o2 = v[io + 4],\n            o3 = v[io + 6];\n\n        if (po <= max(o0, o1, o2, o3) && po >= min(o0, o1, o2, o3)) {\n          var a0 = v[ia + 0],\n              a1 = v[ia + 2],\n              a2 = v[ia + 4],\n              a3 = v[ia + 6],\n              monoCurves = paL > max(a0, a1, a2, a3) || paR < min(a0, a1, a2, a3) ? [v] : Curve.getMonoCurves(v, dir),\n              res;\n\n          for (var i = 0, l = monoCurves.length; i < l; i++) {\n            if (res = addWinding(monoCurves[i])) return res;\n          }\n        }\n      }\n\n      for (var i = 0, l = curves.length; i < l; i++) {\n        var curve = curves[i],\n            path = curve._path,\n            v = curve.getValues(),\n            res;\n\n        if (!i || curves[i - 1]._path !== path) {\n          vPrev = null;\n\n          if (!path._closed) {\n            vClose = Curve.getValues(path.getLastCurve().getSegment2(), curve.getSegment1(), null, !closed);\n\n            if (vClose[io] !== vClose[io + 6]) {\n              vPrev = vClose;\n            }\n          }\n\n          if (!vPrev) {\n            vPrev = v;\n            var prev = path.getLastCurve();\n\n            while (prev && prev !== curve) {\n              var v2 = prev.getValues();\n\n              if (v2[io] !== v2[io + 6]) {\n                vPrev = v2;\n                break;\n              }\n\n              prev = prev.getPrevious();\n            }\n          }\n        }\n\n        if (res = handleCurve(v)) return res;\n\n        if (i + 1 === l || curves[i + 1]._path !== path) {\n          if (vClose && (res = handleCurve(vClose))) return res;\n\n          if (onPath && !pathWindingL && !pathWindingR) {\n            pathWindingL = pathWindingR = path.isClockwise(closed) ^ dir ? 1 : -1;\n          }\n\n          windingL += pathWindingL;\n          windingR += pathWindingR;\n          pathWindingL = pathWindingR = 0;\n\n          if (onPath) {\n            onAnyPath = true;\n            onPath = false;\n          }\n\n          vClose = null;\n        }\n      }\n\n      windingL = abs(windingL);\n      windingR = abs(windingR);\n      return {\n        winding: max(windingL, windingR),\n        windingL: windingL,\n        windingR: windingR,\n        quality: quality,\n        onPath: onAnyPath\n      };\n    }\n\n    function propagateWinding(segment, path1, path2, curves, operator) {\n      var chain = [],\n          start = segment,\n          totalLength = 0,\n          winding;\n\n      do {\n        var curve = segment.getCurve(),\n            length = curve.getLength();\n        chain.push({\n          segment: segment,\n          curve: curve,\n          length: length\n        });\n        totalLength += length;\n        segment = segment.getNext();\n      } while (segment && !segment._intersection && segment !== start);\n\n      var offsets = [0.5, 0.25, 0.75],\n          winding = {\n        winding: 0,\n        quality: -1\n      },\n          tMin = 1e-8,\n          tMax = 1 - tMin;\n\n      for (var i = 0; i < offsets.length && winding.quality < 0.5; i++) {\n        var length = totalLength * offsets[i];\n\n        for (var j = 0, l = chain.length; j < l; j++) {\n          var entry = chain[j],\n              curveLength = entry.length;\n\n          if (length <= curveLength) {\n            var curve = entry.curve,\n                path = curve._path,\n                parent = path._parent,\n                operand = parent instanceof CompoundPath ? parent : path,\n                t = Numerical.clamp(curve.getTimeAt(length), tMin, tMax),\n                pt = curve.getPointAtTime(t),\n                dir = abs(curve.getTangentAtTime(t).y) < Math.SQRT1_2;\n            var wind = null;\n\n            if (operator.subtract && path2) {\n              var pathWinding = operand === path1 ? path2._getWinding(pt, dir, true) : path1._getWinding(pt, dir, true);\n\n              if (operand === path1 && pathWinding.winding || operand === path2 && !pathWinding.winding) {\n                if (pathWinding.quality < 1) {\n                  continue;\n                } else {\n                  wind = {\n                    winding: 0,\n                    quality: 1\n                  };\n                }\n              }\n            }\n\n            wind = wind || getWinding(pt, curves, dir, true);\n            if (wind.quality > winding.quality) winding = wind;\n            break;\n          }\n\n          length -= curveLength;\n        }\n      }\n\n      for (var j = chain.length - 1; j >= 0; j--) {\n        chain[j].segment._winding = winding;\n      }\n    }\n\n    function tracePaths(segments, operator) {\n      var paths = [],\n          starts;\n\n      function isValid(seg) {\n        var winding;\n        return !!(seg && !seg._visited && (!operator || operator[(winding = seg._winding || {}).winding] && !(operator.unite && winding.winding === 2 && winding.windingL && winding.windingR)));\n      }\n\n      function isStart(seg) {\n        if (seg) {\n          for (var i = 0, l = starts.length; i < l; i++) {\n            if (seg === starts[i]) return true;\n          }\n        }\n\n        return false;\n      }\n\n      function visitPath(path) {\n        var segments = path._segments;\n\n        for (var i = 0, l = segments.length; i < l; i++) {\n          segments[i]._visited = true;\n        }\n      }\n\n      function getCrossingSegments(segment, collectStarts) {\n        var inter = segment._intersection,\n            start = inter,\n            crossings = [];\n        if (collectStarts) starts = [segment];\n\n        function collect(inter, end) {\n          while (inter && inter !== end) {\n            var other = inter._segment,\n                path = other && other._path;\n\n            if (path) {\n              var next = other.getNext() || path.getFirstSegment(),\n                  nextInter = next._intersection;\n\n              if (other !== segment && (isStart(other) || isStart(next) || next && isValid(other) && (isValid(next) || nextInter && isValid(nextInter._segment)))) {\n                crossings.push(other);\n              }\n\n              if (collectStarts) starts.push(other);\n            }\n\n            inter = inter._next;\n          }\n        }\n\n        if (inter) {\n          collect(inter);\n\n          while (inter && inter._prev) {\n            inter = inter._prev;\n          }\n\n          collect(inter, start);\n        }\n\n        return crossings;\n      }\n\n      segments.sort(function (seg1, seg2) {\n        var inter1 = seg1._intersection,\n            inter2 = seg2._intersection,\n            over1 = !!(inter1 && inter1._overlap),\n            over2 = !!(inter2 && inter2._overlap),\n            path1 = seg1._path,\n            path2 = seg2._path;\n        return over1 ^ over2 ? over1 ? 1 : -1 : !inter1 ^ !inter2 ? inter1 ? 1 : -1 : path1 !== path2 ? path1._id - path2._id : seg1._index - seg2._index;\n      });\n\n      for (var i = 0, l = segments.length; i < l; i++) {\n        var seg = segments[i],\n            valid = isValid(seg),\n            path = null,\n            finished = false,\n            closed = true,\n            branches = [],\n            branch,\n            visited,\n            handleIn;\n\n        if (valid && seg._path._overlapsOnly) {\n          var path1 = seg._path,\n              path2 = seg._intersection._segment._path;\n\n          if (path1.compare(path2)) {\n            if (path1.getArea()) paths.push(path1.clone(false));\n            visitPath(path1);\n            visitPath(path2);\n            valid = false;\n          }\n        }\n\n        while (valid) {\n          var first = !path,\n              crossings = getCrossingSegments(seg, first),\n              other = crossings.shift(),\n              finished = !first && (isStart(seg) || isStart(other)),\n              cross = !finished && other;\n\n          if (first) {\n            path = new Path(Item.NO_INSERT);\n            branch = null;\n          }\n\n          if (finished) {\n            if (seg.isFirst() || seg.isLast()) closed = seg._path._closed;\n            seg._visited = true;\n            break;\n          }\n\n          if (cross && branch) {\n            branches.push(branch);\n            branch = null;\n          }\n\n          if (!branch) {\n            if (cross) crossings.push(seg);\n            branch = {\n              start: path._segments.length,\n              crossings: crossings,\n              visited: visited = [],\n              handleIn: handleIn\n            };\n          }\n\n          if (cross) seg = other;\n\n          if (!isValid(seg)) {\n            path.removeSegments(branch.start);\n\n            for (var j = 0, k = visited.length; j < k; j++) {\n              visited[j]._visited = false;\n            }\n\n            visited.length = 0;\n\n            do {\n              seg = branch && branch.crossings.shift();\n\n              if (!seg || !seg._path) {\n                seg = null;\n                branch = branches.pop();\n\n                if (branch) {\n                  visited = branch.visited;\n                  handleIn = branch.handleIn;\n                }\n              }\n            } while (branch && !isValid(seg));\n\n            if (!seg) break;\n          }\n\n          var next = seg.getNext();\n          path.add(new Segment(seg._point, handleIn, next && seg._handleOut));\n          seg._visited = true;\n          visited.push(seg);\n          seg = next || seg._path.getFirstSegment();\n          handleIn = next && next._handleIn;\n        }\n\n        if (finished) {\n          if (closed) {\n            path.getFirstSegment().setHandleIn(handleIn);\n            path.setClosed(closed);\n          }\n\n          if (path.getArea() !== 0) {\n            paths.push(path);\n          }\n        }\n      }\n\n      return paths;\n    }\n\n    return {\n      _getWinding: function _getWinding(point, dir, closed) {\n        return getWinding(point, this.getCurves(), dir, closed);\n      },\n      unite: function unite(path, options) {\n        return traceBoolean(this, path, 'unite', options);\n      },\n      intersect: function intersect(path, options) {\n        return traceBoolean(this, path, 'intersect', options);\n      },\n      subtract: function subtract(path, options) {\n        return traceBoolean(this, path, 'subtract', options);\n      },\n      exclude: function exclude(path, options) {\n        return traceBoolean(this, path, 'exclude', options);\n      },\n      divide: function divide(path, options) {\n        return options && (options.trace == false || options.stroke) ? splitBoolean(this, path, 'divide') : createResult([this.subtract(path, options), this.intersect(path, options)], true, this, path, options);\n      },\n      resolveCrossings: function resolveCrossings() {\n        var children = this._children,\n            paths = children || [this];\n\n        function hasOverlap(seg, path) {\n          var inter = seg && seg._intersection;\n          return inter && inter._overlap && inter._path === path;\n        }\n\n        var hasOverlaps = false,\n            hasCrossings = false,\n            intersections = this.getIntersections(null, function (inter) {\n          return inter.hasOverlap() && (hasOverlaps = true) || inter.isCrossing() && (hasCrossings = true);\n        }),\n            clearCurves = hasOverlaps && hasCrossings && [];\n        intersections = CurveLocation.expand(intersections);\n\n        if (hasOverlaps) {\n          var overlaps = divideLocations(intersections, function (inter) {\n            return inter.hasOverlap();\n          }, clearCurves);\n\n          for (var i = overlaps.length - 1; i >= 0; i--) {\n            var overlap = overlaps[i],\n                path = overlap._path,\n                seg = overlap._segment,\n                prev = seg.getPrevious(),\n                next = seg.getNext();\n\n            if (hasOverlap(prev, path) && hasOverlap(next, path)) {\n              seg.remove();\n\n              prev._handleOut._set(0, 0);\n\n              next._handleIn._set(0, 0);\n\n              if (prev !== seg && !prev.getCurve().hasLength()) {\n                next._handleIn.set(prev._handleIn);\n\n                prev.remove();\n              }\n            }\n          }\n        }\n\n        if (hasCrossings) {\n          divideLocations(intersections, hasOverlaps && function (inter) {\n            var curve1 = inter.getCurve(),\n                seg1 = inter.getSegment(),\n                other = inter._intersection,\n                curve2 = other._curve,\n                seg2 = other._segment;\n            if (curve1 && curve2 && curve1._path && curve2._path) return true;\n            if (seg1) seg1._intersection = null;\n            if (seg2) seg2._intersection = null;\n          }, clearCurves);\n          if (clearCurves) clearCurveHandles(clearCurves);\n          paths = tracePaths(Base.each(paths, function (path) {\n            Base.push(this, path._segments);\n          }, []));\n        }\n\n        var length = paths.length,\n            item;\n\n        if (length > 1 && children) {\n          if (paths !== children) this.setChildren(paths);\n          item = this;\n        } else if (length === 1 && !children) {\n          if (paths[0] !== this) this.setSegments(paths[0].removeSegments());\n          item = this;\n        }\n\n        if (!item) {\n          item = new CompoundPath(Item.NO_INSERT);\n          item.addChildren(paths);\n          item = item.reduce();\n          item.copyAttributes(this);\n          this.replaceWith(item);\n        }\n\n        return item;\n      },\n      reorient: function reorient(nonZero, clockwise) {\n        var children = this._children;\n\n        if (children && children.length) {\n          this.setChildren(reorientPaths(this.removeChildren(), function (w) {\n            return !!(nonZero ? w : w & 1);\n          }, clockwise));\n        } else if (clockwise !== undefined) {\n          this.setClockwise(clockwise);\n        }\n\n        return this;\n      },\n      getInteriorPoint: function getInteriorPoint() {\n        var bounds = this.getBounds(),\n            point = bounds.getCenter(true);\n\n        if (!this.contains(point)) {\n          var curves = this.getCurves(),\n              y = point.y,\n              intercepts = [],\n              roots = [];\n\n          for (var i = 0, l = curves.length; i < l; i++) {\n            var v = curves[i].getValues(),\n                o0 = v[1],\n                o1 = v[3],\n                o2 = v[5],\n                o3 = v[7];\n\n            if (y >= min(o0, o1, o2, o3) && y <= max(o0, o1, o2, o3)) {\n              var monoCurves = Curve.getMonoCurves(v);\n\n              for (var j = 0, m = monoCurves.length; j < m; j++) {\n                var mv = monoCurves[j],\n                    mo0 = mv[1],\n                    mo3 = mv[7];\n\n                if (mo0 !== mo3 && (y >= mo0 && y <= mo3 || y >= mo3 && y <= mo0)) {\n                  var x = y === mo0 ? mv[0] : y === mo3 ? mv[6] : Curve.solveCubic(mv, 1, y, roots, 0, 1) === 1 ? Curve.getPoint(mv, roots[0]).x : (mv[0] + mv[6]) / 2;\n                  intercepts.push(x);\n                }\n              }\n            }\n          }\n\n          if (intercepts.length > 1) {\n            intercepts.sort(function (a, b) {\n              return a - b;\n            });\n            point.x = (intercepts[0] + intercepts[1]) / 2;\n          }\n        }\n\n        return point;\n      }\n    };\n  }());\n  var PathFlattener = Base.extend({\n    _class: 'PathFlattener',\n    initialize: function initialize(path, flatness, maxRecursion, ignoreStraight, matrix) {\n      var curves = [],\n          parts = [],\n          length = 0,\n          minSpan = 1 / (maxRecursion || 32),\n          segments = path._segments,\n          segment1 = segments[0],\n          segment2;\n\n      function addCurve(segment1, segment2) {\n        var curve = Curve.getValues(segment1, segment2, matrix);\n        curves.push(curve);\n        computeParts(curve, segment1._index, 0, 1);\n      }\n\n      function computeParts(curve, index, t1, t2) {\n        if (t2 - t1 > minSpan && !(ignoreStraight && Curve.isStraight(curve)) && !Curve.isFlatEnough(curve, flatness || 0.25)) {\n          var halves = Curve.subdivide(curve, 0.5),\n              tMid = (t1 + t2) / 2;\n          computeParts(halves[0], index, t1, tMid);\n          computeParts(halves[1], index, tMid, t2);\n        } else {\n          var dx = curve[6] - curve[0],\n              dy = curve[7] - curve[1],\n              dist = Math.sqrt(dx * dx + dy * dy);\n\n          if (dist > 0) {\n            length += dist;\n            parts.push({\n              offset: length,\n              curve: curve,\n              index: index,\n              time: t2\n            });\n          }\n        }\n      }\n\n      for (var i = 1, l = segments.length; i < l; i++) {\n        segment2 = segments[i];\n        addCurve(segment1, segment2);\n        segment1 = segment2;\n      }\n\n      if (path._closed) addCurve(segment2 || segment1, segments[0]);\n      this.curves = curves;\n      this.parts = parts;\n      this.length = length;\n      this.index = 0;\n    },\n    _get: function _get(offset) {\n      var parts = this.parts,\n          length = parts.length,\n          start,\n          i,\n          j = this.index;\n\n      for (;;) {\n        i = j;\n        if (!j || parts[--j].offset < offset) break;\n      }\n\n      for (; i < length; i++) {\n        var part = parts[i];\n\n        if (part.offset >= offset) {\n          this.index = i;\n          var prev = parts[i - 1],\n              prevTime = prev && prev.index === part.index ? prev.time : 0,\n              prevOffset = prev ? prev.offset : 0;\n          return {\n            index: part.index,\n            time: prevTime + (part.time - prevTime) * (offset - prevOffset) / (part.offset - prevOffset)\n          };\n        }\n      }\n\n      return {\n        index: parts[length - 1].index,\n        time: 1\n      };\n    },\n    drawPart: function drawPart(ctx, from, to) {\n      var start = this._get(from),\n          end = this._get(to);\n\n      for (var i = start.index, l = end.index; i <= l; i++) {\n        var curve = Curve.getPart(this.curves[i], i === start.index ? start.time : 0, i === end.index ? end.time : 1);\n        if (i === start.index) ctx.moveTo(curve[0], curve[1]);\n        ctx.bezierCurveTo.apply(ctx, curve.slice(2));\n      }\n    }\n  }, Base.each(Curve._evaluateMethods, function (name) {\n    this[name + 'At'] = function (offset) {\n      var param = this._get(offset);\n\n      return Curve[name](this.curves[param.index], param.time);\n    };\n  }, {}));\n  var PathFitter = Base.extend({\n    initialize: function initialize(path) {\n      var points = this.points = [],\n          segments = path._segments,\n          closed = path._closed;\n\n      for (var i = 0, prev, l = segments.length; i < l; i++) {\n        var point = segments[i].point;\n\n        if (!prev || !prev.equals(point)) {\n          points.push(prev = point.clone());\n        }\n      }\n\n      if (closed) {\n        points.unshift(points[points.length - 1]);\n        points.push(points[1]);\n      }\n\n      this.closed = closed;\n    },\n    fit: function fit(error) {\n      var points = this.points,\n          length = points.length,\n          segments = null;\n\n      if (length > 0) {\n        segments = [new Segment(points[0])];\n\n        if (length > 1) {\n          this.fitCubic(segments, error, 0, length - 1, points[1].subtract(points[0]), points[length - 2].subtract(points[length - 1]));\n\n          if (this.closed) {\n            segments.shift();\n            segments.pop();\n          }\n        }\n      }\n\n      return segments;\n    },\n    fitCubic: function fitCubic(segments, error, first, last, tan1, tan2) {\n      var points = this.points;\n\n      if (last - first === 1) {\n        var pt1 = points[first],\n            pt2 = points[last],\n            dist = pt1.getDistance(pt2) / 3;\n        this.addCurve(segments, [pt1, pt1.add(tan1.normalize(dist)), pt2.add(tan2.normalize(dist)), pt2]);\n        return;\n      }\n\n      var uPrime = this.chordLengthParameterize(first, last),\n          maxError = Math.max(error, error * error),\n          split,\n          parametersInOrder = true;\n\n      for (var i = 0; i <= 4; i++) {\n        var curve = this.generateBezier(first, last, uPrime, tan1, tan2);\n        var max = this.findMaxError(first, last, curve, uPrime);\n\n        if (max.error < error && parametersInOrder) {\n          this.addCurve(segments, curve);\n          return;\n        }\n\n        split = max.index;\n        if (max.error >= maxError) break;\n        parametersInOrder = this.reparameterize(first, last, uPrime, curve);\n        maxError = max.error;\n      }\n\n      var tanCenter = points[split - 1].subtract(points[split + 1]);\n      this.fitCubic(segments, error, first, split, tan1, tanCenter);\n      this.fitCubic(segments, error, split, last, tanCenter.negate(), tan2);\n    },\n    addCurve: function addCurve(segments, curve) {\n      var prev = segments[segments.length - 1];\n      prev.setHandleOut(curve[1].subtract(curve[0]));\n      segments.push(new Segment(curve[3], curve[2].subtract(curve[3])));\n    },\n    generateBezier: function generateBezier(first, last, uPrime, tan1, tan2) {\n      var epsilon = 1e-12,\n          abs = Math.abs,\n          points = this.points,\n          pt1 = points[first],\n          pt2 = points[last],\n          C = [[0, 0], [0, 0]],\n          X = [0, 0];\n\n      for (var i = 0, l = last - first + 1; i < l; i++) {\n        var u = uPrime[i],\n            t = 1 - u,\n            b = 3 * u * t,\n            b0 = t * t * t,\n            b1 = b * t,\n            b2 = b * u,\n            b3 = u * u * u,\n            a1 = tan1.normalize(b1),\n            a2 = tan2.normalize(b2),\n            tmp = points[first + i].subtract(pt1.multiply(b0 + b1)).subtract(pt2.multiply(b2 + b3));\n        C[0][0] += a1.dot(a1);\n        C[0][1] += a1.dot(a2);\n        C[1][0] = C[0][1];\n        C[1][1] += a2.dot(a2);\n        X[0] += a1.dot(tmp);\n        X[1] += a2.dot(tmp);\n      }\n\n      var detC0C1 = C[0][0] * C[1][1] - C[1][0] * C[0][1],\n          alpha1,\n          alpha2;\n\n      if (abs(detC0C1) > epsilon) {\n        var detC0X = C[0][0] * X[1] - C[1][0] * X[0],\n            detXC1 = X[0] * C[1][1] - X[1] * C[0][1];\n        alpha1 = detXC1 / detC0C1;\n        alpha2 = detC0X / detC0C1;\n      } else {\n        var c0 = C[0][0] + C[0][1],\n            c1 = C[1][0] + C[1][1];\n        alpha1 = alpha2 = abs(c0) > epsilon ? X[0] / c0 : abs(c1) > epsilon ? X[1] / c1 : 0;\n      }\n\n      var segLength = pt2.getDistance(pt1),\n          eps = epsilon * segLength,\n          handle1,\n          handle2;\n\n      if (alpha1 < eps || alpha2 < eps) {\n        alpha1 = alpha2 = segLength / 3;\n      } else {\n        var line = pt2.subtract(pt1);\n        handle1 = tan1.normalize(alpha1);\n        handle2 = tan2.normalize(alpha2);\n\n        if (handle1.dot(line) - handle2.dot(line) > segLength * segLength) {\n          alpha1 = alpha2 = segLength / 3;\n          handle1 = handle2 = null;\n        }\n      }\n\n      return [pt1, pt1.add(handle1 || tan1.normalize(alpha1)), pt2.add(handle2 || tan2.normalize(alpha2)), pt2];\n    },\n    reparameterize: function reparameterize(first, last, u, curve) {\n      for (var i = first; i <= last; i++) {\n        u[i - first] = this.findRoot(curve, this.points[i], u[i - first]);\n      }\n\n      for (var i = 1, l = u.length; i < l; i++) {\n        if (u[i] <= u[i - 1]) return false;\n      }\n\n      return true;\n    },\n    findRoot: function findRoot(curve, point, u) {\n      var curve1 = [],\n          curve2 = [];\n\n      for (var i = 0; i <= 2; i++) {\n        curve1[i] = curve[i + 1].subtract(curve[i]).multiply(3);\n      }\n\n      for (var i = 0; i <= 1; i++) {\n        curve2[i] = curve1[i + 1].subtract(curve1[i]).multiply(2);\n      }\n\n      var pt = this.evaluate(3, curve, u),\n          pt1 = this.evaluate(2, curve1, u),\n          pt2 = this.evaluate(1, curve2, u),\n          diff = pt.subtract(point),\n          df = pt1.dot(pt1) + diff.dot(pt2);\n      return Numerical.isZero(df) ? u : u - diff.dot(pt1) / df;\n    },\n    evaluate: function evaluate(degree, curve, t) {\n      var tmp = curve.slice();\n\n      for (var i = 1; i <= degree; i++) {\n        for (var j = 0; j <= degree - i; j++) {\n          tmp[j] = tmp[j].multiply(1 - t).add(tmp[j + 1].multiply(t));\n        }\n      }\n\n      return tmp[0];\n    },\n    chordLengthParameterize: function chordLengthParameterize(first, last) {\n      var u = [0];\n\n      for (var i = first + 1; i <= last; i++) {\n        u[i - first] = u[i - first - 1] + this.points[i].getDistance(this.points[i - 1]);\n      }\n\n      for (var i = 1, m = last - first; i <= m; i++) {\n        u[i] /= u[m];\n      }\n\n      return u;\n    },\n    findMaxError: function findMaxError(first, last, curve, u) {\n      var index = Math.floor((last - first + 1) / 2),\n          maxDist = 0;\n\n      for (var i = first + 1; i < last; i++) {\n        var P = this.evaluate(3, curve, u[i - first]);\n        var v = P.subtract(this.points[i]);\n        var dist = v.x * v.x + v.y * v.y;\n\n        if (dist >= maxDist) {\n          maxDist = dist;\n          index = i;\n        }\n      }\n\n      return {\n        error: maxDist,\n        index: index\n      };\n    }\n  });\n  var TextItem = Item.extend({\n    _class: 'TextItem',\n    _applyMatrix: false,\n    _canApplyMatrix: false,\n    _serializeFields: {\n      content: null\n    },\n    _boundsOptions: {\n      stroke: false,\n      handle: false\n    },\n    initialize: function TextItem(arg) {\n      this._content = '';\n      this._lines = [];\n      var hasProps = arg && Base.isPlainObject(arg) && arg.x === undefined && arg.y === undefined;\n\n      this._initialize(hasProps && arg, !hasProps && Point.read(arguments));\n    },\n    _equals: function _equals(item) {\n      return this._content === item._content;\n    },\n    copyContent: function copyContent(source) {\n      this.setContent(source._content);\n    },\n    getContent: function getContent() {\n      return this._content;\n    },\n    setContent: function setContent(content) {\n      this._content = '' + content;\n      this._lines = this._content.split(/\\r\\n|\\n|\\r/mg);\n\n      this._changed(521);\n    },\n    isEmpty: function isEmpty() {\n      return !this._content;\n    },\n    getCharacterStyle: '#getStyle',\n    setCharacterStyle: '#setStyle',\n    getParagraphStyle: '#getStyle',\n    setParagraphStyle: '#setStyle'\n  });\n  var PointText = TextItem.extend({\n    _class: 'PointText',\n    initialize: function PointText() {\n      TextItem.apply(this, arguments);\n    },\n    getPoint: function getPoint() {\n      var point = this._matrix.getTranslation();\n\n      return new LinkedPoint(point.x, point.y, this, 'setPoint');\n    },\n    setPoint: function setPoint() {\n      var point = Point.read(arguments);\n      this.translate(point.subtract(this._matrix.getTranslation()));\n    },\n    _draw: function _draw(ctx, param, viewMatrix) {\n      if (!this._content) return;\n\n      this._setStyles(ctx, param, viewMatrix);\n\n      var lines = this._lines,\n          style = this._style,\n          hasFill = style.hasFill(),\n          hasStroke = style.hasStroke(),\n          leading = style.getLeading(),\n          shadowColor = ctx.shadowColor;\n      ctx.font = style.getFontStyle();\n      ctx.textAlign = style.getJustification();\n\n      for (var i = 0, l = lines.length; i < l; i++) {\n        ctx.shadowColor = shadowColor;\n        var line = lines[i];\n\n        if (hasFill) {\n          ctx.fillText(line, 0, 0);\n          ctx.shadowColor = 'rgba(0,0,0,0)';\n        }\n\n        if (hasStroke) ctx.strokeText(line, 0, 0);\n        ctx.translate(0, leading);\n      }\n    },\n    _getBounds: function _getBounds(matrix, options) {\n      var style = this._style,\n          lines = this._lines,\n          numLines = lines.length,\n          justification = style.getJustification(),\n          leading = style.getLeading(),\n          width = this.getView().getTextWidth(style.getFontStyle(), lines),\n          x = 0;\n      if (justification !== 'left') x -= width / (justification === 'center' ? 2 : 1);\n      var rect = new _Rectangle(x, numLines ? -0.75 * leading : 0, width, numLines * leading);\n      return matrix ? matrix._transformBounds(rect, rect) : rect;\n    }\n  });\n  var Color = Base.extend(new function () {\n    var types = {\n      gray: ['gray'],\n      rgb: ['red', 'green', 'blue'],\n      hsb: ['hue', 'saturation', 'brightness'],\n      hsl: ['hue', 'saturation', 'lightness'],\n      gradient: ['gradient', 'origin', 'destination', 'highlight']\n    };\n    var componentParsers = {},\n        namedColors = {\n      transparent: [0, 0, 0, 0]\n    },\n        colorCtx;\n\n    function fromCSS(string) {\n      var match = string.match(/^#([\\da-f]{2})([\\da-f]{2})([\\da-f]{2})([\\da-f]{2})?$/i) || string.match(/^#([\\da-f])([\\da-f])([\\da-f])([\\da-f])?$/i),\n          type = 'rgb',\n          components;\n\n      if (match) {\n        var amount = match[4] ? 4 : 3;\n        components = new Array(amount);\n\n        for (var i = 0; i < amount; i++) {\n          var value = match[i + 1];\n          components[i] = _parseInt(value.length == 1 ? value + value : value, 16) / 255;\n        }\n      } else if (match = string.match(/^(rgb|hsl)a?\\((.*)\\)$/)) {\n        type = match[1];\n        components = match[2].split(/[,\\s]+/g);\n        var isHSL = type === 'hsl';\n\n        for (var i = 0, l = Math.min(components.length, 4); i < l; i++) {\n          var component = components[i];\n\n          var value = _parseFloat(component);\n\n          if (isHSL) {\n            if (i === 0) {\n              var unit = component.match(/([a-z]*)$/)[1];\n              value *= {\n                turn: 360,\n                rad: 180 / Math.PI,\n                grad: 0.9\n              }[unit] || 1;\n            } else if (i < 3) {\n              value /= 100;\n            }\n          } else if (i < 3) {\n            value /= 255;\n          }\n\n          components[i] = value;\n        }\n      } else {\n        var color = namedColors[string];\n\n        if (!color) {\n          if (window) {\n            if (!colorCtx) {\n              colorCtx = CanvasProvider.getContext(1, 1);\n              colorCtx.globalCompositeOperation = 'copy';\n            }\n\n            colorCtx.fillStyle = 'rgba(0,0,0,0)';\n            colorCtx.fillStyle = string;\n            colorCtx.fillRect(0, 0, 1, 1);\n            var data = colorCtx.getImageData(0, 0, 1, 1).data;\n            color = namedColors[string] = [data[0] / 255, data[1] / 255, data[2] / 255];\n          } else {\n            color = [0, 0, 0];\n          }\n        }\n\n        components = color.slice();\n      }\n\n      return [type, components];\n    }\n\n    var hsbIndices = [[0, 3, 1], [2, 0, 1], [1, 0, 3], [1, 2, 0], [3, 1, 0], [0, 1, 2]];\n    var converters = {\n      'rgb-hsb': function rgbHsb(r, g, b) {\n        var max = Math.max(r, g, b),\n            min = Math.min(r, g, b),\n            delta = max - min,\n            h = delta === 0 ? 0 : (max == r ? (g - b) / delta + (g < b ? 6 : 0) : max == g ? (b - r) / delta + 2 : (r - g) / delta + 4) * 60;\n        return [h, max === 0 ? 0 : delta / max, max];\n      },\n      'hsb-rgb': function hsbRgb(h, s, b) {\n        h = (h / 60 % 6 + 6) % 6;\n        var i = Math.floor(h),\n            f = h - i,\n            i = hsbIndices[i],\n            v = [b, b * (1 - s), b * (1 - s * f), b * (1 - s * (1 - f))];\n        return [v[i[0]], v[i[1]], v[i[2]]];\n      },\n      'rgb-hsl': function rgbHsl(r, g, b) {\n        var max = Math.max(r, g, b),\n            min = Math.min(r, g, b),\n            delta = max - min,\n            achromatic = delta === 0,\n            h = achromatic ? 0 : (max == r ? (g - b) / delta + (g < b ? 6 : 0) : max == g ? (b - r) / delta + 2 : (r - g) / delta + 4) * 60,\n            l = (max + min) / 2,\n            s = achromatic ? 0 : l < 0.5 ? delta / (max + min) : delta / (2 - max - min);\n        return [h, s, l];\n      },\n      'hsl-rgb': function hslRgb(h, s, l) {\n        h = (h / 360 % 1 + 1) % 1;\n        if (s === 0) return [l, l, l];\n        var t3s = [h + 1 / 3, h, h - 1 / 3],\n            t2 = l < 0.5 ? l * (1 + s) : l + s - l * s,\n            t1 = 2 * l - t2,\n            c = [];\n\n        for (var i = 0; i < 3; i++) {\n          var t3 = t3s[i];\n          if (t3 < 0) t3 += 1;\n          if (t3 > 1) t3 -= 1;\n          c[i] = 6 * t3 < 1 ? t1 + (t2 - t1) * 6 * t3 : 2 * t3 < 1 ? t2 : 3 * t3 < 2 ? t1 + (t2 - t1) * (2 / 3 - t3) * 6 : t1;\n        }\n\n        return c;\n      },\n      'rgb-gray': function rgbGray(r, g, b) {\n        return [r * 0.2989 + g * 0.587 + b * 0.114];\n      },\n      'gray-rgb': function grayRgb(g) {\n        return [g, g, g];\n      },\n      'gray-hsb': function grayHsb(g) {\n        return [0, 0, g];\n      },\n      'gray-hsl': function grayHsl(g) {\n        return [0, 0, g];\n      },\n      'gradient-rgb': function gradientRgb() {\n        return [];\n      },\n      'rgb-gradient': function rgbGradient() {\n        return [];\n      }\n    };\n    return Base.each(types, function (properties, type) {\n      componentParsers[type] = [];\n      Base.each(properties, function (name, index) {\n        var part = Base.capitalize(name),\n            hasOverlap = /^(hue|saturation)$/.test(name),\n            parser = componentParsers[type][index] = type === 'gradient' ? name === 'gradient' ? function (value) {\n          var current = this._components[0];\n          value = Gradient.read(_Array$isArray(value) ? value : arguments, 0, {\n            readNull: true\n          });\n\n          if (current !== value) {\n            if (current) current._removeOwner(this);\n            if (value) value._addOwner(this);\n          }\n\n          return value;\n        } : function () {\n          return Point.read(arguments, 0, {\n            readNull: name === 'highlight',\n            clone: true\n          });\n        } : function (value) {\n          return value == null || isNaN(value) ? 0 : +value;\n        };\n\n        this['get' + part] = function () {\n          return this._type === type || hasOverlap && /^hs[bl]$/.test(this._type) ? this._components[index] : this._convert(type)[index];\n        };\n\n        this['set' + part] = function (value) {\n          if (this._type !== type && !(hasOverlap && /^hs[bl]$/.test(this._type))) {\n            this._components = this._convert(type);\n            this._properties = types[type];\n            this._type = type;\n          }\n\n          this._components[index] = parser.call(this, value);\n\n          this._changed();\n        };\n      }, this);\n    }, {\n      _class: 'Color',\n      _readIndex: true,\n      initialize: function Color(arg) {\n        var args = arguments,\n            reading = this.__read,\n            read = 0,\n            type,\n            components,\n            alpha,\n            values;\n\n        if (_Array$isArray(arg)) {\n          args = arg;\n          arg = args[0];\n        }\n\n        var argType = arg != null && _typeof(arg);\n\n        if (argType === 'string' && arg in types) {\n          type = arg;\n          arg = args[1];\n\n          if (_Array$isArray(arg)) {\n            components = arg;\n            alpha = args[2];\n          } else {\n            if (reading) read = 1;\n            args = Base.slice(args, 1);\n            argType = _typeof(arg);\n          }\n        }\n\n        if (!components) {\n          values = argType === 'number' ? args : argType === 'object' && arg.length != null ? arg : null;\n\n          if (values) {\n            if (!type) type = values.length >= 3 ? 'rgb' : 'gray';\n            var length = types[type].length;\n            alpha = values[length];\n\n            if (reading) {\n              read += values === arguments ? length + (alpha != null ? 1 : 0) : 1;\n            }\n\n            if (values.length > length) values = Base.slice(values, 0, length);\n          } else if (argType === 'string') {\n            var converted = fromCSS(arg);\n            type = converted[0];\n            components = converted[1];\n\n            if (components.length === 4) {\n              alpha = components[3];\n              components.length--;\n            }\n          } else if (argType === 'object') {\n            if (arg.constructor === Color) {\n              type = arg._type;\n              components = arg._components.slice();\n              alpha = arg._alpha;\n\n              if (type === 'gradient') {\n                for (var i = 1, l = components.length; i < l; i++) {\n                  var point = components[i];\n                  if (point) components[i] = point.clone();\n                }\n              }\n            } else if (arg.constructor === Gradient) {\n              type = 'gradient';\n              values = args;\n            } else {\n              type = 'hue' in arg ? 'lightness' in arg ? 'hsl' : 'hsb' : 'gradient' in arg || 'stops' in arg || 'radial' in arg ? 'gradient' : 'gray' in arg ? 'gray' : 'rgb';\n              var properties = types[type],\n                  parsers = componentParsers[type];\n              this._components = components = [];\n\n              for (var i = 0, l = properties.length; i < l; i++) {\n                var value = arg[properties[i]];\n\n                if (value == null && !i && type === 'gradient' && 'stops' in arg) {\n                  value = {\n                    stops: arg.stops,\n                    radial: arg.radial\n                  };\n                }\n\n                value = parsers[i].call(this, value);\n                if (value != null) components[i] = value;\n              }\n\n              alpha = arg.alpha;\n            }\n          }\n\n          if (reading && type) read = 1;\n        }\n\n        this._type = type || 'rgb';\n\n        if (!components) {\n          this._components = components = [];\n          var parsers = componentParsers[this._type];\n\n          for (var i = 0, l = parsers.length; i < l; i++) {\n            var value = parsers[i].call(this, values && values[i]);\n            if (value != null) components[i] = value;\n          }\n        }\n\n        this._components = components;\n        this._properties = types[this._type];\n        this._alpha = alpha;\n        if (reading) this.__read = read;\n        return this;\n      },\n      set: '#initialize',\n      _serialize: function _serialize(options, dictionary) {\n        var components = this.getComponents();\n        return Base.serialize(/^(gray|rgb)$/.test(this._type) ? components : [this._type].concat(components), options, true, dictionary);\n      },\n      _changed: function _changed() {\n        this._canvasStyle = null;\n        if (this._owner) this._owner._changed(129);\n      },\n      _convert: function _convert(type) {\n        var converter;\n        return this._type === type ? this._components.slice() : (converter = converters[this._type + '-' + type]) ? converter.apply(this, this._components) : converters['rgb-' + type].apply(this, converters[this._type + '-rgb'].apply(this, this._components));\n      },\n      convert: function convert(type) {\n        return new Color(type, this._convert(type), this._alpha);\n      },\n      getType: function getType() {\n        return this._type;\n      },\n      setType: function setType(type) {\n        this._components = this._convert(type);\n        this._properties = types[type];\n        this._type = type;\n      },\n      getComponents: function getComponents() {\n        var components = this._components.slice();\n\n        if (this._alpha != null) components.push(this._alpha);\n        return components;\n      },\n      getAlpha: function getAlpha() {\n        return this._alpha != null ? this._alpha : 1;\n      },\n      setAlpha: function setAlpha(alpha) {\n        this._alpha = alpha == null ? null : Math.min(Math.max(alpha, 0), 1);\n\n        this._changed();\n      },\n      hasAlpha: function hasAlpha() {\n        return this._alpha != null;\n      },\n      equals: function equals(color) {\n        var col = Base.isPlainValue(color, true) ? Color.read(arguments) : color;\n        return col === this || col && this._class === col._class && this._type === col._type && this.getAlpha() === col.getAlpha() && Base.equals(this._components, col._components) || false;\n      },\n      toString: function toString() {\n        var properties = this._properties,\n            parts = [],\n            isGradient = this._type === 'gradient',\n            f = Formatter.instance;\n\n        for (var i = 0, l = properties.length; i < l; i++) {\n          var value = this._components[i];\n          if (value != null) parts.push(properties[i] + ': ' + (isGradient ? value : f.number(value)));\n        }\n\n        if (this._alpha != null) parts.push('alpha: ' + f.number(this._alpha));\n        return '{ ' + parts.join(', ') + ' }';\n      },\n      toCSS: function toCSS(hex) {\n        var components = this._convert('rgb'),\n            alpha = hex || this._alpha == null ? 1 : this._alpha;\n\n        function convert(val) {\n          return Math.round((val < 0 ? 0 : val > 1 ? 1 : val) * 255);\n        }\n\n        components = [convert(components[0]), convert(components[1]), convert(components[2])];\n        if (alpha < 1) components.push(alpha < 0 ? 0 : alpha);\n        return hex ? '#' + ((1 << 24) + (components[0] << 16) + (components[1] << 8) + components[2]).toString(16).slice(1) : (components.length == 4 ? 'rgba(' : 'rgb(') + components.join(',') + ')';\n      },\n      toCanvasStyle: function toCanvasStyle(ctx, matrix) {\n        if (this._canvasStyle) return this._canvasStyle;\n        if (this._type !== 'gradient') return this._canvasStyle = this.toCSS();\n        var components = this._components,\n            gradient = components[0],\n            stops = gradient._stops,\n            origin = components[1],\n            destination = components[2],\n            highlight = components[3],\n            inverse = matrix && matrix.inverted(),\n            canvasGradient;\n\n        if (inverse) {\n          origin = inverse._transformPoint(origin);\n          destination = inverse._transformPoint(destination);\n          if (highlight) highlight = inverse._transformPoint(highlight);\n        }\n\n        if (gradient._radial) {\n          var radius = destination.getDistance(origin);\n\n          if (highlight) {\n            var vector = highlight.subtract(origin);\n            if (vector.getLength() > radius) highlight = origin.add(vector.normalize(radius - 0.1));\n          }\n\n          var start = highlight || origin;\n          canvasGradient = ctx.createRadialGradient(start.x, start.y, 0, origin.x, origin.y, radius);\n        } else {\n          canvasGradient = ctx.createLinearGradient(origin.x, origin.y, destination.x, destination.y);\n        }\n\n        for (var i = 0, l = stops.length; i < l; i++) {\n          var stop = stops[i],\n              offset = stop._offset;\n          canvasGradient.addColorStop(offset == null ? i / (l - 1) : offset, stop._color.toCanvasStyle());\n        }\n\n        return this._canvasStyle = canvasGradient;\n      },\n      transform: function transform(matrix) {\n        if (this._type === 'gradient') {\n          var components = this._components;\n\n          for (var i = 1, l = components.length; i < l; i++) {\n            var point = components[i];\n\n            matrix._transformPoint(point, point, true);\n          }\n\n          this._changed();\n        }\n      },\n      statics: {\n        _types: types,\n        random: function random() {\n          var random = Math.random;\n          return new Color(random(), random(), random());\n        }\n      }\n    });\n  }(), new function () {\n    var operators = {\n      add: function add(a, b) {\n        return a + b;\n      },\n      subtract: function subtract(a, b) {\n        return a - b;\n      },\n      multiply: function multiply(a, b) {\n        return a * b;\n      },\n      divide: function divide(a, b) {\n        return a / b;\n      }\n    };\n    return Base.each(operators, function (operator, name) {\n      this[name] = function (color) {\n        color = Color.read(arguments);\n\n        var type = this._type,\n            components1 = this._components,\n            components2 = color._convert(type);\n\n        for (var i = 0, l = components1.length; i < l; i++) {\n          components2[i] = operator(components1[i], components2[i]);\n        }\n\n        return new Color(type, components2, this._alpha != null ? operator(this._alpha, color.getAlpha()) : null);\n      };\n    }, {});\n  }());\n  var Gradient = Base.extend({\n    _class: 'Gradient',\n    initialize: function Gradient(stops, radial) {\n      this._id = UID.get();\n\n      if (stops && Base.isPlainObject(stops)) {\n        this.set(stops);\n        stops = radial = null;\n      }\n\n      if (this._stops == null) {\n        this.setStops(stops || ['white', 'black']);\n      }\n\n      if (this._radial == null) {\n        this.setRadial(typeof radial === 'string' && radial === 'radial' || radial || false);\n      }\n    },\n    _serialize: function _serialize(options, dictionary) {\n      return dictionary.add(this, function () {\n        return Base.serialize([this._stops, this._radial], options, true, dictionary);\n      });\n    },\n    _changed: function _changed() {\n      for (var i = 0, l = this._owners && this._owners.length; i < l; i++) {\n        this._owners[i]._changed();\n      }\n    },\n    _addOwner: function _addOwner(color) {\n      if (!this._owners) this._owners = [];\n\n      this._owners.push(color);\n    },\n    _removeOwner: function _removeOwner(color) {\n      var index = this._owners ? this._owners.indexOf(color) : -1;\n\n      if (index != -1) {\n        this._owners.splice(index, 1);\n\n        if (!this._owners.length) this._owners = undefined;\n      }\n    },\n    clone: function clone() {\n      var stops = [];\n\n      for (var i = 0, l = this._stops.length; i < l; i++) {\n        stops[i] = this._stops[i].clone();\n      }\n\n      return new Gradient(stops, this._radial);\n    },\n    getStops: function getStops() {\n      return this._stops;\n    },\n    setStops: function setStops(stops) {\n      if (stops.length < 2) {\n        throw new Error('Gradient stop list needs to contain at least two stops.');\n      }\n\n      var _stops = this._stops;\n\n      if (_stops) {\n        for (var i = 0, l = _stops.length; i < l; i++) {\n          _stops[i]._owner = undefined;\n        }\n      }\n\n      _stops = this._stops = GradientStop.readList(stops, 0, {\n        clone: true\n      });\n\n      for (var i = 0, l = _stops.length; i < l; i++) {\n        _stops[i]._owner = this;\n      }\n\n      this._changed();\n    },\n    getRadial: function getRadial() {\n      return this._radial;\n    },\n    setRadial: function setRadial(radial) {\n      this._radial = radial;\n\n      this._changed();\n    },\n    equals: function equals(gradient) {\n      if (gradient === this) return true;\n\n      if (gradient && this._class === gradient._class) {\n        var stops1 = this._stops,\n            stops2 = gradient._stops,\n            length = stops1.length;\n\n        if (length === stops2.length) {\n          for (var i = 0; i < length; i++) {\n            if (!stops1[i].equals(stops2[i])) return false;\n          }\n\n          return true;\n        }\n      }\n\n      return false;\n    }\n  });\n  var GradientStop = Base.extend({\n    _class: 'GradientStop',\n    initialize: function GradientStop(arg0, arg1) {\n      var color = arg0,\n          offset = arg1;\n\n      if (_typeof(arg0) === 'object' && arg1 === undefined) {\n        if (_Array$isArray(arg0) && typeof arg0[0] !== 'number') {\n          color = arg0[0];\n          offset = arg0[1];\n        } else if ('color' in arg0 || 'offset' in arg0 || 'rampPoint' in arg0) {\n          color = arg0.color;\n          offset = arg0.offset || arg0.rampPoint || 0;\n        }\n      }\n\n      this.setColor(color);\n      this.setOffset(offset);\n    },\n    clone: function clone() {\n      return new GradientStop(this._color.clone(), this._offset);\n    },\n    _serialize: function _serialize(options, dictionary) {\n      var color = this._color,\n          offset = this._offset;\n      return Base.serialize(offset == null ? [color] : [color, offset], options, true, dictionary);\n    },\n    _changed: function _changed() {\n      if (this._owner) this._owner._changed(129);\n    },\n    getOffset: function getOffset() {\n      return this._offset;\n    },\n    setOffset: function setOffset(offset) {\n      this._offset = offset;\n\n      this._changed();\n    },\n    getRampPoint: '#getOffset',\n    setRampPoint: '#setOffset',\n    getColor: function getColor() {\n      return this._color;\n    },\n    setColor: function setColor() {\n      var color = Color.read(arguments, 0, {\n        clone: true\n      });\n      if (color) color._owner = this;\n      this._color = color;\n\n      this._changed();\n    },\n    equals: function equals(stop) {\n      return stop === this || stop && this._class === stop._class && this._color.equals(stop._color) && this._offset == stop._offset || false;\n    }\n  });\n  var Style = Base.extend(new function () {\n    var itemDefaults = {\n      fillColor: null,\n      fillRule: 'nonzero',\n      strokeColor: null,\n      strokeWidth: 1,\n      strokeCap: 'butt',\n      strokeJoin: 'miter',\n      strokeScaling: true,\n      miterLimit: 10,\n      dashOffset: 0,\n      dashArray: [],\n      shadowColor: null,\n      shadowBlur: 0,\n      shadowOffset: new Point(),\n      selectedColor: null\n    },\n        groupDefaults = Base.set({}, itemDefaults, {\n      fontFamily: 'sans-serif',\n      fontWeight: 'normal',\n      fontSize: 12,\n      leading: null,\n      justification: 'left'\n    }),\n        textDefaults = Base.set({}, groupDefaults, {\n      fillColor: new Color()\n    }),\n        flags = {\n      strokeWidth: 193,\n      strokeCap: 193,\n      strokeJoin: 193,\n      strokeScaling: 201,\n      miterLimit: 193,\n      fontFamily: 9,\n      fontWeight: 9,\n      fontSize: 9,\n      font: 9,\n      leading: 9,\n      justification: 9\n    },\n        item = {\n      beans: true\n    },\n        fields = {\n      _class: 'Style',\n      beans: true,\n      initialize: function Style(style, _owner, _project) {\n        this._values = {};\n        this._owner = _owner;\n        this._project = _owner && _owner._project || _project || paper.project;\n        this._defaults = !_owner || _owner instanceof Group ? groupDefaults : _owner instanceof TextItem ? textDefaults : itemDefaults;\n        if (style) this.set(style);\n      }\n    };\n    Base.each(groupDefaults, function (value, key) {\n      var isColor = /Color$/.test(key),\n          isPoint = key === 'shadowOffset',\n          part = Base.capitalize(key),\n          flag = flags[key],\n          set = 'set' + part,\n          get = 'get' + part;\n\n      fields[set] = function (value) {\n        var owner = this._owner,\n            children = owner && owner._children,\n            applyToChildren = children && children.length > 0 && !(owner instanceof CompoundPath);\n\n        if (applyToChildren) {\n          for (var i = 0, l = children.length; i < l; i++) {\n            children[i]._style[set](value);\n          }\n        }\n\n        if ((key === 'selectedColor' || !applyToChildren) && key in this._defaults) {\n          var old = this._values[key];\n\n          if (old !== value) {\n            if (isColor) {\n              if (old && old._owner !== undefined) {\n                old._owner = undefined;\n                old._canvasStyle = null;\n              }\n\n              if (value && value.constructor === Color) {\n                if (value._owner) value = value.clone();\n                value._owner = owner;\n              }\n            }\n\n            this._values[key] = value;\n            if (owner) owner._changed(flag || 129);\n          }\n        }\n      };\n\n      fields[get] = function (_dontMerge) {\n        var owner = this._owner,\n            children = owner && owner._children,\n            value;\n\n        if (key in this._defaults && (!children || !children.length || _dontMerge || owner instanceof CompoundPath)) {\n          var value = this._values[key];\n\n          if (value === undefined) {\n            value = this._defaults[key];\n            if (value && value.clone) value = value.clone();\n          } else {\n            var ctor = isColor ? Color : isPoint ? Point : null;\n\n            if (ctor && !(value && value.constructor === ctor)) {\n              this._values[key] = value = ctor.read([value], 0, {\n                readNull: true,\n                clone: true\n              });\n              if (value && isColor) value._owner = owner;\n            }\n          }\n        } else if (children) {\n          for (var i = 0, l = children.length; i < l; i++) {\n            var childValue = children[i]._style[get]();\n\n            if (!i) {\n              value = childValue;\n            } else if (!Base.equals(value, childValue)) {\n              return undefined;\n            }\n          }\n        }\n\n        return value;\n      };\n\n      item[get] = function (_dontMerge) {\n        return this._style[get](_dontMerge);\n      };\n\n      item[set] = function (value) {\n        this._style[set](value);\n      };\n    });\n    Base.each({\n      Font: 'FontFamily',\n      WindingRule: 'FillRule'\n    }, function (value, key) {\n      var get = 'get' + key,\n          set = 'set' + key;\n      fields[get] = item[get] = '#get' + value;\n      fields[set] = item[set] = '#set' + value;\n    });\n    Item.inject(item);\n    return fields;\n  }(), {\n    set: function set(style) {\n      var isStyle = style instanceof Style,\n          values = isStyle ? style._values : style;\n\n      if (values) {\n        for (var key in values) {\n          if (key in this._defaults) {\n            var value = values[key];\n            this[key] = value && isStyle && value.clone ? value.clone() : value;\n          }\n        }\n      }\n    },\n    equals: function equals(style) {\n      function compare(style1, style2, secondary) {\n        var values1 = style1._values,\n            values2 = style2._values,\n            defaults2 = style2._defaults;\n\n        for (var key in values1) {\n          var value1 = values1[key],\n              value2 = values2[key];\n          if (!(secondary && key in values2) && !Base.equals(value1, value2 === undefined ? defaults2[key] : value2)) return false;\n        }\n\n        return true;\n      }\n\n      return style === this || style && this._class === style._class && compare(this, style) && compare(style, this, true) || false;\n    },\n    _dispose: function _dispose() {\n      var color;\n      color = this.getFillColor();\n      if (color) color._canvasStyle = null;\n      color = this.getStrokeColor();\n      if (color) color._canvasStyle = null;\n      color = this.getShadowColor();\n      if (color) color._canvasStyle = null;\n    },\n    hasFill: function hasFill() {\n      var color = this.getFillColor();\n      return !!color && color.alpha > 0;\n    },\n    hasStroke: function hasStroke() {\n      var color = this.getStrokeColor();\n      return !!color && color.alpha > 0 && this.getStrokeWidth() > 0;\n    },\n    hasShadow: function hasShadow() {\n      var color = this.getShadowColor();\n      return !!color && color.alpha > 0 && (this.getShadowBlur() > 0 || !this.getShadowOffset().isZero());\n    },\n    getView: function getView() {\n      return this._project._view;\n    },\n    getFontStyle: function getFontStyle() {\n      var fontSize = this.getFontSize();\n      return this.getFontWeight() + ' ' + fontSize + (/[a-z]/i.test(fontSize + '') ? ' ' : 'px ') + this.getFontFamily();\n    },\n    getFont: '#getFontFamily',\n    setFont: '#setFontFamily',\n    getLeading: function getLeading() {\n      var leading = getLeading.base.call(this),\n          fontSize = this.getFontSize();\n      if (/pt|em|%|px/.test(fontSize)) fontSize = this.getView().getPixelSize(fontSize);\n      return leading != null ? leading : fontSize * 1.2;\n    }\n  });\n  var DomElement = new function () {\n    function handlePrefix(el, name, set, value) {\n      var prefixes = ['', 'webkit', 'moz', 'Moz', 'ms', 'o'],\n          suffix = name[0].toUpperCase() + name.substring(1);\n\n      for (var i = 0; i < 6; i++) {\n        var prefix = prefixes[i],\n            key = prefix ? prefix + suffix : name;\n\n        if (key in el) {\n          if (set) {\n            el[key] = value;\n          } else {\n            return el[key];\n          }\n\n          break;\n        }\n      }\n    }\n\n    return {\n      getStyles: function getStyles(el) {\n        var doc = el && el.nodeType !== 9 ? el.ownerDocument : el,\n            view = doc && doc.defaultView;\n        return view && view.getComputedStyle(el, '');\n      },\n      getBounds: function getBounds(el, viewport) {\n        var doc = el.ownerDocument,\n            body = doc.body,\n            html = doc.documentElement,\n            rect;\n\n        try {\n          rect = el.getBoundingClientRect();\n        } catch (e) {\n          rect = {\n            left: 0,\n            top: 0,\n            width: 0,\n            height: 0\n          };\n        }\n\n        var x = rect.left - (html.clientLeft || body.clientLeft || 0),\n            y = rect.top - (html.clientTop || body.clientTop || 0);\n\n        if (!viewport) {\n          var view = doc.defaultView;\n          x += view.pageXOffset || html.scrollLeft || body.scrollLeft;\n          y += view.pageYOffset || html.scrollTop || body.scrollTop;\n        }\n\n        return new _Rectangle(x, y, rect.width, rect.height);\n      },\n      getViewportBounds: function getViewportBounds(el) {\n        var doc = el.ownerDocument,\n            view = doc.defaultView,\n            html = doc.documentElement;\n        return new _Rectangle(0, 0, view.innerWidth || html.clientWidth, view.innerHeight || html.clientHeight);\n      },\n      getOffset: function getOffset(el, viewport) {\n        return DomElement.getBounds(el, viewport).getPoint();\n      },\n      getSize: function getSize(el) {\n        return DomElement.getBounds(el, true).getSize();\n      },\n      isInvisible: function isInvisible(el) {\n        return DomElement.getSize(el).equals(new Size(0, 0));\n      },\n      isInView: function isInView(el) {\n        return !DomElement.isInvisible(el) && DomElement.getViewportBounds(el).intersects(DomElement.getBounds(el, true));\n      },\n      isInserted: function isInserted(el) {\n        return document.body.contains(el);\n      },\n      getPrefixed: function getPrefixed(el, name) {\n        return el && handlePrefix(el, name);\n      },\n      setPrefixed: function setPrefixed(el, name, value) {\n        if (_typeof(name) === 'object') {\n          for (var key in name) {\n            handlePrefix(el, key, true, name[key]);\n          }\n        } else {\n          handlePrefix(el, name, true, value);\n        }\n      }\n    };\n  }();\n  var DomEvent = {\n    add: function add(el, events) {\n      if (el) {\n        for (var type in events) {\n          var func = events[type],\n              parts = type.split(/[\\s,]+/g);\n\n          for (var i = 0, l = parts.length; i < l; i++) {\n            var name = parts[i];\n            var options = el === document && (name === 'touchstart' || name === 'touchmove') ? {\n              passive: false\n            } : false;\n            el.addEventListener(name, func, options);\n          }\n        }\n      }\n    },\n    remove: function remove(el, events) {\n      if (el) {\n        for (var type in events) {\n          var func = events[type],\n              parts = type.split(/[\\s,]+/g);\n\n          for (var i = 0, l = parts.length; i < l; i++) {\n            el.removeEventListener(parts[i], func, false);\n          }\n        }\n      }\n    },\n    getPoint: function getPoint(event) {\n      var pos = event.targetTouches ? event.targetTouches.length ? event.targetTouches[0] : event.changedTouches[0] : event;\n      return new Point(pos.pageX || pos.clientX + document.documentElement.scrollLeft, pos.pageY || pos.clientY + document.documentElement.scrollTop);\n    },\n    getTarget: function getTarget(event) {\n      return event.target || event.srcElement;\n    },\n    getRelatedTarget: function getRelatedTarget(event) {\n      return event.relatedTarget || event.toElement;\n    },\n    getOffset: function getOffset(event, target) {\n      return DomEvent.getPoint(event).subtract(DomElement.getOffset(target || DomEvent.getTarget(event)));\n    }\n  };\n  DomEvent.requestAnimationFrame = new function () {\n    var nativeRequest = DomElement.getPrefixed(window, 'requestAnimationFrame'),\n        requested = false,\n        callbacks = [],\n        timer;\n\n    function handleCallbacks() {\n      var functions = callbacks;\n      callbacks = [];\n\n      for (var i = 0, l = functions.length; i < l; i++) {\n        functions[i]();\n      }\n\n      requested = nativeRequest && callbacks.length;\n      if (requested) nativeRequest(handleCallbacks);\n    }\n\n    return function (callback) {\n      callbacks.push(callback);\n\n      if (nativeRequest) {\n        if (!requested) {\n          nativeRequest(handleCallbacks);\n          requested = true;\n        }\n      } else if (!timer) {\n        timer = setInterval(handleCallbacks, 1000 / 60);\n      }\n    };\n  }();\n  var View = Base.extend(Emitter, {\n    _class: 'View',\n    initialize: function View(project, element) {\n      function getSize(name) {\n        return element[name] || _parseInt(element.getAttribute(name), 10);\n      }\n\n      function getCanvasSize() {\n        var size = DomElement.getSize(element);\n        return size.isNaN() || size.isZero() ? new Size(getSize('width'), getSize('height')) : size;\n      }\n\n      var size;\n\n      if (window && element) {\n        this._id = element.getAttribute('id');\n        if (this._id == null) element.setAttribute('id', this._id = 'view-' + View._id++);\n        DomEvent.add(element, this._viewEvents);\n        var none = 'none';\n        DomElement.setPrefixed(element.style, {\n          userDrag: none,\n          userSelect: none,\n          touchCallout: none,\n          contentZooming: none,\n          tapHighlightColor: 'rgba(0,0,0,0)'\n        });\n\n        if (PaperScope.hasAttribute(element, 'resize')) {\n          var that = this;\n          DomEvent.add(window, this._windowEvents = {\n            resize: function resize() {\n              that.setViewSize(getCanvasSize());\n            }\n          });\n        }\n\n        size = getCanvasSize();\n\n        if (PaperScope.hasAttribute(element, 'stats') && typeof Stats !== 'undefined') {\n          this._stats = new Stats();\n          var stats = this._stats.domElement,\n              style = stats.style,\n              offset = DomElement.getOffset(element);\n          style.position = 'absolute';\n          style.left = offset.x + 'px';\n          style.top = offset.y + 'px';\n          document.body.appendChild(stats);\n        }\n      } else {\n        size = new Size(element);\n        element = null;\n      }\n\n      this._project = project;\n      this._scope = project._scope;\n      this._element = element;\n      if (!this._pixelRatio) this._pixelRatio = window && window.devicePixelRatio || 1;\n\n      this._setElementSize(size.width, size.height);\n\n      this._viewSize = size;\n\n      View._views.push(this);\n\n      View._viewsById[this._id] = this;\n      (this._matrix = new Matrix())._owner = this;\n      if (!View._focused) View._focused = this;\n      this._frameItems = {};\n      this._frameItemCount = 0;\n      this._itemEvents = {\n        native: {},\n        virtual: {}\n      };\n      this._autoUpdate = !paper.agent.node;\n      this._needsUpdate = false;\n    },\n    remove: function remove() {\n      if (!this._project) return false;\n      if (View._focused === this) View._focused = null;\n\n      View._views.splice(View._views.indexOf(this), 1);\n\n      delete View._viewsById[this._id];\n      var project = this._project;\n      if (project._view === this) project._view = null;\n      DomEvent.remove(this._element, this._viewEvents);\n      DomEvent.remove(window, this._windowEvents);\n      this._element = this._project = null;\n      this.off('frame');\n      this._animate = false;\n      this._frameItems = {};\n      return true;\n    },\n    _events: Base.each(Item._itemHandlers.concat(['onResize', 'onKeyDown', 'onKeyUp']), function (name) {\n      this[name] = {};\n    }, {\n      onFrame: {\n        install: function install() {\n          this.play();\n        },\n        uninstall: function uninstall() {\n          this.pause();\n        }\n      }\n    }),\n    _animate: false,\n    _time: 0,\n    _count: 0,\n    getAutoUpdate: function getAutoUpdate() {\n      return this._autoUpdate;\n    },\n    setAutoUpdate: function setAutoUpdate(autoUpdate) {\n      this._autoUpdate = autoUpdate;\n      if (autoUpdate) this.requestUpdate();\n    },\n    update: function update() {},\n    draw: function draw() {\n      this.update();\n    },\n    requestUpdate: function requestUpdate() {\n      if (!this._requested) {\n        var that = this;\n        DomEvent.requestAnimationFrame(function () {\n          that._requested = false;\n\n          if (that._animate) {\n            that.requestUpdate();\n            var element = that._element;\n\n            if ((!DomElement.getPrefixed(document, 'hidden') || PaperScope.getAttribute(element, 'keepalive') === 'true') && DomElement.isInView(element)) {\n              that._handleFrame();\n            }\n          }\n\n          if (that._autoUpdate) that.update();\n        });\n        this._requested = true;\n      }\n    },\n    play: function play() {\n      this._animate = true;\n      this.requestUpdate();\n    },\n    pause: function pause() {\n      this._animate = false;\n    },\n    _handleFrame: function _handleFrame() {\n      paper = this._scope;\n      var now = _Date$now() / 1000,\n          delta = this._last ? now - this._last : 0;\n      this._last = now;\n      this.emit('frame', new Base({\n        delta: delta,\n        time: this._time += delta,\n        count: this._count++\n      }));\n      if (this._stats) this._stats.update();\n    },\n    _animateItem: function _animateItem(item, animate) {\n      var items = this._frameItems;\n\n      if (animate) {\n        items[item._id] = {\n          item: item,\n          time: 0,\n          count: 0\n        };\n        if (++this._frameItemCount === 1) this.on('frame', this._handleFrameItems);\n      } else {\n        delete items[item._id];\n\n        if (--this._frameItemCount === 0) {\n          this.off('frame', this._handleFrameItems);\n        }\n      }\n    },\n    _handleFrameItems: function _handleFrameItems(event) {\n      for (var i in this._frameItems) {\n        var entry = this._frameItems[i];\n        entry.item.emit('frame', new Base(event, {\n          time: entry.time += event.delta,\n          count: entry.count++\n        }));\n      }\n    },\n    _changed: function _changed() {\n      this._project._changed(4097);\n\n      this._bounds = this._decomposed = undefined;\n    },\n    getElement: function getElement() {\n      return this._element;\n    },\n    getPixelRatio: function getPixelRatio() {\n      return this._pixelRatio;\n    },\n    getResolution: function getResolution() {\n      return this._pixelRatio * 72;\n    },\n    getViewSize: function getViewSize() {\n      var size = this._viewSize;\n      return new LinkedSize(size.width, size.height, this, 'setViewSize');\n    },\n    setViewSize: function setViewSize() {\n      var size = Size.read(arguments),\n          delta = size.subtract(this._viewSize);\n      if (delta.isZero()) return;\n\n      this._setElementSize(size.width, size.height);\n\n      this._viewSize.set(size);\n\n      this._changed();\n\n      this.emit('resize', {\n        size: size,\n        delta: delta\n      });\n\n      if (this._autoUpdate) {\n        this.update();\n      }\n    },\n    _setElementSize: function _setElementSize(width, height) {\n      var element = this._element;\n\n      if (element) {\n        if (element.width !== width) element.width = width;\n        if (element.height !== height) element.height = height;\n      }\n    },\n    getBounds: function getBounds() {\n      if (!this._bounds) this._bounds = this._matrix.inverted()._transformBounds(new _Rectangle(new Point(), this._viewSize));\n      return this._bounds;\n    },\n    getSize: function getSize() {\n      return this.getBounds().getSize();\n    },\n    isVisible: function isVisible() {\n      return DomElement.isInView(this._element);\n    },\n    isInserted: function isInserted() {\n      return DomElement.isInserted(this._element);\n    },\n    getPixelSize: function getPixelSize(size) {\n      var element = this._element,\n          pixels;\n\n      if (element) {\n        var parent = element.parentNode,\n            temp = document.createElement('div');\n        temp.style.fontSize = size;\n        parent.appendChild(temp);\n        pixels = _parseFloat(DomElement.getStyles(temp).fontSize);\n        parent.removeChild(temp);\n      } else {\n        pixels = _parseFloat(pixels);\n      }\n\n      return pixels;\n    },\n    getTextWidth: function getTextWidth(font, lines) {\n      return 0;\n    }\n  }, Base.each(['rotate', 'scale', 'shear', 'skew'], function (key) {\n    var rotate = key === 'rotate';\n\n    this[key] = function () {\n      var value = (rotate ? Base : Point).read(arguments),\n          center = Point.read(arguments, 0, {\n        readNull: true\n      });\n      return this.transform(new Matrix()[key](value, center || this.getCenter(true)));\n    };\n  }, {\n    _decompose: function _decompose() {\n      return this._decomposed || (this._decomposed = this._matrix.decompose());\n    },\n    translate: function translate() {\n      var mx = new Matrix();\n      return this.transform(mx.translate.apply(mx, arguments));\n    },\n    getCenter: function getCenter() {\n      return this.getBounds().getCenter();\n    },\n    setCenter: function setCenter() {\n      var center = Point.read(arguments);\n      this.translate(this.getCenter().subtract(center));\n    },\n    getZoom: function getZoom() {\n      var scaling = this._decompose().scaling;\n\n      return (scaling.x + scaling.y) / 2;\n    },\n    setZoom: function setZoom(zoom) {\n      this.transform(new Matrix().scale(zoom / this.getZoom(), this.getCenter()));\n    },\n    getRotation: function getRotation() {\n      return this._decompose().rotation;\n    },\n    setRotation: function setRotation(rotation) {\n      var current = this.getRotation();\n\n      if (current != null && rotation != null) {\n        this.rotate(rotation - current);\n      }\n    },\n    getScaling: function getScaling() {\n      var scaling = this._decompose().scaling;\n\n      return new LinkedPoint(scaling.x, scaling.y, this, 'setScaling');\n    },\n    setScaling: function setScaling() {\n      var current = this.getScaling(),\n          scaling = Point.read(arguments, 0, {\n        clone: true,\n        readNull: true\n      });\n\n      if (current && scaling) {\n        this.scale(scaling.x / current.x, scaling.y / current.y);\n      }\n    },\n    getMatrix: function getMatrix() {\n      return this._matrix;\n    },\n    setMatrix: function setMatrix() {\n      var matrix = this._matrix;\n      matrix.initialize.apply(matrix, arguments);\n    },\n    transform: function transform(matrix) {\n      this._matrix.append(matrix);\n    },\n    scrollBy: function scrollBy() {\n      this.translate(Point.read(arguments).negate());\n    }\n  }), {\n    projectToView: function projectToView() {\n      return this._matrix._transformPoint(Point.read(arguments));\n    },\n    viewToProject: function viewToProject() {\n      return this._matrix._inverseTransform(Point.read(arguments));\n    },\n    getEventPoint: function getEventPoint(event) {\n      return this.viewToProject(DomEvent.getOffset(event, this._element));\n    }\n  }, {\n    statics: {\n      _views: [],\n      _viewsById: {},\n      _id: 0,\n      create: function create(project, element) {\n        if (document && typeof element === 'string') element = document.getElementById(element);\n        var ctor = window ? CanvasView : View;\n        return new ctor(project, element);\n      }\n    }\n  }, new function () {\n    if (!window) return;\n    var prevFocus,\n        tempFocus,\n        dragging = false,\n        mouseDown = false;\n\n    function getView(event) {\n      var target = DomEvent.getTarget(event);\n      return target.getAttribute && View._viewsById[target.getAttribute('id')];\n    }\n\n    function updateFocus() {\n      var view = View._focused;\n\n      if (!view || !view.isVisible()) {\n        for (var i = 0, l = View._views.length; i < l; i++) {\n          if ((view = View._views[i]).isVisible()) {\n            View._focused = tempFocus = view;\n            break;\n          }\n        }\n      }\n    }\n\n    function handleMouseMove(view, event, point) {\n      view._handleMouseEvent('mousemove', event, point);\n    }\n\n    var navigator = window.navigator,\n        mousedown,\n        mousemove,\n        mouseup;\n\n    if (navigator.pointerEnabled || navigator.msPointerEnabled) {\n      mousedown = 'pointerdown MSPointerDown';\n      mousemove = 'pointermove MSPointerMove';\n      mouseup = 'pointerup pointercancel MSPointerUp MSPointerCancel';\n    } else {\n      mousedown = 'touchstart';\n      mousemove = 'touchmove';\n      mouseup = 'touchend touchcancel';\n\n      if (!('ontouchstart' in window && navigator.userAgent.match(/mobile|tablet|ip(ad|hone|od)|android|silk/i))) {\n        mousedown += ' mousedown';\n        mousemove += ' mousemove';\n        mouseup += ' mouseup';\n      }\n    }\n\n    var viewEvents = {},\n        docEvents = {\n      mouseout: function mouseout(event) {\n        var view = View._focused,\n            target = DomEvent.getRelatedTarget(event);\n\n        if (view && (!target || target.nodeName === 'HTML')) {\n          var offset = DomEvent.getOffset(event, view._element),\n              x = offset.x,\n              abs = Math.abs,\n              ax = abs(x),\n              max = 1 << 25,\n              diff = ax - max;\n          offset.x = abs(diff) < ax ? diff * (x < 0 ? -1 : 1) : x;\n          handleMouseMove(view, event, view.viewToProject(offset));\n        }\n      },\n      scroll: updateFocus\n    };\n\n    viewEvents[mousedown] = function (event) {\n      var view = View._focused = getView(event);\n\n      if (!dragging) {\n        dragging = true;\n\n        view._handleMouseEvent('mousedown', event);\n      }\n    };\n\n    docEvents[mousemove] = function (event) {\n      var view = View._focused;\n\n      if (!mouseDown) {\n        var target = getView(event);\n\n        if (target) {\n          if (view !== target) {\n            if (view) handleMouseMove(view, event);\n            if (!prevFocus) prevFocus = view;\n            view = View._focused = tempFocus = target;\n          }\n        } else if (tempFocus && tempFocus === view) {\n          if (prevFocus && !prevFocus.isInserted()) prevFocus = null;\n          view = View._focused = prevFocus;\n          prevFocus = null;\n          updateFocus();\n        }\n      }\n\n      if (view) handleMouseMove(view, event);\n    };\n\n    docEvents[mousedown] = function () {\n      mouseDown = true;\n    };\n\n    docEvents[mouseup] = function (event) {\n      var view = View._focused;\n      if (view && dragging) view._handleMouseEvent('mouseup', event);\n      mouseDown = dragging = false;\n    };\n\n    DomEvent.add(document, docEvents);\n    DomEvent.add(window, {\n      load: updateFocus\n    });\n    var called = false,\n        prevented = false,\n        fallbacks = {\n      doubleclick: 'click',\n      mousedrag: 'mousemove'\n    },\n        wasInView = false,\n        overView,\n        downPoint,\n        lastPoint,\n        downItem,\n        overItem,\n        dragItem,\n        clickItem,\n        clickTime,\n        dblClick;\n\n    function emitMouseEvent(obj, target, type, event, point, prevPoint, stopItem) {\n      var stopped = false,\n          mouseEvent;\n\n      function emit(obj, type) {\n        if (obj.responds(type)) {\n          if (!mouseEvent) {\n            mouseEvent = new MouseEvent(type, event, point, target || obj, prevPoint ? point.subtract(prevPoint) : null);\n          }\n\n          if (obj.emit(type, mouseEvent)) {\n            called = true;\n            if (mouseEvent.prevented) prevented = true;\n            if (mouseEvent.stopped) return stopped = true;\n          }\n        } else {\n          var fallback = fallbacks[type];\n          if (fallback) return emit(obj, fallback);\n        }\n      }\n\n      while (obj && obj !== stopItem) {\n        if (emit(obj, type)) break;\n        obj = obj._parent;\n      }\n\n      return stopped;\n    }\n\n    function emitMouseEvents(view, hitItem, type, event, point, prevPoint) {\n      view._project.removeOn(type);\n\n      prevented = called = false;\n      return dragItem && emitMouseEvent(dragItem, null, type, event, point, prevPoint) || hitItem && hitItem !== dragItem && !hitItem.isDescendant(dragItem) && emitMouseEvent(hitItem, null, type === 'mousedrag' ? 'mousemove' : type, event, point, prevPoint, dragItem) || emitMouseEvent(view, dragItem || hitItem || view, type, event, point, prevPoint);\n    }\n\n    var itemEventsMap = {\n      mousedown: {\n        mousedown: 1,\n        mousedrag: 1,\n        click: 1,\n        doubleclick: 1\n      },\n      mouseup: {\n        mouseup: 1,\n        mousedrag: 1,\n        click: 1,\n        doubleclick: 1\n      },\n      mousemove: {\n        mousedrag: 1,\n        mousemove: 1,\n        mouseenter: 1,\n        mouseleave: 1\n      }\n    };\n    return {\n      _viewEvents: viewEvents,\n      _handleMouseEvent: function _handleMouseEvent(type, event, point) {\n        var itemEvents = this._itemEvents,\n            hitItems = itemEvents.native[type],\n            nativeMove = type === 'mousemove',\n            tool = this._scope.tool,\n            view = this;\n\n        function responds(type) {\n          return itemEvents.virtual[type] || view.responds(type) || tool && tool.responds(type);\n        }\n\n        if (nativeMove && dragging && responds('mousedrag')) type = 'mousedrag';\n        if (!point) point = this.getEventPoint(event);\n\n        var inView = this.getBounds().contains(point),\n            hit = hitItems && inView && view._project.hitTest(point, {\n          tolerance: 0,\n          fill: true,\n          stroke: true\n        }),\n            hitItem = hit && hit.item || null,\n            handle = false,\n            mouse = {};\n\n        mouse[type.substr(5)] = true;\n\n        if (hitItems && hitItem !== overItem) {\n          if (overItem) {\n            emitMouseEvent(overItem, null, 'mouseleave', event, point);\n          }\n\n          if (hitItem) {\n            emitMouseEvent(hitItem, null, 'mouseenter', event, point);\n          }\n\n          overItem = hitItem;\n        }\n\n        if (wasInView ^ inView) {\n          emitMouseEvent(this, null, inView ? 'mouseenter' : 'mouseleave', event, point);\n          overView = inView ? this : null;\n          handle = true;\n        }\n\n        if ((inView || mouse.drag) && !point.equals(lastPoint)) {\n          emitMouseEvents(this, hitItem, nativeMove ? type : 'mousemove', event, point, lastPoint);\n          handle = true;\n        }\n\n        wasInView = inView;\n\n        if (mouse.down && inView || mouse.up && downPoint) {\n          emitMouseEvents(this, hitItem, type, event, point, downPoint);\n\n          if (mouse.down) {\n            dblClick = hitItem === clickItem && _Date$now() - clickTime < 300;\n            downItem = clickItem = hitItem;\n\n            if (!prevented && hitItem) {\n              var item = hitItem;\n\n              while (item && !item.responds('mousedrag')) {\n                item = item._parent;\n              }\n\n              if (item) dragItem = hitItem;\n            }\n\n            downPoint = point;\n          } else if (mouse.up) {\n            if (!prevented && hitItem === downItem) {\n              clickTime = _Date$now();\n              emitMouseEvents(this, hitItem, dblClick ? 'doubleclick' : 'click', event, point, downPoint);\n              dblClick = false;\n            }\n\n            downItem = dragItem = null;\n          }\n\n          wasInView = false;\n          handle = true;\n        }\n\n        lastPoint = point;\n\n        if (handle && tool) {\n          called = tool._handleMouseEvent(type, event, point, mouse) || called;\n        }\n\n        if (event.cancelable !== false && (called && !mouse.move || mouse.down && responds('mouseup'))) {\n          event.preventDefault();\n        }\n      },\n      _handleKeyEvent: function _handleKeyEvent(type, event, key, character) {\n        var scope = this._scope,\n            tool = scope.tool,\n            keyEvent;\n\n        function emit(obj) {\n          if (obj.responds(type)) {\n            paper = scope;\n            obj.emit(type, keyEvent = keyEvent || new KeyEvent(type, event, key, character));\n          }\n        }\n\n        if (this.isVisible()) {\n          emit(this);\n          if (tool && tool.responds(type)) emit(tool);\n        }\n      },\n      _countItemEvent: function _countItemEvent(type, sign) {\n        var itemEvents = this._itemEvents,\n            native = itemEvents.native,\n            virtual = itemEvents.virtual;\n\n        for (var key in itemEventsMap) {\n          native[key] = (native[key] || 0) + (itemEventsMap[key][type] || 0) * sign;\n        }\n\n        virtual[type] = (virtual[type] || 0) + sign;\n      },\n      statics: {\n        updateFocus: updateFocus,\n        _resetState: function _resetState() {\n          dragging = mouseDown = called = wasInView = false;\n          prevFocus = tempFocus = overView = downPoint = lastPoint = downItem = overItem = dragItem = clickItem = clickTime = dblClick = null;\n        }\n      }\n    };\n  }());\n  var CanvasView = View.extend({\n    _class: 'CanvasView',\n    initialize: function CanvasView(project, canvas) {\n      if (!(canvas instanceof window.HTMLCanvasElement)) {\n        var size = Size.read(arguments, 1);\n        if (size.isZero()) throw new Error('Cannot create CanvasView with the provided argument: ' + Base.slice(arguments, 1));\n        canvas = CanvasProvider.getCanvas(size);\n      }\n\n      var ctx = this._context = canvas.getContext('2d');\n      ctx.save();\n      this._pixelRatio = 1;\n\n      if (!/^off|false$/.test(PaperScope.getAttribute(canvas, 'hidpi'))) {\n        var deviceRatio = window.devicePixelRatio || 1,\n            backingStoreRatio = DomElement.getPrefixed(ctx, 'backingStorePixelRatio') || 1;\n        this._pixelRatio = deviceRatio / backingStoreRatio;\n      }\n\n      View.call(this, project, canvas);\n      this._needsUpdate = true;\n    },\n    remove: function remove() {\n      this._context.restore();\n\n      return remove.base.call(this);\n    },\n    _setElementSize: function _setElementSize(width, height) {\n      var pixelRatio = this._pixelRatio;\n\n      _setElementSize.base.call(this, width * pixelRatio, height * pixelRatio);\n\n      if (pixelRatio !== 1) {\n        var element = this._element,\n            ctx = this._context;\n\n        if (!PaperScope.hasAttribute(element, 'resize')) {\n          var style = element.style;\n          style.width = width + 'px';\n          style.height = height + 'px';\n        }\n\n        ctx.restore();\n        ctx.save();\n        ctx.scale(pixelRatio, pixelRatio);\n      }\n    },\n    getPixelSize: function getPixelSize(size) {\n      var agent = paper.agent,\n          pixels;\n\n      if (agent && agent.firefox) {\n        pixels = getPixelSize.base.call(this, size);\n      } else {\n        var ctx = this._context,\n            prevFont = ctx.font;\n        ctx.font = size + ' serif';\n        pixels = _parseFloat(ctx.font);\n        ctx.font = prevFont;\n      }\n\n      return pixels;\n    },\n    getTextWidth: function getTextWidth(font, lines) {\n      var ctx = this._context,\n          prevFont = ctx.font,\n          width = 0;\n      ctx.font = font;\n\n      for (var i = 0, l = lines.length; i < l; i++) {\n        width = Math.max(width, ctx.measureText(lines[i]).width);\n      }\n\n      ctx.font = prevFont;\n      return width;\n    },\n    update: function update() {\n      if (!this._needsUpdate) return false;\n      var project = this._project,\n          ctx = this._context,\n          size = this._viewSize;\n      ctx.clearRect(0, 0, size.width + 1, size.height + 1);\n      if (project) project.draw(ctx, this._matrix, this._pixelRatio);\n      this._needsUpdate = false;\n      return true;\n    }\n  });\n  var Event = Base.extend({\n    _class: 'Event',\n    initialize: function Event(event) {\n      this.event = event;\n      this.type = event && event.type;\n    },\n    prevented: false,\n    stopped: false,\n    preventDefault: function preventDefault() {\n      this.prevented = true;\n      this.event.preventDefault();\n    },\n    stopPropagation: function stopPropagation() {\n      this.stopped = true;\n      this.event.stopPropagation();\n    },\n    stop: function stop() {\n      this.stopPropagation();\n      this.preventDefault();\n    },\n    getTimeStamp: function getTimeStamp() {\n      return this.event.timeStamp;\n    },\n    getModifiers: function getModifiers() {\n      return Key.modifiers;\n    }\n  });\n  var KeyEvent = Event.extend({\n    _class: 'KeyEvent',\n    initialize: function KeyEvent(type, event, key, character) {\n      this.type = type;\n      this.event = event;\n      this.key = key;\n      this.character = character;\n    },\n    toString: function toString() {\n      return \"{ type: '\" + this.type + \"', key: '\" + this.key + \"', character: '\" + this.character + \"', modifiers: \" + this.getModifiers() + \" }\";\n    }\n  });\n  var Key = new function () {\n    var keyLookup = {\n      '\\t': 'tab',\n      ' ': 'space',\n      '\\b': 'backspace',\n      '\\x7f': 'delete',\n      'Spacebar': 'space',\n      'Del': 'delete',\n      'Win': 'meta',\n      'Esc': 'escape'\n    },\n        charLookup = {\n      'tab': '\\t',\n      'space': ' ',\n      'enter': '\\r'\n    },\n        keyMap = {},\n        charMap = {},\n        metaFixMap,\n        downKey,\n        modifiers = new Base({\n      shift: false,\n      control: false,\n      alt: false,\n      meta: false,\n      capsLock: false,\n      space: false\n    }).inject({\n      option: {\n        get: function get() {\n          return this.alt;\n        }\n      },\n      command: {\n        get: function get() {\n          var agent = paper && paper.agent;\n          return agent && agent.mac ? this.meta : this.control;\n        }\n      }\n    });\n\n    function getKey(event) {\n      var key = event.key || event.keyIdentifier;\n      key = /^U\\+/.test(key) ? String.fromCharCode(_parseInt(key.substr(2), 16)) : /^Arrow[A-Z]/.test(key) ? key.substr(5) : key === 'Unidentified' || key === undefined ? String.fromCharCode(event.keyCode) : key;\n      return keyLookup[key] || (key.length > 1 ? Base.hyphenate(key) : key.toLowerCase());\n    }\n\n    function handleKey(down, key, character, event) {\n      var type = down ? 'keydown' : 'keyup',\n          view = View._focused,\n          name;\n      keyMap[key] = down;\n\n      if (down) {\n        charMap[key] = character;\n      } else {\n        delete charMap[key];\n      }\n\n      if (key.length > 1 && (name = Base.camelize(key)) in modifiers) {\n        modifiers[name] = down;\n        var agent = paper && paper.agent;\n\n        if (name === 'meta' && agent && agent.mac) {\n          if (down) {\n            metaFixMap = {};\n          } else {\n            for (var k in metaFixMap) {\n              if (k in charMap) handleKey(false, k, metaFixMap[k], event);\n            }\n\n            metaFixMap = null;\n          }\n        }\n      } else if (down && metaFixMap) {\n        metaFixMap[key] = character;\n      }\n\n      if (view) {\n        view._handleKeyEvent(down ? 'keydown' : 'keyup', event, key, character);\n      }\n    }\n\n    DomEvent.add(document, {\n      keydown: function keydown(event) {\n        var key = getKey(event),\n            agent = paper && paper.agent;\n\n        if (key.length > 1 || agent && agent.chrome && (event.altKey || agent.mac && event.metaKey || !agent.mac && event.ctrlKey)) {\n          handleKey(true, key, charLookup[key] || (key.length > 1 ? '' : key), event);\n        } else {\n          downKey = key;\n        }\n      },\n      keypress: function keypress(event) {\n        if (downKey) {\n          var key = getKey(event),\n              code = event.charCode,\n              character = code >= 32 ? String.fromCharCode(code) : key.length > 1 ? '' : key;\n\n          if (key !== downKey) {\n            key = character.toLowerCase();\n          }\n\n          handleKey(true, key, character, event);\n          downKey = null;\n        }\n      },\n      keyup: function keyup(event) {\n        var key = getKey(event);\n        if (key in charMap) handleKey(false, key, charMap[key], event);\n      }\n    });\n    DomEvent.add(window, {\n      blur: function blur(event) {\n        for (var key in charMap) {\n          handleKey(false, key, charMap[key], event);\n        }\n      }\n    });\n    return {\n      modifiers: modifiers,\n      isDown: function isDown(key) {\n        return !!keyMap[key];\n      }\n    };\n  }();\n  var MouseEvent = Event.extend({\n    _class: 'MouseEvent',\n    initialize: function MouseEvent(type, event, point, target, delta) {\n      this.type = type;\n      this.event = event;\n      this.point = point;\n      this.target = target;\n      this.delta = delta;\n    },\n    toString: function toString() {\n      return \"{ type: '\" + this.type + \"', point: \" + this.point + ', target: ' + this.target + (this.delta ? ', delta: ' + this.delta : '') + ', modifiers: ' + this.getModifiers() + ' }';\n    }\n  });\n  var ToolEvent = Event.extend({\n    _class: 'ToolEvent',\n    _item: null,\n    initialize: function ToolEvent(tool, type, event) {\n      this.tool = tool;\n      this.type = type;\n      this.event = event;\n    },\n    _choosePoint: function _choosePoint(point, toolPoint) {\n      return point ? point : toolPoint ? toolPoint.clone() : null;\n    },\n    getPoint: function getPoint() {\n      return this._choosePoint(this._point, this.tool._point);\n    },\n    setPoint: function setPoint(point) {\n      this._point = point;\n    },\n    getLastPoint: function getLastPoint() {\n      return this._choosePoint(this._lastPoint, this.tool._lastPoint);\n    },\n    setLastPoint: function setLastPoint(lastPoint) {\n      this._lastPoint = lastPoint;\n    },\n    getDownPoint: function getDownPoint() {\n      return this._choosePoint(this._downPoint, this.tool._downPoint);\n    },\n    setDownPoint: function setDownPoint(downPoint) {\n      this._downPoint = downPoint;\n    },\n    getMiddlePoint: function getMiddlePoint() {\n      if (!this._middlePoint && this.tool._lastPoint) {\n        return this.tool._point.add(this.tool._lastPoint).divide(2);\n      }\n\n      return this._middlePoint;\n    },\n    setMiddlePoint: function setMiddlePoint(middlePoint) {\n      this._middlePoint = middlePoint;\n    },\n    getDelta: function getDelta() {\n      return !this._delta && this.tool._lastPoint ? this.tool._point.subtract(this.tool._lastPoint) : this._delta;\n    },\n    setDelta: function setDelta(delta) {\n      this._delta = delta;\n    },\n    getCount: function getCount() {\n      return this.tool[/^mouse(down|up)$/.test(this.type) ? '_downCount' : '_moveCount'];\n    },\n    setCount: function setCount(count) {\n      this.tool[/^mouse(down|up)$/.test(this.type) ? 'downCount' : 'count'] = count;\n    },\n    getItem: function getItem() {\n      if (!this._item) {\n        var result = this.tool._scope.project.hitTest(this.getPoint());\n\n        if (result) {\n          var item = result.item,\n              parent = item._parent;\n\n          while (/^(Group|CompoundPath)$/.test(parent._class)) {\n            item = parent;\n            parent = parent._parent;\n          }\n\n          this._item = item;\n        }\n      }\n\n      return this._item;\n    },\n    setItem: function setItem(item) {\n      this._item = item;\n    },\n    toString: function toString() {\n      return '{ type: ' + this.type + ', point: ' + this.getPoint() + ', count: ' + this.getCount() + ', modifiers: ' + this.getModifiers() + ' }';\n    }\n  });\n  var Tool = PaperScopeItem.extend({\n    _class: 'Tool',\n    _list: 'tools',\n    _reference: 'tool',\n    _events: ['onMouseDown', 'onMouseUp', 'onMouseDrag', 'onMouseMove', 'onActivate', 'onDeactivate', 'onEditOptions', 'onKeyDown', 'onKeyUp'],\n    initialize: function Tool(props) {\n      PaperScopeItem.call(this);\n      this._moveCount = -1;\n      this._downCount = -1;\n      this.set(props);\n    },\n    getMinDistance: function getMinDistance() {\n      return this._minDistance;\n    },\n    setMinDistance: function setMinDistance(minDistance) {\n      this._minDistance = minDistance;\n\n      if (minDistance != null && this._maxDistance != null && minDistance > this._maxDistance) {\n        this._maxDistance = minDistance;\n      }\n    },\n    getMaxDistance: function getMaxDistance() {\n      return this._maxDistance;\n    },\n    setMaxDistance: function setMaxDistance(maxDistance) {\n      this._maxDistance = maxDistance;\n\n      if (this._minDistance != null && maxDistance != null && maxDistance < this._minDistance) {\n        this._minDistance = maxDistance;\n      }\n    },\n    getFixedDistance: function getFixedDistance() {\n      return this._minDistance == this._maxDistance ? this._minDistance : null;\n    },\n    setFixedDistance: function setFixedDistance(distance) {\n      this._minDistance = this._maxDistance = distance;\n    },\n    _handleMouseEvent: function _handleMouseEvent(type, event, point, mouse) {\n      paper = this._scope;\n      if (mouse.drag && !this.responds(type)) type = 'mousemove';\n      var move = mouse.move || mouse.drag,\n          responds = this.responds(type),\n          minDistance = this.minDistance,\n          maxDistance = this.maxDistance,\n          called = false,\n          tool = this;\n\n      function update(minDistance, maxDistance) {\n        var pt = point,\n            toolPoint = move ? tool._point : tool._downPoint || pt;\n\n        if (move) {\n          if (tool._moveCount >= 0 && pt.equals(toolPoint)) {\n            return false;\n          }\n\n          if (toolPoint && (minDistance != null || maxDistance != null)) {\n            var vector = pt.subtract(toolPoint),\n                distance = vector.getLength();\n            if (distance < (minDistance || 0)) return false;\n\n            if (maxDistance) {\n              pt = toolPoint.add(vector.normalize(Math.min(distance, maxDistance)));\n            }\n          }\n\n          tool._moveCount++;\n        }\n\n        tool._point = pt;\n        tool._lastPoint = toolPoint || pt;\n\n        if (mouse.down) {\n          tool._moveCount = -1;\n          tool._downPoint = pt;\n          tool._downCount++;\n        }\n\n        return true;\n      }\n\n      function emit() {\n        if (responds) {\n          called = tool.emit(type, new ToolEvent(tool, type, event)) || called;\n        }\n      }\n\n      if (mouse.down) {\n        update();\n        emit();\n      } else if (mouse.up) {\n        update(null, maxDistance);\n        emit();\n      } else if (responds) {\n        while (update(minDistance, maxDistance)) {\n          emit();\n        }\n      }\n\n      return called;\n    }\n  });\n  var Tween = Base.extend(Emitter, {\n    _class: 'Tween',\n    statics: {\n      easings: {\n        linear: function linear(t) {\n          return t;\n        },\n        easeInQuad: function easeInQuad(t) {\n          return t * t;\n        },\n        easeOutQuad: function easeOutQuad(t) {\n          return t * (2 - t);\n        },\n        easeInOutQuad: function easeInOutQuad(t) {\n          return t < 0.5 ? 2 * t * t : -1 + 2 * (2 - t) * t;\n        },\n        easeInCubic: function easeInCubic(t) {\n          return t * t * t;\n        },\n        easeOutCubic: function easeOutCubic(t) {\n          return --t * t * t + 1;\n        },\n        easeInOutCubic: function easeInOutCubic(t) {\n          return t < 0.5 ? 4 * t * t * t : (t - 1) * (2 * t - 2) * (2 * t - 2) + 1;\n        },\n        easeInQuart: function easeInQuart(t) {\n          return t * t * t * t;\n        },\n        easeOutQuart: function easeOutQuart(t) {\n          return 1 - --t * t * t * t;\n        },\n        easeInOutQuart: function easeInOutQuart(t) {\n          return t < 0.5 ? 8 * t * t * t * t : 1 - 8 * --t * t * t * t;\n        },\n        easeInQuint: function easeInQuint(t) {\n          return t * t * t * t * t;\n        },\n        easeOutQuint: function easeOutQuint(t) {\n          return 1 + --t * t * t * t * t;\n        },\n        easeInOutQuint: function easeInOutQuint(t) {\n          return t < 0.5 ? 16 * t * t * t * t * t : 1 + 16 * --t * t * t * t * t;\n        }\n      }\n    },\n    initialize: function Tween(object, from, to, duration, easing, start) {\n      this.object = object;\n\n      var type = _typeof(easing);\n\n      var isFunction = type === 'function';\n      this.type = isFunction ? type : type === 'string' ? easing : 'linear';\n      this.easing = isFunction ? easing : Tween.easings[this.type];\n      this.duration = duration;\n      this.running = false;\n      this._then = null;\n      this._startTime = null;\n      var state = from || to;\n      this._keys = state ? _Object$keys(state) : [];\n      this._parsedKeys = this._parseKeys(this._keys);\n      this._from = state && this._getState(from);\n      this._to = state && this._getState(to);\n\n      if (start !== false) {\n        this.start();\n      }\n    },\n    then: function then(_then) {\n      this._then = _then;\n      return this;\n    },\n    start: function start() {\n      this._startTime = null;\n      this.running = true;\n      return this;\n    },\n    stop: function stop() {\n      this.running = false;\n      return this;\n    },\n    update: function update(progress) {\n      if (this.running) {\n        if (progress > 1) {\n          progress = 1;\n          this.running = false;\n        }\n\n        var factor = this.easing(progress),\n            keys = this._keys,\n            getValue = function getValue(value) {\n          return typeof value === 'function' ? value(factor, progress) : value;\n        };\n\n        for (var i = 0, l = keys && keys.length; i < l; i++) {\n          var key = keys[i],\n              from = getValue(this._from[key]),\n              to = getValue(this._to[key]),\n              value = from && to && from.__add && to.__add ? to.__subtract(from).__multiply(factor).__add(from) : (to - from) * factor + from;\n\n          this._setProperty(this._parsedKeys[key], value);\n        }\n\n        if (!this.running && this._then) {\n          this._then(this.object);\n        }\n\n        if (this.responds('update')) {\n          this.emit('update', new Base({\n            progress: progress,\n            factor: factor\n          }));\n        }\n      }\n\n      return this;\n    },\n    _events: {\n      onUpdate: {}\n    },\n    _handleFrame: function _handleFrame(time) {\n      var startTime = this._startTime,\n          progress = startTime ? (time - startTime) / this.duration : 0;\n\n      if (!startTime) {\n        this._startTime = time;\n      }\n\n      this.update(progress);\n    },\n    _getState: function _getState(state) {\n      var keys = this._keys,\n          result = {};\n\n      for (var i = 0, l = keys.length; i < l; i++) {\n        var key = keys[i],\n            path = this._parsedKeys[key],\n            current = this._getProperty(path),\n            value;\n\n        if (state) {\n          var resolved = this._resolveValue(current, state[key]);\n\n          this._setProperty(path, resolved);\n\n          value = this._getProperty(path);\n          value = value && value.clone ? value.clone() : value;\n\n          this._setProperty(path, current);\n        } else {\n          value = current && current.clone ? current.clone() : current;\n        }\n\n        result[key] = value;\n      }\n\n      return result;\n    },\n    _resolveValue: function _resolveValue(current, value) {\n      if (value) {\n        if (_Array$isArray(value) && value.length === 2) {\n          var operator = value[0];\n          return operator && operator.match && operator.match(/^[+\\-*/]=/) ? this._calculate(current, operator[0], value[1]) : value;\n        } else if (typeof value === 'string') {\n          var match = value.match(/^[+\\-*/]=(.*)/);\n\n          if (match) {\n            var parsed = JSON.parse(match[1].replace(/(['\"])?([a-zA-Z0-9_]+)(['\"])?:/g, '\"$2\": '));\n            return this._calculate(current, value[0], parsed);\n          }\n        }\n      }\n\n      return value;\n    },\n    _calculate: function _calculate(left, operator, right) {\n      return paper.PaperScript.calculateBinary(left, operator, right);\n    },\n    _parseKeys: function _parseKeys(keys) {\n      var parsed = {};\n\n      for (var i = 0, l = keys.length; i < l; i++) {\n        var key = keys[i],\n            path = key.replace(/\\.([^.]*)/g, '/$1').replace(/\\[['\"]?([^'\"\\]]*)['\"]?\\]/g, '/$1');\n        parsed[key] = path.split('/');\n      }\n\n      return parsed;\n    },\n    _getProperty: function _getProperty(path, offset) {\n      var obj = this.object;\n\n      for (var i = 0, l = path.length - (offset || 0); i < l && obj; i++) {\n        obj = obj[path[i]];\n      }\n\n      return obj;\n    },\n    _setProperty: function _setProperty(path, value) {\n      var dest = this._getProperty(path, 1);\n\n      if (dest) {\n        dest[path[path.length - 1]] = value;\n      }\n    }\n  });\n  var Http = {\n    request: function request(options) {\n      var xhr = new self.XMLHttpRequest();\n      xhr.open((options.method || 'get').toUpperCase(), options.url, Base.pick(options.async, true));\n      if (options.mimeType) xhr.overrideMimeType(options.mimeType);\n\n      xhr.onload = function () {\n        var status = xhr.status;\n\n        if (status === 0 || status === 200) {\n          if (options.onLoad) {\n            options.onLoad.call(xhr, xhr.responseText);\n          }\n        } else {\n          xhr.onerror();\n        }\n      };\n\n      xhr.onerror = function () {\n        var status = xhr.status,\n            message = 'Could not load \"' + options.url + '\" (Status: ' + status + ')';\n\n        if (options.onError) {\n          options.onError(message, status);\n        } else {\n          throw new Error(message);\n        }\n      };\n\n      return xhr.send(null);\n    }\n  };\n  var CanvasProvider = {\n    canvases: [],\n    getCanvas: function getCanvas(width, height) {\n      if (!window) return null;\n      var canvas,\n          clear = true;\n\n      if (_typeof(width) === 'object') {\n        height = width.height;\n        width = width.width;\n      }\n\n      if (this.canvases.length) {\n        canvas = this.canvases.pop();\n      } else {\n        canvas = document.createElement('canvas');\n        clear = false;\n      }\n\n      var ctx = canvas.getContext('2d');\n\n      if (!ctx) {\n        throw new Error('Canvas ' + canvas + ' is unable to provide a 2D context.');\n      }\n\n      if (canvas.width === width && canvas.height === height) {\n        if (clear) ctx.clearRect(0, 0, width + 1, height + 1);\n      } else {\n        canvas.width = width;\n        canvas.height = height;\n      }\n\n      ctx.save();\n      return canvas;\n    },\n    getContext: function getContext(width, height) {\n      var canvas = this.getCanvas(width, height);\n      return canvas ? canvas.getContext('2d') : null;\n    },\n    release: function release(obj) {\n      var canvas = obj && obj.canvas ? obj.canvas : obj;\n\n      if (canvas && canvas.getContext) {\n        canvas.getContext('2d').restore();\n        this.canvases.push(canvas);\n      }\n    }\n  };\n  var BlendMode = new function () {\n    var min = Math.min,\n        max = Math.max,\n        abs = Math.abs,\n        sr,\n        sg,\n        sb,\n        sa,\n        br,\n        bg,\n        bb,\n        ba,\n        dr,\n        dg,\n        db;\n\n    function getLum(r, g, b) {\n      return 0.2989 * r + 0.587 * g + 0.114 * b;\n    }\n\n    function setLum(r, g, b, l) {\n      var d = l - getLum(r, g, b);\n      dr = r + d;\n      dg = g + d;\n      db = b + d;\n      var l = getLum(dr, dg, db),\n          mn = min(dr, dg, db),\n          mx = max(dr, dg, db);\n\n      if (mn < 0) {\n        var lmn = l - mn;\n        dr = l + (dr - l) * l / lmn;\n        dg = l + (dg - l) * l / lmn;\n        db = l + (db - l) * l / lmn;\n      }\n\n      if (mx > 255) {\n        var ln = 255 - l,\n            mxl = mx - l;\n        dr = l + (dr - l) * ln / mxl;\n        dg = l + (dg - l) * ln / mxl;\n        db = l + (db - l) * ln / mxl;\n      }\n    }\n\n    function getSat(r, g, b) {\n      return max(r, g, b) - min(r, g, b);\n    }\n\n    function setSat(r, g, b, s) {\n      var col = [r, g, b],\n          mx = max(r, g, b),\n          mn = min(r, g, b),\n          md;\n      mn = mn === r ? 0 : mn === g ? 1 : 2;\n      mx = mx === r ? 0 : mx === g ? 1 : 2;\n      md = min(mn, mx) === 0 ? max(mn, mx) === 1 ? 2 : 1 : 0;\n\n      if (col[mx] > col[mn]) {\n        col[md] = (col[md] - col[mn]) * s / (col[mx] - col[mn]);\n        col[mx] = s;\n      } else {\n        col[md] = col[mx] = 0;\n      }\n\n      col[mn] = 0;\n      dr = col[0];\n      dg = col[1];\n      db = col[2];\n    }\n\n    var modes = {\n      multiply: function multiply() {\n        dr = br * sr / 255;\n        dg = bg * sg / 255;\n        db = bb * sb / 255;\n      },\n      screen: function screen() {\n        dr = br + sr - br * sr / 255;\n        dg = bg + sg - bg * sg / 255;\n        db = bb + sb - bb * sb / 255;\n      },\n      overlay: function overlay() {\n        dr = br < 128 ? 2 * br * sr / 255 : 255 - 2 * (255 - br) * (255 - sr) / 255;\n        dg = bg < 128 ? 2 * bg * sg / 255 : 255 - 2 * (255 - bg) * (255 - sg) / 255;\n        db = bb < 128 ? 2 * bb * sb / 255 : 255 - 2 * (255 - bb) * (255 - sb) / 255;\n      },\n      'soft-light': function softLight() {\n        var t = sr * br / 255;\n        dr = t + br * (255 - (255 - br) * (255 - sr) / 255 - t) / 255;\n        t = sg * bg / 255;\n        dg = t + bg * (255 - (255 - bg) * (255 - sg) / 255 - t) / 255;\n        t = sb * bb / 255;\n        db = t + bb * (255 - (255 - bb) * (255 - sb) / 255 - t) / 255;\n      },\n      'hard-light': function hardLight() {\n        dr = sr < 128 ? 2 * sr * br / 255 : 255 - 2 * (255 - sr) * (255 - br) / 255;\n        dg = sg < 128 ? 2 * sg * bg / 255 : 255 - 2 * (255 - sg) * (255 - bg) / 255;\n        db = sb < 128 ? 2 * sb * bb / 255 : 255 - 2 * (255 - sb) * (255 - bb) / 255;\n      },\n      'color-dodge': function colorDodge() {\n        dr = br === 0 ? 0 : sr === 255 ? 255 : min(255, 255 * br / (255 - sr));\n        dg = bg === 0 ? 0 : sg === 255 ? 255 : min(255, 255 * bg / (255 - sg));\n        db = bb === 0 ? 0 : sb === 255 ? 255 : min(255, 255 * bb / (255 - sb));\n      },\n      'color-burn': function colorBurn() {\n        dr = br === 255 ? 255 : sr === 0 ? 0 : max(0, 255 - (255 - br) * 255 / sr);\n        dg = bg === 255 ? 255 : sg === 0 ? 0 : max(0, 255 - (255 - bg) * 255 / sg);\n        db = bb === 255 ? 255 : sb === 0 ? 0 : max(0, 255 - (255 - bb) * 255 / sb);\n      },\n      darken: function darken() {\n        dr = br < sr ? br : sr;\n        dg = bg < sg ? bg : sg;\n        db = bb < sb ? bb : sb;\n      },\n      lighten: function lighten() {\n        dr = br > sr ? br : sr;\n        dg = bg > sg ? bg : sg;\n        db = bb > sb ? bb : sb;\n      },\n      difference: function difference() {\n        dr = br - sr;\n        if (dr < 0) dr = -dr;\n        dg = bg - sg;\n        if (dg < 0) dg = -dg;\n        db = bb - sb;\n        if (db < 0) db = -db;\n      },\n      exclusion: function exclusion() {\n        dr = br + sr * (255 - br - br) / 255;\n        dg = bg + sg * (255 - bg - bg) / 255;\n        db = bb + sb * (255 - bb - bb) / 255;\n      },\n      hue: function hue() {\n        setSat(sr, sg, sb, getSat(br, bg, bb));\n        setLum(dr, dg, db, getLum(br, bg, bb));\n      },\n      saturation: function saturation() {\n        setSat(br, bg, bb, getSat(sr, sg, sb));\n        setLum(dr, dg, db, getLum(br, bg, bb));\n      },\n      luminosity: function luminosity() {\n        setLum(br, bg, bb, getLum(sr, sg, sb));\n      },\n      color: function color() {\n        setLum(sr, sg, sb, getLum(br, bg, bb));\n      },\n      add: function add() {\n        dr = min(br + sr, 255);\n        dg = min(bg + sg, 255);\n        db = min(bb + sb, 255);\n      },\n      subtract: function subtract() {\n        dr = max(br - sr, 0);\n        dg = max(bg - sg, 0);\n        db = max(bb - sb, 0);\n      },\n      average: function average() {\n        dr = (br + sr) / 2;\n        dg = (bg + sg) / 2;\n        db = (bb + sb) / 2;\n      },\n      negation: function negation() {\n        dr = 255 - abs(255 - sr - br);\n        dg = 255 - abs(255 - sg - bg);\n        db = 255 - abs(255 - sb - bb);\n      }\n    };\n    var nativeModes = this.nativeModes = Base.each(['source-over', 'source-in', 'source-out', 'source-atop', 'destination-over', 'destination-in', 'destination-out', 'destination-atop', 'lighter', 'darker', 'copy', 'xor'], function (mode) {\n      this[mode] = true;\n    }, {});\n    var ctx = CanvasProvider.getContext(1, 1);\n\n    if (ctx) {\n      Base.each(modes, function (func, mode) {\n        var darken = mode === 'darken',\n            ok = false;\n        ctx.save();\n\n        try {\n          ctx.fillStyle = darken ? '#300' : '#a00';\n          ctx.fillRect(0, 0, 1, 1);\n          ctx.globalCompositeOperation = mode;\n\n          if (ctx.globalCompositeOperation === mode) {\n            ctx.fillStyle = darken ? '#a00' : '#300';\n            ctx.fillRect(0, 0, 1, 1);\n            ok = ctx.getImageData(0, 0, 1, 1).data[0] !== darken ? 170 : 51;\n          }\n        } catch (e) {}\n\n        ctx.restore();\n        nativeModes[mode] = ok;\n      });\n      CanvasProvider.release(ctx);\n    }\n\n    this.process = function (mode, srcContext, dstContext, alpha, offset) {\n      var srcCanvas = srcContext.canvas,\n          normal = mode === 'normal';\n\n      if (normal || nativeModes[mode]) {\n        dstContext.save();\n        dstContext.setTransform(1, 0, 0, 1, 0, 0);\n        dstContext.globalAlpha = alpha;\n        if (!normal) dstContext.globalCompositeOperation = mode;\n        dstContext.drawImage(srcCanvas, offset.x, offset.y);\n        dstContext.restore();\n      } else {\n        var process = modes[mode];\n        if (!process) return;\n        var dstData = dstContext.getImageData(offset.x, offset.y, srcCanvas.width, srcCanvas.height),\n            dst = dstData.data,\n            src = srcContext.getImageData(0, 0, srcCanvas.width, srcCanvas.height).data;\n\n        for (var i = 0, l = dst.length; i < l; i += 4) {\n          sr = src[i];\n          br = dst[i];\n          sg = src[i + 1];\n          bg = dst[i + 1];\n          sb = src[i + 2];\n          bb = dst[i + 2];\n          sa = src[i + 3];\n          ba = dst[i + 3];\n          process();\n          var a1 = sa * alpha / 255,\n              a2 = 1 - a1;\n          dst[i] = a1 * dr + a2 * br;\n          dst[i + 1] = a1 * dg + a2 * bg;\n          dst[i + 2] = a1 * db + a2 * bb;\n          dst[i + 3] = sa * alpha + a2 * ba;\n        }\n\n        dstContext.putImageData(dstData, offset.x, offset.y);\n      }\n    };\n  }();\n  var SvgElement = new function () {\n    var svg = 'http://www.w3.org/2000/svg',\n        xmlns = 'http://www.w3.org/2000/xmlns',\n        xlink = 'http://www.w3.org/1999/xlink',\n        attributeNamespace = {\n      href: xlink,\n      xlink: xmlns,\n      xmlns: xmlns + '/',\n      'xmlns:xlink': xmlns + '/'\n    };\n\n    function create(tag, attributes, formatter) {\n      return set(document.createElementNS(svg, tag), attributes, formatter);\n    }\n\n    function get(node, name) {\n      var namespace = attributeNamespace[name],\n          value = namespace ? node.getAttributeNS(namespace, name) : node.getAttribute(name);\n      return value === 'null' ? null : value;\n    }\n\n    function set(node, attributes, formatter) {\n      for (var name in attributes) {\n        var value = attributes[name],\n            namespace = attributeNamespace[name];\n        if (typeof value === 'number' && formatter) value = formatter.number(value);\n\n        if (namespace) {\n          node.setAttributeNS(namespace, name, value);\n        } else {\n          node.setAttribute(name, value);\n        }\n      }\n\n      return node;\n    }\n\n    return {\n      svg: svg,\n      xmlns: xmlns,\n      xlink: xlink,\n      create: create,\n      get: get,\n      set: set\n    };\n  }();\n  var SvgStyles = Base.each({\n    fillColor: ['fill', 'color'],\n    fillRule: ['fill-rule', 'string'],\n    strokeColor: ['stroke', 'color'],\n    strokeWidth: ['stroke-width', 'number'],\n    strokeCap: ['stroke-linecap', 'string'],\n    strokeJoin: ['stroke-linejoin', 'string'],\n    strokeScaling: ['vector-effect', 'lookup', {\n      true: 'none',\n      false: 'non-scaling-stroke'\n    }, function (item, value) {\n      return !value && (item instanceof PathItem || item instanceof Shape || item instanceof TextItem);\n    }],\n    miterLimit: ['stroke-miterlimit', 'number'],\n    dashArray: ['stroke-dasharray', 'array'],\n    dashOffset: ['stroke-dashoffset', 'number'],\n    fontFamily: ['font-family', 'string'],\n    fontWeight: ['font-weight', 'string'],\n    fontSize: ['font-size', 'number'],\n    justification: ['text-anchor', 'lookup', {\n      left: 'start',\n      center: 'middle',\n      right: 'end'\n    }],\n    opacity: ['opacity', 'number'],\n    blendMode: ['mix-blend-mode', 'style']\n  }, function (entry, key) {\n    var part = Base.capitalize(key),\n        lookup = entry[2];\n    this[key] = {\n      type: entry[1],\n      property: key,\n      attribute: entry[0],\n      toSVG: lookup,\n      fromSVG: lookup && Base.each(lookup, function (value, name) {\n        this[value] = name;\n      }, {}),\n      exportFilter: entry[3],\n      get: 'get' + part,\n      set: 'set' + part\n    };\n  }, {});\n  new function () {\n    var formatter;\n\n    function getTransform(matrix, coordinates, center) {\n      var attrs = new Base(),\n          trans = matrix.getTranslation();\n\n      if (coordinates) {\n        matrix = matrix._shiftless();\n\n        var point = matrix._inverseTransform(trans);\n\n        attrs[center ? 'cx' : 'x'] = point.x;\n        attrs[center ? 'cy' : 'y'] = point.y;\n        trans = null;\n      }\n\n      if (!matrix.isIdentity()) {\n        var decomposed = matrix.decompose();\n\n        if (decomposed) {\n          var parts = [],\n              angle = decomposed.rotation,\n              scale = decomposed.scaling,\n              skew = decomposed.skewing;\n          if (trans && !trans.isZero()) parts.push('translate(' + formatter.point(trans) + ')');\n          if (angle) parts.push('rotate(' + formatter.number(angle) + ')');\n          if (!Numerical.isZero(scale.x - 1) || !Numerical.isZero(scale.y - 1)) parts.push('scale(' + formatter.point(scale) + ')');\n          if (skew.x) parts.push('skewX(' + formatter.number(skew.x) + ')');\n          if (skew.y) parts.push('skewY(' + formatter.number(skew.y) + ')');\n          attrs.transform = parts.join(' ');\n        } else {\n          attrs.transform = 'matrix(' + matrix.getValues().join(',') + ')';\n        }\n      }\n\n      return attrs;\n    }\n\n    function exportGroup(item, options) {\n      var attrs = getTransform(item._matrix),\n          children = item._children;\n      var node = SvgElement.create('g', attrs, formatter);\n\n      for (var i = 0, l = children.length; i < l; i++) {\n        var child = children[i];\n\n        var childNode = _exportSVG(child, options);\n\n        if (childNode) {\n          if (child.isClipMask()) {\n            var clip = SvgElement.create('clipPath');\n            clip.appendChild(childNode);\n            setDefinition(child, clip, 'clip');\n            SvgElement.set(node, {\n              'clip-path': 'url(#' + clip.id + ')'\n            });\n          } else {\n            node.appendChild(childNode);\n          }\n        }\n      }\n\n      return node;\n    }\n\n    function exportRaster(item, options) {\n      var attrs = getTransform(item._matrix, true),\n          size = item.getSize(),\n          image = item.getImage();\n      attrs.x -= size.width / 2;\n      attrs.y -= size.height / 2;\n      attrs.width = size.width;\n      attrs.height = size.height;\n      attrs.href = options.embedImages == false && image && image.src || item.toDataURL();\n      return SvgElement.create('image', attrs, formatter);\n    }\n\n    function exportPath(item, options) {\n      var matchShapes = options.matchShapes;\n\n      if (matchShapes) {\n        var shape = item.toShape(false);\n        if (shape) return exportShape(shape, options);\n      }\n\n      var segments = item._segments,\n          length = segments.length,\n          type,\n          attrs = getTransform(item._matrix);\n\n      if (matchShapes && length >= 2 && !item.hasHandles()) {\n        if (length > 2) {\n          type = item._closed ? 'polygon' : 'polyline';\n          var parts = [];\n\n          for (var i = 0; i < length; i++) {\n            parts.push(formatter.point(segments[i]._point));\n          }\n\n          attrs.points = parts.join(' ');\n        } else {\n          type = 'line';\n          var start = segments[0]._point,\n              end = segments[1]._point;\n          attrs.set({\n            x1: start.x,\n            y1: start.y,\n            x2: end.x,\n            y2: end.y\n          });\n        }\n      } else {\n        type = 'path';\n        attrs.d = item.getPathData(null, options.precision);\n      }\n\n      return SvgElement.create(type, attrs, formatter);\n    }\n\n    function exportShape(item) {\n      var type = item._type,\n          radius = item._radius,\n          attrs = getTransform(item._matrix, true, type !== 'rectangle');\n\n      if (type === 'rectangle') {\n        type = 'rect';\n        var size = item._size,\n            width = size.width,\n            height = size.height;\n        attrs.x -= width / 2;\n        attrs.y -= height / 2;\n        attrs.width = width;\n        attrs.height = height;\n        if (radius.isZero()) radius = null;\n      }\n\n      if (radius) {\n        if (type === 'circle') {\n          attrs.r = radius;\n        } else {\n          attrs.rx = radius.width;\n          attrs.ry = radius.height;\n        }\n      }\n\n      return SvgElement.create(type, attrs, formatter);\n    }\n\n    function exportCompoundPath(item, options) {\n      var attrs = getTransform(item._matrix);\n      var data = item.getPathData(null, options.precision);\n      if (data) attrs.d = data;\n      return SvgElement.create('path', attrs, formatter);\n    }\n\n    function exportSymbolItem(item, options) {\n      var attrs = getTransform(item._matrix, true),\n          definition = item._definition,\n          node = getDefinition(definition, 'symbol'),\n          definitionItem = definition._item,\n          bounds = definitionItem.getBounds();\n\n      if (!node) {\n        node = SvgElement.create('symbol', {\n          viewBox: formatter.rectangle(bounds)\n        });\n        node.appendChild(_exportSVG(definitionItem, options));\n        setDefinition(definition, node, 'symbol');\n      }\n\n      attrs.href = '#' + node.id;\n      attrs.x += bounds.x;\n      attrs.y += bounds.y;\n      attrs.width = bounds.width;\n      attrs.height = bounds.height;\n      attrs.overflow = 'visible';\n      return SvgElement.create('use', attrs, formatter);\n    }\n\n    function exportGradient(color) {\n      var gradientNode = getDefinition(color, 'color');\n\n      if (!gradientNode) {\n        var gradient = color.getGradient(),\n            radial = gradient._radial,\n            origin = color.getOrigin(),\n            destination = color.getDestination(),\n            attrs;\n\n        if (radial) {\n          attrs = {\n            cx: origin.x,\n            cy: origin.y,\n            r: origin.getDistance(destination)\n          };\n          var highlight = color.getHighlight();\n\n          if (highlight) {\n            attrs.fx = highlight.x;\n            attrs.fy = highlight.y;\n          }\n        } else {\n          attrs = {\n            x1: origin.x,\n            y1: origin.y,\n            x2: destination.x,\n            y2: destination.y\n          };\n        }\n\n        attrs.gradientUnits = 'userSpaceOnUse';\n        gradientNode = SvgElement.create((radial ? 'radial' : 'linear') + 'Gradient', attrs, formatter);\n        var stops = gradient._stops;\n\n        for (var i = 0, l = stops.length; i < l; i++) {\n          var stop = stops[i],\n              stopColor = stop._color,\n              alpha = stopColor.getAlpha(),\n              offset = stop._offset;\n          attrs = {\n            offset: offset == null ? i / (l - 1) : offset\n          };\n          if (stopColor) attrs['stop-color'] = stopColor.toCSS(true);\n          if (alpha < 1) attrs['stop-opacity'] = alpha;\n          gradientNode.appendChild(SvgElement.create('stop', attrs, formatter));\n        }\n\n        setDefinition(color, gradientNode, 'color');\n      }\n\n      return 'url(#' + gradientNode.id + ')';\n    }\n\n    function exportText(item) {\n      var node = SvgElement.create('text', getTransform(item._matrix, true), formatter);\n      node.textContent = item._content;\n      return node;\n    }\n\n    var exporters = {\n      Group: exportGroup,\n      Layer: exportGroup,\n      Raster: exportRaster,\n      Path: exportPath,\n      Shape: exportShape,\n      CompoundPath: exportCompoundPath,\n      SymbolItem: exportSymbolItem,\n      PointText: exportText\n    };\n\n    function applyStyle(item, node, isRoot) {\n      var attrs = {},\n          parent = !isRoot && item.getParent(),\n          style = [];\n      if (item._name != null) attrs.id = item._name;\n      Base.each(SvgStyles, function (entry) {\n        var get = entry.get,\n            type = entry.type,\n            value = item[get]();\n\n        if (entry.exportFilter ? entry.exportFilter(item, value) : !parent || !Base.equals(parent[get](), value)) {\n          if (type === 'color' && value != null) {\n            var alpha = value.getAlpha();\n            if (alpha < 1) attrs[entry.attribute + '-opacity'] = alpha;\n          }\n\n          if (type === 'style') {\n            style.push(entry.attribute + ': ' + value);\n          } else {\n            attrs[entry.attribute] = value == null ? 'none' : type === 'color' ? value.gradient ? exportGradient(value, item) : value.toCSS(true) : type === 'array' ? value.join(',') : type === 'lookup' ? entry.toSVG[value] : value;\n          }\n        }\n      });\n      if (style.length) attrs.style = style.join(';');\n      if (attrs.opacity === 1) delete attrs.opacity;\n      if (!item._visible) attrs.visibility = 'hidden';\n      return SvgElement.set(node, attrs, formatter);\n    }\n\n    var definitions;\n\n    function getDefinition(item, type) {\n      if (!definitions) definitions = {\n        ids: {},\n        svgs: {}\n      };\n      return item && definitions.svgs[type + '-' + (item._id || item.__id || (item.__id = UID.get('svg')))];\n    }\n\n    function setDefinition(item, node, type) {\n      if (!definitions) getDefinition();\n      var typeId = definitions.ids[type] = (definitions.ids[type] || 0) + 1;\n      node.id = type + '-' + typeId;\n      definitions.svgs[type + '-' + (item._id || item.__id)] = node;\n    }\n\n    function exportDefinitions(node, options) {\n      var svg = node,\n          defs = null;\n\n      if (definitions) {\n        svg = node.nodeName.toLowerCase() === 'svg' && node;\n\n        for (var i in definitions.svgs) {\n          if (!defs) {\n            if (!svg) {\n              svg = SvgElement.create('svg');\n              svg.appendChild(node);\n            }\n\n            defs = svg.insertBefore(SvgElement.create('defs'), svg.firstChild);\n          }\n\n          defs.appendChild(definitions.svgs[i]);\n        }\n\n        definitions = null;\n      }\n\n      return options.asString ? new self.XMLSerializer().serializeToString(svg) : svg;\n    }\n\n    function _exportSVG(item, options, isRoot) {\n      var exporter = exporters[item._class],\n          node = exporter && exporter(item, options);\n\n      if (node) {\n        var onExport = options.onExport;\n        if (onExport) node = onExport(item, node, options) || node;\n\n        var data = _JSON$stringify(item._data);\n\n        if (data && data !== '{}' && data !== 'null') node.setAttribute('data-paper-data', data);\n      }\n\n      return node && applyStyle(item, node, isRoot);\n    }\n\n    function setOptions(options) {\n      if (!options) options = {};\n      formatter = new Formatter(options.precision);\n      return options;\n    }\n\n    Item.inject({\n      exportSVG: function exportSVG(options) {\n        options = setOptions(options);\n        return exportDefinitions(_exportSVG(this, options, true), options);\n      }\n    });\n    Project.inject({\n      exportSVG: function exportSVG(options) {\n        options = setOptions(options);\n        var children = this._children,\n            view = this.getView(),\n            bounds = Base.pick(options.bounds, 'view'),\n            mx = options.matrix || bounds === 'view' && view._matrix,\n            matrix = mx && Matrix.read([mx]),\n            rect = bounds === 'view' ? new _Rectangle([0, 0], view.getViewSize()) : bounds === 'content' ? Item._getBounds(children, matrix, {\n          stroke: true\n        }).rect : _Rectangle.read([bounds], 0, {\n          readNull: true\n        }),\n            attrs = {\n          version: '1.1',\n          xmlns: SvgElement.svg,\n          'xmlns:xlink': SvgElement.xlink\n        };\n\n        if (rect) {\n          attrs.width = rect.width;\n          attrs.height = rect.height;\n          if (rect.x || rect.y) attrs.viewBox = formatter.rectangle(rect);\n        }\n\n        var node = SvgElement.create('svg', attrs, formatter),\n            parent = node;\n\n        if (matrix && !matrix.isIdentity()) {\n          parent = node.appendChild(SvgElement.create('g', getTransform(matrix), formatter));\n        }\n\n        for (var i = 0, l = children.length; i < l; i++) {\n          parent.appendChild(_exportSVG(children[i], options, true));\n        }\n\n        return exportDefinitions(node, options);\n      }\n    });\n  }();\n  new function () {\n    var definitions = {},\n        rootSize;\n\n    function getValue(node, name, isString, allowNull, allowPercent) {\n      var value = SvgElement.get(node, name),\n          res = value == null ? allowNull ? null : isString ? '' : 0 : isString ? value : _parseFloat(value);\n      return /%\\s*$/.test(value) ? res / 100 * (allowPercent ? 1 : rootSize[/x|^width/.test(name) ? 'width' : 'height']) : res;\n    }\n\n    function getPoint(node, x, y, allowNull, allowPercent) {\n      x = getValue(node, x || 'x', false, allowNull, allowPercent);\n      y = getValue(node, y || 'y', false, allowNull, allowPercent);\n      return allowNull && (x == null || y == null) ? null : new Point(x, y);\n    }\n\n    function getSize(node, w, h, allowNull, allowPercent) {\n      w = getValue(node, w || 'width', false, allowNull, allowPercent);\n      h = getValue(node, h || 'height', false, allowNull, allowPercent);\n      return allowNull && (w == null || h == null) ? null : new Size(w, h);\n    }\n\n    function convertValue(value, type, lookup) {\n      return value === 'none' ? null : type === 'number' ? _parseFloat(value) : type === 'array' ? value ? value.split(/[\\s,]+/g).map(_parseFloat) : [] : type === 'color' ? getDefinition(value) || value : type === 'lookup' ? lookup[value] : value;\n    }\n\n    function importGroup(node, type, options, isRoot) {\n      var nodes = node.childNodes,\n          isClip = type === 'clippath',\n          isDefs = type === 'defs',\n          item = new Group(),\n          project = item._project,\n          currentStyle = project._currentStyle,\n          children = [];\n\n      if (!isClip && !isDefs) {\n        item = applyAttributes(item, node, isRoot);\n        project._currentStyle = item._style.clone();\n      }\n\n      if (isRoot) {\n        var defs = node.querySelectorAll('defs');\n\n        for (var i = 0, l = defs.length; i < l; i++) {\n          importNode(defs[i], options, false);\n        }\n      }\n\n      for (var i = 0, l = nodes.length; i < l; i++) {\n        var childNode = nodes[i],\n            child;\n        if (childNode.nodeType === 1 && !/^defs$/i.test(childNode.nodeName) && (child = importNode(childNode, options, false)) && !(child instanceof SymbolDefinition)) children.push(child);\n      }\n\n      item.addChildren(children);\n      if (isClip) item = applyAttributes(item.reduce(), node, isRoot);\n      project._currentStyle = currentStyle;\n\n      if (isClip || isDefs) {\n        item.remove();\n        item = null;\n      }\n\n      return item;\n    }\n\n    function importPoly(node, type) {\n      var coords = node.getAttribute('points').match(/[+-]?(?:\\d*\\.\\d+|\\d+\\.?)(?:[eE][+-]?\\d+)?/g),\n          points = [];\n\n      for (var i = 0, l = coords.length; i < l; i += 2) {\n        points.push(new Point(_parseFloat(coords[i]), _parseFloat(coords[i + 1])));\n      }\n\n      var path = new Path(points);\n      if (type === 'polygon') path.closePath();\n      return path;\n    }\n\n    function importPath(node) {\n      return PathItem.create(node.getAttribute('d'));\n    }\n\n    function importGradient(node, type) {\n      var id = (getValue(node, 'href', true) || '').substring(1),\n          radial = type === 'radialgradient',\n          gradient;\n\n      if (id) {\n        gradient = definitions[id].getGradient();\n\n        if (gradient._radial ^ radial) {\n          gradient = gradient.clone();\n          gradient._radial = radial;\n        }\n      } else {\n        var nodes = node.childNodes,\n            stops = [];\n\n        for (var i = 0, l = nodes.length; i < l; i++) {\n          var child = nodes[i];\n          if (child.nodeType === 1) stops.push(applyAttributes(new GradientStop(), child));\n        }\n\n        gradient = new Gradient(stops, radial);\n      }\n\n      var origin,\n          destination,\n          highlight,\n          scaleToBounds = getValue(node, 'gradientUnits', true) !== 'userSpaceOnUse';\n\n      if (radial) {\n        origin = getPoint(node, 'cx', 'cy', false, scaleToBounds);\n        destination = origin.add(getValue(node, 'r', false, false, scaleToBounds), 0);\n        highlight = getPoint(node, 'fx', 'fy', true, scaleToBounds);\n      } else {\n        origin = getPoint(node, 'x1', 'y1', false, scaleToBounds);\n        destination = getPoint(node, 'x2', 'y2', false, scaleToBounds);\n      }\n\n      var color = applyAttributes(new Color(gradient, origin, destination, highlight), node);\n      color._scaleToBounds = scaleToBounds;\n      return null;\n    }\n\n    var importers = {\n      '#document': function document(node, type, options, isRoot) {\n        var nodes = node.childNodes;\n\n        for (var i = 0, l = nodes.length; i < l; i++) {\n          var child = nodes[i];\n          if (child.nodeType === 1) return importNode(child, options, isRoot);\n        }\n      },\n      g: importGroup,\n      svg: importGroup,\n      clippath: importGroup,\n      polygon: importPoly,\n      polyline: importPoly,\n      path: importPath,\n      lineargradient: importGradient,\n      radialgradient: importGradient,\n      image: function image(node) {\n        var raster = new Raster(getValue(node, 'href', true));\n        raster.on('load', function () {\n          var size = getSize(node);\n          this.setSize(size);\n          var center = getPoint(node).add(size.divide(2));\n\n          this._matrix.append(new Matrix().translate(center));\n        });\n        return raster;\n      },\n      symbol: function symbol(node, type, options, isRoot) {\n        return new SymbolDefinition(importGroup(node, type, options, isRoot), true);\n      },\n      defs: importGroup,\n      use: function use(node) {\n        var id = (getValue(node, 'href', true) || '').substring(1),\n            definition = definitions[id],\n            point = getPoint(node);\n        return definition ? definition instanceof SymbolDefinition ? definition.place(point) : definition.clone().translate(point) : null;\n      },\n      circle: function circle(node) {\n        return new Shape.Circle(getPoint(node, 'cx', 'cy'), getValue(node, 'r'));\n      },\n      ellipse: function ellipse(node) {\n        return new Shape.Ellipse({\n          center: getPoint(node, 'cx', 'cy'),\n          radius: getSize(node, 'rx', 'ry')\n        });\n      },\n      rect: function rect(node) {\n        return new Shape.Rectangle(new _Rectangle(getPoint(node), getSize(node)), getSize(node, 'rx', 'ry'));\n      },\n      line: function line(node) {\n        return new Path.Line(getPoint(node, 'x1', 'y1'), getPoint(node, 'x2', 'y2'));\n      },\n      text: function text(node) {\n        var text = new PointText(getPoint(node).add(getPoint(node, 'dx', 'dy')));\n        text.setContent(node.textContent.trim() || '');\n        return text;\n      }\n    };\n\n    function applyTransform(item, value, name, node) {\n      if (item.transform) {\n        var transforms = (node.getAttribute(name) || '').split(/\\)\\s*/g),\n            matrix = new Matrix();\n\n        for (var i = 0, l = transforms.length; i < l; i++) {\n          var transform = transforms[i];\n          if (!transform) break;\n          var parts = transform.split(/\\(\\s*/),\n              command = parts[0],\n              v = parts[1].split(/[\\s,]+/g);\n\n          for (var j = 0, m = v.length; j < m; j++) {\n            v[j] = _parseFloat(v[j]);\n          }\n\n          switch (command) {\n            case 'matrix':\n              matrix.append(new Matrix(v[0], v[1], v[2], v[3], v[4], v[5]));\n              break;\n\n            case 'rotate':\n              matrix.rotate(v[0], v[1] || 0, v[2] || 0);\n              break;\n\n            case 'translate':\n              matrix.translate(v[0], v[1] || 0);\n              break;\n\n            case 'scale':\n              matrix.scale(v);\n              break;\n\n            case 'skewX':\n              matrix.skew(v[0], 0);\n              break;\n\n            case 'skewY':\n              matrix.skew(0, v[0]);\n              break;\n          }\n        }\n\n        item.transform(matrix);\n      }\n    }\n\n    function applyOpacity(item, value, name) {\n      var key = name === 'fill-opacity' ? 'getFillColor' : 'getStrokeColor',\n          color = item[key] && item[key]();\n      if (color) color.setAlpha(_parseFloat(value));\n    }\n\n    var attributes = Base.set(Base.each(SvgStyles, function (entry) {\n      this[entry.attribute] = function (item, value) {\n        if (item[entry.set]) {\n          item[entry.set](convertValue(value, entry.type, entry.fromSVG));\n\n          if (entry.type === 'color') {\n            var color = item[entry.get]();\n\n            if (color) {\n              if (color._scaleToBounds) {\n                var bounds = item.getBounds();\n                color.transform(new Matrix().translate(bounds.getPoint()).scale(bounds.getSize()));\n              }\n            }\n          }\n        }\n      };\n    }, {}), {\n      id: function id(item, value) {\n        definitions[value] = item;\n        if (item.setName) item.setName(value);\n      },\n      'clip-path': function clipPath(item, value) {\n        var clip = getDefinition(value);\n\n        if (clip) {\n          clip = clip.clone();\n          clip.setClipMask(true);\n\n          if (item instanceof Group) {\n            item.insertChild(0, clip);\n          } else {\n            return new Group(clip, item);\n          }\n        }\n      },\n      gradientTransform: applyTransform,\n      transform: applyTransform,\n      'fill-opacity': applyOpacity,\n      'stroke-opacity': applyOpacity,\n      visibility: function visibility(item, value) {\n        if (item.setVisible) item.setVisible(value === 'visible');\n      },\n      display: function display(item, value) {\n        if (item.setVisible) item.setVisible(value !== null);\n      },\n      'stop-color': function stopColor(item, value) {\n        if (item.setColor) item.setColor(value);\n      },\n      'stop-opacity': function stopOpacity(item, value) {\n        if (item._color) item._color.setAlpha(_parseFloat(value));\n      },\n      offset: function offset(item, value) {\n        if (item.setOffset) {\n          var percent = value.match(/(.*)%$/);\n          item.setOffset(percent ? percent[1] / 100 : _parseFloat(value));\n        }\n      },\n      viewBox: function viewBox(item, value, name, node, styles) {\n        var rect = new _Rectangle(convertValue(value, 'array')),\n            size = getSize(node, null, null, true),\n            group,\n            matrix;\n\n        if (item instanceof Group) {\n          var scale = size ? size.divide(rect.getSize()) : 1,\n              matrix = new Matrix().scale(scale).translate(rect.getPoint().negate());\n          group = item;\n        } else if (item instanceof SymbolDefinition) {\n          if (size) rect.setSize(size);\n          group = item._item;\n        }\n\n        if (group) {\n          if (getAttribute(node, 'overflow', styles) !== 'visible') {\n            var clip = new Shape.Rectangle(rect);\n            clip.setClipMask(true);\n            group.addChild(clip);\n          }\n\n          if (matrix) group.transform(matrix);\n        }\n      }\n    });\n\n    function getAttribute(node, name, styles) {\n      var attr = node.attributes[name],\n          value = attr && attr.value;\n\n      if (!value && node.style) {\n        var style = Base.camelize(name);\n        value = node.style[style];\n        if (!value && styles.node[style] !== styles.parent[style]) value = styles.node[style];\n      }\n\n      return !value ? undefined : value === 'none' ? null : value;\n    }\n\n    function applyAttributes(item, node, isRoot) {\n      var parent = node.parentNode,\n          styles = {\n        node: DomElement.getStyles(node) || {},\n        parent: !isRoot && !/^defs$/i.test(parent.tagName) && DomElement.getStyles(parent) || {}\n      };\n      Base.each(attributes, function (apply, name) {\n        var value = getAttribute(node, name, styles);\n        item = value !== undefined && apply(item, value, name, node, styles) || item;\n      });\n      return item;\n    }\n\n    function getDefinition(value) {\n      var match = value && value.match(/\\((?:[\"'#]*)([^\"')]+)/),\n          name = match && match[1],\n          res = name && definitions[window ? name.replace(window.location.href.split('#')[0] + '#', '') : name];\n\n      if (res && res._scaleToBounds) {\n        res = res.clone();\n        res._scaleToBounds = true;\n      }\n\n      return res;\n    }\n\n    function importNode(node, options, isRoot) {\n      var type = node.nodeName.toLowerCase(),\n          isElement = type !== '#document',\n          body = document.body,\n          container,\n          parent,\n          next;\n\n      if (isRoot && isElement) {\n        rootSize = paper.getView().getSize();\n        rootSize = getSize(node, null, null, true) || rootSize;\n        container = SvgElement.create('svg', {\n          style: 'stroke-width: 1px; stroke-miterlimit: 10'\n        });\n        parent = node.parentNode;\n        next = node.nextSibling;\n        container.appendChild(node);\n        body.appendChild(container);\n      }\n\n      var settings = paper.settings,\n          applyMatrix = settings.applyMatrix,\n          insertItems = settings.insertItems;\n      settings.applyMatrix = false;\n      settings.insertItems = false;\n      var importer = importers[type],\n          item = importer && importer(node, type, options, isRoot) || null;\n      settings.insertItems = insertItems;\n      settings.applyMatrix = applyMatrix;\n\n      if (item) {\n        if (isElement && !(item instanceof Group)) item = applyAttributes(item, node, isRoot);\n        var onImport = options.onImport,\n            data = isElement && node.getAttribute('data-paper-data');\n        if (onImport) item = onImport(node, item, options) || item;\n\n        if (options.expandShapes && item instanceof Shape) {\n          item.remove();\n          item = item.toPath();\n        }\n\n        if (data) item._data = JSON.parse(data);\n      }\n\n      if (container) {\n        body.removeChild(container);\n\n        if (parent) {\n          if (next) {\n            parent.insertBefore(node, next);\n          } else {\n            parent.appendChild(node);\n          }\n        }\n      }\n\n      if (isRoot) {\n        definitions = {};\n        if (item && Base.pick(options.applyMatrix, applyMatrix)) item.matrix.apply(true, true);\n      }\n\n      return item;\n    }\n\n    function _importSVG(source, options, owner) {\n      if (!source) return null;\n      options = typeof options === 'function' ? {\n        onLoad: options\n      } : options || {};\n      var scope = paper,\n          item = null;\n\n      function onLoad(svg) {\n        try {\n          var node = _typeof(svg) === 'object' ? svg : new self.DOMParser().parseFromString(svg, 'image/svg+xml');\n\n          if (!node.nodeName) {\n            node = null;\n            throw new Error('Unsupported SVG source: ' + source);\n          }\n\n          paper = scope;\n          item = importNode(node, options, true);\n\n          if (!options || options.insert !== false) {\n            owner._insertItem(undefined, item);\n          }\n\n          var onLoad = options.onLoad;\n          if (onLoad) onLoad(item, svg);\n        } catch (e) {\n          onError(e);\n        }\n      }\n\n      function onError(message, status) {\n        var onError = options.onError;\n\n        if (onError) {\n          onError(message, status);\n        } else {\n          throw new Error(message);\n        }\n      }\n\n      if (typeof source === 'string' && !/^.*</.test(source)) {\n        var node = document.getElementById(source);\n\n        if (node) {\n          onLoad(node);\n        } else {\n          Http.request({\n            url: source,\n            async: true,\n            onLoad: onLoad,\n            onError: onError\n          });\n        }\n      } else if (typeof File !== 'undefined' && source instanceof File) {\n        var reader = new FileReader();\n\n        reader.onload = function () {\n          onLoad(reader.result);\n        };\n\n        reader.onerror = function () {\n          onError(reader.error);\n        };\n\n        return reader.readAsText(source);\n      } else {\n        onLoad(source);\n      }\n\n      return item;\n    }\n\n    Item.inject({\n      importSVG: function importSVG(node, options) {\n        return _importSVG(node, options, this);\n      }\n    });\n    Project.inject({\n      importSVG: function importSVG(node, options) {\n        this.activate();\n        return _importSVG(node, options, this);\n      }\n    });\n  }();\n\n  Base.exports.PaperScript = function () {\n    var global = this,\n        acorn = global.acorn;\n\n    if (!acorn && typeof require !== 'undefined') {\n      try {\n        acorn = require('acorn');\n      } catch (e) {}\n    }\n\n    if (!acorn) {\n      var exports, module;\n      acorn = exports = module = {};\n\n      (function (root, mod) {\n        if (_typeof(exports) == \"object\" && _typeof(module) == \"object\") return mod(exports);\n        if (typeof define == \"function\" && define.amd) return define([\"exports\"], mod);\n        mod(root.acorn || (root.acorn = {}));\n      })(this, function (exports) {\n        \"use strict\";\n\n        exports.version = \"0.5.0\";\n        var options, input, inputLen, sourceFile;\n\n        exports.parse = function (inpt, opts) {\n          input = String(inpt);\n          inputLen = input.length;\n          setOptions(opts);\n          initTokenState();\n          return parseTopLevel(options.program);\n        };\n\n        var defaultOptions = exports.defaultOptions = {\n          ecmaVersion: 5,\n          strictSemicolons: false,\n          allowTrailingCommas: true,\n          forbidReserved: false,\n          allowReturnOutsideFunction: false,\n          locations: false,\n          onComment: null,\n          ranges: false,\n          program: null,\n          sourceFile: null,\n          directSourceFile: null\n        };\n\n        function setOptions(opts) {\n          options = opts || {};\n\n          for (var opt in defaultOptions) {\n            if (!Object.prototype.hasOwnProperty.call(options, opt)) options[opt] = defaultOptions[opt];\n          }\n\n          sourceFile = options.sourceFile || null;\n        }\n\n        var getLineInfo = exports.getLineInfo = function (input, offset) {\n          for (var line = 1, cur = 0;;) {\n            lineBreak.lastIndex = cur;\n            var match = lineBreak.exec(input);\n\n            if (match && match.index < offset) {\n              ++line;\n              cur = match.index + match[0].length;\n            } else break;\n          }\n\n          return {\n            line: line,\n            column: offset - cur\n          };\n        };\n\n        exports.tokenize = function (inpt, opts) {\n          input = String(inpt);\n          inputLen = input.length;\n          setOptions(opts);\n          initTokenState();\n          var t = {};\n\n          function getToken(forceRegexp) {\n            lastEnd = tokEnd;\n            readToken(forceRegexp);\n            t.start = tokStart;\n            t.end = tokEnd;\n            t.startLoc = tokStartLoc;\n            t.endLoc = tokEndLoc;\n            t.type = tokType;\n            t.value = tokVal;\n            return t;\n          }\n\n          getToken.jumpTo = function (pos, reAllowed) {\n            tokPos = pos;\n\n            if (options.locations) {\n              tokCurLine = 1;\n              tokLineStart = lineBreak.lastIndex = 0;\n              var match;\n\n              while ((match = lineBreak.exec(input)) && match.index < pos) {\n                ++tokCurLine;\n                tokLineStart = match.index + match[0].length;\n              }\n            }\n\n            tokRegexpAllowed = reAllowed;\n            skipSpace();\n          };\n\n          return getToken;\n        };\n\n        var tokPos;\n        var tokStart, tokEnd;\n        var tokStartLoc, tokEndLoc;\n        var tokType, tokVal;\n        var tokRegexpAllowed;\n        var tokCurLine, tokLineStart;\n        var lastStart, lastEnd, lastEndLoc;\n        var inFunction, labels, strict;\n\n        function raise(pos, message) {\n          var loc = getLineInfo(input, pos);\n          message += \" (\" + loc.line + \":\" + loc.column + \")\";\n          var err = new SyntaxError(message);\n          err.pos = pos;\n          err.loc = loc;\n          err.raisedAt = tokPos;\n          throw err;\n        }\n\n        var empty = [];\n        var _num = {\n          type: \"num\"\n        },\n            _regexp = {\n          type: \"regexp\"\n        },\n            _string = {\n          type: \"string\"\n        };\n        var _name = {\n          type: \"name\"\n        },\n            _eof = {\n          type: \"eof\"\n        };\n        var _break = {\n          keyword: \"break\"\n        },\n            _case = {\n          keyword: \"case\",\n          beforeExpr: true\n        },\n            _catch = {\n          keyword: \"catch\"\n        };\n        var _continue = {\n          keyword: \"continue\"\n        },\n            _debugger = {\n          keyword: \"debugger\"\n        },\n            _default = {\n          keyword: \"default\"\n        };\n        var _do = {\n          keyword: \"do\",\n          isLoop: true\n        },\n            _else = {\n          keyword: \"else\",\n          beforeExpr: true\n        };\n        var _finally = {\n          keyword: \"finally\"\n        },\n            _for = {\n          keyword: \"for\",\n          isLoop: true\n        },\n            _function = {\n          keyword: \"function\"\n        };\n        var _if = {\n          keyword: \"if\"\n        },\n            _return = {\n          keyword: \"return\",\n          beforeExpr: true\n        },\n            _switch = {\n          keyword: \"switch\"\n        };\n        var _throw = {\n          keyword: \"throw\",\n          beforeExpr: true\n        },\n            _try = {\n          keyword: \"try\"\n        },\n            _var = {\n          keyword: \"var\"\n        };\n        var _while = {\n          keyword: \"while\",\n          isLoop: true\n        },\n            _with = {\n          keyword: \"with\"\n        },\n            _new = {\n          keyword: \"new\",\n          beforeExpr: true\n        };\n        var _this = {\n          keyword: \"this\"\n        };\n        var _null = {\n          keyword: \"null\",\n          atomValue: null\n        },\n            _true = {\n          keyword: \"true\",\n          atomValue: true\n        };\n        var _false = {\n          keyword: \"false\",\n          atomValue: false\n        };\n        var _in = {\n          keyword: \"in\",\n          binop: 7,\n          beforeExpr: true\n        };\n        var keywordTypes = {\n          \"break\": _break,\n          \"case\": _case,\n          \"catch\": _catch,\n          \"continue\": _continue,\n          \"debugger\": _debugger,\n          \"default\": _default,\n          \"do\": _do,\n          \"else\": _else,\n          \"finally\": _finally,\n          \"for\": _for,\n          \"function\": _function,\n          \"if\": _if,\n          \"return\": _return,\n          \"switch\": _switch,\n          \"throw\": _throw,\n          \"try\": _try,\n          \"var\": _var,\n          \"while\": _while,\n          \"with\": _with,\n          \"null\": _null,\n          \"true\": _true,\n          \"false\": _false,\n          \"new\": _new,\n          \"in\": _in,\n          \"instanceof\": {\n            keyword: \"instanceof\",\n            binop: 7,\n            beforeExpr: true\n          },\n          \"this\": _this,\n          \"typeof\": {\n            keyword: \"typeof\",\n            prefix: true,\n            beforeExpr: true\n          },\n          \"void\": {\n            keyword: \"void\",\n            prefix: true,\n            beforeExpr: true\n          },\n          \"delete\": {\n            keyword: \"delete\",\n            prefix: true,\n            beforeExpr: true\n          }\n        };\n        var _bracketL = {\n          type: \"[\",\n          beforeExpr: true\n        },\n            _bracketR = {\n          type: \"]\"\n        },\n            _braceL = {\n          type: \"{\",\n          beforeExpr: true\n        };\n        var _braceR = {\n          type: \"}\"\n        },\n            _parenL = {\n          type: \"(\",\n          beforeExpr: true\n        },\n            _parenR = {\n          type: \")\"\n        };\n        var _comma = {\n          type: \",\",\n          beforeExpr: true\n        },\n            _semi = {\n          type: \";\",\n          beforeExpr: true\n        };\n        var _colon = {\n          type: \":\",\n          beforeExpr: true\n        },\n            _dot = {\n          type: \".\"\n        },\n            _question = {\n          type: \"?\",\n          beforeExpr: true\n        };\n        var _slash = {\n          binop: 10,\n          beforeExpr: true\n        },\n            _eq = {\n          isAssign: true,\n          beforeExpr: true\n        };\n        var _assign = {\n          isAssign: true,\n          beforeExpr: true\n        };\n        var _incDec = {\n          postfix: true,\n          prefix: true,\n          isUpdate: true\n        },\n            _prefix = {\n          prefix: true,\n          beforeExpr: true\n        };\n        var _logicalOR = {\n          binop: 1,\n          beforeExpr: true\n        };\n        var _logicalAND = {\n          binop: 2,\n          beforeExpr: true\n        };\n        var _bitwiseOR = {\n          binop: 3,\n          beforeExpr: true\n        };\n        var _bitwiseXOR = {\n          binop: 4,\n          beforeExpr: true\n        };\n        var _bitwiseAND = {\n          binop: 5,\n          beforeExpr: true\n        };\n        var _equality = {\n          binop: 6,\n          beforeExpr: true\n        };\n        var _relational = {\n          binop: 7,\n          beforeExpr: true\n        };\n        var _bitShift = {\n          binop: 8,\n          beforeExpr: true\n        };\n        var _plusMin = {\n          binop: 9,\n          prefix: true,\n          beforeExpr: true\n        };\n        var _multiplyModulo = {\n          binop: 10,\n          beforeExpr: true\n        };\n        exports.tokTypes = {\n          bracketL: _bracketL,\n          bracketR: _bracketR,\n          braceL: _braceL,\n          braceR: _braceR,\n          parenL: _parenL,\n          parenR: _parenR,\n          comma: _comma,\n          semi: _semi,\n          colon: _colon,\n          dot: _dot,\n          question: _question,\n          slash: _slash,\n          eq: _eq,\n          name: _name,\n          eof: _eof,\n          num: _num,\n          regexp: _regexp,\n          string: _string\n        };\n\n        for (var kw in keywordTypes) {\n          exports.tokTypes[\"_\" + kw] = keywordTypes[kw];\n        }\n\n        function makePredicate(words) {\n          words = words.split(\" \");\n          var f = \"\",\n              cats = [];\n\n          out: for (var i = 0; i < words.length; ++i) {\n            for (var j = 0; j < cats.length; ++j) {\n              if (cats[j][0].length == words[i].length) {\n                cats[j].push(words[i]);\n                continue out;\n              }\n            }\n\n            cats.push([words[i]]);\n          }\n\n          function compareTo(arr) {\n            if (arr.length == 1) return f += \"return str === \" + _JSON$stringify(arr[0]) + \";\";\n            f += \"switch(str){\";\n\n            for (var i = 0; i < arr.length; ++i) {\n              f += \"case \" + _JSON$stringify(arr[i]) + \":\";\n            }\n\n            f += \"return true}return false;\";\n          }\n\n          if (cats.length > 3) {\n            cats.sort(function (a, b) {\n              return b.length - a.length;\n            });\n            f += \"switch(str.length){\";\n\n            for (var i = 0; i < cats.length; ++i) {\n              var cat = cats[i];\n              f += \"case \" + cat[0].length + \":\";\n              compareTo(cat);\n            }\n\n            f += \"}\";\n          } else {\n            compareTo(words);\n          }\n\n          return new Function(\"str\", f);\n        }\n\n        var isReservedWord3 = makePredicate(\"abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile\");\n        var isReservedWord5 = makePredicate(\"class enum extends super const export import\");\n        var isStrictReservedWord = makePredicate(\"implements interface let package private protected public static yield\");\n        var isStrictBadIdWord = makePredicate(\"eval arguments\");\n        var isKeyword = makePredicate(\"break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this\");\n        var nonASCIIwhitespace = /[\\u1680\\u180e\\u2000-\\u200a\\u202f\\u205f\\u3000\\ufeff]/;\n        var nonASCIIidentifierStartChars = \"\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u0527\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0\\u08A2-\\u08AC\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0977\\u0979-\\u097F\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C33\\u0C35-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F0\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191C\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA697\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA793\\uA7A0-\\uA7AA\\uA7F8-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA80-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC\";\n        var nonASCIIidentifierChars = \"\\u0300-\\u036F\\u0483-\\u0487\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u0610-\\u061A\\u0620-\\u0649\\u0672-\\u06D3\\u06E7-\\u06E8\\u06FB-\\u06FC\\u0730-\\u074A\\u0800-\\u0814\\u081B-\\u0823\\u0825-\\u0827\\u0829-\\u082D\\u0840-\\u0857\\u08E4-\\u08FE\\u0900-\\u0903\\u093A-\\u093C\\u093E-\\u094F\\u0951-\\u0957\\u0962-\\u0963\\u0966-\\u096F\\u0981-\\u0983\\u09BC\\u09BE-\\u09C4\\u09C7\\u09C8\\u09D7\\u09DF-\\u09E0\\u0A01-\\u0A03\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A66-\\u0A71\\u0A75\\u0A81-\\u0A83\\u0ABC\\u0ABE-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AE2-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B3C\\u0B3E-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5F-\\u0B60\\u0B66-\\u0B6F\\u0B82\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD7\\u0BE6-\\u0BEF\\u0C01-\\u0C03\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C62-\\u0C63\\u0C66-\\u0C6F\\u0C82\\u0C83\\u0CBC\\u0CBE-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CE2-\\u0CE3\\u0CE6-\\u0CEF\\u0D02\\u0D03\\u0D46-\\u0D48\\u0D57\\u0D62-\\u0D63\\u0D66-\\u0D6F\\u0D82\\u0D83\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DF2\\u0DF3\\u0E34-\\u0E3A\\u0E40-\\u0E45\\u0E50-\\u0E59\\u0EB4-\\u0EB9\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F41-\\u0F47\\u0F71-\\u0F84\\u0F86-\\u0F87\\u0F8D-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1029\\u1040-\\u1049\\u1067-\\u106D\\u1071-\\u1074\\u1082-\\u108D\\u108F-\\u109D\\u135D-\\u135F\\u170E-\\u1710\\u1720-\\u1730\\u1740-\\u1750\\u1772\\u1773\\u1780-\\u17B2\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1920-\\u192B\\u1930-\\u193B\\u1951-\\u196D\\u19B0-\\u19C0\\u19C8-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A15\\u1A20-\\u1A53\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1B46-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1BB0-\\u1BB9\\u1BE6-\\u1BF3\\u1C00-\\u1C22\\u1C40-\\u1C49\\u1C5B-\\u1C7D\\u1CD0-\\u1CD2\\u1D00-\\u1DBE\\u1E01-\\u1F15\\u200C\\u200D\\u203F\\u2040\\u2054\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2D81-\\u2D96\\u2DE0-\\u2DFF\\u3021-\\u3028\\u3099\\u309A\\uA640-\\uA66D\\uA674-\\uA67D\\uA69F\\uA6F0-\\uA6F1\\uA7F8-\\uA800\\uA806\\uA80B\\uA823-\\uA827\\uA880-\\uA881\\uA8B4-\\uA8C4\\uA8D0-\\uA8D9\\uA8F3-\\uA8F7\\uA900-\\uA909\\uA926-\\uA92D\\uA930-\\uA945\\uA980-\\uA983\\uA9B3-\\uA9C0\\uAA00-\\uAA27\\uAA40-\\uAA41\\uAA4C-\\uAA4D\\uAA50-\\uAA59\\uAA7B\\uAAE0-\\uAAE9\\uAAF2-\\uAAF3\\uABC0-\\uABE1\\uABEC\\uABED\\uABF0-\\uABF9\\uFB20-\\uFB28\\uFE00-\\uFE0F\\uFE20-\\uFE26\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFF10-\\uFF19\\uFF3F\";\n        var nonASCIIidentifierStart = new RegExp(\"[\" + nonASCIIidentifierStartChars + \"]\");\n        var nonASCIIidentifier = new RegExp(\"[\" + nonASCIIidentifierStartChars + nonASCIIidentifierChars + \"]\");\n        var newline = /[\\n\\r\\u2028\\u2029]/;\n        var lineBreak = /\\r\\n|[\\n\\r\\u2028\\u2029]/g;\n\n        var isIdentifierStart = exports.isIdentifierStart = function (code) {\n          if (code < 65) return code === 36;\n          if (code < 91) return true;\n          if (code < 97) return code === 95;\n          if (code < 123) return true;\n          return code >= 0xaa && nonASCIIidentifierStart.test(String.fromCharCode(code));\n        };\n\n        var isIdentifierChar = exports.isIdentifierChar = function (code) {\n          if (code < 48) return code === 36;\n          if (code < 58) return true;\n          if (code < 65) return false;\n          if (code < 91) return true;\n          if (code < 97) return code === 95;\n          if (code < 123) return true;\n          return code >= 0xaa && nonASCIIidentifier.test(String.fromCharCode(code));\n        };\n\n        function line_loc_t() {\n          this.line = tokCurLine;\n          this.column = tokPos - tokLineStart;\n        }\n\n        function initTokenState() {\n          tokCurLine = 1;\n          tokPos = tokLineStart = 0;\n          tokRegexpAllowed = true;\n          skipSpace();\n        }\n\n        function finishToken(type, val) {\n          tokEnd = tokPos;\n          if (options.locations) tokEndLoc = new line_loc_t();\n          tokType = type;\n          skipSpace();\n          tokVal = val;\n          tokRegexpAllowed = type.beforeExpr;\n        }\n\n        function skipBlockComment() {\n          var startLoc = options.onComment && options.locations && new line_loc_t();\n          var start = tokPos,\n              end = input.indexOf(\"*/\", tokPos += 2);\n          if (end === -1) raise(tokPos - 2, \"Unterminated comment\");\n          tokPos = end + 2;\n\n          if (options.locations) {\n            lineBreak.lastIndex = start;\n            var match;\n\n            while ((match = lineBreak.exec(input)) && match.index < tokPos) {\n              ++tokCurLine;\n              tokLineStart = match.index + match[0].length;\n            }\n          }\n\n          if (options.onComment) options.onComment(true, input.slice(start + 2, end), start, tokPos, startLoc, options.locations && new line_loc_t());\n        }\n\n        function skipLineComment() {\n          var start = tokPos;\n          var startLoc = options.onComment && options.locations && new line_loc_t();\n          var ch = input.charCodeAt(tokPos += 2);\n\n          while (tokPos < inputLen && ch !== 10 && ch !== 13 && ch !== 8232 && ch !== 8233) {\n            ++tokPos;\n            ch = input.charCodeAt(tokPos);\n          }\n\n          if (options.onComment) options.onComment(false, input.slice(start + 2, tokPos), start, tokPos, startLoc, options.locations && new line_loc_t());\n        }\n\n        function skipSpace() {\n          while (tokPos < inputLen) {\n            var ch = input.charCodeAt(tokPos);\n\n            if (ch === 32) {\n              ++tokPos;\n            } else if (ch === 13) {\n              ++tokPos;\n              var next = input.charCodeAt(tokPos);\n\n              if (next === 10) {\n                ++tokPos;\n              }\n\n              if (options.locations) {\n                ++tokCurLine;\n                tokLineStart = tokPos;\n              }\n            } else if (ch === 10 || ch === 8232 || ch === 8233) {\n              ++tokPos;\n\n              if (options.locations) {\n                ++tokCurLine;\n                tokLineStart = tokPos;\n              }\n            } else if (ch > 8 && ch < 14) {\n              ++tokPos;\n            } else if (ch === 47) {\n              var next = input.charCodeAt(tokPos + 1);\n\n              if (next === 42) {\n                skipBlockComment();\n              } else if (next === 47) {\n                skipLineComment();\n              } else break;\n            } else if (ch === 160) {\n              ++tokPos;\n            } else if (ch >= 5760 && nonASCIIwhitespace.test(String.fromCharCode(ch))) {\n              ++tokPos;\n            } else {\n              break;\n            }\n          }\n        }\n\n        function readToken_dot() {\n          var next = input.charCodeAt(tokPos + 1);\n          if (next >= 48 && next <= 57) return readNumber(true);\n          ++tokPos;\n          return finishToken(_dot);\n        }\n\n        function readToken_slash() {\n          var next = input.charCodeAt(tokPos + 1);\n\n          if (tokRegexpAllowed) {\n            ++tokPos;\n            return readRegexp();\n          }\n\n          if (next === 61) return finishOp(_assign, 2);\n          return finishOp(_slash, 1);\n        }\n\n        function readToken_mult_modulo() {\n          var next = input.charCodeAt(tokPos + 1);\n          if (next === 61) return finishOp(_assign, 2);\n          return finishOp(_multiplyModulo, 1);\n        }\n\n        function readToken_pipe_amp(code) {\n          var next = input.charCodeAt(tokPos + 1);\n          if (next === code) return finishOp(code === 124 ? _logicalOR : _logicalAND, 2);\n          if (next === 61) return finishOp(_assign, 2);\n          return finishOp(code === 124 ? _bitwiseOR : _bitwiseAND, 1);\n        }\n\n        function readToken_caret() {\n          var next = input.charCodeAt(tokPos + 1);\n          if (next === 61) return finishOp(_assign, 2);\n          return finishOp(_bitwiseXOR, 1);\n        }\n\n        function readToken_plus_min(code) {\n          var next = input.charCodeAt(tokPos + 1);\n\n          if (next === code) {\n            if (next == 45 && input.charCodeAt(tokPos + 2) == 62 && newline.test(input.slice(lastEnd, tokPos))) {\n              tokPos += 3;\n              skipLineComment();\n              skipSpace();\n              return readToken();\n            }\n\n            return finishOp(_incDec, 2);\n          }\n\n          if (next === 61) return finishOp(_assign, 2);\n          return finishOp(_plusMin, 1);\n        }\n\n        function readToken_lt_gt(code) {\n          var next = input.charCodeAt(tokPos + 1);\n          var size = 1;\n\n          if (next === code) {\n            size = code === 62 && input.charCodeAt(tokPos + 2) === 62 ? 3 : 2;\n            if (input.charCodeAt(tokPos + size) === 61) return finishOp(_assign, size + 1);\n            return finishOp(_bitShift, size);\n          }\n\n          if (next == 33 && code == 60 && input.charCodeAt(tokPos + 2) == 45 && input.charCodeAt(tokPos + 3) == 45) {\n            tokPos += 4;\n            skipLineComment();\n            skipSpace();\n            return readToken();\n          }\n\n          if (next === 61) size = input.charCodeAt(tokPos + 2) === 61 ? 3 : 2;\n          return finishOp(_relational, size);\n        }\n\n        function readToken_eq_excl(code) {\n          var next = input.charCodeAt(tokPos + 1);\n          if (next === 61) return finishOp(_equality, input.charCodeAt(tokPos + 2) === 61 ? 3 : 2);\n          return finishOp(code === 61 ? _eq : _prefix, 1);\n        }\n\n        function getTokenFromCode(code) {\n          switch (code) {\n            case 46:\n              return readToken_dot();\n\n            case 40:\n              ++tokPos;\n              return finishToken(_parenL);\n\n            case 41:\n              ++tokPos;\n              return finishToken(_parenR);\n\n            case 59:\n              ++tokPos;\n              return finishToken(_semi);\n\n            case 44:\n              ++tokPos;\n              return finishToken(_comma);\n\n            case 91:\n              ++tokPos;\n              return finishToken(_bracketL);\n\n            case 93:\n              ++tokPos;\n              return finishToken(_bracketR);\n\n            case 123:\n              ++tokPos;\n              return finishToken(_braceL);\n\n            case 125:\n              ++tokPos;\n              return finishToken(_braceR);\n\n            case 58:\n              ++tokPos;\n              return finishToken(_colon);\n\n            case 63:\n              ++tokPos;\n              return finishToken(_question);\n\n            case 48:\n              var next = input.charCodeAt(tokPos + 1);\n              if (next === 120 || next === 88) return readHexNumber();\n\n            case 49:\n            case 50:\n            case 51:\n            case 52:\n            case 53:\n            case 54:\n            case 55:\n            case 56:\n            case 57:\n              return readNumber(false);\n\n            case 34:\n            case 39:\n              return readString(code);\n\n            case 47:\n              return readToken_slash(code);\n\n            case 37:\n            case 42:\n              return readToken_mult_modulo();\n\n            case 124:\n            case 38:\n              return readToken_pipe_amp(code);\n\n            case 94:\n              return readToken_caret();\n\n            case 43:\n            case 45:\n              return readToken_plus_min(code);\n\n            case 60:\n            case 62:\n              return readToken_lt_gt(code);\n\n            case 61:\n            case 33:\n              return readToken_eq_excl(code);\n\n            case 126:\n              return finishOp(_prefix, 1);\n          }\n\n          return false;\n        }\n\n        function readToken(forceRegexp) {\n          if (!forceRegexp) tokStart = tokPos;else tokPos = tokStart + 1;\n          if (options.locations) tokStartLoc = new line_loc_t();\n          if (forceRegexp) return readRegexp();\n          if (tokPos >= inputLen) return finishToken(_eof);\n          var code = input.charCodeAt(tokPos);\n          if (isIdentifierStart(code) || code === 92) return readWord();\n          var tok = getTokenFromCode(code);\n\n          if (tok === false) {\n            var ch = String.fromCharCode(code);\n            if (ch === \"\\\\\" || nonASCIIidentifierStart.test(ch)) return readWord();\n            raise(tokPos, \"Unexpected character '\" + ch + \"'\");\n          }\n\n          return tok;\n        }\n\n        function finishOp(type, size) {\n          var str = input.slice(tokPos, tokPos + size);\n          tokPos += size;\n          finishToken(type, str);\n        }\n\n        function readRegexp() {\n          var content = \"\",\n              escaped,\n              inClass,\n              start = tokPos;\n\n          for (;;) {\n            if (tokPos >= inputLen) raise(start, \"Unterminated regular expression\");\n            var ch = input.charAt(tokPos);\n            if (newline.test(ch)) raise(start, \"Unterminated regular expression\");\n\n            if (!escaped) {\n              if (ch === \"[\") inClass = true;else if (ch === \"]\" && inClass) inClass = false;else if (ch === \"/\" && !inClass) break;\n              escaped = ch === \"\\\\\";\n            } else escaped = false;\n\n            ++tokPos;\n          }\n\n          var content = input.slice(start, tokPos);\n          ++tokPos;\n          var mods = readWord1();\n          if (mods && !/^[gmsiy]*$/.test(mods)) raise(start, \"Invalid regexp flag\");\n\n          try {\n            var value = new RegExp(content, mods);\n          } catch (e) {\n            if (e instanceof SyntaxError) raise(start, e.message);\n            raise(e);\n          }\n\n          return finishToken(_regexp, value);\n        }\n\n        function readInt(radix, len) {\n          var start = tokPos,\n              total = 0;\n\n          for (var i = 0, e = len == null ? Infinity : len; i < e; ++i) {\n            var code = input.charCodeAt(tokPos),\n                val;\n            if (code >= 97) val = code - 97 + 10;else if (code >= 65) val = code - 65 + 10;else if (code >= 48 && code <= 57) val = code - 48;else val = Infinity;\n            if (val >= radix) break;\n            ++tokPos;\n            total = total * radix + val;\n          }\n\n          if (tokPos === start || len != null && tokPos - start !== len) return null;\n          return total;\n        }\n\n        function readHexNumber() {\n          tokPos += 2;\n          var val = readInt(16);\n          if (val == null) raise(tokStart + 2, \"Expected hexadecimal number\");\n          if (isIdentifierStart(input.charCodeAt(tokPos))) raise(tokPos, \"Identifier directly after number\");\n          return finishToken(_num, val);\n        }\n\n        function readNumber(startsWithDot) {\n          var start = tokPos,\n              isFloat = false,\n              octal = input.charCodeAt(tokPos) === 48;\n          if (!startsWithDot && readInt(10) === null) raise(start, \"Invalid number\");\n\n          if (input.charCodeAt(tokPos) === 46) {\n            ++tokPos;\n            readInt(10);\n            isFloat = true;\n          }\n\n          var next = input.charCodeAt(tokPos);\n\n          if (next === 69 || next === 101) {\n            next = input.charCodeAt(++tokPos);\n            if (next === 43 || next === 45) ++tokPos;\n            if (readInt(10) === null) raise(start, \"Invalid number\");\n            isFloat = true;\n          }\n\n          if (isIdentifierStart(input.charCodeAt(tokPos))) raise(tokPos, \"Identifier directly after number\");\n          var str = input.slice(start, tokPos),\n              val;\n          if (isFloat) val = _parseFloat(str);else if (!octal || str.length === 1) val = _parseInt(str, 10);else if (/[89]/.test(str) || strict) raise(start, \"Invalid number\");else val = _parseInt(str, 8);\n          return finishToken(_num, val);\n        }\n\n        function readString(quote) {\n          tokPos++;\n          var out = \"\";\n\n          for (;;) {\n            if (tokPos >= inputLen) raise(tokStart, \"Unterminated string constant\");\n            var ch = input.charCodeAt(tokPos);\n\n            if (ch === quote) {\n              ++tokPos;\n              return finishToken(_string, out);\n            }\n\n            if (ch === 92) {\n              ch = input.charCodeAt(++tokPos);\n              var octal = /^[0-7]+/.exec(input.slice(tokPos, tokPos + 3));\n              if (octal) octal = octal[0];\n\n              while (octal && _parseInt(octal, 8) > 255) {\n                octal = octal.slice(0, -1);\n              }\n\n              if (octal === \"0\") octal = null;\n              ++tokPos;\n\n              if (octal) {\n                if (strict) raise(tokPos - 2, \"Octal literal in strict mode\");\n                out += String.fromCharCode(_parseInt(octal, 8));\n                tokPos += octal.length - 1;\n              } else {\n                switch (ch) {\n                  case 110:\n                    out += \"\\n\";\n                    break;\n\n                  case 114:\n                    out += \"\\r\";\n                    break;\n\n                  case 120:\n                    out += String.fromCharCode(readHexChar(2));\n                    break;\n\n                  case 117:\n                    out += String.fromCharCode(readHexChar(4));\n                    break;\n\n                  case 85:\n                    out += String.fromCharCode(readHexChar(8));\n                    break;\n\n                  case 116:\n                    out += \"\\t\";\n                    break;\n\n                  case 98:\n                    out += \"\\b\";\n                    break;\n\n                  case 118:\n                    out += \"\\x0B\";\n                    break;\n\n                  case 102:\n                    out += \"\\f\";\n                    break;\n\n                  case 48:\n                    out += \"\\0\";\n                    break;\n\n                  case 13:\n                    if (input.charCodeAt(tokPos) === 10) ++tokPos;\n\n                  case 10:\n                    if (options.locations) {\n                      tokLineStart = tokPos;\n                      ++tokCurLine;\n                    }\n\n                    break;\n\n                  default:\n                    out += String.fromCharCode(ch);\n                    break;\n                }\n              }\n            } else {\n              if (ch === 13 || ch === 10 || ch === 8232 || ch === 8233) raise(tokStart, \"Unterminated string constant\");\n              out += String.fromCharCode(ch);\n              ++tokPos;\n            }\n          }\n        }\n\n        function readHexChar(len) {\n          var n = readInt(16, len);\n          if (n === null) raise(tokStart, \"Bad character escape sequence\");\n          return n;\n        }\n\n        var containsEsc;\n\n        function readWord1() {\n          containsEsc = false;\n          var word,\n              first = true,\n              start = tokPos;\n\n          for (;;) {\n            var ch = input.charCodeAt(tokPos);\n\n            if (isIdentifierChar(ch)) {\n              if (containsEsc) word += input.charAt(tokPos);\n              ++tokPos;\n            } else if (ch === 92) {\n              if (!containsEsc) word = input.slice(start, tokPos);\n              containsEsc = true;\n              if (input.charCodeAt(++tokPos) != 117) raise(tokPos, \"Expecting Unicode escape sequence \\\\uXXXX\");\n              ++tokPos;\n              var esc = readHexChar(4);\n              var escStr = String.fromCharCode(esc);\n              if (!escStr) raise(tokPos - 1, \"Invalid Unicode escape\");\n              if (!(first ? isIdentifierStart(esc) : isIdentifierChar(esc))) raise(tokPos - 4, \"Invalid Unicode escape\");\n              word += escStr;\n            } else {\n              break;\n            }\n\n            first = false;\n          }\n\n          return containsEsc ? word : input.slice(start, tokPos);\n        }\n\n        function readWord() {\n          var word = readWord1();\n          var type = _name;\n          if (!containsEsc && isKeyword(word)) type = keywordTypes[word];\n          return finishToken(type, word);\n        }\n\n        function next() {\n          lastStart = tokStart;\n          lastEnd = tokEnd;\n          lastEndLoc = tokEndLoc;\n          readToken();\n        }\n\n        function setStrict(strct) {\n          strict = strct;\n          tokPos = tokStart;\n\n          if (options.locations) {\n            while (tokPos < tokLineStart) {\n              tokLineStart = input.lastIndexOf(\"\\n\", tokLineStart - 2) + 1;\n              --tokCurLine;\n            }\n          }\n\n          skipSpace();\n          readToken();\n        }\n\n        function node_t() {\n          this.type = null;\n          this.start = tokStart;\n          this.end = null;\n        }\n\n        function node_loc_t() {\n          this.start = tokStartLoc;\n          this.end = null;\n          if (sourceFile !== null) this.source = sourceFile;\n        }\n\n        function startNode() {\n          var node = new node_t();\n          if (options.locations) node.loc = new node_loc_t();\n          if (options.directSourceFile) node.sourceFile = options.directSourceFile;\n          if (options.ranges) node.range = [tokStart, 0];\n          return node;\n        }\n\n        function startNodeFrom(other) {\n          var node = new node_t();\n          node.start = other.start;\n\n          if (options.locations) {\n            node.loc = new node_loc_t();\n            node.loc.start = other.loc.start;\n          }\n\n          if (options.ranges) node.range = [other.range[0], 0];\n          return node;\n        }\n\n        function finishNode(node, type) {\n          node.type = type;\n          node.end = lastEnd;\n          if (options.locations) node.loc.end = lastEndLoc;\n          if (options.ranges) node.range[1] = lastEnd;\n          return node;\n        }\n\n        function isUseStrict(stmt) {\n          return options.ecmaVersion >= 5 && stmt.type === \"ExpressionStatement\" && stmt.expression.type === \"Literal\" && stmt.expression.value === \"use strict\";\n        }\n\n        function eat(type) {\n          if (tokType === type) {\n            next();\n            return true;\n          }\n        }\n\n        function canInsertSemicolon() {\n          return !options.strictSemicolons && (tokType === _eof || tokType === _braceR || newline.test(input.slice(lastEnd, tokStart)));\n        }\n\n        function semicolon() {\n          if (!eat(_semi) && !canInsertSemicolon()) unexpected();\n        }\n\n        function expect(type) {\n          if (tokType === type) next();else unexpected();\n        }\n\n        function unexpected() {\n          raise(tokStart, \"Unexpected token\");\n        }\n\n        function checkLVal(expr) {\n          if (expr.type !== \"Identifier\" && expr.type !== \"MemberExpression\") raise(expr.start, \"Assigning to rvalue\");\n          if (strict && expr.type === \"Identifier\" && isStrictBadIdWord(expr.name)) raise(expr.start, \"Assigning to \" + expr.name + \" in strict mode\");\n        }\n\n        function parseTopLevel(program) {\n          lastStart = lastEnd = tokPos;\n          if (options.locations) lastEndLoc = new line_loc_t();\n          inFunction = strict = null;\n          labels = [];\n          readToken();\n          var node = program || startNode(),\n              first = true;\n          if (!program) node.body = [];\n\n          while (tokType !== _eof) {\n            var stmt = parseStatement();\n            node.body.push(stmt);\n            if (first && isUseStrict(stmt)) setStrict(true);\n            first = false;\n          }\n\n          return finishNode(node, \"Program\");\n        }\n\n        var loopLabel = {\n          kind: \"loop\"\n        },\n            switchLabel = {\n          kind: \"switch\"\n        };\n\n        function parseStatement() {\n          if (tokType === _slash || tokType === _assign && tokVal == \"/=\") readToken(true);\n          var starttype = tokType,\n              node = startNode();\n\n          switch (starttype) {\n            case _break:\n            case _continue:\n              next();\n              var isBreak = starttype === _break;\n              if (eat(_semi) || canInsertSemicolon()) node.label = null;else if (tokType !== _name) unexpected();else {\n                node.label = parseIdent();\n                semicolon();\n              }\n\n              for (var i = 0; i < labels.length; ++i) {\n                var lab = labels[i];\n\n                if (node.label == null || lab.name === node.label.name) {\n                  if (lab.kind != null && (isBreak || lab.kind === \"loop\")) break;\n                  if (node.label && isBreak) break;\n                }\n              }\n\n              if (i === labels.length) raise(node.start, \"Unsyntactic \" + starttype.keyword);\n              return finishNode(node, isBreak ? \"BreakStatement\" : \"ContinueStatement\");\n\n            case _debugger:\n              next();\n              semicolon();\n              return finishNode(node, \"DebuggerStatement\");\n\n            case _do:\n              next();\n              labels.push(loopLabel);\n              node.body = parseStatement();\n              labels.pop();\n              expect(_while);\n              node.test = parseParenExpression();\n              semicolon();\n              return finishNode(node, \"DoWhileStatement\");\n\n            case _for:\n              next();\n              labels.push(loopLabel);\n              expect(_parenL);\n              if (tokType === _semi) return parseFor(node, null);\n\n              if (tokType === _var) {\n                var init = startNode();\n                next();\n                parseVar(init, true);\n                finishNode(init, \"VariableDeclaration\");\n                if (init.declarations.length === 1 && eat(_in)) return parseForIn(node, init);\n                return parseFor(node, init);\n              }\n\n              var init = parseExpression(false, true);\n\n              if (eat(_in)) {\n                checkLVal(init);\n                return parseForIn(node, init);\n              }\n\n              return parseFor(node, init);\n\n            case _function:\n              next();\n              return parseFunction(node, true);\n\n            case _if:\n              next();\n              node.test = parseParenExpression();\n              node.consequent = parseStatement();\n              node.alternate = eat(_else) ? parseStatement() : null;\n              return finishNode(node, \"IfStatement\");\n\n            case _return:\n              if (!inFunction && !options.allowReturnOutsideFunction) raise(tokStart, \"'return' outside of function\");\n              next();\n              if (eat(_semi) || canInsertSemicolon()) node.argument = null;else {\n                node.argument = parseExpression();\n                semicolon();\n              }\n              return finishNode(node, \"ReturnStatement\");\n\n            case _switch:\n              next();\n              node.discriminant = parseParenExpression();\n              node.cases = [];\n              expect(_braceL);\n              labels.push(switchLabel);\n\n              for (var cur, sawDefault; tokType != _braceR;) {\n                if (tokType === _case || tokType === _default) {\n                  var isCase = tokType === _case;\n                  if (cur) finishNode(cur, \"SwitchCase\");\n                  node.cases.push(cur = startNode());\n                  cur.consequent = [];\n                  next();\n                  if (isCase) cur.test = parseExpression();else {\n                    if (sawDefault) raise(lastStart, \"Multiple default clauses\");\n                    sawDefault = true;\n                    cur.test = null;\n                  }\n                  expect(_colon);\n                } else {\n                  if (!cur) unexpected();\n                  cur.consequent.push(parseStatement());\n                }\n              }\n\n              if (cur) finishNode(cur, \"SwitchCase\");\n              next();\n              labels.pop();\n              return finishNode(node, \"SwitchStatement\");\n\n            case _throw:\n              next();\n              if (newline.test(input.slice(lastEnd, tokStart))) raise(lastEnd, \"Illegal newline after throw\");\n              node.argument = parseExpression();\n              semicolon();\n              return finishNode(node, \"ThrowStatement\");\n\n            case _try:\n              next();\n              node.block = parseBlock();\n              node.handler = null;\n\n              if (tokType === _catch) {\n                var clause = startNode();\n                next();\n                expect(_parenL);\n                clause.param = parseIdent();\n                if (strict && isStrictBadIdWord(clause.param.name)) raise(clause.param.start, \"Binding \" + clause.param.name + \" in strict mode\");\n                expect(_parenR);\n                clause.guard = null;\n                clause.body = parseBlock();\n                node.handler = finishNode(clause, \"CatchClause\");\n              }\n\n              node.guardedHandlers = empty;\n              node.finalizer = eat(_finally) ? parseBlock() : null;\n              if (!node.handler && !node.finalizer) raise(node.start, \"Missing catch or finally clause\");\n              return finishNode(node, \"TryStatement\");\n\n            case _var:\n              next();\n              parseVar(node);\n              semicolon();\n              return finishNode(node, \"VariableDeclaration\");\n\n            case _while:\n              next();\n              node.test = parseParenExpression();\n              labels.push(loopLabel);\n              node.body = parseStatement();\n              labels.pop();\n              return finishNode(node, \"WhileStatement\");\n\n            case _with:\n              if (strict) raise(tokStart, \"'with' in strict mode\");\n              next();\n              node.object = parseParenExpression();\n              node.body = parseStatement();\n              return finishNode(node, \"WithStatement\");\n\n            case _braceL:\n              return parseBlock();\n\n            case _semi:\n              next();\n              return finishNode(node, \"EmptyStatement\");\n\n            default:\n              var maybeName = tokVal,\n                  expr = parseExpression();\n\n              if (starttype === _name && expr.type === \"Identifier\" && eat(_colon)) {\n                for (var i = 0; i < labels.length; ++i) {\n                  if (labels[i].name === maybeName) raise(expr.start, \"Label '\" + maybeName + \"' is already declared\");\n                }\n\n                var kind = tokType.isLoop ? \"loop\" : tokType === _switch ? \"switch\" : null;\n                labels.push({\n                  name: maybeName,\n                  kind: kind\n                });\n                node.body = parseStatement();\n                labels.pop();\n                node.label = expr;\n                return finishNode(node, \"LabeledStatement\");\n              } else {\n                node.expression = expr;\n                semicolon();\n                return finishNode(node, \"ExpressionStatement\");\n              }\n\n          }\n        }\n\n        function parseParenExpression() {\n          expect(_parenL);\n          var val = parseExpression();\n          expect(_parenR);\n          return val;\n        }\n\n        function parseBlock(allowStrict) {\n          var node = startNode(),\n              first = true,\n              strict = false,\n              oldStrict;\n          node.body = [];\n          expect(_braceL);\n\n          while (!eat(_braceR)) {\n            var stmt = parseStatement();\n            node.body.push(stmt);\n\n            if (first && allowStrict && isUseStrict(stmt)) {\n              oldStrict = strict;\n              setStrict(strict = true);\n            }\n\n            first = false;\n          }\n\n          if (strict && !oldStrict) setStrict(false);\n          return finishNode(node, \"BlockStatement\");\n        }\n\n        function parseFor(node, init) {\n          node.init = init;\n          expect(_semi);\n          node.test = tokType === _semi ? null : parseExpression();\n          expect(_semi);\n          node.update = tokType === _parenR ? null : parseExpression();\n          expect(_parenR);\n          node.body = parseStatement();\n          labels.pop();\n          return finishNode(node, \"ForStatement\");\n        }\n\n        function parseForIn(node, init) {\n          node.left = init;\n          node.right = parseExpression();\n          expect(_parenR);\n          node.body = parseStatement();\n          labels.pop();\n          return finishNode(node, \"ForInStatement\");\n        }\n\n        function parseVar(node, noIn) {\n          node.declarations = [];\n          node.kind = \"var\";\n\n          for (;;) {\n            var decl = startNode();\n            decl.id = parseIdent();\n            if (strict && isStrictBadIdWord(decl.id.name)) raise(decl.id.start, \"Binding \" + decl.id.name + \" in strict mode\");\n            decl.init = eat(_eq) ? parseExpression(true, noIn) : null;\n            node.declarations.push(finishNode(decl, \"VariableDeclarator\"));\n            if (!eat(_comma)) break;\n          }\n\n          return node;\n        }\n\n        function parseExpression(noComma, noIn) {\n          var expr = parseMaybeAssign(noIn);\n\n          if (!noComma && tokType === _comma) {\n            var node = startNodeFrom(expr);\n            node.expressions = [expr];\n\n            while (eat(_comma)) {\n              node.expressions.push(parseMaybeAssign(noIn));\n            }\n\n            return finishNode(node, \"SequenceExpression\");\n          }\n\n          return expr;\n        }\n\n        function parseMaybeAssign(noIn) {\n          var left = parseMaybeConditional(noIn);\n\n          if (tokType.isAssign) {\n            var node = startNodeFrom(left);\n            node.operator = tokVal;\n            node.left = left;\n            next();\n            node.right = parseMaybeAssign(noIn);\n            checkLVal(left);\n            return finishNode(node, \"AssignmentExpression\");\n          }\n\n          return left;\n        }\n\n        function parseMaybeConditional(noIn) {\n          var expr = parseExprOps(noIn);\n\n          if (eat(_question)) {\n            var node = startNodeFrom(expr);\n            node.test = expr;\n            node.consequent = parseExpression(true);\n            expect(_colon);\n            node.alternate = parseExpression(true, noIn);\n            return finishNode(node, \"ConditionalExpression\");\n          }\n\n          return expr;\n        }\n\n        function parseExprOps(noIn) {\n          return parseExprOp(parseMaybeUnary(), -1, noIn);\n        }\n\n        function parseExprOp(left, minPrec, noIn) {\n          var prec = tokType.binop;\n\n          if (prec != null && (!noIn || tokType !== _in)) {\n            if (prec > minPrec) {\n              var node = startNodeFrom(left);\n              node.left = left;\n              node.operator = tokVal;\n              var op = tokType;\n              next();\n              node.right = parseExprOp(parseMaybeUnary(), prec, noIn);\n              var exprNode = finishNode(node, op === _logicalOR || op === _logicalAND ? \"LogicalExpression\" : \"BinaryExpression\");\n              return parseExprOp(exprNode, minPrec, noIn);\n            }\n          }\n\n          return left;\n        }\n\n        function parseMaybeUnary() {\n          if (tokType.prefix) {\n            var node = startNode(),\n                update = tokType.isUpdate;\n            node.operator = tokVal;\n            node.prefix = true;\n            tokRegexpAllowed = true;\n            next();\n            node.argument = parseMaybeUnary();\n            if (update) checkLVal(node.argument);else if (strict && node.operator === \"delete\" && node.argument.type === \"Identifier\") raise(node.start, \"Deleting local variable in strict mode\");\n            return finishNode(node, update ? \"UpdateExpression\" : \"UnaryExpression\");\n          }\n\n          var expr = parseExprSubscripts();\n\n          while (tokType.postfix && !canInsertSemicolon()) {\n            var node = startNodeFrom(expr);\n            node.operator = tokVal;\n            node.prefix = false;\n            node.argument = expr;\n            checkLVal(expr);\n            next();\n            expr = finishNode(node, \"UpdateExpression\");\n          }\n\n          return expr;\n        }\n\n        function parseExprSubscripts() {\n          return parseSubscripts(parseExprAtom());\n        }\n\n        function parseSubscripts(base, noCalls) {\n          if (eat(_dot)) {\n            var node = startNodeFrom(base);\n            node.object = base;\n            node.property = parseIdent(true);\n            node.computed = false;\n            return parseSubscripts(finishNode(node, \"MemberExpression\"), noCalls);\n          } else if (eat(_bracketL)) {\n            var node = startNodeFrom(base);\n            node.object = base;\n            node.property = parseExpression();\n            node.computed = true;\n            expect(_bracketR);\n            return parseSubscripts(finishNode(node, \"MemberExpression\"), noCalls);\n          } else if (!noCalls && eat(_parenL)) {\n            var node = startNodeFrom(base);\n            node.callee = base;\n            node.arguments = parseExprList(_parenR, false);\n            return parseSubscripts(finishNode(node, \"CallExpression\"), noCalls);\n          } else return base;\n        }\n\n        function parseExprAtom() {\n          switch (tokType) {\n            case _this:\n              var node = startNode();\n              next();\n              return finishNode(node, \"ThisExpression\");\n\n            case _name:\n              return parseIdent();\n\n            case _num:\n            case _string:\n            case _regexp:\n              var node = startNode();\n              node.value = tokVal;\n              node.raw = input.slice(tokStart, tokEnd);\n              next();\n              return finishNode(node, \"Literal\");\n\n            case _null:\n            case _true:\n            case _false:\n              var node = startNode();\n              node.value = tokType.atomValue;\n              node.raw = tokType.keyword;\n              next();\n              return finishNode(node, \"Literal\");\n\n            case _parenL:\n              var tokStartLoc1 = tokStartLoc,\n                  tokStart1 = tokStart;\n              next();\n              var val = parseExpression();\n              val.start = tokStart1;\n              val.end = tokEnd;\n\n              if (options.locations) {\n                val.loc.start = tokStartLoc1;\n                val.loc.end = tokEndLoc;\n              }\n\n              if (options.ranges) val.range = [tokStart1, tokEnd];\n              expect(_parenR);\n              return val;\n\n            case _bracketL:\n              var node = startNode();\n              next();\n              node.elements = parseExprList(_bracketR, true, true);\n              return finishNode(node, \"ArrayExpression\");\n\n            case _braceL:\n              return parseObj();\n\n            case _function:\n              var node = startNode();\n              next();\n              return parseFunction(node, false);\n\n            case _new:\n              return parseNew();\n\n            default:\n              unexpected();\n          }\n        }\n\n        function parseNew() {\n          var node = startNode();\n          next();\n          node.callee = parseSubscripts(parseExprAtom(), true);\n          if (eat(_parenL)) node.arguments = parseExprList(_parenR, false);else node.arguments = empty;\n          return finishNode(node, \"NewExpression\");\n        }\n\n        function parseObj() {\n          var node = startNode(),\n              first = true,\n              sawGetSet = false;\n          node.properties = [];\n          next();\n\n          while (!eat(_braceR)) {\n            if (!first) {\n              expect(_comma);\n              if (options.allowTrailingCommas && eat(_braceR)) break;\n            } else first = false;\n\n            var prop = {\n              key: parsePropertyName()\n            },\n                isGetSet = false,\n                kind;\n\n            if (eat(_colon)) {\n              prop.value = parseExpression(true);\n              kind = prop.kind = \"init\";\n            } else if (options.ecmaVersion >= 5 && prop.key.type === \"Identifier\" && (prop.key.name === \"get\" || prop.key.name === \"set\")) {\n              isGetSet = sawGetSet = true;\n              kind = prop.kind = prop.key.name;\n              prop.key = parsePropertyName();\n              if (tokType !== _parenL) unexpected();\n              prop.value = parseFunction(startNode(), false);\n            } else unexpected();\n\n            if (prop.key.type === \"Identifier\" && (strict || sawGetSet)) {\n              for (var i = 0; i < node.properties.length; ++i) {\n                var other = node.properties[i];\n\n                if (other.key.name === prop.key.name) {\n                  var conflict = kind == other.kind || isGetSet && other.kind === \"init\" || kind === \"init\" && (other.kind === \"get\" || other.kind === \"set\");\n                  if (conflict && !strict && kind === \"init\" && other.kind === \"init\") conflict = false;\n                  if (conflict) raise(prop.key.start, \"Redefinition of property\");\n                }\n              }\n            }\n\n            node.properties.push(prop);\n          }\n\n          return finishNode(node, \"ObjectExpression\");\n        }\n\n        function parsePropertyName() {\n          if (tokType === _num || tokType === _string) return parseExprAtom();\n          return parseIdent(true);\n        }\n\n        function parseFunction(node, isStatement) {\n          if (tokType === _name) node.id = parseIdent();else if (isStatement) unexpected();else node.id = null;\n          node.params = [];\n          var first = true;\n          expect(_parenL);\n\n          while (!eat(_parenR)) {\n            if (!first) expect(_comma);else first = false;\n            node.params.push(parseIdent());\n          }\n\n          var oldInFunc = inFunction,\n              oldLabels = labels;\n          inFunction = true;\n          labels = [];\n          node.body = parseBlock(true);\n          inFunction = oldInFunc;\n          labels = oldLabels;\n\n          if (strict || node.body.body.length && isUseStrict(node.body.body[0])) {\n            for (var i = node.id ? -1 : 0; i < node.params.length; ++i) {\n              var id = i < 0 ? node.id : node.params[i];\n              if (isStrictReservedWord(id.name) || isStrictBadIdWord(id.name)) raise(id.start, \"Defining '\" + id.name + \"' in strict mode\");\n              if (i >= 0) for (var j = 0; j < i; ++j) {\n                if (id.name === node.params[j].name) raise(id.start, \"Argument name clash in strict mode\");\n              }\n            }\n          }\n\n          return finishNode(node, isStatement ? \"FunctionDeclaration\" : \"FunctionExpression\");\n        }\n\n        function parseExprList(close, allowTrailingComma, allowEmpty) {\n          var elts = [],\n              first = true;\n\n          while (!eat(close)) {\n            if (!first) {\n              expect(_comma);\n              if (allowTrailingComma && options.allowTrailingCommas && eat(close)) break;\n            } else first = false;\n\n            if (allowEmpty && tokType === _comma) elts.push(null);else elts.push(parseExpression(true));\n          }\n\n          return elts;\n        }\n\n        function parseIdent(liberal) {\n          var node = startNode();\n          if (liberal && options.forbidReserved == \"everywhere\") liberal = false;\n\n          if (tokType === _name) {\n            if (!liberal && (options.forbidReserved && (options.ecmaVersion === 3 ? isReservedWord3 : isReservedWord5)(tokVal) || strict && isStrictReservedWord(tokVal)) && input.slice(tokStart, tokEnd).indexOf(\"\\\\\") == -1) raise(tokStart, \"The keyword '\" + tokVal + \"' is reserved\");\n            node.name = tokVal;\n          } else if (liberal && tokType.keyword) {\n            node.name = tokType.keyword;\n          } else {\n            unexpected();\n          }\n\n          tokRegexpAllowed = false;\n          next();\n          return finishNode(node, \"Identifier\");\n        }\n      });\n\n      if (!acorn.version) acorn = null;\n    }\n\n    function parse(code, options) {\n      return (global.acorn || acorn).parse(code, options);\n    }\n\n    var binaryOperators = {\n      '+': '__add',\n      '-': '__subtract',\n      '*': '__multiply',\n      '/': '__divide',\n      '%': '__modulo',\n      '==': '__equals',\n      '!=': '__equals'\n    };\n    var unaryOperators = {\n      '-': '__negate',\n      '+': '__self'\n    };\n    var fields = Base.each(['add', 'subtract', 'multiply', 'divide', 'modulo', 'equals', 'negate'], function (name) {\n      this['__' + name] = '#' + name;\n    }, {\n      __self: function __self() {\n        return this;\n      }\n    });\n    Point.inject(fields);\n    Size.inject(fields);\n    Color.inject(fields);\n\n    function __$__(left, operator, right) {\n      var handler = binaryOperators[operator];\n\n      if (left && left[handler]) {\n        var res = left[handler](right);\n        return operator === '!=' ? !res : res;\n      }\n\n      switch (operator) {\n        case '+':\n          return left + right;\n\n        case '-':\n          return left - right;\n\n        case '*':\n          return left * right;\n\n        case '/':\n          return left / right;\n\n        case '%':\n          return left % right;\n\n        case '==':\n          return left == right;\n\n        case '!=':\n          return left != right;\n      }\n    }\n\n    function $__(operator, value) {\n      var handler = unaryOperators[operator];\n      if (value && value[handler]) return value[handler]();\n\n      switch (operator) {\n        case '+':\n          return +value;\n\n        case '-':\n          return -value;\n      }\n    }\n\n    function compile(code, options) {\n      if (!code) return '';\n      options = options || {};\n      var insertions = [];\n\n      function getOffset(offset) {\n        for (var i = 0, l = insertions.length; i < l; i++) {\n          var insertion = insertions[i];\n          if (insertion[0] >= offset) break;\n          offset += insertion[1];\n        }\n\n        return offset;\n      }\n\n      function getCode(node) {\n        return code.substring(getOffset(node.range[0]), getOffset(node.range[1]));\n      }\n\n      function getBetween(left, right) {\n        return code.substring(getOffset(left.range[1]), getOffset(right.range[0]));\n      }\n\n      function replaceCode(node, str) {\n        var start = getOffset(node.range[0]),\n            end = getOffset(node.range[1]),\n            insert = 0;\n\n        for (var i = insertions.length - 1; i >= 0; i--) {\n          if (start > insertions[i][0]) {\n            insert = i + 1;\n            break;\n          }\n        }\n\n        insertions.splice(insert, 0, [start, str.length - end + start]);\n        code = code.substring(0, start) + str + code.substring(end);\n      }\n\n      function walkAST(node, parent) {\n        if (!node) return;\n\n        for (var key in node) {\n          if (key === 'range' || key === 'loc') continue;\n          var value = node[key];\n\n          if (_Array$isArray(value)) {\n            for (var i = 0, l = value.length; i < l; i++) {\n              walkAST(value[i], node);\n            }\n          } else if (value && _typeof(value) === 'object') {\n            walkAST(value, node);\n          }\n        }\n\n        switch (node.type) {\n          case 'UnaryExpression':\n            if (node.operator in unaryOperators && node.argument.type !== 'Literal') {\n              var arg = getCode(node.argument);\n              replaceCode(node, '$__(\"' + node.operator + '\", ' + arg + ')');\n            }\n\n            break;\n\n          case 'BinaryExpression':\n            if (node.operator in binaryOperators && node.left.type !== 'Literal') {\n              var left = getCode(node.left),\n                  right = getCode(node.right),\n                  between = getBetween(node.left, node.right),\n                  operator = node.operator;\n              replaceCode(node, '__$__(' + left + ',' + between.replace(new RegExp('\\\\' + operator), '\"' + operator + '\"') + ', ' + right + ')');\n            }\n\n            break;\n\n          case 'UpdateExpression':\n          case 'AssignmentExpression':\n            var parentType = parent && parent.type;\n\n            if (!(parentType === 'ForStatement' || parentType === 'BinaryExpression' && /^[=!<>]/.test(parent.operator) || parentType === 'MemberExpression' && parent.computed)) {\n              if (node.type === 'UpdateExpression') {\n                var arg = getCode(node.argument),\n                    exp = '__$__(' + arg + ', \"' + node.operator[0] + '\", 1)',\n                    str = arg + ' = ' + exp;\n\n                if (!node.prefix && (parentType === 'AssignmentExpression' || parentType === 'VariableDeclarator')) {\n                  if (getCode(parent.left || parent.id) === arg) str = exp;\n                  str = arg + '; ' + str;\n                }\n\n                replaceCode(node, str);\n              } else {\n                if (/^.=$/.test(node.operator) && node.left.type !== 'Literal') {\n                  var left = getCode(node.left),\n                      right = getCode(node.right),\n                      exp = left + ' = __$__(' + left + ', \"' + node.operator[0] + '\", ' + right + ')';\n                  replaceCode(node, /^\\(.*\\)$/.test(getCode(node)) ? '(' + exp + ')' : exp);\n                }\n              }\n            }\n\n            break;\n\n          case 'ExportDefaultDeclaration':\n            replaceCode({\n              range: [node.start, node.declaration.start]\n            }, 'module.exports = ');\n            break;\n\n          case 'ExportNamedDeclaration':\n            var declaration = node.declaration;\n            var specifiers = node.specifiers;\n\n            if (declaration) {\n              var declarations = declaration.declarations;\n\n              if (declarations) {\n                declarations.forEach(function (dec) {\n                  replaceCode(dec, 'module.exports.' + getCode(dec));\n                });\n                replaceCode({\n                  range: [node.start, declaration.start + declaration.kind.length]\n                }, '');\n              }\n            } else if (specifiers) {\n              var exports = specifiers.map(function (specifier) {\n                var name = getCode(specifier);\n                return 'module.exports.' + name + ' = ' + name + '; ';\n              }).join('');\n\n              if (exports) {\n                replaceCode(node, exports);\n              }\n            }\n\n            break;\n        }\n      }\n\n      function encodeVLQ(value) {\n        var res = '',\n            base64 = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';\n        value = (Math.abs(value) << 1) + (value < 0 ? 1 : 0);\n\n        while (value || !res) {\n          var next = value & 32 - 1;\n          value >>= 5;\n          if (value) next |= 32;\n          res += base64[next];\n        }\n\n        return res;\n      }\n\n      var url = options.url || '',\n          agent = paper.agent,\n          version = agent.versionNumber,\n          offsetCode = false,\n          sourceMaps = options.sourceMaps,\n          source = options.source || code,\n          lineBreaks = /\\r\\n|\\n|\\r/mg,\n          offset = options.offset || 0,\n          map;\n\n      if (sourceMaps && (agent.chrome && version >= 30 || agent.webkit && version >= 537.76 || agent.firefox && version >= 23 || agent.node)) {\n        if (agent.node) {\n          offset -= 2;\n        } else if (window && url && !window.location.href.indexOf(url)) {\n          var html = document.getElementsByTagName('html')[0].innerHTML;\n          offset = html.substr(0, html.indexOf(code) + 1).match(lineBreaks).length + 1;\n        }\n\n        offsetCode = offset > 0 && !(agent.chrome && version >= 36 || agent.safari && version >= 600 || agent.firefox && version >= 40 || agent.node);\n        var mappings = ['AA' + encodeVLQ(offsetCode ? 0 : offset) + 'A'];\n        mappings.length = (code.match(lineBreaks) || []).length + 1 + (offsetCode ? offset : 0);\n        map = {\n          version: 3,\n          file: url,\n          names: [],\n          mappings: mappings.join(';AACA'),\n          sourceRoot: '',\n          sources: [url],\n          sourcesContent: [source]\n        };\n      }\n\n      walkAST(parse(code, {\n        ranges: true,\n        preserveParens: true,\n        sourceType: 'module'\n      }));\n\n      if (map) {\n        if (offsetCode) {\n          code = new Array(offset + 1).join('\\n') + code;\n        }\n\n        if (/^(inline|both)$/.test(sourceMaps)) {\n          code += \"\\n//# sourceMappingURL=data:application/json;base64,\" + self.btoa(unescape(encodeURIComponent(_JSON$stringify(map))));\n        }\n\n        code += \"\\n//# sourceURL=\" + (url || 'paperscript');\n      }\n\n      return {\n        url: url,\n        source: source,\n        code: code,\n        map: map\n      };\n    }\n\n    function execute(code, scope, options) {\n      paper = scope;\n      var view = scope.getView(),\n          tool = /\\btool\\.\\w+|\\s+on(?:Key|Mouse)(?:Up|Down|Move|Drag)\\b/.test(code) && !/\\bnew\\s+Tool\\b/.test(code) ? new Tool() : null,\n          toolHandlers = tool ? tool._events : [],\n          handlers = ['onFrame', 'onResize'].concat(toolHandlers),\n          params = [],\n          args = [],\n          func,\n          compiled = _typeof(code) === 'object' ? code : compile(code, options);\n      code = compiled.code;\n\n      function expose(scope, hidden) {\n        for (var key in scope) {\n          if ((hidden || !/^_/.test(key)) && new RegExp('([\\\\b\\\\s\\\\W]|^)' + key.replace(/\\$/g, '\\\\$') + '\\\\b').test(code)) {\n            params.push(key);\n            args.push(scope[key]);\n          }\n        }\n      }\n\n      expose({\n        __$__: __$__,\n        $__: $__,\n        paper: scope,\n        view: view,\n        tool: tool\n      }, true);\n      expose(scope);\n      code = 'var module = { exports: {} }; ' + code;\n      var exports = Base.each(handlers, function (key) {\n        if (new RegExp('\\\\s+' + key + '\\\\b').test(code)) {\n          params.push(key);\n          this.push('module.exports.' + key + ' = ' + key + ';');\n        }\n      }, []).join('\\n');\n\n      if (exports) {\n        code += '\\n' + exports;\n      }\n\n      code += '\\nreturn module.exports;';\n      var agent = paper.agent;\n\n      if (document && (agent.chrome || agent.firefox && agent.versionNumber < 40)) {\n        var script = document.createElement('script'),\n            head = document.head || document.getElementsByTagName('head')[0];\n        if (agent.firefox) code = '\\n' + code;\n        script.appendChild(document.createTextNode('document.__paperscript__ = function(' + params + ') {' + code + '\\n}'));\n        head.appendChild(script);\n        func = document.__paperscript__;\n        delete document.__paperscript__;\n        head.removeChild(script);\n      } else {\n        func = Function(params, code);\n      }\n\n      var exports = func && func.apply(scope, args);\n      var obj = exports || {};\n      Base.each(toolHandlers, function (key) {\n        var value = obj[key];\n        if (value) tool[key] = value;\n      });\n\n      if (view) {\n        if (obj.onResize) view.setOnResize(obj.onResize);\n        view.emit('resize', {\n          size: view.size,\n          delta: new Point()\n        });\n        if (obj.onFrame) view.setOnFrame(obj.onFrame);\n        view.requestUpdate();\n      }\n\n      return exports;\n    }\n\n    function loadScript(script) {\n      if (/^text\\/(?:x-|)paperscript$/.test(script.type) && PaperScope.getAttribute(script, 'ignore') !== 'true') {\n        var canvasId = PaperScope.getAttribute(script, 'canvas'),\n            canvas = document.getElementById(canvasId),\n            src = script.src || script.getAttribute('data-src'),\n            async = PaperScope.hasAttribute(script, 'async'),\n            scopeAttribute = 'data-paper-scope';\n        if (!canvas) throw new Error('Unable to find canvas with id \"' + canvasId + '\"');\n        var scope = PaperScope.get(canvas.getAttribute(scopeAttribute)) || new PaperScope().setup(canvas);\n        canvas.setAttribute(scopeAttribute, scope._id);\n\n        if (src) {\n          Http.request({\n            url: src,\n            async: async,\n            mimeType: 'text/plain',\n            onLoad: function onLoad(code) {\n              execute(code, scope, src);\n            }\n          });\n        } else {\n          execute(script.innerHTML, scope, script.baseURI);\n        }\n\n        script.setAttribute('data-paper-ignore', 'true');\n        return scope;\n      }\n    }\n\n    function loadAll() {\n      Base.each(document && document.getElementsByTagName('script'), loadScript);\n    }\n\n    function load(script) {\n      return script ? loadScript(script) : loadAll();\n    }\n\n    if (window) {\n      if (document.readyState === 'complete') {\n        setTimeout(loadAll);\n      } else {\n        DomEvent.add(window, {\n          load: loadAll\n        });\n      }\n    }\n\n    return {\n      compile: compile,\n      execute: execute,\n      load: load,\n      parse: parse,\n      calculateBinary: __$__,\n      calculateUnary: $__\n    };\n  }.call(this);\n\n  var paper = new (PaperScope.inject(Base.exports, {\n    Base: Base,\n    Numerical: Numerical,\n    Key: Key,\n    DomEvent: DomEvent,\n    DomElement: DomElement,\n    document: document,\n    window: window,\n    Symbol: SymbolDefinition,\n    PlacedSymbol: SymbolItem\n  }))();\n\n  if (paper.agent.node) {\n    require('./node/extend.js')(paper);\n  }\n\n  if (typeof define === 'function' && define.amd) {\n    define('paper', paper);\n  } else if ((typeof module === \"undefined\" ? \"undefined\" : _typeof(module)) === 'object' && module) {\n    module.exports = paper;\n  }\n\n  return paper;\n}.call(this, (typeof self === \"undefined\" ? \"undefined\" : _typeof(self)) === 'object' ? self : null);",{"version":3,"sources":["D:\\GitHub\\Vectory\\vectory\\src\\libraries\\paper-full.js"],"names":["paper","self","undefined","require","window","document","Base","hidden","array","slice","create","describe","define","forEach","iter","bind","i","l","length","call","forIn","hasOwnProperty","set","dst","arguments","src","key","each","obj","desc","value","inject","dest","enumerable","beans","preserve","beansNames","field","name","val","get","substring","isFunc","res","prev","base","bean","match","toLowerCase","isPlainObject","writable","configurable","test","part","statics","prototype","extend","ctor","proto","initialize","apply","clone","constructor","Object","pick","a","b","list","begin","end","module","exports","toString","_id","_class","_name","type","push","Formatter","instance","number","join","getClassName","importJSON","json","exportJSON","options","toJSON","serialize","props","exclude","filter","_prioritize","equals","obj1","obj2","keys","read","start","amount","peek","__index","readIndex","_readIndex","readNull","__read","filtered","__filtered","remain","readList","entry","readNamed","getNamed","hasObject","__unfiltered","arg","_hasObject","hasNamed","source","prioritize","processed","handleKey","isPlainValue","asString","compact","dictionary","isRoot","formatter","precision","definitions","references","add","item","id","ref","unshift","_serialize","_compactSerialize","deserialize","_data","_setDictionary","_isRoot","isFirst","hasDictionary","isDictionary","args","target","JSON","parse","useTarget","Item","Layer","insert","items","itemsLength","startLength","splice","index","remove","append","_index","removed","capitalize","str","replace","toUpperCase","camelize","chr","hyphenate","Emitter","on","func","types","_eventTypes","handlers","_callbacks","indexOf","install","off","uninstall","once","handler","emit","event","setTarget","currentTarget","stop","responds","attach","detach","fire","_installEvents","events","_events","isString","PaperScope","settings","applyMatrix","insertItems","handleSize","hitTolerance","project","projects","tools","_scopes","support","ctx","CanvasProvider","getContext","nativeDash","nativeBlendModes","BlendMode","nativeModes","release","agent","user","navigator","userAgent","os","exec","platform","browser","n","v1","v2","rv","chrome","v","version","versionNumber","webkit","atom","getView","_view","getPaper","execute","code","PaperScript","View","updateFocus","scope","that","setup","element","Project","createCanvas","width","height","getCanvas","activate","clear","handleAttribute","el","attr","getAttribute","hasAttribute","PaperScopeItem","_scope","_list","_reference","isActive","multiplier","Math","pow","round","pair","val1","val2","separator","point","x","y","size","rectangle","Numerical","abscissas","weights","abs","sqrt","log2","log","LOG2E","EPSILON","MACHINE_EPSILON","clamp","min","max","getDiscriminant","c","split","hi","lo","D","E","ad","bd","cd","p","dp","q","dq","getNormalizationFactor","norm","CURVETIME_EPSILON","GEOMETRIC_EPSILON","TRIGONOMETRIC_EPSILON","KAPPA","isZero","integrate","f","w","A","B","m","sum","Ax","findRoot","df","tolerance","fx","dx","nx","solveQuadratic","roots","x1","x2","Infinity","Q","R","count","boundless","minB","maxB","isFinite","solveCubic","d","b1","c2","qd","evaluate","x0","tmp","t","r","s","td","rd","UID","_pools","pool","Point","arg0","arg1","reading","hasY","_set","setAngle","angle","getLength","setLength","_angle","cos","sin","scale","getAngle","getAngleInRadians","PI","setAngleInRadians","getAngleInDegrees","setAngleInDegrees","atan2","div","NaN","dot","acos","getQuadrant","getDirectedAngle","cross","getDistance","squared","normalize","current","rotate","center","subtract","transform","matrix","_transformPoint","multiply","divide","modulo","negate","isInside","Rectangle","contains","isClose","isCollinear","isColinear","isOrthogonal","isNaN","isInQuadrant","point1","point2","random","y1","y2","op","LinkedPoint","owner","setter","_x","_y","_owner","_setter","_dontNotify","getX","setX","getY","setY","isSelected","_selection","_getSelection","setSelected","selected","_changeSelection","Size","hasHeight","size1","size2","LinkedSize","_width","_height","getWidth","setWidth","getHeight","setHeight","arg2","arg3","from","to","frm","next","rect","rt","getPoint","_dontLink","setPoint","getSize","_fw","_fh","setSize","sx","_sx","sy","_sy","h","getLeft","setLeft","left","getTop","setTop","top","getRight","setRight","right","getBottom","setBottom","bottom","getCenterX","setCenterX","getCenterY","setCenterY","getCenter","setCenter","getArea","isEmpty","_containsRectangle","_containsPoint","intersects","epsilon","intersect","unite","include","expand","hor","ver","parts","xFirst","LinkedRectangle","internal","Matrix","ok","_a","_b","_c","_d","_tx","_ty","concat","reset","Error","tx","ty","_changed","getValues","_applyMatrix","mx","recursively","_setApplyMatrix","isIdentity","translate","shear","skew","toRadians","tan","a1","c1","d1","a2","b2","d2","tx2","ty2","prepend","tx1","ty1","appended","prepended","invert","det","inverted","concatenate","preConcatenate","chain","_shiftless","_orNullIfIdentity","isInvertible","isSingular","_transformCoordinates","_transformCorners","coords","_transformBounds","bounds","j","inverseTransform","_inverseTransform","decompose","degrees","asin","translation","getTranslation","rotation","scaling","skewing","getScaling","getRotation","applyToContext","prop","Line","arg4","asVector","_px","_py","_vx","_vy","getVector","line","isInfinite","getSide","getSignedDistance","p1x","p1y","v1x","v1y","p2x","p2y","v2x","v2y","dy","u1","u2","uMin","uMax","px","py","vx","vy","ccw","_children","_namedChildren","_activeLayer","_currentStyle","Style","_selectionItems","_selectionCount","_updateVersion","flags","view","_needsUpdate","_requested","_autoUpdate","requestUpdate","changes","_changes","changesById","_changesById","children","getCurrentStyle","setCurrentStyle","style","getIndex","getOptions","getLayers","getActiveLayer","getSymbolDefinitions","ids","getItems","class","SymbolItem","definition","_definition","getSymbols","getSelectedItems","selectionItems","selection","isInserted","_updateSelection","selectAll","setFullySelected","deselectAll","addLayer","layer","insertLayer","_remove","_setProject","setName","_insertItem","_created","NO_INSERT","insertChild","_getItems","getItem","removeOn","sets","_removeSets","mousedrag","other","draw","pixelRatio","save","param","offset","viewMatrix","matrices","updateMatrix","restore","strokeWidth","_drawSelection","_serializeFields","_canApplyMatrix","_canScaleStroke","_pivot","_visible","_blendMode","_opacity","_locked","_guide","_clipMask","_selectBounds","_selectChildren","pivot","visible","blendMode","opacity","locked","guide","clipMask","data","_countItemEvent","onFrame","_animateItem","onLoad","onError","_itemHandlers","_initialize","hasProps","_matrix","_parent","_style","parent","fields","fontSize","Group","_defaults","symbol","_symbol","cacheParent","_project","_bounds","_position","_decomposed","_globalMatrix","_clearBoundsCache","getId","getName","_removeNamed","_getOwner","namedChildren","getStyle","setStyle","getSelection","setSelection","flag","isFullySelected","isClipMask","setClipMask","setFillColor","setStrokeColor","getData","setData","getPosition","position","_getPositionFromBounds","setPosition","getBounds","getPivot","setPivot","getStrokeBounds","stroke","getHandleBounds","handle","getInternalBounds","hasMatrix","opts","_boundsOptions","getStrokeScaling","cacheItem","_getCachedBounds","setBounds","_backup","_getBounds","_updateBoundsCache","_getBoundsCacheKey","noInternal","cacheKey","cached","nonscaling","hasStroke","_getStrokeMatrix","_item","getViewMatrix","_boundsCache","cache","_decompose","decomposed","setRotation","setScaling","getMatrix","setMatrix","getGlobalMatrix","_dontClone","parents","getApplyMatrix","setApplyMatrix","getTransformContent","setTransformContent","getProject","installEvents","getLayer","getParent","setParent","addChild","getChildren","setChildren","removeChildren","addChildren","getFirstChild","getLastChild","getNextSibling","getPreviousSibling","_equals","copy","deep","copyAttributes","copyContent","insertAbove","orig","excludeMatrix","rasterize","resolution","getResolution","topLeft","getTopLeft","floor","bottomRight","getBottomRight","ceil","raster","Raster","canvas","setCanvas","_contains","_asPathItem","Path","getIntersections","hitTest","_hitTest","HitResult","hitTestAll","all","hitTestChildren","_exclude","child","_hitTestChildren","parentViewMatrix","guides","tolerancePadding","_tolerancePadding","_getStrokePadding","checkSelf","hit","checkPoint","pt","checkPosition","checkCenter","checkBounds","points","_hitTestSelf","fill","hasFill","matches","compare","matchObject","firstOnly","overlapping","inside","recursive","path","childMatrix","insertChildren","inserted","notifySelf","_insertAt","insertBelow","sendToBack","bringToFront","appendTop","appendBottom","moveAbove","moveBelow","addTo","copyTo","reduce","namedArray","notifyParent","_dispose","replaceWith","reverseChildren","reverse","isEditable","hasShadow","_getOrder","getList","list1","list2","hasChildren","isAbove","isBelow","isParent","isChild","isDescendant","isAncestor","isSibling","isGroupedWith","_applyRecursively","transformMatrix","fillColor","getFillColor","strokeColor","getStrokeColor","_transformContent","decomp","applyRecursively","globalToLocal","localToGlobal","parentToLocal","localToParent","fitBounds","itemRatio","rectRatio","newBounds","_setStyles","fillStyle","toCanvasStyle","strokeStyle","lineWidth","getStrokeWidth","strokeJoin","getStrokeJoin","strokeCap","getStrokeCap","miterLimit","getMiterLimit","lineJoin","lineCap","dashArray","getDashArray","dashOffset","getDashOffset","setLineDash","lineDashOffset","mozDash","mozDashOffset","blur","getShadowBlur","getShadowOffset","shadowColor","getShadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","parentStrokeMatrix","updateVersion","globalMatrix","normalBlend","nativeBlend","direct","dontStart","clip","_canComposite","mainCtx","itemOffset","prevOffset","pop","strokeMatrix","clipItem","globalAlpha","globalCompositeOperation","setTransform","_draw","dontFinish","process","_isUpdated","CompoundPath","updated","itemSelected","boundsSelected","positionSelected","_drawSelected","color","getSelectedColor","half","pos","beginPath","arc","deltas","delta","moveTo","lineTo","closePath","fillRect","hash","tween","easing","duration","Tween","_handleFrame","time","running","tweenTo","tweenFrom","_clipItem","_getClipItem","isClipped","setClipped","clipped","Shape","radius","_type","_size","_radius","setType","setRadius","getType","getShape","setShape","getRadius","rad","toPath","toShape","dontPaint","untransformed","isCircle","rx","ry","kappa","cx","cy","bezierCurveTo","getFillRule","getCornerCenter","halfSize","dir","corner","quadrant","isOnEllipseStroke","padding","vector","hitStroke","hitFill","strokeRadius","strokePadding","outer","inner","createShape","Circle","Ellipse","ellipse","_readEllipse","crossOrigin","_smoothing","object","image","getElementById","setImage","setSource","_loaded","getSource","_image","_canvas","_setImage","copyCanvas","drawImage","_crossOrigin","getElement","getLoaded","u","getPpi","getImage","Event","setTimeout","DomEvent","load","error","complete","naturalWidth","naturalHeight","_context","e","modify","setContext","context","toDataURL","Image","getCrossOrigin","setCrossOrigin","getSmoothing","setSmoothing","smoothing","getSubCanvas","getSubRaster","getAverageColor","PathItem","sampleSize","_sampleContext","clearRect","pixels","getImageData","channels","total","alpha","Color","getPixel","setPixel","components","_convert","_alpha","imageData","createImageData","putImageData","setImageData","DomElement","setPrefixed","setDefinition","SymbolDefinition","getDefinition","getSymbol","setSymbol","dontCenter","setItem","_dontCenter","place","values","segments","handles","ends","Segment","arg5","handleIn","handleOut","SegmentPoint","_point","hasHandles","_handleIn","_handleOut","_path","curves","_curves","curve","_closed","getHandleIn","setHandleIn","getHandleOut","setHandleOut","isSmooth","clearHandles","oldSelection","getPath","getCurve","_segments","getCurves","getLocation","CurveLocation","_segment1","getNext","smooth","_first","_last","factor","getPrevious","p0","p1","p2","d1_a","d1_2a","d2_a","d2_2a","N","k","isLast","reversed","removeSegment","segment","Array","interpolate","handleIn1","handleIn2","handleOut2","handleOut1","change","Curve","arg6","arg7","seg1","seg2","handle1","handle2","segment1","segment2","_segment2","getPoint1","getHandle1","getHandle2","getPoint2","_length","classify","setPoint1","setPoint2","setHandle1","setHandle2","getSegment1","getSegment2","getPoints","getLine","getPart","getPartLength","divideAt","location","divideAtTime","getTimeAt","_setHandles","tMin","tMax","subdivide","setHandles","splitAt","splitAtTime","getLocationAtTime","isTime","straight","h1","h2","y0","x3","y3","x4","y4","x5","y5","x6","y6","x7","y7","x8","y8","x9","y9","getMonoCurves","io","o0","o1","o2","o3","isStraight","sort","coord","v0","v3","getTimeOf","p3","geomEpsilon","getNearestTime","minDist","minT","refine","dist","step","flip","isFlatEnough","flatness","ux","uy","_addBounds","minPad","maxPad","s1","s2","isLinear","third","hasLength","isHorizontal","getTangentAtTime","isVertical","getLocationAt","_isTime","getParameterAt","getTimesWithTangent","tangent","getOffsetAtTime","getLocationOf","getOffsetOf","loc","getOffset","getParameterOf","getNearestLocation","getNearestPoint","methods","_evaluateMethods","getLengthIntegrand","ax","bx","ay","by","getIterations","normalized","len","a3","d3","serpentine","t1","t2","hasRoots","t1Ok","t2Ok","f1","f2","ds","forward","rangeLength","diff","guess","getTangent","getWeightedTangent","getNormal","getWeightedNormal","getCurvature","getPeaks","addLocation","locations","overlap","excludeStart","excludeEnd","loc1","loc2","_intersection","addCurveIntersections","recursion","calls","fatLineEpsilon","q0x","q0y","q3x","q3y","dMin","dMax","dp0","dp1","dp2","dp3","hull","getConvexHull","tMinClip","tMaxClip","clipConvexHull","tMinNew","tMaxNew","dq0","dq1","dq2","dq3","dist1","dist2","distRatio","hullTop","hullBottom","clipConvexHullPart","threshold","qx","qy","getCurveLineIntersections","addCurveLineIntersections","addLineIntersection","getCurveIntersections","overlaps","getOverlaps","straight1","straight2","before","i1","i2","getLoopIntersection","info","curves1","curves2","matrix1","matrix2","_returnFirst","length1","length2","values2","arrays","curve1","values1","path1","getSquaredLineLength","timeEpsilon","straightBoth","l1","l2","pairs","den","times","num","t0","_overlap","_distance","_setCurve","_time","getPointAtTime","_next","_previous","_version","_curve","_segment","_setSegment","getSegment","getTime","_offset","_curveOffset","trySegment","getParameter","getCurveOffset","getIntersection","getLastSegment","_ignoreOther","isTouching","inter","curve2","isCrossing","t1Inside","t2Inside","c4","c3","offsets","addOffsets","isInRange","getPointAt","v4","a4","hasOverlap","merge","search","found","path2","expanded","compound","pathData","first","isClockwise","setClockwise","clockwise","setPathData","relative","previous","control","getCoord","command","lower","move","cubicCurveTo","quadraticCurveTo","arcTo","winding","_getWinding","onPath","windingL","windingR","getCrossings","minLoc","isPath","itemsFrom","itemsTo","setClosed","paths1","paths2","matched","closed","setSegments","_segmentSelection","_area","getSegments","fullySelected","last","_add","getFirstSegment","_countCurves","getFirstCurve","getLastCurve","isClosed","getPathData","_precision","curX","curY","prevX","prevY","inX","inY","outX","outY","addSegment","skipLine","segs","_adjustCurves","insertSegment","addSegments","insertSegments","removeSegments","_includeCurves","area","_selectSegments","newSelection","last1","last2","first2","first1","simplify","flatten","flattener","PathFlattener","PathFitter","fit","_default","loop","asymmetric","paddingLeft","paddingRight","knots","n_1","rf","hx","hy","topCenter","seg3","seg4","isArc","pt1","pt2","shape","pos1","pos2","end1","end2","start2","numSegments","cap","hitCurves","isCloseEnough","checkSegmentPoint","seg","anchor","checkSegmentPoints","addToArea","checkSegmentStroke","isJoin","_addBevelJoin","_addSquareCap","getOffsetsWithTangent","curveStart","curveTimes","drawHandles","pX","pY","drawHandle","hX","hY","drawSegments","drawSegment","dashLength","drawPart","getCurrentSegment","moveBy","curveTo","through","extent","middle","large","rxSq","rySq","xSq","ySq","throughSide","centerSide","ext","inc","z","out","_in","lineBy","curveBy","parameter","cubicCurveBy","quadraticCurveBy","arcBy","method","prevCoords","processSegment","joinBounds","addPoint","addRound","addJoin","addCap","phi","isArea","normal1","getNormalAtTime","normal2","normal","joinPadding","joinRadius","SQRT2","paddingX","paddingY","xn","xx","yn","yx","ellipseSegments","createPath","createEllipse","bl","getBottomLeft","tl","tr","getTopRight","br","RoundRectangle","Oval","Arc","RegularPolygon","sides","three","Star","radius1","radius2","paths","getCurrentPath","check","operators","preparePath","resolve","resolveCrossings","reorient","createResult","result","traceBoolean","operation","trace","splitBoolean","_path1","_path2","operator","crossings","divideLocations","collect","_overlapsOnly","propagateWinding","_winding","tracePaths","reorientPaths","added","addPath","linkIntersections","clearCurveHandles","lookup","container","sorted","entry1","getInteriorPoint","containerWinding","entry2","clearLater","results","clearCurves","clearLookup","renormalizeLocs","prevCurve","prevTime","origTime","newCurve","getWinding","dontFlip","ia","pv","pa","po","windingEpsilon","qualityEpsilon","paL","paR","pathWindingL","pathWindingR","onAnyPath","quality","vPrev","vClose","addWinding","a0","windingPrev","a3Prev","handleCurve","monoCurves","totalLength","curveLength","operand","SQRT1_2","wind","pathWinding","starts","isValid","_visited","isStart","visitPath","getCrossingSegments","collectStarts","nextInter","_prev","inter1","inter2","over1","over2","valid","finished","branches","branch","visited","shift","hasOverlaps","hasCrossings","intersections","nonZero","intercepts","mv","mo0","mo3","maxRecursion","ignoreStraight","minSpan","addCurve","computeParts","halves","tMid","_get","fitCubic","tan1","tan2","uPrime","chordLengthParameterize","maxError","parametersInOrder","generateBezier","findMaxError","reparameterize","tanCenter","C","X","b0","b3","detC0C1","alpha1","alpha2","detC0X","detXC1","c0","segLength","eps","degree","maxDist","P","TextItem","content","_content","_lines","setContent","getContent","getCharacterStyle","setCharacterStyle","getParagraphStyle","setParagraphStyle","PointText","lines","leading","getLeading","font","getFontStyle","textAlign","getJustification","fillText","strokeText","numLines","justification","getTextWidth","gray","rgb","hsb","hsl","gradient","componentParsers","namedColors","transparent","colorCtx","fromCSS","string","isHSL","component","unit","turn","grad","hsbIndices","converters","g","achromatic","t3s","t3","properties","parser","_components","Gradient","_removeOwner","_addOwner","_properties","argType","converted","parsers","stops","radial","getComponents","_canvasStyle","converter","convert","getAlpha","setAlpha","hasAlpha","col","isGradient","toCSS","hex","_stops","origin","destination","highlight","inverse","canvasGradient","_radial","createRadialGradient","createLinearGradient","addColorStop","_color","_types","components1","components2","setStops","setRadial","_owners","getStops","GradientStop","getRadial","stops1","stops2","rampPoint","setColor","setOffset","getRampPoint","setRampPoint","getColor","itemDefaults","fillRule","strokeScaling","shadowOffset","selectedColor","groupDefaults","fontFamily","fontWeight","textDefaults","_values","isColor","isPoint","applyToChildren","old","_dontMerge","childValue","Font","WindingRule","isStyle","style1","style2","secondary","defaults2","value1","value2","getFontSize","getFontWeight","getFontFamily","getFont","setFont","getPixelSize","handlePrefix","prefixes","suffix","prefix","getStyles","doc","nodeType","ownerDocument","defaultView","getComputedStyle","viewport","body","html","documentElement","getBoundingClientRect","clientLeft","clientTop","pageXOffset","scrollLeft","pageYOffset","scrollTop","getViewportBounds","innerWidth","clientWidth","innerHeight","clientHeight","isInvisible","isInView","getPrefixed","passive","addEventListener","removeEventListener","targetTouches","changedTouches","pageX","clientX","pageY","clientY","getTarget","srcElement","getRelatedTarget","relatedTarget","toElement","requestAnimationFrame","nativeRequest","requested","callbacks","timer","handleCallbacks","functions","callback","setInterval","getCanvasSize","setAttribute","_viewEvents","none","userDrag","userSelect","touchCallout","contentZooming","tapHighlightColor","_windowEvents","resize","setViewSize","Stats","_stats","stats","domElement","appendChild","_element","_pixelRatio","devicePixelRatio","_setElementSize","_viewSize","_views","_viewsById","_focused","_frameItems","_frameItemCount","_itemEvents","native","virtual","node","_animate","play","pause","_count","getAutoUpdate","setAutoUpdate","autoUpdate","update","now","animate","_handleFrameItems","getPixelRatio","getViewSize","isVisible","parentNode","temp","createElement","removeChild","getZoom","setZoom","zoom","scrollBy","projectToView","viewToProject","getEventPoint","CanvasView","prevFocus","tempFocus","dragging","mouseDown","handleMouseMove","_handleMouseEvent","mousedown","mousemove","mouseup","pointerEnabled","msPointerEnabled","viewEvents","docEvents","mouseout","nodeName","scroll","called","prevented","fallbacks","doubleclick","wasInView","overView","downPoint","lastPoint","downItem","overItem","dragItem","clickItem","clickTime","dblClick","emitMouseEvent","prevPoint","stopItem","stopped","mouseEvent","MouseEvent","fallback","emitMouseEvents","hitItem","itemEventsMap","click","mouseenter","mouseleave","itemEvents","hitItems","nativeMove","tool","inView","mouse","substr","drag","down","up","cancelable","preventDefault","_handleKeyEvent","character","keyEvent","KeyEvent","sign","_resetState","HTMLCanvasElement","deviceRatio","backingStoreRatio","firefox","prevFont","measureText","stopPropagation","getTimeStamp","timeStamp","getModifiers","Key","modifiers","keyLookup","charLookup","keyMap","charMap","metaFixMap","downKey","alt","meta","capsLock","space","option","mac","getKey","keyIdentifier","String","fromCharCode","keyCode","keydown","altKey","metaKey","ctrlKey","keypress","charCode","keyup","isDown","ToolEvent","_choosePoint","toolPoint","getLastPoint","_lastPoint","setLastPoint","getDownPoint","_downPoint","setDownPoint","getMiddlePoint","_middlePoint","setMiddlePoint","middlePoint","getDelta","_delta","setDelta","getCount","setCount","Tool","_moveCount","_downCount","getMinDistance","_minDistance","setMinDistance","minDistance","_maxDistance","getMaxDistance","setMaxDistance","maxDistance","getFixedDistance","setFixedDistance","distance","easings","linear","easeInQuad","easeOutQuad","easeInOutQuad","easeInCubic","easeOutCubic","easeInOutCubic","easeInQuart","easeOutQuart","easeInOutQuart","easeInQuint","easeOutQuint","easeInOutQuint","isFunction","_then","_startTime","state","_keys","_parsedKeys","_parseKeys","_from","_getState","_to","then","progress","getValue","__add","__subtract","__multiply","_setProperty","onUpdate","startTime","_getProperty","resolved","_resolveValue","_calculate","parsed","calculateBinary","Http","request","xhr","XMLHttpRequest","open","url","async","mimeType","overrideMimeType","onload","status","responseText","onerror","message","send","canvases","sr","sg","sb","sa","bg","bb","ba","dr","dg","db","getLum","setLum","mn","lmn","ln","mxl","getSat","setSat","md","modes","screen","overlay","darken","lighten","difference","exclusion","hue","saturation","luminosity","average","negation","mode","srcContext","dstContext","srcCanvas","dstData","SvgElement","svg","xmlns","xlink","attributeNamespace","href","tag","attributes","createElementNS","namespace","getAttributeNS","setAttributeNS","SvgStyles","true","false","property","attribute","toSVG","fromSVG","exportFilter","getTransform","coordinates","attrs","trans","exportGroup","childNode","exportSVG","exportRaster","embedImages","exportPath","matchShapes","exportShape","exportCompoundPath","exportSymbolItem","definitionItem","viewBox","overflow","exportGradient","gradientNode","getGradient","getOrigin","getDestination","getHighlight","fy","gradientUnits","stopColor","exportText","textContent","exporters","applyStyle","visibility","svgs","__id","typeId","exportDefinitions","defs","insertBefore","firstChild","XMLSerializer","serializeToString","exporter","onExport","setOptions","rootSize","allowNull","allowPercent","convertValue","map","importGroup","nodes","childNodes","isClip","isDefs","currentStyle","applyAttributes","querySelectorAll","importNode","importPoly","importPath","importGradient","scaleToBounds","_scaleToBounds","importers","clippath","polygon","polyline","lineargradient","radialgradient","use","circle","text","trim","applyTransform","transforms","applyOpacity","gradientTransform","setVisible","display","percent","styles","group","tagName","isElement","nextSibling","importer","onImport","expandShapes","importSVG","DOMParser","parseFromString","File","reader","FileReader","readAsText","global","acorn","root","mod","amd","input","inputLen","sourceFile","inpt","initTokenState","parseTopLevel","program","defaultOptions","ecmaVersion","strictSemicolons","allowTrailingCommas","forbidReserved","allowReturnOutsideFunction","onComment","ranges","directSourceFile","opt","getLineInfo","cur","lineBreak","lastIndex","column","tokenize","getToken","forceRegexp","lastEnd","tokEnd","readToken","tokStart","startLoc","tokStartLoc","endLoc","tokEndLoc","tokType","tokVal","jumpTo","reAllowed","tokPos","tokCurLine","tokLineStart","tokRegexpAllowed","skipSpace","lastStart","lastEndLoc","inFunction","labels","strict","raise","err","SyntaxError","raisedAt","empty","_num","_regexp","_string","_eof","_break","keyword","_case","beforeExpr","_catch","_continue","_debugger","_do","isLoop","_else","_finally","_for","_function","_if","_return","_switch","_throw","_try","_var","_while","_with","_new","_this","_null","atomValue","_true","_false","binop","keywordTypes","_bracketL","_bracketR","_braceL","_braceR","_parenL","_parenR","_comma","_semi","_colon","_dot","_question","_slash","_eq","isAssign","_assign","_incDec","postfix","isUpdate","_prefix","_logicalOR","_logicalAND","_bitwiseOR","_bitwiseXOR","_bitwiseAND","_equality","_relational","_bitShift","_plusMin","_multiplyModulo","tokTypes","bracketL","bracketR","braceL","braceR","parenL","parenR","comma","semi","colon","question","slash","eq","eof","regexp","kw","makePredicate","words","cats","compareTo","arr","cat","Function","isReservedWord3","isReservedWord5","isStrictReservedWord","isStrictBadIdWord","isKeyword","nonASCIIwhitespace","nonASCIIidentifierStartChars","nonASCIIidentifierChars","nonASCIIidentifierStart","RegExp","nonASCIIidentifier","newline","isIdentifierStart","isIdentifierChar","line_loc_t","finishToken","skipBlockComment","skipLineComment","ch","charCodeAt","readToken_dot","readNumber","readToken_slash","readRegexp","finishOp","readToken_mult_modulo","readToken_pipe_amp","readToken_caret","readToken_plus_min","readToken_lt_gt","readToken_eq_excl","getTokenFromCode","readHexNumber","readString","readWord","tok","escaped","inClass","charAt","mods","readWord1","readInt","radix","startsWithDot","isFloat","octal","quote","readHexChar","containsEsc","word","esc","escStr","setStrict","strct","lastIndexOf","node_t","node_loc_t","startNode","range","startNodeFrom","finishNode","isUseStrict","stmt","expression","eat","canInsertSemicolon","semicolon","unexpected","expect","checkLVal","expr","parseStatement","loopLabel","kind","switchLabel","starttype","isBreak","label","parseIdent","lab","parseParenExpression","parseFor","init","parseVar","declarations","parseForIn","parseExpression","parseFunction","consequent","alternate","argument","discriminant","cases","sawDefault","isCase","block","parseBlock","clause","guard","guardedHandlers","finalizer","maybeName","allowStrict","oldStrict","noIn","decl","noComma","parseMaybeAssign","expressions","parseMaybeConditional","parseExprOps","parseExprOp","parseMaybeUnary","minPrec","prec","exprNode","parseExprSubscripts","parseSubscripts","parseExprAtom","noCalls","computed","callee","parseExprList","raw","tokStartLoc1","tokStart1","elements","parseObj","parseNew","sawGetSet","parsePropertyName","isGetSet","conflict","isStatement","params","oldInFunc","oldLabels","close","allowTrailingComma","allowEmpty","elts","liberal","binaryOperators","unaryOperators","__self","__$__","$__","compile","insertions","insertion","getCode","getBetween","replaceCode","walkAST","between","parentType","exp","declaration","specifiers","dec","specifier","encodeVLQ","base64","offsetCode","sourceMaps","lineBreaks","getElementsByTagName","innerHTML","safari","mappings","file","names","sourceRoot","sources","sourcesContent","preserveParens","sourceType","btoa","unescape","encodeURIComponent","toolHandlers","compiled","expose","script","head","createTextNode","__paperscript__","onResize","setOnResize","setOnFrame","loadScript","canvasId","scopeAttribute","baseURI","loadAll","readyState","calculateUnary","Symbol","PlacedSymbol"],"mappings":"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","sourcesContent":["/*!\n * Paper.js v0.12.0 - The Swiss Army Knife of Vector Graphics Scripting.\n * http://paperjs.org/\n *\n * Copyright (c) 2011 - 2016, Juerg Lehni & Jonathan Puckey\n * http://scratchdisk.com/ & https://puckey.studio/\n *\n * Distributed under the MIT license. See LICENSE file for details.\n *\n * All rights reserved.\n *\n * Date: Mon Dec 3 14:19:11 2018 +0100\n *\n ***\n *\n * Straps.js - Class inheritance library with support for bean-style accessors\n *\n * Copyright (c) 2006 - 2016 Juerg Lehni\n * http://scratchdisk.com/\n *\n * Distributed under the MIT license.\n *\n ***\n *\n * Acorn.js\n * https://marijnhaverbeke.nl/acorn/\n *\n * Acorn is a tiny, fast JavaScript parser written in JavaScript,\n * created by Marijn Haverbeke and released under an MIT license.\n *\n */\n\nvar paper = function(self, undefined) {\n\nself = self || require('./node/self.js');\nvar window = self.window,\n\tdocument = self.document;\n\nvar Base = new function() {\n\tvar hidden = /^(statics|enumerable|beans|preserve)$/,\n\t\tarray = [],\n\t\tslice = array.slice,\n\t\tcreate = Object.create,\n\t\tdescribe = Object.getOwnPropertyDescriptor,\n\t\tdefine = Object.defineProperty,\n\n\t\tforEach = array.forEach || function(iter, bind) {\n\t\t\tfor (var i = 0, l = this.length; i < l; i++) {\n\t\t\t\titer.call(bind, this[i], i, this);\n\t\t\t}\n\t\t},\n\n\t\tforIn = function(iter, bind) {\n\t\t\tfor (var i in this) {\n\t\t\t\tif (this.hasOwnProperty(i))\n\t\t\t\t\titer.call(bind, this[i], i, this);\n\t\t\t}\n\t\t},\n\n\t\tset = Object.assign || function(dst) {\n\t\t\tfor (var i = 1, l = arguments.length; i < l; i++) {\n\t\t\t\tvar src = arguments[i];\n\t\t\t\tfor (var key in src) {\n\t\t\t\t\tif (src.hasOwnProperty(key))\n\t\t\t\t\t\tdst[key] = src[key];\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn dst;\n\t\t},\n\n\t\teach = function(obj, iter, bind) {\n\t\t\tif (obj) {\n\t\t\t\tvar desc = describe(obj, 'length');\n\t\t\t\t(desc && typeof desc.value === 'number' ? forEach : forIn)\n\t\t\t\t\t.call(obj, iter, bind = bind || obj);\n\t\t\t}\n\t\t\treturn bind;\n\t\t};\n\n\tfunction inject(dest, src, enumerable, beans, preserve) {\n\t\tvar beansNames = {};\n\n\t\tfunction field(name, val) {\n\t\t\tval = val || (val = describe(src, name))\n\t\t\t\t\t&& (val.get ? val : val.value);\n\t\t\tif (typeof val === 'string' && val[0] === '#')\n\t\t\t\tval = dest[val.substring(1)] || val;\n\t\t\tvar isFunc = typeof val === 'function',\n\t\t\t\tres = val,\n\t\t\t\tprev = preserve || isFunc && !val.base\n\t\t\t\t\t\t? (val && val.get ? name in dest : dest[name])\n\t\t\t\t\t\t: null,\n\t\t\t\tbean;\n\t\t\tif (!preserve || !prev) {\n\t\t\t\tif (isFunc && prev)\n\t\t\t\t\tval.base = prev;\n\t\t\t\tif (isFunc && beans !== false\n\t\t\t\t\t\t&& (bean = name.match(/^([gs]et|is)(([A-Z])(.*))$/)))\n\t\t\t\t\tbeansNames[bean[3].toLowerCase() + bean[4]] = bean[2];\n\t\t\t\tif (!res || isFunc || !res.get || typeof res.get !== 'function'\n\t\t\t\t\t\t|| !Base.isPlainObject(res)) {\n\t\t\t\t\tres = { value: res, writable: true };\n\t\t\t\t}\n\t\t\t\tif ((describe(dest, name)\n\t\t\t\t\t\t|| { configurable: true }).configurable) {\n\t\t\t\t\tres.configurable = true;\n\t\t\t\t\tres.enumerable = enumerable != null ? enumerable : !bean;\n\t\t\t\t}\n\t\t\t\tdefine(dest, name, res);\n\t\t\t}\n\t\t}\n\t\tif (src) {\n\t\t\tfor (var name in src) {\n\t\t\t\tif (src.hasOwnProperty(name) && !hidden.test(name))\n\t\t\t\t\tfield(name);\n\t\t\t}\n\t\t\tfor (var name in beansNames) {\n\t\t\t\tvar part = beansNames[name],\n\t\t\t\t\tset = dest['set' + part],\n\t\t\t\t\tget = dest['get' + part] || set && dest['is' + part];\n\t\t\t\tif (get && (beans === true || get.length === 0))\n\t\t\t\t\tfield(name, { get: get, set: set });\n\t\t\t}\n\t\t}\n\t\treturn dest;\n\t}\n\n\tfunction Base() {\n\t\tfor (var i = 0, l = arguments.length; i < l; i++) {\n\t\t\tvar src = arguments[i];\n\t\t\tif (src)\n\t\t\t\tset(this, src);\n\t\t}\n\t\treturn this;\n\t}\n\n\treturn inject(Base, {\n\t\tinject: function(src) {\n\t\t\tif (src) {\n\t\t\t\tvar statics = src.statics === true ? src : src.statics,\n\t\t\t\t\tbeans = src.beans,\n\t\t\t\t\tpreserve = src.preserve;\n\t\t\t\tif (statics !== src)\n\t\t\t\t\tinject(this.prototype, src, src.enumerable, beans, preserve);\n\t\t\t\tinject(this, statics, null, beans, preserve);\n\t\t\t}\n\t\t\tfor (var i = 1, l = arguments.length; i < l; i++)\n\t\t\t\tthis.inject(arguments[i]);\n\t\t\treturn this;\n\t\t},\n\n\t\textend: function() {\n\t\t\tvar base = this,\n\t\t\t\tctor,\n\t\t\t\tproto;\n\t\t\tfor (var i = 0, obj, l = arguments.length;\n\t\t\t\t\ti < l && !(ctor && proto); i++) {\n\t\t\t\tobj = arguments[i];\n\t\t\t\tctor = ctor || obj.initialize;\n\t\t\t\tproto = proto || obj.prototype;\n\t\t\t}\n\t\t\tctor = ctor || function() {\n\t\t\t\tbase.apply(this, arguments);\n\t\t\t};\n\t\t\tproto = ctor.prototype = proto || create(this.prototype);\n\t\t\tdefine(proto, 'constructor',\n\t\t\t\t\t{ value: ctor, writable: true, configurable: true });\n\t\t\tinject(ctor, this);\n\t\t\tif (arguments.length)\n\t\t\t\tthis.inject.apply(ctor, arguments);\n\t\t\tctor.base = base;\n\t\t\treturn ctor;\n\t\t}\n\t}).inject({\n\t\tenumerable: false,\n\n\t\tinitialize: Base,\n\n\t\tset: Base,\n\n\t\tinject: function() {\n\t\t\tfor (var i = 0, l = arguments.length; i < l; i++) {\n\t\t\t\tvar src = arguments[i];\n\t\t\t\tif (src) {\n\t\t\t\t\tinject(this, src, src.enumerable, src.beans, src.preserve);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn this;\n\t\t},\n\n\t\textend: function() {\n\t\t\tvar res = create(this);\n\t\t\treturn res.inject.apply(res, arguments);\n\t\t},\n\n\t\teach: function(iter, bind) {\n\t\t\treturn each(this, iter, bind);\n\t\t},\n\n\t\tclone: function() {\n\t\t\treturn new this.constructor(this);\n\t\t},\n\n\t\tstatics: {\n\t\t\tset: set,\n\t\t\teach: each,\n\t\t\tcreate: create,\n\t\t\tdefine: define,\n\t\t\tdescribe: describe,\n\n\t\t\tclone: function(obj) {\n\t\t\t\treturn set(new obj.constructor(), obj);\n\t\t\t},\n\n\t\t\tisPlainObject: function(obj) {\n\t\t\t\tvar ctor = obj != null && obj.constructor;\n\t\t\t\treturn ctor && (ctor === Object || ctor === Base\n\t\t\t\t\t\t|| ctor.name === 'Object');\n\t\t\t},\n\n\t\t\tpick: function(a, b) {\n\t\t\t\treturn a !== undefined ? a : b;\n\t\t\t},\n\n\t\t\tslice: function(list, begin, end) {\n\t\t\t\treturn slice.call(list, begin, end);\n\t\t\t}\n\t\t}\n\t});\n};\n\nif (typeof module !== 'undefined')\n\tmodule.exports = Base;\n\nBase.inject({\n\tenumerable: false,\n\n\ttoString: function() {\n\t\treturn this._id != null\n\t\t\t?  (this._class || 'Object') + (this._name\n\t\t\t\t? \" '\" + this._name + \"'\"\n\t\t\t\t: ' @' + this._id)\n\t\t\t: '{ ' + Base.each(this, function(value, key) {\n\t\t\t\tif (!/^_/.test(key)) {\n\t\t\t\t\tvar type = typeof value;\n\t\t\t\t\tthis.push(key + ': ' + (type === 'number'\n\t\t\t\t\t\t\t? Formatter.instance.number(value)\n\t\t\t\t\t\t\t: type === 'string' ? \"'\" + value + \"'\" : value));\n\t\t\t\t}\n\t\t\t}, []).join(', ') + ' }';\n\t},\n\n\tgetClassName: function() {\n\t\treturn this._class || '';\n\t},\n\n\timportJSON: function(json) {\n\t\treturn Base.importJSON(json, this);\n\t},\n\n\texportJSON: function(options) {\n\t\treturn Base.exportJSON(this, options);\n\t},\n\n\ttoJSON: function() {\n\t\treturn Base.serialize(this);\n\t},\n\n\tset: function(props, exclude) {\n\t\tif (props)\n\t\t\tBase.filter(this, props, exclude, this._prioritize);\n\t\treturn this;\n\t}\n}, {\n\nbeans: false,\nstatics: {\n\texports: {},\n\n\textend: function extend() {\n\t\tvar res = extend.base.apply(this, arguments),\n\t\t\tname = res.prototype._class;\n\t\tif (name && !Base.exports[name])\n\t\t\tBase.exports[name] = res;\n\t\treturn res;\n\t},\n\n\tequals: function(obj1, obj2) {\n\t\tif (obj1 === obj2)\n\t\t\treturn true;\n\t\tif (obj1 && obj1.equals)\n\t\t\treturn obj1.equals(obj2);\n\t\tif (obj2 && obj2.equals)\n\t\t\treturn obj2.equals(obj1);\n\t\tif (obj1 && obj2\n\t\t\t\t&& typeof obj1 === 'object' && typeof obj2 === 'object') {\n\t\t\tif (Array.isArray(obj1) && Array.isArray(obj2)) {\n\t\t\t\tvar length = obj1.length;\n\t\t\t\tif (length !== obj2.length)\n\t\t\t\t\treturn false;\n\t\t\t\twhile (length--) {\n\t\t\t\t\tif (!Base.equals(obj1[length], obj2[length]))\n\t\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tvar keys = Object.keys(obj1),\n\t\t\t\t\tlength = keys.length;\n\t\t\t\tif (length !== Object.keys(obj2).length)\n\t\t\t\t\treturn false;\n\t\t\t\twhile (length--) {\n\t\t\t\t\tvar key = keys[length];\n\t\t\t\t\tif (!(obj2.hasOwnProperty(key)\n\t\t\t\t\t\t\t&& Base.equals(obj1[key], obj2[key])))\n\t\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t},\n\n\tread: function(list, start, options, amount) {\n\t\tif (this === Base) {\n\t\t\tvar value = this.peek(list, start);\n\t\t\tlist.__index++;\n\t\t\treturn value;\n\t\t}\n\t\tvar proto = this.prototype,\n\t\t\treadIndex = proto._readIndex,\n\t\t\tbegin = start || readIndex && list.__index || 0,\n\t\t\tlength = list.length,\n\t\t\tobj = list[begin];\n\t\tamount = amount || length - begin;\n\t\tif (obj instanceof this\n\t\t\t|| options && options.readNull && obj == null && amount <= 1) {\n\t\t\tif (readIndex)\n\t\t\t\tlist.__index = begin + 1;\n\t\t\treturn obj && options && options.clone ? obj.clone() : obj;\n\t\t}\n\t\tobj = Base.create(proto);\n\t\tif (readIndex)\n\t\t\tobj.__read = true;\n\t\tobj = obj.initialize.apply(obj, begin > 0 || begin + amount < length\n\t\t\t\t? Base.slice(list, begin, begin + amount)\n\t\t\t\t: list) || obj;\n\t\tif (readIndex) {\n\t\t\tlist.__index = begin + obj.__read;\n\t\t\tvar filtered = obj.__filtered;\n\t\t\tif (filtered) {\n\t\t\t\tlist.__filtered = filtered;\n\t\t\t\tobj.__filtered = undefined;\n\t\t\t}\n\t\t\tobj.__read = undefined;\n\t\t}\n\t\treturn obj;\n\t},\n\n\tpeek: function(list, start) {\n\t\treturn list[list.__index = start || list.__index || 0];\n\t},\n\n\tremain: function(list) {\n\t\treturn list.length - (list.__index || 0);\n\t},\n\n\treadList: function(list, start, options, amount) {\n\t\tvar res = [],\n\t\t\tentry,\n\t\t\tbegin = start || 0,\n\t\t\tend = amount ? begin + amount : list.length;\n\t\tfor (var i = begin; i < end; i++) {\n\t\t\tres.push(Array.isArray(entry = list[i])\n\t\t\t\t\t? this.read(entry, 0, options)\n\t\t\t\t\t: this.read(list, i, options, 1));\n\t\t}\n\t\treturn res;\n\t},\n\n\treadNamed: function(list, name, start, options, amount) {\n\t\tvar value = this.getNamed(list, name),\n\t\t\thasObject = value !== undefined;\n\t\tif (hasObject) {\n\t\t\tvar filtered = list.__filtered;\n\t\t\tif (!filtered) {\n\t\t\t\tfiltered = list.__filtered = Base.create(list[0]);\n\t\t\t\tfiltered.__unfiltered = list[0];\n\t\t\t}\n\t\t\tfiltered[name] = undefined;\n\t\t}\n\t\tvar l = hasObject ? [value] : list,\n\t\t\tres = this.read(l, start, options, amount);\n\t\treturn res;\n\t},\n\n\tgetNamed: function(list, name) {\n\t\tvar arg = list[0];\n\t\tif (list._hasObject === undefined)\n\t\t\tlist._hasObject = list.length === 1 && Base.isPlainObject(arg);\n\t\tif (list._hasObject)\n\t\t\treturn name ? arg[name] : list.__filtered || arg;\n\t},\n\n\thasNamed: function(list, name) {\n\t\treturn !!this.getNamed(list, name);\n\t},\n\n\tfilter: function(dest, source, exclude, prioritize) {\n\t\tvar processed;\n\n\t\tfunction handleKey(key) {\n\t\t\tif (!(exclude && key in exclude) &&\n\t\t\t\t!(processed && key in processed)) {\n\t\t\t\tvar value = source[key];\n\t\t\t\tif (value !== undefined)\n\t\t\t\t\tdest[key] = value;\n\t\t\t}\n\t\t}\n\n\t\tif (prioritize) {\n\t\t\tvar keys = {};\n\t\t\tfor (var i = 0, key, l = prioritize.length; i < l; i++) {\n\t\t\t\tif ((key = prioritize[i]) in source) {\n\t\t\t\t\thandleKey(key);\n\t\t\t\t\tkeys[key] = true;\n\t\t\t\t}\n\t\t\t}\n\t\t\tprocessed = keys;\n\t\t}\n\n\t\tObject.keys(source.__unfiltered || source).forEach(handleKey);\n\t\treturn dest;\n\t},\n\n\tisPlainValue: function(obj, asString) {\n\t\treturn Base.isPlainObject(obj) || Array.isArray(obj)\n\t\t\t\t|| asString && typeof obj === 'string';\n\t},\n\n\tserialize: function(obj, options, compact, dictionary) {\n\t\toptions = options || {};\n\n\t\tvar isRoot = !dictionary,\n\t\t\tres;\n\t\tif (isRoot) {\n\t\t\toptions.formatter = new Formatter(options.precision);\n\t\t\tdictionary = {\n\t\t\t\tlength: 0,\n\t\t\t\tdefinitions: {},\n\t\t\t\treferences: {},\n\t\t\t\tadd: function(item, create) {\n\t\t\t\t\tvar id = '#' + item._id,\n\t\t\t\t\t\tref = this.references[id];\n\t\t\t\t\tif (!ref) {\n\t\t\t\t\t\tthis.length++;\n\t\t\t\t\t\tvar res = create.call(item),\n\t\t\t\t\t\t\tname = item._class;\n\t\t\t\t\t\tif (name && res[0] !== name)\n\t\t\t\t\t\t\tres.unshift(name);\n\t\t\t\t\t\tthis.definitions[id] = res;\n\t\t\t\t\t\tref = this.references[id] = [id];\n\t\t\t\t\t}\n\t\t\t\t\treturn ref;\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t\tif (obj && obj._serialize) {\n\t\t\tres = obj._serialize(options, dictionary);\n\t\t\tvar name = obj._class;\n\t\t\tif (name && !obj._compactSerialize && (isRoot || !compact)\n\t\t\t\t\t&& res[0] !== name) {\n\t\t\t\tres.unshift(name);\n\t\t\t}\n\t\t} else if (Array.isArray(obj)) {\n\t\t\tres = [];\n\t\t\tfor (var i = 0, l = obj.length; i < l; i++)\n\t\t\t\tres[i] = Base.serialize(obj[i], options, compact, dictionary);\n\t\t} else if (Base.isPlainObject(obj)) {\n\t\t\tres = {};\n\t\t\tvar keys = Object.keys(obj);\n\t\t\tfor (var i = 0, l = keys.length; i < l; i++) {\n\t\t\t\tvar key = keys[i];\n\t\t\t\tres[key] = Base.serialize(obj[key], options, compact,\n\t\t\t\t\t\tdictionary);\n\t\t\t}\n\t\t} else if (typeof obj === 'number') {\n\t\t\tres = options.formatter.number(obj, options.precision);\n\t\t} else {\n\t\t\tres = obj;\n\t\t}\n\t\treturn isRoot && dictionary.length > 0\n\t\t\t\t? [['dictionary', dictionary.definitions], res]\n\t\t\t\t: res;\n\t},\n\n\tdeserialize: function(json, create, _data, _setDictionary, _isRoot) {\n\t\tvar res = json,\n\t\t\tisFirst = !_data,\n\t\t\thasDictionary = isFirst && json && json.length\n\t\t\t\t&& json[0][0] === 'dictionary';\n\t\t_data = _data || {};\n\t\tif (Array.isArray(json)) {\n\t\t\tvar type = json[0],\n\t\t\t\tisDictionary = type === 'dictionary';\n\t\t\tif (json.length == 1 && /^#/.test(type)) {\n\t\t\t\treturn _data.dictionary[type];\n\t\t\t}\n\t\t\ttype = Base.exports[type];\n\t\t\tres = [];\n\t\t\tfor (var i = type ? 1 : 0, l = json.length; i < l; i++) {\n\t\t\t\tres.push(Base.deserialize(json[i], create, _data,\n\t\t\t\t\t\tisDictionary, hasDictionary));\n\t\t\t}\n\t\t\tif (type) {\n\t\t\t\tvar args = res;\n\t\t\t\tif (create) {\n\t\t\t\t\tres = create(type, args, isFirst || _isRoot);\n\t\t\t\t} else {\n\t\t\t\t\tres = new type(args);\n\t\t\t\t}\n\t\t\t}\n\t\t} else if (Base.isPlainObject(json)) {\n\t\t\tres = {};\n\t\t\tif (_setDictionary)\n\t\t\t\t_data.dictionary = res;\n\t\t\tfor (var key in json)\n\t\t\t\tres[key] = Base.deserialize(json[key], create, _data);\n\t\t}\n\t\treturn hasDictionary ? res[1] : res;\n\t},\n\n\texportJSON: function(obj, options) {\n\t\tvar json = Base.serialize(obj, options);\n\t\treturn options && options.asString == false\n\t\t\t\t? json\n\t\t\t\t: JSON.stringify(json);\n\t},\n\n\timportJSON: function(json, target) {\n\t\treturn Base.deserialize(\n\t\t\t\ttypeof json === 'string' ? JSON.parse(json) : json,\n\t\t\t\tfunction(ctor, args, isRoot) {\n\t\t\t\t\tvar useTarget = isRoot && target\n\t\t\t\t\t\t\t&& target.constructor === ctor,\n\t\t\t\t\t\tobj = useTarget ? target\n\t\t\t\t\t\t\t: Base.create(ctor.prototype);\n\t\t\t\t\tif (args.length === 1 && obj instanceof Item\n\t\t\t\t\t\t\t&& (useTarget || !(obj instanceof Layer))) {\n\t\t\t\t\t\tvar arg = args[0];\n\t\t\t\t\t\tif (Base.isPlainObject(arg))\n\t\t\t\t\t\t\targ.insert = false;\n\t\t\t\t\t}\n\t\t\t\t\t(useTarget ? obj.set : ctor).apply(obj, args);\n\t\t\t\t\tif (useTarget)\n\t\t\t\t\t\ttarget = null;\n\t\t\t\t\treturn obj;\n\t\t\t\t});\n\t},\n\n\tpush: function(list, items) {\n\t\tvar itemsLength = items.length;\n\t\tif (itemsLength < 4096) {\n\t\t\tlist.push.apply(list, items);\n\t\t} else {\n\t\t\tvar startLength = list.length;\n\t\t\tlist.length += itemsLength;\n\t\t\tfor (var i = 0; i < itemsLength; i++) {\n\t\t\t\tlist[startLength + i] = items[i];\n\t\t\t}\n\t\t}\n\t\treturn list;\n\t},\n\n\tsplice: function(list, items, index, remove) {\n\t\tvar amount = items && items.length,\n\t\t\tappend = index === undefined;\n\t\tindex = append ? list.length : index;\n\t\tif (index > list.length)\n\t\t\tindex = list.length;\n\t\tfor (var i = 0; i < amount; i++)\n\t\t\titems[i]._index = index + i;\n\t\tif (append) {\n\t\t\tBase.push(list, items);\n\t\t\treturn [];\n\t\t} else {\n\t\t\tvar args = [index, remove];\n\t\t\tif (items)\n\t\t\t\tBase.push(args, items);\n\t\t\tvar removed = list.splice.apply(list, args);\n\t\t\tfor (var i = 0, l = removed.length; i < l; i++)\n\t\t\t\tremoved[i]._index = undefined;\n\t\t\tfor (var i = index + amount, l = list.length; i < l; i++)\n\t\t\t\tlist[i]._index = i;\n\t\t\treturn removed;\n\t\t}\n\t},\n\n\tcapitalize: function(str) {\n\t\treturn str.replace(/\\b[a-z]/g, function(match) {\n\t\t\treturn match.toUpperCase();\n\t\t});\n\t},\n\n\tcamelize: function(str) {\n\t\treturn str.replace(/-(.)/g, function(match, chr) {\n\t\t\treturn chr.toUpperCase();\n\t\t});\n\t},\n\n\thyphenate: function(str) {\n\t\treturn str.replace(/([a-z])([A-Z])/g, '$1-$2').toLowerCase();\n\t}\n}});\n\nvar Emitter = {\n\ton: function(type, func) {\n\t\tif (typeof type !== 'string') {\n\t\t\tBase.each(type, function(value, key) {\n\t\t\t\tthis.on(key, value);\n\t\t\t}, this);\n\t\t} else {\n\t\t\tvar types = this._eventTypes,\n\t\t\t\tentry = types && types[type],\n\t\t\t\thandlers = this._callbacks = this._callbacks || {};\n\t\t\thandlers = handlers[type] = handlers[type] || [];\n\t\t\tif (handlers.indexOf(func) === -1) {\n\t\t\t\thandlers.push(func);\n\t\t\t\tif (entry && entry.install && handlers.length === 1)\n\t\t\t\t\tentry.install.call(this, type);\n\t\t\t}\n\t\t}\n\t\treturn this;\n\t},\n\n\toff: function(type, func) {\n\t\tif (typeof type !== 'string') {\n\t\t\tBase.each(type, function(value, key) {\n\t\t\t\tthis.off(key, value);\n\t\t\t}, this);\n\t\t\treturn;\n\t\t}\n\t\tvar types = this._eventTypes,\n\t\t\tentry = types && types[type],\n\t\t\thandlers = this._callbacks && this._callbacks[type],\n\t\t\tindex;\n\t\tif (handlers) {\n\t\t\tif (!func || (index = handlers.indexOf(func)) !== -1\n\t\t\t\t\t&& handlers.length === 1) {\n\t\t\t\tif (entry && entry.uninstall)\n\t\t\t\t\tentry.uninstall.call(this, type);\n\t\t\t\tdelete this._callbacks[type];\n\t\t\t} else if (index !== -1) {\n\t\t\t\thandlers.splice(index, 1);\n\t\t\t}\n\t\t}\n\t\treturn this;\n\t},\n\n\tonce: function(type, func) {\n\t\treturn this.on(type, function handler() {\n\t\t\tfunc.apply(this, arguments);\n\t\t\tthis.off(type, handler);\n\t\t});\n\t},\n\n\temit: function(type, event) {\n\t\tvar handlers = this._callbacks && this._callbacks[type];\n\t\tif (!handlers)\n\t\t\treturn false;\n\t\tvar args = Base.slice(arguments, 1),\n\t\t\tsetTarget = event && event.target && !event.currentTarget;\n\t\thandlers = handlers.slice();\n\t\tif (setTarget)\n\t\t\tevent.currentTarget = this;\n\t\tfor (var i = 0, l = handlers.length; i < l; i++) {\n\t\t\tif (handlers[i].apply(this, args) == false) {\n\t\t\t\tif (event && event.stop)\n\t\t\t\t\tevent.stop();\n\t\t\t\tbreak;\n\t\t   }\n\t\t}\n\t\tif (setTarget)\n\t\t\tdelete event.currentTarget;\n\t\treturn true;\n\t},\n\n\tresponds: function(type) {\n\t\treturn !!(this._callbacks && this._callbacks[type]);\n\t},\n\n\tattach: '#on',\n\tdetach: '#off',\n\tfire: '#emit',\n\n\t_installEvents: function(install) {\n\t\tvar types = this._eventTypes,\n\t\t\thandlers = this._callbacks,\n\t\t\tkey = install ? 'install' : 'uninstall';\n\t\tif (types) {\n\t\t\tfor (var type in handlers) {\n\t\t\t\tif (handlers[type].length > 0) {\n\t\t\t\t\tvar entry = types[type],\n\t\t\t\t\t\tfunc = entry && entry[key];\n\t\t\t\t\tif (func)\n\t\t\t\t\t\tfunc.call(this, type);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\n\tstatics: {\n\t\tinject: function inject(src) {\n\t\t\tvar events = src._events;\n\t\t\tif (events) {\n\t\t\t\tvar types = {};\n\t\t\t\tBase.each(events, function(entry, key) {\n\t\t\t\t\tvar isString = typeof entry === 'string',\n\t\t\t\t\t\tname = isString ? entry : key,\n\t\t\t\t\t\tpart = Base.capitalize(name),\n\t\t\t\t\t\ttype = name.substring(2).toLowerCase();\n\t\t\t\t\ttypes[type] = isString ? {} : entry;\n\t\t\t\t\tname = '_' + name;\n\t\t\t\t\tsrc['get' + part] = function() {\n\t\t\t\t\t\treturn this[name];\n\t\t\t\t\t};\n\t\t\t\t\tsrc['set' + part] = function(func) {\n\t\t\t\t\t\tvar prev = this[name];\n\t\t\t\t\t\tif (prev)\n\t\t\t\t\t\t\tthis.off(type, prev);\n\t\t\t\t\t\tif (func)\n\t\t\t\t\t\t\tthis.on(type, func);\n\t\t\t\t\t\tthis[name] = func;\n\t\t\t\t\t};\n\t\t\t\t});\n\t\t\t\tsrc._eventTypes = types;\n\t\t\t}\n\t\t\treturn inject.base.apply(this, arguments);\n\t\t}\n\t}\n};\n\nvar PaperScope = Base.extend({\n\t_class: 'PaperScope',\n\n\tinitialize: function PaperScope() {\n\t\tpaper = this;\n\t\tthis.settings = new Base({\n\t\t\tapplyMatrix: true,\n\t\t\tinsertItems: true,\n\t\t\thandleSize: 4,\n\t\t\thitTolerance: 0\n\t\t});\n\t\tthis.project = null;\n\t\tthis.projects = [];\n\t\tthis.tools = [];\n\t\tthis._id = PaperScope._id++;\n\t\tPaperScope._scopes[this._id] = this;\n\t\tvar proto = PaperScope.prototype;\n\t\tif (!this.support) {\n\t\t\tvar ctx = CanvasProvider.getContext(1, 1) || {};\n\t\t\tproto.support = {\n\t\t\t\tnativeDash: 'setLineDash' in ctx || 'mozDash' in ctx,\n\t\t\t\tnativeBlendModes: BlendMode.nativeModes\n\t\t\t};\n\t\t\tCanvasProvider.release(ctx);\n\t\t}\n\t\tif (!this.agent) {\n\t\t\tvar user = self.navigator.userAgent.toLowerCase(),\n\t\t\t\tos = (/(darwin|win|mac|linux|freebsd|sunos)/.exec(user)||[])[0],\n\t\t\t\tplatform = os === 'darwin' ? 'mac' : os,\n\t\t\t\tagent = proto.agent = proto.browser = { platform: platform };\n\t\t\tif (platform)\n\t\t\t\tagent[platform] = true;\n\t\t\tuser.replace(\n\t\t\t\t/(opera|chrome|safari|webkit|firefox|msie|trident|atom|node)\\/?\\s*([.\\d]+)(?:.*version\\/([.\\d]+))?(?:.*rv\\:v?([.\\d]+))?/g,\n\t\t\t\tfunction(match, n, v1, v2, rv) {\n\t\t\t\t\tif (!agent.chrome) {\n\t\t\t\t\t\tvar v = n === 'opera' ? v2 :\n\t\t\t\t\t\t\t\t/^(node|trident)$/.test(n) ? rv : v1;\n\t\t\t\t\t\tagent.version = v;\n\t\t\t\t\t\tagent.versionNumber = parseFloat(v);\n\t\t\t\t\t\tn = n === 'trident' ? 'msie' : n;\n\t\t\t\t\t\tagent.name = n;\n\t\t\t\t\t\tagent[n] = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\t\t\tif (agent.chrome)\n\t\t\t\tdelete agent.webkit;\n\t\t\tif (agent.atom)\n\t\t\t\tdelete agent.chrome;\n\t\t}\n\t},\n\n\tversion: \"0.12.0\",\n\n\tgetView: function() {\n\t\tvar project = this.project;\n\t\treturn project && project._view;\n\t},\n\n\tgetPaper: function() {\n\t\treturn this;\n\t},\n\n\texecute: function(code, options) {\n\t\t\tvar exports = paper.PaperScript.execute(code, this, options);\n\t\t\tView.updateFocus();\n\t\t\treturn exports;\n\t},\n\n\tinstall: function(scope) {\n\t\tvar that = this;\n\t\tBase.each(['project', 'view', 'tool'], function(key) {\n\t\t\tBase.define(scope, key, {\n\t\t\t\tconfigurable: true,\n\t\t\t\tget: function() {\n\t\t\t\t\treturn that[key];\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t\tfor (var key in this)\n\t\t\tif (!/^_/.test(key) && this[key])\n\t\t\t\tscope[key] = this[key];\n\t},\n\n\tsetup: function(element) {\n\t\tpaper = this;\n\t\tthis.project = new Project(element);\n\t\treturn this;\n\t},\n\n\tcreateCanvas: function(width, height) {\n\t\treturn CanvasProvider.getCanvas(width, height);\n\t},\n\n\tactivate: function() {\n\t\tpaper = this;\n\t},\n\n\tclear: function() {\n\t\tvar projects = this.projects,\n\t\t\ttools = this.tools;\n\t\tfor (var i = projects.length - 1; i >= 0; i--)\n\t\t\tprojects[i].remove();\n\t\tfor (var i = tools.length - 1; i >= 0; i--)\n\t\t\ttools[i].remove();\n\t},\n\n\tremove: function() {\n\t\tthis.clear();\n\t\tdelete PaperScope._scopes[this._id];\n\t},\n\n\tstatics: new function() {\n\t\tfunction handleAttribute(name) {\n\t\t\tname += 'Attribute';\n\t\t\treturn function(el, attr) {\n\t\t\t\treturn el[name](attr) || el[name]('data-paper-' + attr);\n\t\t\t};\n\t\t}\n\n\t\treturn {\n\t\t\t_scopes: {},\n\t\t\t_id: 0,\n\n\t\t\tget: function(id) {\n\t\t\t\treturn this._scopes[id] || null;\n\t\t\t},\n\n\t\t\tgetAttribute: handleAttribute('get'),\n\t\t\thasAttribute: handleAttribute('has')\n\t\t};\n\t}\n});\n\nvar PaperScopeItem = Base.extend(Emitter, {\n\n\tinitialize: function(activate) {\n\t\tthis._scope = paper;\n\t\tthis._index = this._scope[this._list].push(this) - 1;\n\t\tif (activate || !this._scope[this._reference])\n\t\t\tthis.activate();\n\t},\n\n\tactivate: function() {\n\t\tif (!this._scope)\n\t\t\treturn false;\n\t\tvar prev = this._scope[this._reference];\n\t\tif (prev && prev !== this)\n\t\t\tprev.emit('deactivate');\n\t\tthis._scope[this._reference] = this;\n\t\tthis.emit('activate', prev);\n\t\treturn true;\n\t},\n\n\tisActive: function() {\n\t\treturn this._scope[this._reference] === this;\n\t},\n\n\tremove: function() {\n\t\tif (this._index == null)\n\t\t\treturn false;\n\t\tBase.splice(this._scope[this._list], null, this._index, 1);\n\t\tif (this._scope[this._reference] == this)\n\t\t\tthis._scope[this._reference] = null;\n\t\tthis._scope = null;\n\t\treturn true;\n\t},\n\n\tgetView: function() {\n\t\treturn this._scope.getView();\n\t}\n});\n\nvar Formatter = Base.extend({\n\tinitialize: function(precision) {\n\t\tthis.precision = Base.pick(precision, 5);\n\t\tthis.multiplier = Math.pow(10, this.precision);\n\t},\n\n\tnumber: function(val) {\n\t\treturn this.precision < 16\n\t\t\t\t? Math.round(val * this.multiplier) / this.multiplier : val;\n\t},\n\n\tpair: function(val1, val2, separator) {\n\t\treturn this.number(val1) + (separator || ',') + this.number(val2);\n\t},\n\n\tpoint: function(val, separator) {\n\t\treturn this.number(val.x) + (separator || ',') + this.number(val.y);\n\t},\n\n\tsize: function(val, separator) {\n\t\treturn this.number(val.width) + (separator || ',')\n\t\t\t\t+ this.number(val.height);\n\t},\n\n\trectangle: function(val, separator) {\n\t\treturn this.point(val, separator) + (separator || ',')\n\t\t\t\t+ this.size(val, separator);\n\t}\n});\n\nFormatter.instance = new Formatter();\n\nvar Numerical = new function() {\n\n\tvar abscissas = [\n\t\t[  0.5773502691896257645091488],\n\t\t[0,0.7745966692414833770358531],\n\t\t[  0.3399810435848562648026658,0.8611363115940525752239465],\n\t\t[0,0.5384693101056830910363144,0.9061798459386639927976269],\n\t\t[  0.2386191860831969086305017,0.6612093864662645136613996,0.9324695142031520278123016],\n\t\t[0,0.4058451513773971669066064,0.7415311855993944398638648,0.9491079123427585245261897],\n\t\t[  0.1834346424956498049394761,0.5255324099163289858177390,0.7966664774136267395915539,0.9602898564975362316835609],\n\t\t[0,0.3242534234038089290385380,0.6133714327005903973087020,0.8360311073266357942994298,0.9681602395076260898355762],\n\t\t[  0.1488743389816312108848260,0.4333953941292471907992659,0.6794095682990244062343274,0.8650633666889845107320967,0.9739065285171717200779640],\n\t\t[0,0.2695431559523449723315320,0.5190961292068118159257257,0.7301520055740493240934163,0.8870625997680952990751578,0.9782286581460569928039380],\n\t\t[  0.1252334085114689154724414,0.3678314989981801937526915,0.5873179542866174472967024,0.7699026741943046870368938,0.9041172563704748566784659,0.9815606342467192506905491],\n\t\t[0,0.2304583159551347940655281,0.4484927510364468528779129,0.6423493394403402206439846,0.8015780907333099127942065,0.9175983992229779652065478,0.9841830547185881494728294],\n\t\t[  0.1080549487073436620662447,0.3191123689278897604356718,0.5152486363581540919652907,0.6872929048116854701480198,0.8272013150697649931897947,0.9284348836635735173363911,0.9862838086968123388415973],\n\t\t[0,0.2011940939974345223006283,0.3941513470775633698972074,0.5709721726085388475372267,0.7244177313601700474161861,0.8482065834104272162006483,0.9372733924007059043077589,0.9879925180204854284895657],\n\t\t[  0.0950125098376374401853193,0.2816035507792589132304605,0.4580167776572273863424194,0.6178762444026437484466718,0.7554044083550030338951012,0.8656312023878317438804679,0.9445750230732325760779884,0.9894009349916499325961542]\n\t];\n\n\tvar weights = [\n\t\t[1],\n\t\t[0.8888888888888888888888889,0.5555555555555555555555556],\n\t\t[0.6521451548625461426269361,0.3478548451374538573730639],\n\t\t[0.5688888888888888888888889,0.4786286704993664680412915,0.2369268850561890875142640],\n\t\t[0.4679139345726910473898703,0.3607615730481386075698335,0.1713244923791703450402961],\n\t\t[0.4179591836734693877551020,0.3818300505051189449503698,0.2797053914892766679014678,0.1294849661688696932706114],\n\t\t[0.3626837833783619829651504,0.3137066458778872873379622,0.2223810344533744705443560,0.1012285362903762591525314],\n\t\t[0.3302393550012597631645251,0.3123470770400028400686304,0.2606106964029354623187429,0.1806481606948574040584720,0.0812743883615744119718922],\n\t\t[0.2955242247147528701738930,0.2692667193099963550912269,0.2190863625159820439955349,0.1494513491505805931457763,0.0666713443086881375935688],\n\t\t[0.2729250867779006307144835,0.2628045445102466621806889,0.2331937645919904799185237,0.1862902109277342514260976,0.1255803694649046246346943,0.0556685671161736664827537],\n\t\t[0.2491470458134027850005624,0.2334925365383548087608499,0.2031674267230659217490645,0.1600783285433462263346525,0.1069393259953184309602547,0.0471753363865118271946160],\n\t\t[0.2325515532308739101945895,0.2262831802628972384120902,0.2078160475368885023125232,0.1781459807619457382800467,0.1388735102197872384636018,0.0921214998377284479144218,0.0404840047653158795200216],\n\t\t[0.2152638534631577901958764,0.2051984637212956039659241,0.1855383974779378137417166,0.1572031671581935345696019,0.1215185706879031846894148,0.0801580871597602098056333,0.0351194603317518630318329],\n\t\t[0.2025782419255612728806202,0.1984314853271115764561183,0.1861610000155622110268006,0.1662692058169939335532009,0.1395706779261543144478048,0.1071592204671719350118695,0.0703660474881081247092674,0.0307532419961172683546284],\n\t\t[0.1894506104550684962853967,0.1826034150449235888667637,0.1691565193950025381893121,0.1495959888165767320815017,0.1246289712555338720524763,0.0951585116824927848099251,0.0622535239386478928628438,0.0271524594117540948517806]\n\t];\n\n\tvar abs = Math.abs,\n\t\tsqrt = Math.sqrt,\n\t\tpow = Math.pow,\n\t\tlog2 = Math.log2 || function(x) {\n\t\t\treturn Math.log(x) * Math.LOG2E;\n\t\t},\n\t\tEPSILON = 1e-12,\n\t\tMACHINE_EPSILON = 1.12e-16;\n\n\tfunction clamp(value, min, max) {\n\t\treturn value < min ? min : value > max ? max : value;\n\t}\n\n\tfunction getDiscriminant(a, b, c) {\n\t\tfunction split(v) {\n\t\t\tvar x = v * 134217729,\n\t\t\t\ty = v - x,\n\t\t\t\thi = y + x,\n\t\t\t\tlo = v - hi;\n\t\t\treturn [hi, lo];\n\t\t}\n\n\t\tvar D = b * b - a * c,\n\t\t\tE = b * b + a * c;\n\t\tif (abs(D) * 3 < E) {\n\t\t\tvar ad = split(a),\n\t\t\t\tbd = split(b),\n\t\t\t\tcd = split(c),\n\t\t\t\tp = b * b,\n\t\t\t\tdp = (bd[0] * bd[0] - p + 2 * bd[0] * bd[1]) + bd[1] * bd[1],\n\t\t\t\tq = a * c,\n\t\t\t\tdq = (ad[0] * cd[0] - q + ad[0] * cd[1] + ad[1] * cd[0])\n\t\t\t\t\t\t+ ad[1] * cd[1];\n\t\t\tD = (p - q) + (dp - dq);\n\t\t}\n\t\treturn D;\n\t}\n\n\tfunction getNormalizationFactor() {\n\t\tvar norm = Math.max.apply(Math, arguments);\n\t\treturn norm && (norm < 1e-8 || norm > 1e8)\n\t\t\t\t? pow(2, -Math.round(log2(norm)))\n\t\t\t\t: 0;\n\t}\n\n\treturn {\n\t\tEPSILON: EPSILON,\n\t\tMACHINE_EPSILON: MACHINE_EPSILON,\n\t\tCURVETIME_EPSILON: 1e-8,\n\t\tGEOMETRIC_EPSILON: 1e-7,\n\t\tTRIGONOMETRIC_EPSILON: 1e-8,\n\t\tKAPPA: 4 * (sqrt(2) - 1) / 3,\n\n\t\tisZero: function(val) {\n\t\t\treturn val >= -EPSILON && val <= EPSILON;\n\t\t},\n\n\t\tclamp: clamp,\n\n\t\tintegrate: function(f, a, b, n) {\n\t\t\tvar x = abscissas[n - 2],\n\t\t\t\tw = weights[n - 2],\n\t\t\t\tA = (b - a) * 0.5,\n\t\t\t\tB = A + a,\n\t\t\t\ti = 0,\n\t\t\t\tm = (n + 1) >> 1,\n\t\t\t\tsum = n & 1 ? w[i++] * f(B) : 0;\n\t\t\twhile (i < m) {\n\t\t\t\tvar Ax = A * x[i];\n\t\t\t\tsum += w[i++] * (f(B + Ax) + f(B - Ax));\n\t\t\t}\n\t\t\treturn A * sum;\n\t\t},\n\n\t\tfindRoot: function(f, df, x, a, b, n, tolerance) {\n\t\t\tfor (var i = 0; i < n; i++) {\n\t\t\t\tvar fx = f(x),\n\t\t\t\t\tdx = fx / df(x),\n\t\t\t\t\tnx = x - dx;\n\t\t\t\tif (abs(dx) < tolerance) {\n\t\t\t\t\tx = nx;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tif (fx > 0) {\n\t\t\t\t\tb = x;\n\t\t\t\t\tx = nx <= a ? (a + b) * 0.5 : nx;\n\t\t\t\t} else {\n\t\t\t\t\ta = x;\n\t\t\t\t\tx = nx >= b ? (a + b) * 0.5 : nx;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn clamp(x, a, b);\n\t\t},\n\n\t\tsolveQuadratic: function(a, b, c, roots, min, max) {\n\t\t\tvar x1, x2 = Infinity;\n\t\t\tif (abs(a) < EPSILON) {\n\t\t\t\tif (abs(b) < EPSILON)\n\t\t\t\t\treturn abs(c) < EPSILON ? -1 : 0;\n\t\t\t\tx1 = -c / b;\n\t\t\t} else {\n\t\t\t\tb *= -0.5;\n\t\t\t\tvar D = getDiscriminant(a, b, c);\n\t\t\t\tif (D && abs(D) < MACHINE_EPSILON) {\n\t\t\t\t\tvar f = getNormalizationFactor(abs(a), abs(b), abs(c));\n\t\t\t\t\tif (f) {\n\t\t\t\t\t\ta *= f;\n\t\t\t\t\t\tb *= f;\n\t\t\t\t\t\tc *= f;\n\t\t\t\t\t\tD = getDiscriminant(a, b, c);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (D >= -MACHINE_EPSILON) {\n\t\t\t\t\tvar Q = D < 0 ? 0 : sqrt(D),\n\t\t\t\t\t\tR = b + (b < 0 ? -Q : Q);\n\t\t\t\t\tif (R === 0) {\n\t\t\t\t\t\tx1 = c / a;\n\t\t\t\t\t\tx2 = -x1;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tx1 = R / a;\n\t\t\t\t\t\tx2 = c / R;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tvar count = 0,\n\t\t\t\tboundless = min == null,\n\t\t\t\tminB = min - EPSILON,\n\t\t\t\tmaxB = max + EPSILON;\n\t\t\tif (isFinite(x1) && (boundless || x1 > minB && x1 < maxB))\n\t\t\t\troots[count++] = boundless ? x1 : clamp(x1, min, max);\n\t\t\tif (x2 !== x1\n\t\t\t\t\t&& isFinite(x2) && (boundless || x2 > minB && x2 < maxB))\n\t\t\t\troots[count++] = boundless ? x2 : clamp(x2, min, max);\n\t\t\treturn count;\n\t\t},\n\n\t\tsolveCubic: function(a, b, c, d, roots, min, max) {\n\t\t\tvar f = getNormalizationFactor(abs(a), abs(b), abs(c), abs(d)),\n\t\t\t\tx, b1, c2, qd, q;\n\t\t\tif (f) {\n\t\t\t\ta *= f;\n\t\t\t\tb *= f;\n\t\t\t\tc *= f;\n\t\t\t\td *= f;\n\t\t\t}\n\n\t\t\tfunction evaluate(x0) {\n\t\t\t\tx = x0;\n\t\t\t\tvar tmp = a * x;\n\t\t\t\tb1 = tmp + b;\n\t\t\t\tc2 = b1 * x + c;\n\t\t\t\tqd = (tmp + b1) * x + c2;\n\t\t\t\tq = c2 * x + d;\n\t\t\t}\n\n\t\t\tif (abs(a) < EPSILON) {\n\t\t\t\ta = b;\n\t\t\t\tb1 = c;\n\t\t\t\tc2 = d;\n\t\t\t\tx = Infinity;\n\t\t\t} else if (abs(d) < EPSILON) {\n\t\t\t\tb1 = b;\n\t\t\t\tc2 = c;\n\t\t\t\tx = 0;\n\t\t\t} else {\n\t\t\t\tevaluate(-(b / a) / 3);\n\t\t\t\tvar t = q / a,\n\t\t\t\t\tr = pow(abs(t), 1/3),\n\t\t\t\t\ts = t < 0 ? -1 : 1,\n\t\t\t\t\ttd = -qd / a,\n\t\t\t\t\trd = td > 0 ? 1.324717957244746 * Math.max(r, sqrt(td)) : r,\n\t\t\t\t\tx0 = x - s * rd;\n\t\t\t\tif (x0 !== x) {\n\t\t\t\t\tdo {\n\t\t\t\t\t\tevaluate(x0);\n\t\t\t\t\t\tx0 = qd === 0 ? x : x - q / qd / (1 + MACHINE_EPSILON);\n\t\t\t\t\t} while (s * x0 > s * x);\n\t\t\t\t\tif (abs(a) * x * x > abs(d / x)) {\n\t\t\t\t\t\tc2 = -d / x;\n\t\t\t\t\t\tb1 = (c2 - c) / x;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tvar count = Numerical.solveQuadratic(a, b1, c2, roots, min, max),\n\t\t\t\tboundless = min == null;\n\t\t\tif (isFinite(x) && (count === 0\n\t\t\t\t\t|| count > 0 && x !== roots[0] && x !== roots[1])\n\t\t\t\t\t&& (boundless || x > min - EPSILON && x < max + EPSILON))\n\t\t\t\troots[count++] = boundless ? x : clamp(x, min, max);\n\t\t\treturn count;\n\t\t}\n\t};\n};\n\nvar UID = {\n\t_id: 1,\n\t_pools: {},\n\n\tget: function(name) {\n\t\tif (name) {\n\t\t\tvar pool = this._pools[name];\n\t\t\tif (!pool)\n\t\t\t\tpool = this._pools[name] = { _id: 1 };\n\t\t\treturn pool._id++;\n\t\t} else {\n\t\t\treturn this._id++;\n\t\t}\n\t}\n};\n\nvar Point = Base.extend({\n\t_class: 'Point',\n\t_readIndex: true,\n\n\tinitialize: function Point(arg0, arg1) {\n\t\tvar type = typeof arg0,\n\t\t\treading = this.__read,\n\t\t\tread = 0;\n\t\tif (type === 'number') {\n\t\t\tvar hasY = typeof arg1 === 'number';\n\t\t\tthis._set(arg0, hasY ? arg1 : arg0);\n\t\t\tif (reading)\n\t\t\t\tread = hasY ? 2 : 1;\n\t\t} else if (type === 'undefined' || arg0 === null) {\n\t\t\tthis._set(0, 0);\n\t\t\tif (reading)\n\t\t\t\tread = arg0 === null ? 1 : 0;\n\t\t} else {\n\t\t\tvar obj = type === 'string' ? arg0.split(/[\\s,]+/) || [] : arg0;\n\t\t\tread = 1;\n\t\t\tif (Array.isArray(obj)) {\n\t\t\t\tthis._set(+obj[0], +(obj.length > 1 ? obj[1] : obj[0]));\n\t\t\t} else if ('x' in obj) {\n\t\t\t\tthis._set(obj.x || 0, obj.y || 0);\n\t\t\t} else if ('width' in obj) {\n\t\t\t\tthis._set(obj.width || 0, obj.height || 0);\n\t\t\t} else if ('angle' in obj) {\n\t\t\t\tthis._set(obj.length || 0, 0);\n\t\t\t\tthis.setAngle(obj.angle || 0);\n\t\t\t} else {\n\t\t\t\tthis._set(0, 0);\n\t\t\t\tread = 0;\n\t\t\t}\n\t\t}\n\t\tif (reading)\n\t\t\tthis.__read = read;\n\t\treturn this;\n\t},\n\n\tset: '#initialize',\n\n\t_set: function(x, y) {\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t\treturn this;\n\t},\n\n\tequals: function(point) {\n\t\treturn this === point || point\n\t\t\t\t&& (this.x === point.x && this.y === point.y\n\t\t\t\t\t|| Array.isArray(point)\n\t\t\t\t\t\t&& this.x === point[0] && this.y === point[1])\n\t\t\t\t|| false;\n\t},\n\n\tclone: function() {\n\t\treturn new Point(this.x, this.y);\n\t},\n\n\ttoString: function() {\n\t\tvar f = Formatter.instance;\n\t\treturn '{ x: ' + f.number(this.x) + ', y: ' + f.number(this.y) + ' }';\n\t},\n\n\t_serialize: function(options) {\n\t\tvar f = options.formatter;\n\t\treturn [f.number(this.x), f.number(this.y)];\n\t},\n\n\tgetLength: function() {\n\t\treturn Math.sqrt(this.x * this.x + this.y * this.y);\n\t},\n\n\tsetLength: function(length) {\n\t\tif (this.isZero()) {\n\t\t\tvar angle = this._angle || 0;\n\t\t\tthis._set(\n\t\t\t\tMath.cos(angle) * length,\n\t\t\t\tMath.sin(angle) * length\n\t\t\t);\n\t\t} else {\n\t\t\tvar scale = length / this.getLength();\n\t\t\tif (Numerical.isZero(scale))\n\t\t\t\tthis.getAngle();\n\t\t\tthis._set(\n\t\t\t\tthis.x * scale,\n\t\t\t\tthis.y * scale\n\t\t\t);\n\t\t}\n\t},\n\tgetAngle: function() {\n\t\treturn this.getAngleInRadians.apply(this, arguments) * 180 / Math.PI;\n\t},\n\n\tsetAngle: function(angle) {\n\t\tthis.setAngleInRadians.call(this, angle * Math.PI / 180);\n\t},\n\n\tgetAngleInDegrees: '#getAngle',\n\tsetAngleInDegrees: '#setAngle',\n\n\tgetAngleInRadians: function() {\n\t\tif (!arguments.length) {\n\t\t\treturn this.isZero()\n\t\t\t\t\t? this._angle || 0\n\t\t\t\t\t: this._angle = Math.atan2(this.y, this.x);\n\t\t} else {\n\t\t\tvar point = Point.read(arguments),\n\t\t\t\tdiv = this.getLength() * point.getLength();\n\t\t\tif (Numerical.isZero(div)) {\n\t\t\t\treturn NaN;\n\t\t\t} else {\n\t\t\t\tvar a = this.dot(point) / div;\n\t\t\t\treturn Math.acos(a < -1 ? -1 : a > 1 ? 1 : a);\n\t\t\t}\n\t\t}\n\t},\n\n\tsetAngleInRadians: function(angle) {\n\t\tthis._angle = angle;\n\t\tif (!this.isZero()) {\n\t\t\tvar length = this.getLength();\n\t\t\tthis._set(\n\t\t\t\tMath.cos(angle) * length,\n\t\t\t\tMath.sin(angle) * length\n\t\t\t);\n\t\t}\n\t},\n\n\tgetQuadrant: function() {\n\t\treturn this.x >= 0 ? this.y >= 0 ? 1 : 4 : this.y >= 0 ? 2 : 3;\n\t}\n}, {\n\tbeans: false,\n\n\tgetDirectedAngle: function() {\n\t\tvar point = Point.read(arguments);\n\t\treturn Math.atan2(this.cross(point), this.dot(point)) * 180 / Math.PI;\n\t},\n\n\tgetDistance: function() {\n\t\tvar point = Point.read(arguments),\n\t\t\tx = point.x - this.x,\n\t\t\ty = point.y - this.y,\n\t\t\td = x * x + y * y,\n\t\t\tsquared = Base.read(arguments);\n\t\treturn squared ? d : Math.sqrt(d);\n\t},\n\n\tnormalize: function(length) {\n\t\tif (length === undefined)\n\t\t\tlength = 1;\n\t\tvar current = this.getLength(),\n\t\t\tscale = current !== 0 ? length / current : 0,\n\t\t\tpoint = new Point(this.x * scale, this.y * scale);\n\t\tif (scale >= 0)\n\t\t\tpoint._angle = this._angle;\n\t\treturn point;\n\t},\n\n\trotate: function(angle, center) {\n\t\tif (angle === 0)\n\t\t\treturn this.clone();\n\t\tangle = angle * Math.PI / 180;\n\t\tvar point = center ? this.subtract(center) : this,\n\t\t\tsin = Math.sin(angle),\n\t\t\tcos = Math.cos(angle);\n\t\tpoint = new Point(\n\t\t\tpoint.x * cos - point.y * sin,\n\t\t\tpoint.x * sin + point.y * cos\n\t\t);\n\t\treturn center ? point.add(center) : point;\n\t},\n\n\ttransform: function(matrix) {\n\t\treturn matrix ? matrix._transformPoint(this) : this;\n\t},\n\n\tadd: function() {\n\t\tvar point = Point.read(arguments);\n\t\treturn new Point(this.x + point.x, this.y + point.y);\n\t},\n\n\tsubtract: function() {\n\t\tvar point = Point.read(arguments);\n\t\treturn new Point(this.x - point.x, this.y - point.y);\n\t},\n\n\tmultiply: function() {\n\t\tvar point = Point.read(arguments);\n\t\treturn new Point(this.x * point.x, this.y * point.y);\n\t},\n\n\tdivide: function() {\n\t\tvar point = Point.read(arguments);\n\t\treturn new Point(this.x / point.x, this.y / point.y);\n\t},\n\n\tmodulo: function() {\n\t\tvar point = Point.read(arguments);\n\t\treturn new Point(this.x % point.x, this.y % point.y);\n\t},\n\n\tnegate: function() {\n\t\treturn new Point(-this.x, -this.y);\n\t},\n\n\tisInside: function() {\n\t\treturn Rectangle.read(arguments).contains(this);\n\t},\n\n\tisClose: function() {\n\t\tvar point = Point.read(arguments),\n\t\t\ttolerance = Base.read(arguments);\n\t\treturn this.getDistance(point) <= tolerance;\n\t},\n\n\tisCollinear: function() {\n\t\tvar point = Point.read(arguments);\n\t\treturn Point.isCollinear(this.x, this.y, point.x, point.y);\n\t},\n\n\tisColinear: '#isCollinear',\n\n\tisOrthogonal: function() {\n\t\tvar point = Point.read(arguments);\n\t\treturn Point.isOrthogonal(this.x, this.y, point.x, point.y);\n\t},\n\n\tisZero: function() {\n\t\tvar isZero = Numerical.isZero;\n\t\treturn isZero(this.x) && isZero(this.y);\n\t},\n\n\tisNaN: function() {\n\t\treturn isNaN(this.x) || isNaN(this.y);\n\t},\n\n\tisInQuadrant: function(q) {\n\t\treturn this.x * (q > 1 && q < 4 ? -1 : 1) >= 0\n\t\t\t&& this.y * (q > 2 ? -1 : 1) >= 0;\n\t},\n\n\tdot: function() {\n\t\tvar point = Point.read(arguments);\n\t\treturn this.x * point.x + this.y * point.y;\n\t},\n\n\tcross: function() {\n\t\tvar point = Point.read(arguments);\n\t\treturn this.x * point.y - this.y * point.x;\n\t},\n\n\tproject: function() {\n\t\tvar point = Point.read(arguments),\n\t\t\tscale = point.isZero() ? 0 : this.dot(point) / point.dot(point);\n\t\treturn new Point(\n\t\t\tpoint.x * scale,\n\t\t\tpoint.y * scale\n\t\t);\n\t},\n\n\tstatics: {\n\t\tmin: function() {\n\t\t\tvar point1 = Point.read(arguments),\n\t\t\t\tpoint2 = Point.read(arguments);\n\t\t\treturn new Point(\n\t\t\t\tMath.min(point1.x, point2.x),\n\t\t\t\tMath.min(point1.y, point2.y)\n\t\t\t);\n\t\t},\n\n\t\tmax: function() {\n\t\t\tvar point1 = Point.read(arguments),\n\t\t\t\tpoint2 = Point.read(arguments);\n\t\t\treturn new Point(\n\t\t\t\tMath.max(point1.x, point2.x),\n\t\t\t\tMath.max(point1.y, point2.y)\n\t\t\t);\n\t\t},\n\n\t\trandom: function() {\n\t\t\treturn new Point(Math.random(), Math.random());\n\t\t},\n\n\t\tisCollinear: function(x1, y1, x2, y2) {\n\t\t\treturn Math.abs(x1 * y2 - y1 * x2)\n\t\t\t\t\t<= Math.sqrt((x1 * x1 + y1 * y1) * (x2 * x2 + y2 * y2))\n\t\t\t\t\t\t* 1e-8;\n\t\t},\n\n\t\tisOrthogonal: function(x1, y1, x2, y2) {\n\t\t\treturn Math.abs(x1 * x2 + y1 * y2)\n\t\t\t\t\t<= Math.sqrt((x1 * x1 + y1 * y1) * (x2 * x2 + y2 * y2))\n\t\t\t\t\t\t* 1e-8;\n\t\t}\n\t}\n}, Base.each(['round', 'ceil', 'floor', 'abs'], function(key) {\n\tvar op = Math[key];\n\tthis[key] = function() {\n\t\treturn new Point(op(this.x), op(this.y));\n\t};\n}, {}));\n\nvar LinkedPoint = Point.extend({\n\tinitialize: function Point(x, y, owner, setter) {\n\t\tthis._x = x;\n\t\tthis._y = y;\n\t\tthis._owner = owner;\n\t\tthis._setter = setter;\n\t},\n\n\t_set: function(x, y, _dontNotify) {\n\t\tthis._x = x;\n\t\tthis._y = y;\n\t\tif (!_dontNotify)\n\t\t\tthis._owner[this._setter](this);\n\t\treturn this;\n\t},\n\n\tgetX: function() {\n\t\treturn this._x;\n\t},\n\n\tsetX: function(x) {\n\t\tthis._x = x;\n\t\tthis._owner[this._setter](this);\n\t},\n\n\tgetY: function() {\n\t\treturn this._y;\n\t},\n\n\tsetY: function(y) {\n\t\tthis._y = y;\n\t\tthis._owner[this._setter](this);\n\t},\n\n\tisSelected: function() {\n\t\treturn !!(this._owner._selection & this._getSelection());\n\t},\n\n\tsetSelected: function(selected) {\n\t\tthis._owner._changeSelection(this._getSelection(), selected);\n\t},\n\n\t_getSelection: function() {\n\t\treturn this._setter === 'setPosition' ? 4 : 0;\n\t}\n});\n\nvar Size = Base.extend({\n\t_class: 'Size',\n\t_readIndex: true,\n\n\tinitialize: function Size(arg0, arg1) {\n\t\tvar type = typeof arg0,\n\t\t\treading = this.__read,\n\t\t\tread = 0;\n\t\tif (type === 'number') {\n\t\t\tvar hasHeight = typeof arg1 === 'number';\n\t\t\tthis._set(arg0, hasHeight ? arg1 : arg0);\n\t\t\tif (reading)\n\t\t\t\tread = hasHeight ? 2 : 1;\n\t\t} else if (type === 'undefined' || arg0 === null) {\n\t\t\tthis._set(0, 0);\n\t\t\tif (reading)\n\t\t\t\tread = arg0 === null ? 1 : 0;\n\t\t} else {\n\t\t\tvar obj = type === 'string' ? arg0.split(/[\\s,]+/) || [] : arg0;\n\t\t\tread = 1;\n\t\t\tif (Array.isArray(obj)) {\n\t\t\t\tthis._set(+obj[0], +(obj.length > 1 ? obj[1] : obj[0]));\n\t\t\t} else if ('width' in obj) {\n\t\t\t\tthis._set(obj.width || 0, obj.height || 0);\n\t\t\t} else if ('x' in obj) {\n\t\t\t\tthis._set(obj.x || 0, obj.y || 0);\n\t\t\t} else {\n\t\t\t\tthis._set(0, 0);\n\t\t\t\tread = 0;\n\t\t\t}\n\t\t}\n\t\tif (reading)\n\t\t\tthis.__read = read;\n\t\treturn this;\n\t},\n\n\tset: '#initialize',\n\n\t_set: function(width, height) {\n\t\tthis.width = width;\n\t\tthis.height = height;\n\t\treturn this;\n\t},\n\n\tequals: function(size) {\n\t\treturn size === this || size && (this.width === size.width\n\t\t\t\t&& this.height === size.height\n\t\t\t\t|| Array.isArray(size) && this.width === size[0]\n\t\t\t\t\t&& this.height === size[1]) || false;\n\t},\n\n\tclone: function() {\n\t\treturn new Size(this.width, this.height);\n\t},\n\n\ttoString: function() {\n\t\tvar f = Formatter.instance;\n\t\treturn '{ width: ' + f.number(this.width)\n\t\t\t\t+ ', height: ' + f.number(this.height) + ' }';\n\t},\n\n\t_serialize: function(options) {\n\t\tvar f = options.formatter;\n\t\treturn [f.number(this.width),\n\t\t\t\tf.number(this.height)];\n\t},\n\n\tadd: function() {\n\t\tvar size = Size.read(arguments);\n\t\treturn new Size(this.width + size.width, this.height + size.height);\n\t},\n\n\tsubtract: function() {\n\t\tvar size = Size.read(arguments);\n\t\treturn new Size(this.width - size.width, this.height - size.height);\n\t},\n\n\tmultiply: function() {\n\t\tvar size = Size.read(arguments);\n\t\treturn new Size(this.width * size.width, this.height * size.height);\n\t},\n\n\tdivide: function() {\n\t\tvar size = Size.read(arguments);\n\t\treturn new Size(this.width / size.width, this.height / size.height);\n\t},\n\n\tmodulo: function() {\n\t\tvar size = Size.read(arguments);\n\t\treturn new Size(this.width % size.width, this.height % size.height);\n\t},\n\n\tnegate: function() {\n\t\treturn new Size(-this.width, -this.height);\n\t},\n\n\tisZero: function() {\n\t\tvar isZero = Numerical.isZero;\n\t\treturn isZero(this.width) && isZero(this.height);\n\t},\n\n\tisNaN: function() {\n\t\treturn isNaN(this.width) || isNaN(this.height);\n\t},\n\n\tstatics: {\n\t\tmin: function(size1, size2) {\n\t\t\treturn new Size(\n\t\t\t\tMath.min(size1.width, size2.width),\n\t\t\t\tMath.min(size1.height, size2.height));\n\t\t},\n\n\t\tmax: function(size1, size2) {\n\t\t\treturn new Size(\n\t\t\t\tMath.max(size1.width, size2.width),\n\t\t\t\tMath.max(size1.height, size2.height));\n\t\t},\n\n\t\trandom: function() {\n\t\t\treturn new Size(Math.random(), Math.random());\n\t\t}\n\t}\n}, Base.each(['round', 'ceil', 'floor', 'abs'], function(key) {\n\tvar op = Math[key];\n\tthis[key] = function() {\n\t\treturn new Size(op(this.width), op(this.height));\n\t};\n}, {}));\n\nvar LinkedSize = Size.extend({\n\tinitialize: function Size(width, height, owner, setter) {\n\t\tthis._width = width;\n\t\tthis._height = height;\n\t\tthis._owner = owner;\n\t\tthis._setter = setter;\n\t},\n\n\t_set: function(width, height, _dontNotify) {\n\t\tthis._width = width;\n\t\tthis._height = height;\n\t\tif (!_dontNotify)\n\t\t\tthis._owner[this._setter](this);\n\t\treturn this;\n\t},\n\n\tgetWidth: function() {\n\t\treturn this._width;\n\t},\n\n\tsetWidth: function(width) {\n\t\tthis._width = width;\n\t\tthis._owner[this._setter](this);\n\t},\n\n\tgetHeight: function() {\n\t\treturn this._height;\n\t},\n\n\tsetHeight: function(height) {\n\t\tthis._height = height;\n\t\tthis._owner[this._setter](this);\n\t}\n});\n\nvar Rectangle = Base.extend({\n\t_class: 'Rectangle',\n\t_readIndex: true,\n\tbeans: true,\n\n\tinitialize: function Rectangle(arg0, arg1, arg2, arg3) {\n\t\tvar type = typeof arg0,\n\t\t\tread;\n\t\tif (type === 'number') {\n\t\t\tthis._set(arg0, arg1, arg2, arg3);\n\t\t\tread = 4;\n\t\t} else if (type === 'undefined' || arg0 === null) {\n\t\t\tthis._set(0, 0, 0, 0);\n\t\t\tread = arg0 === null ? 1 : 0;\n\t\t} else if (arguments.length === 1) {\n\t\t\tif (Array.isArray(arg0)) {\n\t\t\t\tthis._set.apply(this, arg0);\n\t\t\t\tread = 1;\n\t\t\t} else if (arg0.x !== undefined || arg0.width !== undefined) {\n\t\t\t\tthis._set(arg0.x || 0, arg0.y || 0,\n\t\t\t\t\t\targ0.width || 0, arg0.height || 0);\n\t\t\t\tread = 1;\n\t\t\t} else if (arg0.from === undefined && arg0.to === undefined) {\n\t\t\t\tthis._set(0, 0, 0, 0);\n\t\t\t\tBase.filter(this, arg0);\n\t\t\t\tread = 1;\n\t\t\t}\n\t\t}\n\t\tif (read === undefined) {\n\t\t\tvar frm = Point.readNamed(arguments, 'from'),\n\t\t\t\tnext = Base.peek(arguments),\n\t\t\t\tx = frm.x,\n\t\t\t\ty = frm.y,\n\t\t\t\twidth,\n\t\t\t\theight;\n\t\t\tif (next && next.x !== undefined\n\t\t\t\t\t|| Base.hasNamed(arguments, 'to')) {\n\t\t\t\tvar to = Point.readNamed(arguments, 'to');\n\t\t\t\twidth = to.x - x;\n\t\t\t\theight = to.y - y;\n\t\t\t\tif (width < 0) {\n\t\t\t\t\tx = to.x;\n\t\t\t\t\twidth = -width;\n\t\t\t\t}\n\t\t\t\tif (height < 0) {\n\t\t\t\t\ty = to.y;\n\t\t\t\t\theight = -height;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tvar size = Size.read(arguments);\n\t\t\t\twidth = size.width;\n\t\t\t\theight = size.height;\n\t\t\t}\n\t\t\tthis._set(x, y, width, height);\n\t\t\tread = arguments.__index;\n\t\t\tvar filtered = arguments.__filtered;\n\t\t\tif (filtered)\n\t\t\t\tthis.__filtered = filtered;\n\t\t}\n\t\tif (this.__read)\n\t\t\tthis.__read = read;\n\t\treturn this;\n\t},\n\n\tset: '#initialize',\n\n\t_set: function(x, y, width, height) {\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t\tthis.width = width;\n\t\tthis.height = height;\n\t\treturn this;\n\t},\n\n\tclone: function() {\n\t\treturn new Rectangle(this.x, this.y, this.width, this.height);\n\t},\n\n\tequals: function(rect) {\n\t\tvar rt = Base.isPlainValue(rect)\n\t\t\t\t? Rectangle.read(arguments)\n\t\t\t\t: rect;\n\t\treturn rt === this\n\t\t\t\t|| rt && this.x === rt.x && this.y === rt.y\n\t\t\t\t\t&& this.width === rt.width && this.height === rt.height\n\t\t\t\t|| false;\n\t},\n\n\ttoString: function() {\n\t\tvar f = Formatter.instance;\n\t\treturn '{ x: ' + f.number(this.x)\n\t\t\t\t+ ', y: ' + f.number(this.y)\n\t\t\t\t+ ', width: ' + f.number(this.width)\n\t\t\t\t+ ', height: ' + f.number(this.height)\n\t\t\t\t+ ' }';\n\t},\n\n\t_serialize: function(options) {\n\t\tvar f = options.formatter;\n\t\treturn [f.number(this.x),\n\t\t\t\tf.number(this.y),\n\t\t\t\tf.number(this.width),\n\t\t\t\tf.number(this.height)];\n\t},\n\n\tgetPoint: function(_dontLink) {\n\t\tvar ctor = _dontLink ? Point : LinkedPoint;\n\t\treturn new ctor(this.x, this.y, this, 'setPoint');\n\t},\n\n\tsetPoint: function() {\n\t\tvar point = Point.read(arguments);\n\t\tthis.x = point.x;\n\t\tthis.y = point.y;\n\t},\n\n\tgetSize: function(_dontLink) {\n\t\tvar ctor = _dontLink ? Size : LinkedSize;\n\t\treturn new ctor(this.width, this.height, this, 'setSize');\n\t},\n\n\t_fw: 1,\n\t_fh: 1,\n\n\tsetSize: function() {\n\t\tvar size = Size.read(arguments),\n\t\t\tsx = this._sx,\n\t\t\tsy = this._sy,\n\t\t\tw = size.width,\n\t\t\th = size.height;\n\t\tif (sx) {\n\t\t\tthis.x += (this.width - w) * sx;\n\t\t}\n\t\tif (sy) {\n\t\t\tthis.y += (this.height - h) * sy;\n\t\t}\n\t\tthis.width = w;\n\t\tthis.height = h;\n\t\tthis._fw = this._fh = 1;\n\t},\n\n\tgetLeft: function() {\n\t\treturn this.x;\n\t},\n\n\tsetLeft: function(left) {\n\t\tif (!this._fw) {\n\t\t\tvar amount = left - this.x;\n\t\t\tthis.width -= this._sx === 0.5 ? amount * 2 : amount;\n\t\t}\n\t\tthis.x = left;\n\t\tthis._sx = this._fw = 0;\n\t},\n\n\tgetTop: function() {\n\t\treturn this.y;\n\t},\n\n\tsetTop: function(top) {\n\t\tif (!this._fh) {\n\t\t\tvar amount = top - this.y;\n\t\t\tthis.height -= this._sy === 0.5 ? amount * 2 : amount;\n\t\t}\n\t\tthis.y = top;\n\t\tthis._sy = this._fh = 0;\n\t},\n\n\tgetRight: function() {\n\t\treturn this.x + this.width;\n\t},\n\n\tsetRight: function(right) {\n\t\tif (!this._fw) {\n\t\t\tvar amount = right - this.x;\n\t\t\tthis.width = this._sx === 0.5 ? amount * 2 : amount;\n\t\t}\n\t\tthis.x = right - this.width;\n\t\tthis._sx = 1;\n\t\tthis._fw = 0;\n\t},\n\n\tgetBottom: function() {\n\t\treturn this.y + this.height;\n\t},\n\n\tsetBottom: function(bottom) {\n\t\tif (!this._fh) {\n\t\t\tvar amount = bottom - this.y;\n\t\t\tthis.height = this._sy === 0.5 ? amount * 2 : amount;\n\t\t}\n\t\tthis.y = bottom - this.height;\n\t\tthis._sy = 1;\n\t\tthis._fh = 0;\n\t},\n\n\tgetCenterX: function() {\n\t\treturn this.x + this.width / 2;\n\t},\n\n\tsetCenterX: function(x) {\n\t\tif (this._fw || this._sx === 0.5) {\n\t\t\tthis.x = x - this.width / 2;\n\t\t} else {\n\t\t\tif (this._sx) {\n\t\t\t\tthis.x += (x - this.x) * 2 * this._sx;\n\t\t\t}\n\t\t\tthis.width = (x - this.x) * 2;\n\t\t}\n\t\tthis._sx = 0.5;\n\t\tthis._fw = 0;\n\t},\n\n\tgetCenterY: function() {\n\t\treturn this.y + this.height / 2;\n\t},\n\n\tsetCenterY: function(y) {\n\t\tif (this._fh || this._sy === 0.5) {\n\t\t\tthis.y = y - this.height / 2;\n\t\t} else {\n\t\t\tif (this._sy) {\n\t\t\t\tthis.y += (y - this.y) * 2 * this._sy;\n\t\t\t}\n\t\t\tthis.height = (y - this.y) * 2;\n\t\t}\n\t\tthis._sy = 0.5;\n\t\tthis._fh = 0;\n\t},\n\n\tgetCenter: function(_dontLink) {\n\t\tvar ctor = _dontLink ? Point : LinkedPoint;\n\t\treturn new ctor(this.getCenterX(), this.getCenterY(), this, 'setCenter');\n\t},\n\n\tsetCenter: function() {\n\t\tvar point = Point.read(arguments);\n\t\tthis.setCenterX(point.x);\n\t\tthis.setCenterY(point.y);\n\t\treturn this;\n\t},\n\n\tgetArea: function() {\n\t\treturn this.width * this.height;\n\t},\n\n\tisEmpty: function() {\n\t\treturn this.width === 0 || this.height === 0;\n\t},\n\n\tcontains: function(arg) {\n\t\treturn arg && arg.width !== undefined\n\t\t\t\t|| (Array.isArray(arg) ? arg : arguments).length === 4\n\t\t\t\t? this._containsRectangle(Rectangle.read(arguments))\n\t\t\t\t: this._containsPoint(Point.read(arguments));\n\t},\n\n\t_containsPoint: function(point) {\n\t\tvar x = point.x,\n\t\t\ty = point.y;\n\t\treturn x >= this.x && y >= this.y\n\t\t\t\t&& x <= this.x + this.width\n\t\t\t\t&& y <= this.y + this.height;\n\t},\n\n\t_containsRectangle: function(rect) {\n\t\tvar x = rect.x,\n\t\t\ty = rect.y;\n\t\treturn x >= this.x && y >= this.y\n\t\t\t\t&& x + rect.width <= this.x + this.width\n\t\t\t\t&& y + rect.height <= this.y + this.height;\n\t},\n\n\tintersects: function() {\n\t\tvar rect = Rectangle.read(arguments),\n\t\t\tepsilon = Base.read(arguments) || 0;\n\t\treturn rect.x + rect.width > this.x - epsilon\n\t\t\t\t&& rect.y + rect.height > this.y - epsilon\n\t\t\t\t&& rect.x < this.x + this.width + epsilon\n\t\t\t\t&& rect.y < this.y + this.height + epsilon;\n\t},\n\n\tintersect: function() {\n\t\tvar rect = Rectangle.read(arguments),\n\t\t\tx1 = Math.max(this.x, rect.x),\n\t\t\ty1 = Math.max(this.y, rect.y),\n\t\t\tx2 = Math.min(this.x + this.width, rect.x + rect.width),\n\t\t\ty2 = Math.min(this.y + this.height, rect.y + rect.height);\n\t\treturn new Rectangle(x1, y1, x2 - x1, y2 - y1);\n\t},\n\n\tunite: function() {\n\t\tvar rect = Rectangle.read(arguments),\n\t\t\tx1 = Math.min(this.x, rect.x),\n\t\t\ty1 = Math.min(this.y, rect.y),\n\t\t\tx2 = Math.max(this.x + this.width, rect.x + rect.width),\n\t\t\ty2 = Math.max(this.y + this.height, rect.y + rect.height);\n\t\treturn new Rectangle(x1, y1, x2 - x1, y2 - y1);\n\t},\n\n\tinclude: function() {\n\t\tvar point = Point.read(arguments);\n\t\tvar x1 = Math.min(this.x, point.x),\n\t\t\ty1 = Math.min(this.y, point.y),\n\t\t\tx2 = Math.max(this.x + this.width, point.x),\n\t\t\ty2 = Math.max(this.y + this.height, point.y);\n\t\treturn new Rectangle(x1, y1, x2 - x1, y2 - y1);\n\t},\n\n\texpand: function() {\n\t\tvar amount = Size.read(arguments),\n\t\t\thor = amount.width,\n\t\t\tver = amount.height;\n\t\treturn new Rectangle(this.x - hor / 2, this.y - ver / 2,\n\t\t\t\tthis.width + hor, this.height + ver);\n\t},\n\n\tscale: function(hor, ver) {\n\t\treturn this.expand(this.width * hor - this.width,\n\t\t\t\tthis.height * (ver === undefined ? hor : ver) - this.height);\n\t}\n}, Base.each([\n\t\t['Top', 'Left'], ['Top', 'Right'],\n\t\t['Bottom', 'Left'], ['Bottom', 'Right'],\n\t\t['Left', 'Center'], ['Top', 'Center'],\n\t\t['Right', 'Center'], ['Bottom', 'Center']\n\t],\n\tfunction(parts, index) {\n\t\tvar part = parts.join(''),\n\t\t\txFirst = /^[RL]/.test(part);\n\t\tif (index >= 4)\n\t\t\tparts[1] += xFirst ? 'Y' : 'X';\n\t\tvar x = parts[xFirst ? 0 : 1],\n\t\t\ty = parts[xFirst ? 1 : 0],\n\t\t\tgetX = 'get' + x,\n\t\t\tgetY = 'get' + y,\n\t\t\tsetX = 'set' + x,\n\t\t\tsetY = 'set' + y,\n\t\t\tget = 'get' + part,\n\t\t\tset = 'set' + part;\n\t\tthis[get] = function(_dontLink) {\n\t\t\tvar ctor = _dontLink ? Point : LinkedPoint;\n\t\t\treturn new ctor(this[getX](), this[getY](), this, set);\n\t\t};\n\t\tthis[set] = function() {\n\t\t\tvar point = Point.read(arguments);\n\t\t\tthis[setX](point.x);\n\t\t\tthis[setY](point.y);\n\t\t};\n\t}, {\n\t\tbeans: true\n\t}\n));\n\nvar LinkedRectangle = Rectangle.extend({\n\tinitialize: function Rectangle(x, y, width, height, owner, setter) {\n\t\tthis._set(x, y, width, height, true);\n\t\tthis._owner = owner;\n\t\tthis._setter = setter;\n\t},\n\n\t_set: function(x, y, width, height, _dontNotify) {\n\t\tthis._x = x;\n\t\tthis._y = y;\n\t\tthis._width = width;\n\t\tthis._height = height;\n\t\tif (!_dontNotify)\n\t\t\tthis._owner[this._setter](this);\n\t\treturn this;\n\t}\n},\nnew function() {\n\tvar proto = Rectangle.prototype;\n\n\treturn Base.each(['x', 'y', 'width', 'height'], function(key) {\n\t\tvar part = Base.capitalize(key),\n\t\t\tinternal = '_' + key;\n\t\tthis['get' + part] = function() {\n\t\t\treturn this[internal];\n\t\t};\n\n\t\tthis['set' + part] = function(value) {\n\t\t\tthis[internal] = value;\n\t\t\tif (!this._dontNotify)\n\t\t\t\tthis._owner[this._setter](this);\n\t\t};\n\t}, Base.each(['Point', 'Size', 'Center',\n\t\t\t'Left', 'Top', 'Right', 'Bottom', 'CenterX', 'CenterY',\n\t\t\t'TopLeft', 'TopRight', 'BottomLeft', 'BottomRight',\n\t\t\t'LeftCenter', 'TopCenter', 'RightCenter', 'BottomCenter'],\n\t\tfunction(key) {\n\t\t\tvar name = 'set' + key;\n\t\t\tthis[name] = function() {\n\t\t\t\tthis._dontNotify = true;\n\t\t\t\tproto[name].apply(this, arguments);\n\t\t\t\tthis._dontNotify = false;\n\t\t\t\tthis._owner[this._setter](this);\n\t\t\t};\n\t\t}, {\n\t\t\tisSelected: function() {\n\t\t\t\treturn !!(this._owner._selection & 2);\n\t\t\t},\n\n\t\t\tsetSelected: function(selected) {\n\t\t\t\tvar owner = this._owner;\n\t\t\t\tif (owner._changeSelection) {\n\t\t\t\t\towner._changeSelection(2, selected);\n\t\t\t\t}\n\t\t\t}\n\t\t})\n\t);\n});\n\nvar Matrix = Base.extend({\n\t_class: 'Matrix',\n\n\tinitialize: function Matrix(arg, _dontNotify) {\n\t\tvar count = arguments.length,\n\t\t\tok = true;\n\t\tif (count >= 6) {\n\t\t\tthis._set.apply(this, arguments);\n\t\t} else if (count === 1 || count === 2) {\n\t\t\tif (arg instanceof Matrix) {\n\t\t\t\tthis._set(arg._a, arg._b, arg._c, arg._d, arg._tx, arg._ty,\n\t\t\t\t\t\t_dontNotify);\n\t\t\t} else if (Array.isArray(arg)) {\n\t\t\t\tthis._set.apply(this,\n\t\t\t\t\t\t_dontNotify ? arg.concat([_dontNotify]) : arg);\n\t\t\t} else {\n\t\t\t\tok = false;\n\t\t\t}\n\t\t} else if (!count) {\n\t\t\tthis.reset();\n\t\t} else {\n\t\t\tok = false;\n\t\t}\n\t\tif (!ok) {\n\t\t\tthrow new Error('Unsupported matrix parameters');\n\t\t}\n\t\treturn this;\n\t},\n\n\tset: '#initialize',\n\n\t_set: function(a, b, c, d, tx, ty, _dontNotify) {\n\t\tthis._a = a;\n\t\tthis._b = b;\n\t\tthis._c = c;\n\t\tthis._d = d;\n\t\tthis._tx = tx;\n\t\tthis._ty = ty;\n\t\tif (!_dontNotify)\n\t\t\tthis._changed();\n\t\treturn this;\n\t},\n\n\t_serialize: function(options, dictionary) {\n\t\treturn Base.serialize(this.getValues(), options, true, dictionary);\n\t},\n\n\t_changed: function() {\n\t\tvar owner = this._owner;\n\t\tif (owner) {\n\t\t\tif (owner._applyMatrix) {\n\t\t\t\towner.transform(null, true);\n\t\t\t} else {\n\t\t\t\towner._changed(25);\n\t\t\t}\n\t\t}\n\t},\n\n\tclone: function() {\n\t\treturn new Matrix(this._a, this._b, this._c, this._d,\n\t\t\t\tthis._tx, this._ty);\n\t},\n\n\tequals: function(mx) {\n\t\treturn mx === this || mx && this._a === mx._a && this._b === mx._b\n\t\t\t\t&& this._c === mx._c && this._d === mx._d\n\t\t\t\t&& this._tx === mx._tx && this._ty === mx._ty;\n\t},\n\n\ttoString: function() {\n\t\tvar f = Formatter.instance;\n\t\treturn '[[' + [f.number(this._a), f.number(this._c),\n\t\t\t\t\tf.number(this._tx)].join(', ') + '], ['\n\t\t\t\t+ [f.number(this._b), f.number(this._d),\n\t\t\t\t\tf.number(this._ty)].join(', ') + ']]';\n\t},\n\n\treset: function(_dontNotify) {\n\t\tthis._a = this._d = 1;\n\t\tthis._b = this._c = this._tx = this._ty = 0;\n\t\tif (!_dontNotify)\n\t\t\tthis._changed();\n\t\treturn this;\n\t},\n\n\tapply: function(recursively, _setApplyMatrix) {\n\t\tvar owner = this._owner;\n\t\tif (owner) {\n\t\t\towner.transform(null, true, Base.pick(recursively, true),\n\t\t\t\t\t_setApplyMatrix);\n\t\t\treturn this.isIdentity();\n\t\t}\n\t\treturn false;\n\t},\n\n\ttranslate: function() {\n\t\tvar point = Point.read(arguments),\n\t\t\tx = point.x,\n\t\t\ty = point.y;\n\t\tthis._tx += x * this._a + y * this._c;\n\t\tthis._ty += x * this._b + y * this._d;\n\t\tthis._changed();\n\t\treturn this;\n\t},\n\n\tscale: function() {\n\t\tvar scale = Point.read(arguments),\n\t\t\tcenter = Point.read(arguments, 0, { readNull: true });\n\t\tif (center)\n\t\t\tthis.translate(center);\n\t\tthis._a *= scale.x;\n\t\tthis._b *= scale.x;\n\t\tthis._c *= scale.y;\n\t\tthis._d *= scale.y;\n\t\tif (center)\n\t\t\tthis.translate(center.negate());\n\t\tthis._changed();\n\t\treturn this;\n\t},\n\n\trotate: function(angle ) {\n\t\tangle *= Math.PI / 180;\n\t\tvar center = Point.read(arguments, 1),\n\t\t\tx = center.x,\n\t\t\ty = center.y,\n\t\t\tcos = Math.cos(angle),\n\t\t\tsin = Math.sin(angle),\n\t\t\ttx = x - x * cos + y * sin,\n\t\t\tty = y - x * sin - y * cos,\n\t\t\ta = this._a,\n\t\t\tb = this._b,\n\t\t\tc = this._c,\n\t\t\td = this._d;\n\t\tthis._a = cos * a + sin * c;\n\t\tthis._b = cos * b + sin * d;\n\t\tthis._c = -sin * a + cos * c;\n\t\tthis._d = -sin * b + cos * d;\n\t\tthis._tx += tx * a + ty * c;\n\t\tthis._ty += tx * b + ty * d;\n\t\tthis._changed();\n\t\treturn this;\n\t},\n\n\tshear: function() {\n\t\tvar shear = Point.read(arguments),\n\t\t\tcenter = Point.read(arguments, 0, { readNull: true });\n\t\tif (center)\n\t\t\tthis.translate(center);\n\t\tvar a = this._a,\n\t\t\tb = this._b;\n\t\tthis._a += shear.y * this._c;\n\t\tthis._b += shear.y * this._d;\n\t\tthis._c += shear.x * a;\n\t\tthis._d += shear.x * b;\n\t\tif (center)\n\t\t\tthis.translate(center.negate());\n\t\tthis._changed();\n\t\treturn this;\n\t},\n\n\tskew: function() {\n\t\tvar skew = Point.read(arguments),\n\t\t\tcenter = Point.read(arguments, 0, { readNull: true }),\n\t\t\ttoRadians = Math.PI / 180,\n\t\t\tshear = new Point(Math.tan(skew.x * toRadians),\n\t\t\t\tMath.tan(skew.y * toRadians));\n\t\treturn this.shear(shear, center);\n\t},\n\n\tappend: function(mx, _dontNotify) {\n\t\tif (mx) {\n\t\t\tvar a1 = this._a,\n\t\t\t\tb1 = this._b,\n\t\t\t\tc1 = this._c,\n\t\t\t\td1 = this._d,\n\t\t\t\ta2 = mx._a,\n\t\t\t\tb2 = mx._c,\n\t\t\t\tc2 = mx._b,\n\t\t\t\td2 = mx._d,\n\t\t\t\ttx2 = mx._tx,\n\t\t\t\tty2 = mx._ty;\n\t\t\tthis._a = a2 * a1 + c2 * c1;\n\t\t\tthis._c = b2 * a1 + d2 * c1;\n\t\t\tthis._b = a2 * b1 + c2 * d1;\n\t\t\tthis._d = b2 * b1 + d2 * d1;\n\t\t\tthis._tx += tx2 * a1 + ty2 * c1;\n\t\t\tthis._ty += tx2 * b1 + ty2 * d1;\n\t\t\tif (!_dontNotify)\n\t\t\t\tthis._changed();\n\t\t}\n\t\treturn this;\n\t},\n\n\tprepend: function(mx, _dontNotify) {\n\t\tif (mx) {\n\t\t\tvar a1 = this._a,\n\t\t\t\tb1 = this._b,\n\t\t\t\tc1 = this._c,\n\t\t\t\td1 = this._d,\n\t\t\t\ttx1 = this._tx,\n\t\t\t\tty1 = this._ty,\n\t\t\t\ta2 = mx._a,\n\t\t\t\tb2 = mx._c,\n\t\t\t\tc2 = mx._b,\n\t\t\t\td2 = mx._d,\n\t\t\t\ttx2 = mx._tx,\n\t\t\t\tty2 = mx._ty;\n\t\t\tthis._a = a2 * a1 + b2 * b1;\n\t\t\tthis._c = a2 * c1 + b2 * d1;\n\t\t\tthis._b = c2 * a1 + d2 * b1;\n\t\t\tthis._d = c2 * c1 + d2 * d1;\n\t\t\tthis._tx = a2 * tx1 + b2 * ty1 + tx2;\n\t\t\tthis._ty = c2 * tx1 + d2 * ty1 + ty2;\n\t\t\tif (!_dontNotify)\n\t\t\t\tthis._changed();\n\t\t}\n\t\treturn this;\n\t},\n\n\tappended: function(mx) {\n\t\treturn this.clone().append(mx);\n\t},\n\n\tprepended: function(mx) {\n\t\treturn this.clone().prepend(mx);\n\t},\n\n\tinvert: function() {\n\t\tvar a = this._a,\n\t\t\tb = this._b,\n\t\t\tc = this._c,\n\t\t\td = this._d,\n\t\t\ttx = this._tx,\n\t\t\tty = this._ty,\n\t\t\tdet = a * d - b * c,\n\t\t\tres = null;\n\t\tif (det && !isNaN(det) && isFinite(tx) && isFinite(ty)) {\n\t\t\tthis._a = d / det;\n\t\t\tthis._b = -b / det;\n\t\t\tthis._c = -c / det;\n\t\t\tthis._d = a / det;\n\t\t\tthis._tx = (c * ty - d * tx) / det;\n\t\t\tthis._ty = (b * tx - a * ty) / det;\n\t\t\tres = this;\n\t\t}\n\t\treturn res;\n\t},\n\n\tinverted: function() {\n\t\treturn this.clone().invert();\n\t},\n\n\tconcatenate: '#append',\n\tpreConcatenate: '#prepend',\n\tchain: '#appended',\n\n\t_shiftless: function() {\n\t\treturn new Matrix(this._a, this._b, this._c, this._d, 0, 0);\n\t},\n\n\t_orNullIfIdentity: function() {\n\t\treturn this.isIdentity() ? null : this;\n\t},\n\n\tisIdentity: function() {\n\t\treturn this._a === 1 && this._b === 0 && this._c === 0 && this._d === 1\n\t\t\t\t&& this._tx === 0 && this._ty === 0;\n\t},\n\n\tisInvertible: function() {\n\t\tvar det = this._a * this._d - this._c * this._b;\n\t\treturn det && !isNaN(det) && isFinite(this._tx) && isFinite(this._ty);\n\t},\n\n\tisSingular: function() {\n\t\treturn !this.isInvertible();\n\t},\n\n\ttransform: function( src, dst, count) {\n\t\treturn arguments.length < 3\n\t\t\t? this._transformPoint(Point.read(arguments))\n\t\t\t: this._transformCoordinates(src, dst, count);\n\t},\n\n\t_transformPoint: function(point, dest, _dontNotify) {\n\t\tvar x = point.x,\n\t\t\ty = point.y;\n\t\tif (!dest)\n\t\t\tdest = new Point();\n\t\treturn dest._set(\n\t\t\t\tx * this._a + y * this._c + this._tx,\n\t\t\t\tx * this._b + y * this._d + this._ty,\n\t\t\t\t_dontNotify);\n\t},\n\n\t_transformCoordinates: function(src, dst, count) {\n\t\tfor (var i = 0, max = 2 * count; i < max; i += 2) {\n\t\t\tvar x = src[i],\n\t\t\t\ty = src[i + 1];\n\t\t\tdst[i] = x * this._a + y * this._c + this._tx;\n\t\t\tdst[i + 1] = x * this._b + y * this._d + this._ty;\n\t\t}\n\t\treturn dst;\n\t},\n\n\t_transformCorners: function(rect) {\n\t\tvar x1 = rect.x,\n\t\t\ty1 = rect.y,\n\t\t\tx2 = x1 + rect.width,\n\t\t\ty2 = y1 + rect.height,\n\t\t\tcoords = [ x1, y1, x2, y1, x2, y2, x1, y2 ];\n\t\treturn this._transformCoordinates(coords, coords, 4);\n\t},\n\n\t_transformBounds: function(bounds, dest, _dontNotify) {\n\t\tvar coords = this._transformCorners(bounds),\n\t\t\tmin = coords.slice(0, 2),\n\t\t\tmax = min.slice();\n\t\tfor (var i = 2; i < 8; i++) {\n\t\t\tvar val = coords[i],\n\t\t\t\tj = i & 1;\n\t\t\tif (val < min[j]) {\n\t\t\t\tmin[j] = val;\n\t\t\t} else if (val > max[j]) {\n\t\t\t\tmax[j] = val;\n\t\t\t}\n\t\t}\n\t\tif (!dest)\n\t\t\tdest = new Rectangle();\n\t\treturn dest._set(min[0], min[1], max[0] - min[0], max[1] - min[1],\n\t\t\t\t_dontNotify);\n\t},\n\n\tinverseTransform: function() {\n\t\treturn this._inverseTransform(Point.read(arguments));\n\t},\n\n\t_inverseTransform: function(point, dest, _dontNotify) {\n\t\tvar a = this._a,\n\t\t\tb = this._b,\n\t\t\tc = this._c,\n\t\t\td = this._d,\n\t\t\ttx = this._tx,\n\t\t\tty = this._ty,\n\t\t\tdet = a * d - b * c,\n\t\t\tres = null;\n\t\tif (det && !isNaN(det) && isFinite(tx) && isFinite(ty)) {\n\t\t\tvar x = point.x - this._tx,\n\t\t\t\ty = point.y - this._ty;\n\t\t\tif (!dest)\n\t\t\t\tdest = new Point();\n\t\t\tres = dest._set(\n\t\t\t\t\t(x * d - y * c) / det,\n\t\t\t\t\t(y * a - x * b) / det,\n\t\t\t\t\t_dontNotify);\n\t\t}\n\t\treturn res;\n\t},\n\n\tdecompose: function() {\n\t\tvar a = this._a,\n\t\t\tb = this._b,\n\t\t\tc = this._c,\n\t\t\td = this._d,\n\t\t\tdet = a * d - b * c,\n\t\t\tsqrt = Math.sqrt,\n\t\t\tatan2 = Math.atan2,\n\t\t\tdegrees = 180 / Math.PI,\n\t\t\trotate,\n\t\t\tscale,\n\t\t\tskew;\n\t\tif (a !== 0 || b !== 0) {\n\t\t\tvar r = sqrt(a * a + b * b);\n\t\t\trotate = Math.acos(a / r) * (b > 0 ? 1 : -1);\n\t\t\tscale = [r, det / r];\n\t\t\tskew = [atan2(a * c + b * d, r * r), 0];\n\t\t} else if (c !== 0 || d !== 0) {\n\t\t\tvar s = sqrt(c * c + d * d);\n\t\t\trotate = Math.asin(c / s)  * (d > 0 ? 1 : -1);\n\t\t\tscale = [det / s, s];\n\t\t\tskew = [0, atan2(a * c + b * d, s * s)];\n\t\t} else {\n\t\t\trotate = 0;\n\t\t\tskew = scale = [0, 0];\n\t\t}\n\t\treturn {\n\t\t\ttranslation: this.getTranslation(),\n\t\t\trotation: rotate * degrees,\n\t\t\tscaling: new Point(scale),\n\t\t\tskewing: new Point(skew[0] * degrees, skew[1] * degrees)\n\t\t};\n\t},\n\n\tgetValues: function() {\n\t\treturn [ this._a, this._b, this._c, this._d, this._tx, this._ty ];\n\t},\n\n\tgetTranslation: function() {\n\t\treturn new Point(this._tx, this._ty);\n\t},\n\n\tgetScaling: function() {\n\t\treturn this.decompose().scaling;\n\t},\n\n\tgetRotation: function() {\n\t\treturn this.decompose().rotation;\n\t},\n\n\tapplyToContext: function(ctx) {\n\t\tif (!this.isIdentity()) {\n\t\t\tctx.transform(this._a, this._b, this._c, this._d,\n\t\t\t\t\tthis._tx, this._ty);\n\t\t}\n\t}\n}, Base.each(['a', 'b', 'c', 'd', 'tx', 'ty'], function(key) {\n\tvar part = Base.capitalize(key),\n\t\tprop = '_' + key;\n\tthis['get' + part] = function() {\n\t\treturn this[prop];\n\t};\n\tthis['set' + part] = function(value) {\n\t\tthis[prop] = value;\n\t\tthis._changed();\n\t};\n}, {}));\n\nvar Line = Base.extend({\n\t_class: 'Line',\n\n\tinitialize: function Line(arg0, arg1, arg2, arg3, arg4) {\n\t\tvar asVector = false;\n\t\tif (arguments.length >= 4) {\n\t\t\tthis._px = arg0;\n\t\t\tthis._py = arg1;\n\t\t\tthis._vx = arg2;\n\t\t\tthis._vy = arg3;\n\t\t\tasVector = arg4;\n\t\t} else {\n\t\t\tthis._px = arg0.x;\n\t\t\tthis._py = arg0.y;\n\t\t\tthis._vx = arg1.x;\n\t\t\tthis._vy = arg1.y;\n\t\t\tasVector = arg2;\n\t\t}\n\t\tif (!asVector) {\n\t\t\tthis._vx -= this._px;\n\t\t\tthis._vy -= this._py;\n\t\t}\n\t},\n\n\tgetPoint: function() {\n\t\treturn new Point(this._px, this._py);\n\t},\n\n\tgetVector: function() {\n\t\treturn new Point(this._vx, this._vy);\n\t},\n\n\tgetLength: function() {\n\t\treturn this.getVector().getLength();\n\t},\n\n\tintersect: function(line, isInfinite) {\n\t\treturn Line.intersect(\n\t\t\t\tthis._px, this._py, this._vx, this._vy,\n\t\t\t\tline._px, line._py, line._vx, line._vy,\n\t\t\t\ttrue, isInfinite);\n\t},\n\n\tgetSide: function(point, isInfinite) {\n\t\treturn Line.getSide(\n\t\t\t\tthis._px, this._py, this._vx, this._vy,\n\t\t\t\tpoint.x, point.y, true, isInfinite);\n\t},\n\n\tgetDistance: function(point) {\n\t\treturn Math.abs(this.getSignedDistance(point));\n\t},\n\n\tgetSignedDistance: function(point) {\n\t\treturn Line.getSignedDistance(this._px, this._py, this._vx, this._vy,\n\t\t\t\tpoint.x, point.y, true);\n\t},\n\n\tisCollinear: function(line) {\n\t\treturn Point.isCollinear(this._vx, this._vy, line._vx, line._vy);\n\t},\n\n\tisOrthogonal: function(line) {\n\t\treturn Point.isOrthogonal(this._vx, this._vy, line._vx, line._vy);\n\t},\n\n\tstatics: {\n\t\tintersect: function(p1x, p1y, v1x, v1y, p2x, p2y, v2x, v2y, asVector,\n\t\t\t\tisInfinite) {\n\t\t\tif (!asVector) {\n\t\t\t\tv1x -= p1x;\n\t\t\t\tv1y -= p1y;\n\t\t\t\tv2x -= p2x;\n\t\t\t\tv2y -= p2y;\n\t\t\t}\n\t\t\tvar cross = v1x * v2y - v1y * v2x;\n\t\t\tif (!Numerical.isZero(cross)) {\n\t\t\t\tvar dx = p1x - p2x,\n\t\t\t\t\tdy = p1y - p2y,\n\t\t\t\t\tu1 = (v2x * dy - v2y * dx) / cross,\n\t\t\t\t\tu2 = (v1x * dy - v1y * dx) / cross,\n\t\t\t\t\tepsilon = 1e-12,\n\t\t\t\t\tuMin = -epsilon,\n\t\t\t\t\tuMax = 1 + epsilon;\n\t\t\t\tif (isInfinite\n\t\t\t\t\t\t|| uMin < u1 && u1 < uMax && uMin < u2 && u2 < uMax) {\n\t\t\t\t\tif (!isInfinite) {\n\t\t\t\t\t\tu1 = u1 <= 0 ? 0 : u1 >= 1 ? 1 : u1;\n\t\t\t\t\t}\n\t\t\t\t\treturn new Point(\n\t\t\t\t\t\t\tp1x + u1 * v1x,\n\t\t\t\t\t\t\tp1y + u1 * v1y);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\tgetSide: function(px, py, vx, vy, x, y, asVector, isInfinite) {\n\t\t\tif (!asVector) {\n\t\t\t\tvx -= px;\n\t\t\t\tvy -= py;\n\t\t\t}\n\t\t\tvar v2x = x - px,\n\t\t\t\tv2y = y - py,\n\t\t\t\tccw = v2x * vy - v2y * vx;\n\t\t\tif (!isInfinite && Numerical.isZero(ccw)) {\n\t\t\t\tccw = (v2x * vx + v2x * vx) / (vx * vx + vy * vy);\n\t\t\t\tif (ccw >= 0 && ccw <= 1)\n\t\t\t\t\tccw = 0;\n\t\t\t}\n\t\t\treturn ccw < 0 ? -1 : ccw > 0 ? 1 : 0;\n\t\t},\n\n\t\tgetSignedDistance: function(px, py, vx, vy, x, y, asVector) {\n\t\t\tif (!asVector) {\n\t\t\t\tvx -= px;\n\t\t\t\tvy -= py;\n\t\t\t}\n\t\t\treturn vx === 0 ? vy > 0 ? x - px : px - x\n\t\t\t\t : vy === 0 ? vx < 0 ? y - py : py - y\n\t\t\t\t : ((x-px) * vy - (y-py) * vx) / Math.sqrt(vx * vx + vy * vy);\n\t\t},\n\n\t\tgetDistance: function(px, py, vx, vy, x, y, asVector) {\n\t\t\treturn Math.abs(\n\t\t\t\t\tLine.getSignedDistance(px, py, vx, vy, x, y, asVector));\n\t\t}\n\t}\n});\n\nvar Project = PaperScopeItem.extend({\n\t_class: 'Project',\n\t_list: 'projects',\n\t_reference: 'project',\n\t_compactSerialize: true,\n\n\tinitialize: function Project(element) {\n\t\tPaperScopeItem.call(this, true);\n\t\tthis._children = [];\n\t\tthis._namedChildren = {};\n\t\tthis._activeLayer = null;\n\t\tthis._currentStyle = new Style(null, null, this);\n\t\tthis._view = View.create(this,\n\t\t\t\telement || CanvasProvider.getCanvas(1, 1));\n\t\tthis._selectionItems = {};\n\t\tthis._selectionCount = 0;\n\t\tthis._updateVersion = 0;\n\t},\n\n\t_serialize: function(options, dictionary) {\n\t\treturn Base.serialize(this._children, options, true, dictionary);\n\t},\n\n\t_changed: function(flags, item) {\n\t\tif (flags & 1) {\n\t\t\tvar view = this._view;\n\t\t\tif (view) {\n\t\t\t\tview._needsUpdate = true;\n\t\t\t\tif (!view._requested && view._autoUpdate)\n\t\t\t\t\tview.requestUpdate();\n\t\t\t}\n\t\t}\n\t\tvar changes = this._changes;\n\t\tif (changes && item) {\n\t\t\tvar changesById = this._changesById,\n\t\t\t\tid = item._id,\n\t\t\t\tentry = changesById[id];\n\t\t\tif (entry) {\n\t\t\t\tentry.flags |= flags;\n\t\t\t} else {\n\t\t\t\tchanges.push(changesById[id] = { item: item, flags: flags });\n\t\t\t}\n\t\t}\n\t},\n\n\tclear: function() {\n\t\tvar children = this._children;\n\t\tfor (var i = children.length - 1; i >= 0; i--)\n\t\t\tchildren[i].remove();\n\t},\n\n\tisEmpty: function() {\n\t\treturn !this._children.length;\n\t},\n\n\tremove: function remove() {\n\t\tif (!remove.base.call(this))\n\t\t\treturn false;\n\t\tif (this._view)\n\t\t\tthis._view.remove();\n\t\treturn true;\n\t},\n\n\tgetView: function() {\n\t\treturn this._view;\n\t},\n\n\tgetCurrentStyle: function() {\n\t\treturn this._currentStyle;\n\t},\n\n\tsetCurrentStyle: function(style) {\n\t\tthis._currentStyle.set(style);\n\t},\n\n\tgetIndex: function() {\n\t\treturn this._index;\n\t},\n\n\tgetOptions: function() {\n\t\treturn this._scope.settings;\n\t},\n\n\tgetLayers: function() {\n\t\treturn this._children;\n\t},\n\n\tgetActiveLayer: function() {\n\t\treturn this._activeLayer || new Layer({ project: this, insert: true });\n\t},\n\n\tgetSymbolDefinitions: function() {\n\t\tvar definitions = [],\n\t\t\tids = {};\n\t\tthis.getItems({\n\t\t\tclass: SymbolItem,\n\t\t\tmatch: function(item) {\n\t\t\t\tvar definition = item._definition,\n\t\t\t\t\tid = definition._id;\n\t\t\t\tif (!ids[id]) {\n\t\t\t\t\tids[id] = true;\n\t\t\t\t\tdefinitions.push(definition);\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t});\n\t\treturn definitions;\n\t},\n\n\tgetSymbols: 'getSymbolDefinitions',\n\n\tgetSelectedItems: function() {\n\t\tvar selectionItems = this._selectionItems,\n\t\t\titems = [];\n\t\tfor (var id in selectionItems) {\n\t\t\tvar item = selectionItems[id],\n\t\t\t\tselection = item._selection;\n\t\t\tif ((selection & 1) && item.isInserted()) {\n\t\t\t\titems.push(item);\n\t\t\t} else if (!selection) {\n\t\t\t\tthis._updateSelection(item);\n\t\t\t}\n\t\t}\n\t\treturn items;\n\t},\n\n\t_updateSelection: function(item) {\n\t\tvar id = item._id,\n\t\t\tselectionItems = this._selectionItems;\n\t\tif (item._selection) {\n\t\t\tif (selectionItems[id] !== item) {\n\t\t\t\tthis._selectionCount++;\n\t\t\t\tselectionItems[id] = item;\n\t\t\t}\n\t\t} else if (selectionItems[id] === item) {\n\t\t\tthis._selectionCount--;\n\t\t\tdelete selectionItems[id];\n\t\t}\n\t},\n\n\tselectAll: function() {\n\t\tvar children = this._children;\n\t\tfor (var i = 0, l = children.length; i < l; i++)\n\t\t\tchildren[i].setFullySelected(true);\n\t},\n\n\tdeselectAll: function() {\n\t\tvar selectionItems = this._selectionItems;\n\t\tfor (var i in selectionItems)\n\t\t\tselectionItems[i].setFullySelected(false);\n\t},\n\n\taddLayer: function(layer) {\n\t\treturn this.insertLayer(undefined, layer);\n\t},\n\n\tinsertLayer: function(index, layer) {\n\t\tif (layer instanceof Layer) {\n\t\t\tlayer._remove(false, true);\n\t\t\tBase.splice(this._children, [layer], index, 0);\n\t\t\tlayer._setProject(this, true);\n\t\t\tvar name = layer._name;\n\t\t\tif (name)\n\t\t\t\tlayer.setName(name);\n\t\t\tif (this._changes)\n\t\t\t\tlayer._changed(5);\n\t\t\tif (!this._activeLayer)\n\t\t\t\tthis._activeLayer = layer;\n\t\t} else {\n\t\t\tlayer = null;\n\t\t}\n\t\treturn layer;\n\t},\n\n\t_insertItem: function(index, item, _created) {\n\t\titem = this.insertLayer(index, item)\n\t\t\t\t|| (this._activeLayer || this._insertItem(undefined,\n\t\t\t\t\t\tnew Layer(Item.NO_INSERT), true))\n\t\t\t\t\t\t.insertChild(index, item);\n\t\tif (_created && item.activate)\n\t\t\titem.activate();\n\t\treturn item;\n\t},\n\n\tgetItems: function(options) {\n\t\treturn Item._getItems(this, options);\n\t},\n\n\tgetItem: function(options) {\n\t\treturn Item._getItems(this, options, null, null, true)[0] || null;\n\t},\n\n\timportJSON: function(json) {\n\t\tthis.activate();\n\t\tvar layer = this._activeLayer;\n\t\treturn Base.importJSON(json, layer && layer.isEmpty() && layer);\n\t},\n\n\tremoveOn: function(type) {\n\t\tvar sets = this._removeSets;\n\t\tif (sets) {\n\t\t\tif (type === 'mouseup')\n\t\t\t\tsets.mousedrag = null;\n\t\t\tvar set = sets[type];\n\t\t\tif (set) {\n\t\t\t\tfor (var id in set) {\n\t\t\t\t\tvar item = set[id];\n\t\t\t\t\tfor (var key in sets) {\n\t\t\t\t\t\tvar other = sets[key];\n\t\t\t\t\t\tif (other && other != set)\n\t\t\t\t\t\t\tdelete other[item._id];\n\t\t\t\t\t}\n\t\t\t\t\titem.remove();\n\t\t\t\t}\n\t\t\t\tsets[type] = null;\n\t\t\t}\n\t\t}\n\t},\n\n\tdraw: function(ctx, matrix, pixelRatio) {\n\t\tthis._updateVersion++;\n\t\tctx.save();\n\t\tmatrix.applyToContext(ctx);\n\t\tvar children = this._children,\n\t\t\tparam = new Base({\n\t\t\t\toffset: new Point(0, 0),\n\t\t\t\tpixelRatio: pixelRatio,\n\t\t\t\tviewMatrix: matrix.isIdentity() ? null : matrix,\n\t\t\t\tmatrices: [new Matrix()],\n\t\t\t\tupdateMatrix: true\n\t\t\t});\n\t\tfor (var i = 0, l = children.length; i < l; i++) {\n\t\t\tchildren[i].draw(ctx, param);\n\t\t}\n\t\tctx.restore();\n\n\t\tif (this._selectionCount > 0) {\n\t\t\tctx.save();\n\t\t\tctx.strokeWidth = 1;\n\t\t\tvar items = this._selectionItems,\n\t\t\t\tsize = this._scope.settings.handleSize,\n\t\t\t\tversion = this._updateVersion;\n\t\t\tfor (var id in items) {\n\t\t\t\titems[id]._drawSelection(ctx, matrix, size, items, version);\n\t\t\t}\n\t\t\tctx.restore();\n\t\t}\n\t}\n});\n\nvar Item = Base.extend(Emitter, {\n\tstatics: {\n\t\textend: function extend(src) {\n\t\t\tif (src._serializeFields)\n\t\t\t\tsrc._serializeFields = Base.set({},\n\t\t\t\t\tthis.prototype._serializeFields, src._serializeFields);\n\t\t\treturn extend.base.apply(this, arguments);\n\t\t},\n\n\t\tNO_INSERT: { insert: false }\n\t},\n\n\t_class: 'Item',\n\t_name: null,\n\t_applyMatrix: true,\n\t_canApplyMatrix: true,\n\t_canScaleStroke: false,\n\t_pivot: null,\n\t_visible: true,\n\t_blendMode: 'normal',\n\t_opacity: 1,\n\t_locked: false,\n\t_guide: false,\n\t_clipMask: false,\n\t_selection: 0,\n\t_selectBounds: true,\n\t_selectChildren: false,\n\t_serializeFields: {\n\t\tname: null,\n\t\tapplyMatrix: null,\n\t\tmatrix: new Matrix(),\n\t\tpivot: null,\n\t\tvisible: true,\n\t\tblendMode: 'normal',\n\t\topacity: 1,\n\t\tlocked: false,\n\t\tguide: false,\n\t\tclipMask: false,\n\t\tselected: false,\n\t\tdata: {}\n\t},\n\t_prioritize: ['applyMatrix']\n},\nnew function() {\n\tvar handlers = ['onMouseDown', 'onMouseUp', 'onMouseDrag', 'onClick',\n\t\t\t'onDoubleClick', 'onMouseMove', 'onMouseEnter', 'onMouseLeave'];\n\treturn Base.each(handlers,\n\t\tfunction(name) {\n\t\t\tthis._events[name] = {\n\t\t\t\tinstall: function(type) {\n\t\t\t\t\tthis.getView()._countItemEvent(type, 1);\n\t\t\t\t},\n\n\t\t\t\tuninstall: function(type) {\n\t\t\t\t\tthis.getView()._countItemEvent(type, -1);\n\t\t\t\t}\n\t\t\t};\n\t\t}, {\n\t\t\t_events: {\n\t\t\t\tonFrame: {\n\t\t\t\t\tinstall: function() {\n\t\t\t\t\t\tthis.getView()._animateItem(this, true);\n\t\t\t\t\t},\n\n\t\t\t\t\tuninstall: function() {\n\t\t\t\t\t\tthis.getView()._animateItem(this, false);\n\t\t\t\t\t}\n\t\t\t\t},\n\n\t\t\t\tonLoad: {},\n\t\t\t\tonError: {}\n\t\t\t},\n\t\t\tstatics: {\n\t\t\t\t_itemHandlers: handlers\n\t\t\t}\n\t\t}\n\t);\n}, {\n\tinitialize: function Item() {\n\t},\n\n\t_initialize: function(props, point) {\n\t\tvar hasProps = props && Base.isPlainObject(props),\n\t\t\tinternal = hasProps && props.internal === true,\n\t\t\tmatrix = this._matrix = new Matrix(),\n\t\t\tproject = hasProps && props.project || paper.project,\n\t\t\tsettings = paper.settings;\n\t\tthis._id = internal ? null : UID.get();\n\t\tthis._parent = this._index = null;\n\t\tthis._applyMatrix = this._canApplyMatrix && settings.applyMatrix;\n\t\tif (point)\n\t\t\tmatrix.translate(point);\n\t\tmatrix._owner = this;\n\t\tthis._style = new Style(project._currentStyle, this, project);\n\t\tif (internal || hasProps && props.insert == false\n\t\t\t|| !settings.insertItems && !(hasProps && props.insert === true)) {\n\t\t\tthis._setProject(project);\n\t\t} else {\n\t\t\t(hasProps && props.parent || project)\n\t\t\t\t\t._insertItem(undefined, this, true);\n\t\t}\n\t\tif (hasProps && props !== Item.NO_INSERT) {\n\t\t\tthis.set(props, {\n\t\t\t\tinternal: true, insert: true, project: true, parent: true\n\t\t\t});\n\t\t}\n\t\treturn hasProps;\n\t},\n\n\t_serialize: function(options, dictionary) {\n\t\tvar props = {},\n\t\t\tthat = this;\n\n\t\tfunction serialize(fields) {\n\t\t\tfor (var key in fields) {\n\t\t\t\tvar value = that[key];\n\t\t\t\tif (!Base.equals(value, key === 'leading'\n\t\t\t\t\t\t? fields.fontSize * 1.2 : fields[key])) {\n\t\t\t\t\tprops[key] = Base.serialize(value, options,\n\t\t\t\t\t\t\tkey !== 'data', dictionary);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tserialize(this._serializeFields);\n\t\tif (!(this instanceof Group))\n\t\t\tserialize(this._style._defaults);\n\t\treturn [ this._class, props ];\n\t},\n\n\t_changed: function(flags) {\n\t\tvar symbol = this._symbol,\n\t\t\tcacheParent = this._parent || symbol,\n\t\t\tproject = this._project;\n\t\tif (flags & 8) {\n\t\t\tthis._bounds = this._position = this._decomposed = undefined;\n\t\t}\n\t\tif (flags & 16) {\n\t\t\tthis._globalMatrix = undefined;\n\t\t}\n\t\tif (cacheParent\n\t\t\t\t&& (flags & 72)) {\n\t\t\tItem._clearBoundsCache(cacheParent);\n\t\t}\n\t\tif (flags & 2) {\n\t\t\tItem._clearBoundsCache(this);\n\t\t}\n\t\tif (project)\n\t\t\tproject._changed(flags, this);\n\t\tif (symbol)\n\t\t\tsymbol._changed(flags);\n\t},\n\n\tgetId: function() {\n\t\treturn this._id;\n\t},\n\n\tgetName: function() {\n\t\treturn this._name;\n\t},\n\n\tsetName: function(name) {\n\n\t\tif (this._name)\n\t\t\tthis._removeNamed();\n\t\tif (name === (+name) + '')\n\t\t\tthrow new Error(\n\t\t\t\t\t'Names consisting only of numbers are not supported.');\n\t\tvar owner = this._getOwner();\n\t\tif (name && owner) {\n\t\t\tvar children = owner._children,\n\t\t\t\tnamedChildren = owner._namedChildren;\n\t\t\t(namedChildren[name] = namedChildren[name] || []).push(this);\n\t\t\tif (!(name in children))\n\t\t\t\tchildren[name] = this;\n\t\t}\n\t\tthis._name = name || undefined;\n\t\tthis._changed(256);\n\t},\n\n\tgetStyle: function() {\n\t\treturn this._style;\n\t},\n\n\tsetStyle: function(style) {\n\t\tthis.getStyle().set(style);\n\t}\n}, Base.each(['locked', 'visible', 'blendMode', 'opacity', 'guide'],\n\tfunction(name) {\n\t\tvar part = Base.capitalize(name),\n\t\t\tkey = '_' + name,\n\t\t\tflags = {\n\t\t\t\tlocked: 256,\n\t\t\t\tvisible: 265\n\t\t\t};\n\t\tthis['get' + part] = function() {\n\t\t\treturn this[key];\n\t\t};\n\t\tthis['set' + part] = function(value) {\n\t\t\tif (value != this[key]) {\n\t\t\t\tthis[key] = value;\n\t\t\t\tthis._changed(flags[name] || 257);\n\t\t\t}\n\t\t};\n\t},\n{}), {\n\tbeans: true,\n\n\tgetSelection: function() {\n\t\treturn this._selection;\n\t},\n\n\tsetSelection: function(selection) {\n\t\tif (selection !== this._selection) {\n\t\t\tthis._selection = selection;\n\t\t\tvar project = this._project;\n\t\t\tif (project) {\n\t\t\t\tproject._updateSelection(this);\n\t\t\t\tthis._changed(257);\n\t\t\t}\n\t\t}\n\t},\n\n\t_changeSelection: function(flag, selected) {\n\t\tvar selection = this._selection;\n\t\tthis.setSelection(selected ? selection | flag : selection & ~flag);\n\t},\n\n\tisSelected: function() {\n\t\tif (this._selectChildren) {\n\t\t\tvar children = this._children;\n\t\t\tfor (var i = 0, l = children.length; i < l; i++)\n\t\t\t\tif (children[i].isSelected())\n\t\t\t\t\treturn true;\n\t\t}\n\t\treturn !!(this._selection & 1);\n\t},\n\n\tsetSelected: function(selected) {\n\t\tif (this._selectChildren) {\n\t\t\tvar children = this._children;\n\t\t\tfor (var i = 0, l = children.length; i < l; i++)\n\t\t\t\tchildren[i].setSelected(selected);\n\t\t}\n\t\tthis._changeSelection(1, selected);\n\t},\n\n\tisFullySelected: function() {\n\t\tvar children = this._children,\n\t\t\tselected = !!(this._selection & 1);\n\t\tif (children && selected) {\n\t\t\tfor (var i = 0, l = children.length; i < l; i++)\n\t\t\t\tif (!children[i].isFullySelected())\n\t\t\t\t\treturn false;\n\t\t\treturn true;\n\t\t}\n\t\treturn selected;\n\t},\n\n\tsetFullySelected: function(selected) {\n\t\tvar children = this._children;\n\t\tif (children) {\n\t\t\tfor (var i = 0, l = children.length; i < l; i++)\n\t\t\t\tchildren[i].setFullySelected(selected);\n\t\t}\n\t\tthis._changeSelection(1, selected);\n\t},\n\n\tisClipMask: function() {\n\t\treturn this._clipMask;\n\t},\n\n\tsetClipMask: function(clipMask) {\n\t\tif (this._clipMask != (clipMask = !!clipMask)) {\n\t\t\tthis._clipMask = clipMask;\n\t\t\tif (clipMask) {\n\t\t\t\tthis.setFillColor(null);\n\t\t\t\tthis.setStrokeColor(null);\n\t\t\t}\n\t\t\tthis._changed(257);\n\t\t\tif (this._parent)\n\t\t\t\tthis._parent._changed(2048);\n\t\t}\n\t},\n\n\tgetData: function() {\n\t\tif (!this._data)\n\t\t\tthis._data = {};\n\t\treturn this._data;\n\t},\n\n\tsetData: function(data) {\n\t\tthis._data = data;\n\t},\n\n\tgetPosition: function(_dontLink) {\n\t\tvar ctor = _dontLink ? Point : LinkedPoint;\n\t\tvar position = this._position ||\n\t\t\t(this._position = this._getPositionFromBounds());\n\t\treturn new ctor(position.x, position.y, this, 'setPosition');\n\t},\n\n\tsetPosition: function() {\n\t\tthis.translate(Point.read(arguments).subtract(this.getPosition(true)));\n\t},\n\n\t_getPositionFromBounds: function(bounds) {\n\t\treturn this._pivot\n\t\t\t\t? this._matrix._transformPoint(this._pivot)\n\t\t\t\t: (bounds || this.getBounds()).getCenter(true);\n\t},\n\n\tgetPivot: function() {\n\t\tvar pivot = this._pivot;\n\t\treturn pivot\n\t\t\t\t? new LinkedPoint(pivot.x, pivot.y, this, 'setPivot')\n\t\t\t\t: null;\n\t},\n\n\tsetPivot: function() {\n\t\tthis._pivot = Point.read(arguments, 0, { clone: true, readNull: true });\n\t\tthis._position = undefined;\n\t}\n}, Base.each({\n\t\tgetStrokeBounds: { stroke: true },\n\t\tgetHandleBounds: { handle: true },\n\t\tgetInternalBounds: { internal: true }\n\t},\n\tfunction(options, key) {\n\t\tthis[key] = function(matrix) {\n\t\t\treturn this.getBounds(matrix, options);\n\t\t};\n\t},\n{\n\tbeans: true,\n\n\tgetBounds: function(matrix, options) {\n\t\tvar hasMatrix = options || matrix instanceof Matrix,\n\t\t\topts = Base.set({}, hasMatrix ? options : matrix,\n\t\t\t\t\tthis._boundsOptions);\n\t\tif (!opts.stroke || this.getStrokeScaling())\n\t\t\topts.cacheItem = this;\n\t\tvar rect = this._getCachedBounds(hasMatrix && matrix, opts).rect;\n\t\treturn !arguments.length\n\t\t\t\t? new LinkedRectangle(rect.x, rect.y, rect.width, rect.height,\n\t\t\t\t\tthis, 'setBounds')\n\t\t\t\t: rect;\n\t},\n\n\tsetBounds: function() {\n\t\tvar rect = Rectangle.read(arguments),\n\t\t\tbounds = this.getBounds(),\n\t\t\t_matrix = this._matrix,\n\t\t\tmatrix = new Matrix(),\n\t\t\tcenter = rect.getCenter();\n\t\tmatrix.translate(center);\n\t\tif (rect.width != bounds.width || rect.height != bounds.height) {\n\t\t\tif (!_matrix.isInvertible()) {\n\t\t\t\t_matrix.set(_matrix._backup\n\t\t\t\t\t\t|| new Matrix().translate(_matrix.getTranslation()));\n\t\t\t\tbounds = this.getBounds();\n\t\t\t}\n\t\t\tmatrix.scale(\n\t\t\t\t\tbounds.width !== 0 ? rect.width / bounds.width : 0,\n\t\t\t\t\tbounds.height !== 0 ? rect.height / bounds.height : 0);\n\t\t}\n\t\tcenter = bounds.getCenter();\n\t\tmatrix.translate(-center.x, -center.y);\n\t\tthis.transform(matrix);\n\t},\n\n\t_getBounds: function(matrix, options) {\n\t\tvar children = this._children;\n\t\tif (!children || !children.length)\n\t\t\treturn new Rectangle();\n\t\tItem._updateBoundsCache(this, options.cacheItem);\n\t\treturn Item._getBounds(children, matrix, options);\n\t},\n\n\t_getBoundsCacheKey: function(options, internal) {\n\t\treturn [\n\t\t\toptions.stroke ? 1 : 0,\n\t\t\toptions.handle ? 1 : 0,\n\t\t\tinternal ? 1 : 0\n\t\t].join('');\n\t},\n\n\t_getCachedBounds: function(matrix, options, noInternal) {\n\t\tmatrix = matrix && matrix._orNullIfIdentity();\n\t\tvar internal = options.internal && !noInternal,\n\t\t\tcacheItem = options.cacheItem,\n\t\t\t_matrix = internal ? null : this._matrix._orNullIfIdentity(),\n\t\t\tcacheKey = cacheItem && (!matrix || matrix.equals(_matrix))\n\t\t\t\t&& this._getBoundsCacheKey(options, internal),\n\t\t\tbounds = this._bounds;\n\t\tItem._updateBoundsCache(this._parent || this._symbol, cacheItem);\n\t\tif (cacheKey && bounds && cacheKey in bounds) {\n\t\t\tvar cached = bounds[cacheKey];\n\t\t\treturn {\n\t\t\t\trect: cached.rect.clone(),\n\t\t\t\tnonscaling: cached.nonscaling\n\t\t\t};\n\t\t}\n\t\tvar res = this._getBounds(matrix || _matrix, options),\n\t\t\trect = res.rect || res,\n\t\t\tstyle = this._style,\n\t\t\tnonscaling = res.nonscaling || style.hasStroke()\n\t\t\t\t&& !style.getStrokeScaling();\n\t\tif (cacheKey) {\n\t\t\tif (!bounds) {\n\t\t\t\tthis._bounds = bounds = {};\n\t\t\t}\n\t\t\tvar cached = bounds[cacheKey] = {\n\t\t\t\trect: rect.clone(),\n\t\t\t\tnonscaling: nonscaling,\n\t\t\t\tinternal: internal\n\t\t\t};\n\t\t}\n\t\treturn {\n\t\t\trect: rect,\n\t\t\tnonscaling: nonscaling\n\t\t};\n\t},\n\n\t_getStrokeMatrix: function(matrix, options) {\n\t\tvar parent = this.getStrokeScaling() ? null\n\t\t\t\t: options && options.internal ? this\n\t\t\t\t\t: this._parent || this._symbol && this._symbol._item,\n\t\t\tmx = parent ? parent.getViewMatrix().invert() : matrix;\n\t\treturn mx && mx._shiftless();\n\t},\n\n\tstatics: {\n\t\t_updateBoundsCache: function(parent, item) {\n\t\t\tif (parent && item) {\n\t\t\t\tvar id = item._id,\n\t\t\t\t\tref = parent._boundsCache = parent._boundsCache || {\n\t\t\t\t\t\tids: {},\n\t\t\t\t\t\tlist: []\n\t\t\t\t\t};\n\t\t\t\tif (!ref.ids[id]) {\n\t\t\t\t\tref.list.push(item);\n\t\t\t\t\tref.ids[id] = item;\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t_clearBoundsCache: function(item) {\n\t\t\tvar cache = item._boundsCache;\n\t\t\tif (cache) {\n\t\t\t\titem._bounds = item._position = item._boundsCache = undefined;\n\t\t\t\tfor (var i = 0, list = cache.list, l = list.length; i < l; i++){\n\t\t\t\t\tvar other = list[i];\n\t\t\t\t\tif (other !== item) {\n\t\t\t\t\t\tother._bounds = other._position = undefined;\n\t\t\t\t\t\tif (other._boundsCache)\n\t\t\t\t\t\t\tItem._clearBoundsCache(other);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t_getBounds: function(items, matrix, options) {\n\t\t\tvar x1 = Infinity,\n\t\t\t\tx2 = -x1,\n\t\t\t\ty1 = x1,\n\t\t\t\ty2 = x2,\n\t\t\t\tnonscaling = false;\n\t\t\toptions = options || {};\n\t\t\tfor (var i = 0, l = items.length; i < l; i++) {\n\t\t\t\tvar item = items[i];\n\t\t\t\tif (item._visible && !item.isEmpty()) {\n\t\t\t\t\tvar bounds = item._getCachedBounds(\n\t\t\t\t\t\tmatrix && matrix.appended(item._matrix), options, true),\n\t\t\t\t\t\trect = bounds.rect;\n\t\t\t\t\tx1 = Math.min(rect.x, x1);\n\t\t\t\t\ty1 = Math.min(rect.y, y1);\n\t\t\t\t\tx2 = Math.max(rect.x + rect.width, x2);\n\t\t\t\t\ty2 = Math.max(rect.y + rect.height, y2);\n\t\t\t\t\tif (bounds.nonscaling)\n\t\t\t\t\t\tnonscaling = true;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn {\n\t\t\t\trect: isFinite(x1)\n\t\t\t\t\t? new Rectangle(x1, y1, x2 - x1, y2 - y1)\n\t\t\t\t\t: new Rectangle(),\n\t\t\t\tnonscaling: nonscaling\n\t\t\t};\n\t\t}\n\t}\n\n}), {\n\tbeans: true,\n\n\t_decompose: function() {\n\t\treturn this._applyMatrix\n\t\t\t? null\n\t\t\t: this._decomposed || (this._decomposed = this._matrix.decompose());\n\t},\n\n\tgetRotation: function() {\n\t\tvar decomposed = this._decompose();\n\t\treturn decomposed ? decomposed.rotation : 0;\n\t},\n\n\tsetRotation: function(rotation) {\n\t\tvar current = this.getRotation();\n\t\tif (current != null && rotation != null) {\n\t\t\tvar decomposed = this._decomposed;\n\t\t\tthis.rotate(rotation - current);\n\t\t\tif (decomposed) {\n\t\t\t\tdecomposed.rotation = rotation;\n\t\t\t\tthis._decomposed = decomposed;\n\t\t\t}\n\t\t}\n\t},\n\n\tgetScaling: function() {\n\t\tvar decomposed = this._decompose(),\n\t\t\ts = decomposed && decomposed.scaling;\n\t\treturn new LinkedPoint(s ? s.x : 1, s ? s.y : 1, this, 'setScaling');\n\t},\n\n\tsetScaling: function() {\n\t\tvar current = this.getScaling(),\n\t\t\tscaling = Point.read(arguments, 0, { clone: true, readNull: true });\n\t\tif (current && scaling && !current.equals(scaling)) {\n\t\t\tvar rotation = this.getRotation(),\n\t\t\t\tdecomposed = this._decomposed,\n\t\t\t\tmatrix = new Matrix(),\n\t\t\t\tcenter = this.getPosition(true);\n\t\t\tmatrix.translate(center);\n\t\t\tif (rotation)\n\t\t\t\tmatrix.rotate(rotation);\n\t\t\tmatrix.scale(scaling.x / current.x, scaling.y / current.y);\n\t\t\tif (rotation)\n\t\t\t\tmatrix.rotate(-rotation);\n\t\t\tmatrix.translate(center.negate());\n\t\t\tthis.transform(matrix);\n\t\t\tif (decomposed) {\n\t\t\t\tdecomposed.scaling = scaling;\n\t\t\t\tthis._decomposed = decomposed;\n\t\t\t}\n\t\t}\n\t},\n\n\tgetMatrix: function() {\n\t\treturn this._matrix;\n\t},\n\n\tsetMatrix: function() {\n\t\tvar matrix = this._matrix;\n\t\tmatrix.initialize.apply(matrix, arguments);\n\t},\n\n\tgetGlobalMatrix: function(_dontClone) {\n\t\tvar matrix = this._globalMatrix;\n\t\tif (matrix) {\n\t\t\tvar parent = this._parent;\n\t\t\tvar parents = [];\n\t\t\twhile (parent) {\n\t\t\t\tif (!parent._globalMatrix) {\n\t\t\t\t\tmatrix = null;\n\t\t\t\t\tfor (var i = 0, l = parents.length; i < l; i++) {\n\t\t\t\t\t\tparents[i]._globalMatrix = null;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tparents.push(parent);\n\t\t\t\tparent = parent._parent;\n\t\t\t}\n\t\t}\n\t\tif (!matrix) {\n\t\t\tmatrix = this._globalMatrix = this._matrix.clone();\n\t\t\tvar parent = this._parent;\n\t\t\tif (parent)\n\t\t\t\tmatrix.prepend(parent.getGlobalMatrix(true));\n\t\t}\n\t\treturn _dontClone ? matrix : matrix.clone();\n\t},\n\n\tgetViewMatrix: function() {\n\t\treturn this.getGlobalMatrix().prepend(this.getView()._matrix);\n\t},\n\n\tgetApplyMatrix: function() {\n\t\treturn this._applyMatrix;\n\t},\n\n\tsetApplyMatrix: function(apply) {\n\t\tif (this._applyMatrix = this._canApplyMatrix && !!apply)\n\t\t\tthis.transform(null, true);\n\t},\n\n\tgetTransformContent: '#getApplyMatrix',\n\tsetTransformContent: '#setApplyMatrix',\n}, {\n\tgetProject: function() {\n\t\treturn this._project;\n\t},\n\n\t_setProject: function(project, installEvents) {\n\t\tif (this._project !== project) {\n\t\t\tif (this._project)\n\t\t\t\tthis._installEvents(false);\n\t\t\tthis._project = project;\n\t\t\tvar children = this._children;\n\t\t\tfor (var i = 0, l = children && children.length; i < l; i++)\n\t\t\t\tchildren[i]._setProject(project);\n\t\t\tinstallEvents = true;\n\t\t}\n\t\tif (installEvents)\n\t\t\tthis._installEvents(true);\n\t},\n\n\tgetView: function() {\n\t\treturn this._project._view;\n\t},\n\n\t_installEvents: function _installEvents(install) {\n\t\t_installEvents.base.call(this, install);\n\t\tvar children = this._children;\n\t\tfor (var i = 0, l = children && children.length; i < l; i++)\n\t\t\tchildren[i]._installEvents(install);\n\t},\n\n\tgetLayer: function() {\n\t\tvar parent = this;\n\t\twhile (parent = parent._parent) {\n\t\t\tif (parent instanceof Layer)\n\t\t\t\treturn parent;\n\t\t}\n\t\treturn null;\n\t},\n\n\tgetParent: function() {\n\t\treturn this._parent;\n\t},\n\n\tsetParent: function(item) {\n\t\treturn item.addChild(this);\n\t},\n\n\t_getOwner: '#getParent',\n\n\tgetChildren: function() {\n\t\treturn this._children;\n\t},\n\n\tsetChildren: function(items) {\n\t\tthis.removeChildren();\n\t\tthis.addChildren(items);\n\t},\n\n\tgetFirstChild: function() {\n\t\treturn this._children && this._children[0] || null;\n\t},\n\n\tgetLastChild: function() {\n\t\treturn this._children && this._children[this._children.length - 1]\n\t\t\t\t|| null;\n\t},\n\n\tgetNextSibling: function() {\n\t\tvar owner = this._getOwner();\n\t\treturn owner && owner._children[this._index + 1] || null;\n\t},\n\n\tgetPreviousSibling: function() {\n\t\tvar owner = this._getOwner();\n\t\treturn owner && owner._children[this._index - 1] || null;\n\t},\n\n\tgetIndex: function() {\n\t\treturn this._index;\n\t},\n\n\tequals: function(item) {\n\t\treturn item === this || item && this._class === item._class\n\t\t\t\t&& this._style.equals(item._style)\n\t\t\t\t&& this._matrix.equals(item._matrix)\n\t\t\t\t&& this._locked === item._locked\n\t\t\t\t&& this._visible === item._visible\n\t\t\t\t&& this._blendMode === item._blendMode\n\t\t\t\t&& this._opacity === item._opacity\n\t\t\t\t&& this._clipMask === item._clipMask\n\t\t\t\t&& this._guide === item._guide\n\t\t\t\t&& this._equals(item)\n\t\t\t\t|| false;\n\t},\n\n\t_equals: function(item) {\n\t\treturn Base.equals(this._children, item._children);\n\t},\n\n\tclone: function(options) {\n\t\tvar copy = new this.constructor(Item.NO_INSERT),\n\t\t\tchildren = this._children,\n\t\t\tinsert = Base.pick(options ? options.insert : undefined,\n\t\t\t\t\toptions === undefined || options === true),\n\t\t\tdeep = Base.pick(options ? options.deep : undefined, true);\n\t\tif (children)\n\t\t\tcopy.copyAttributes(this);\n\t\tif (!children || deep)\n\t\t\tcopy.copyContent(this);\n\t\tif (!children)\n\t\t\tcopy.copyAttributes(this);\n\t\tif (insert)\n\t\t\tcopy.insertAbove(this);\n\t\tvar name = this._name,\n\t\t\tparent = this._parent;\n\t\tif (name && parent) {\n\t\t\tvar children = parent._children,\n\t\t\t\torig = name,\n\t\t\t\ti = 1;\n\t\t\twhile (children[name])\n\t\t\t\tname = orig + ' ' + (i++);\n\t\t\tif (name !== orig)\n\t\t\t\tcopy.setName(name);\n\t\t}\n\t\treturn copy;\n\t},\n\n\tcopyContent: function(source) {\n\t\tvar children = source._children;\n\t\tfor (var i = 0, l = children && children.length; i < l; i++) {\n\t\t\tthis.addChild(children[i].clone(false), true);\n\t\t}\n\t},\n\n\tcopyAttributes: function(source, excludeMatrix) {\n\t\tthis.setStyle(source._style);\n\t\tvar keys = ['_locked', '_visible', '_blendMode', '_opacity',\n\t\t\t\t'_clipMask', '_guide'];\n\t\tfor (var i = 0, l = keys.length; i < l; i++) {\n\t\t\tvar key = keys[i];\n\t\t\tif (source.hasOwnProperty(key))\n\t\t\t\tthis[key] = source[key];\n\t\t}\n\t\tif (!excludeMatrix)\n\t\t\tthis._matrix.set(source._matrix, true);\n\t\tthis.setApplyMatrix(source._applyMatrix);\n\t\tthis.setPivot(source._pivot);\n\t\tthis.setSelection(source._selection);\n\t\tvar data = source._data,\n\t\t\tname = source._name;\n\t\tthis._data = data ? Base.clone(data) : null;\n\t\tif (name)\n\t\t\tthis.setName(name);\n\t},\n\n\trasterize: function(resolution, insert) {\n\t\tvar bounds = this.getStrokeBounds(),\n\t\t\tscale = (resolution || this.getView().getResolution()) / 72,\n\t\t\ttopLeft = bounds.getTopLeft().floor(),\n\t\t\tbottomRight = bounds.getBottomRight().ceil(),\n\t\t\tsize = new Size(bottomRight.subtract(topLeft)),\n\t\t\traster = new Raster(Item.NO_INSERT);\n\t\tif (!size.isZero()) {\n\t\t\tvar canvas = CanvasProvider.getCanvas(size.multiply(scale)),\n\t\t\t\tctx = canvas.getContext('2d'),\n\t\t\t\tmatrix = new Matrix().scale(scale).translate(topLeft.negate());\n\t\t\tctx.save();\n\t\t\tmatrix.applyToContext(ctx);\n\t\t\tthis.draw(ctx, new Base({ matrices: [matrix] }));\n\t\t\tctx.restore();\n\t\t\traster.setCanvas(canvas);\n\t\t}\n\t\traster.transform(new Matrix().translate(topLeft.add(size.divide(2)))\n\t\t\t\t.scale(1 / scale));\n\t\tif (insert === undefined || insert)\n\t\t\traster.insertAbove(this);\n\t\treturn raster;\n\t},\n\n\tcontains: function() {\n\t\treturn !!this._contains(\n\t\t\t\tthis._matrix._inverseTransform(Point.read(arguments)));\n\t},\n\n\t_contains: function(point) {\n\t\tvar children = this._children;\n\t\tif (children) {\n\t\t\tfor (var i = children.length - 1; i >= 0; i--) {\n\t\t\t\tif (children[i].contains(point))\n\t\t\t\t\treturn true;\n\t\t\t}\n\t\t\treturn false;\n\t\t}\n\t\treturn point.isInside(this.getInternalBounds());\n\t},\n\n\tisInside: function() {\n\t\treturn Rectangle.read(arguments).contains(this.getBounds());\n\t},\n\n\t_asPathItem: function() {\n\t\treturn new Path.Rectangle({\n\t\t\trectangle: this.getInternalBounds(),\n\t\t\tmatrix: this._matrix,\n\t\t\tinsert: false,\n\t\t});\n\t},\n\n\tintersects: function(item, _matrix) {\n\t\tif (!(item instanceof Item))\n\t\t\treturn false;\n\t\treturn this._asPathItem().getIntersections(item._asPathItem(), null,\n\t\t\t\t_matrix, true).length > 0;\n\t}\n},\nnew function() {\n\tfunction hitTest() {\n\t\treturn this._hitTest(\n\t\t\t\tPoint.read(arguments),\n\t\t\t\tHitResult.getOptions(arguments));\n\t}\n\n\tfunction hitTestAll() {\n\t\tvar point = Point.read(arguments),\n\t\t\toptions = HitResult.getOptions(arguments),\n\t\t\tall = [];\n\t\tthis._hitTest(point, Base.set({ all: all }, options));\n\t\treturn all;\n\t}\n\n\tfunction hitTestChildren(point, options, viewMatrix, _exclude) {\n\t\tvar children = this._children;\n\t\tif (children) {\n\t\t\tfor (var i = children.length - 1; i >= 0; i--) {\n\t\t\t\tvar child = children[i];\n\t\t\t\tvar res = child !== _exclude && child._hitTest(point, options,\n\t\t\t\t\t\tviewMatrix);\n\t\t\t\tif (res && !options.all)\n\t\t\t\t\treturn res;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tProject.inject({\n\t\thitTest: hitTest,\n\t\thitTestAll: hitTestAll,\n\t\t_hitTest: hitTestChildren\n\t});\n\n\treturn {\n\t\thitTest: hitTest,\n\t\thitTestAll: hitTestAll,\n\t\t_hitTestChildren: hitTestChildren,\n\t};\n}, {\n\n\t_hitTest: function(point, options, parentViewMatrix) {\n\t\tif (this._locked || !this._visible || this._guide && !options.guides\n\t\t\t\t|| this.isEmpty()) {\n\t\t\treturn null;\n\t\t}\n\n\t\tvar matrix = this._matrix,\n\t\t\tviewMatrix = parentViewMatrix\n\t\t\t\t\t? parentViewMatrix.appended(matrix)\n\t\t\t\t\t: this.getGlobalMatrix().prepend(this.getView()._matrix),\n\t\t\ttolerance = Math.max(options.tolerance, 1e-12),\n\t\t\ttolerancePadding = options._tolerancePadding = new Size(\n\t\t\t\t\tPath._getStrokePadding(tolerance,\n\t\t\t\t\t\tmatrix._shiftless().invert()));\n\t\tpoint = matrix._inverseTransform(point);\n\t\tif (!point || !this._children &&\n\t\t\t!this.getBounds({ internal: true, stroke: true, handle: true })\n\t\t\t\t.expand(tolerancePadding.multiply(2))._containsPoint(point)) {\n\t\t\treturn null;\n\t\t}\n\n\t\tvar checkSelf = !(options.guides && !this._guide\n\t\t\t\t|| options.selected && !this.isSelected()\n\t\t\t\t|| options.type && options.type !== Base.hyphenate(this._class)\n\t\t\t\t|| options.class && !(this instanceof options.class)),\n\t\t\tmatch = options.match,\n\t\t\tthat = this,\n\t\t\tbounds,\n\t\t\tres;\n\n\t\tfunction filter(hit) {\n\t\t\tif (hit && match && !match(hit))\n\t\t\t\thit = null;\n\t\t\tif (hit && options.all)\n\t\t\t\toptions.all.push(hit);\n\t\t\treturn hit;\n\t\t}\n\n\t\tfunction checkPoint(type, part) {\n\t\t\tvar pt = part ? bounds['get' + part]() : that.getPosition();\n\t\t\tif (point.subtract(pt).divide(tolerancePadding).length <= 1) {\n\t\t\t\treturn new HitResult(type, that, {\n\t\t\t\t\tname: part ? Base.hyphenate(part) : type,\n\t\t\t\t\tpoint: pt\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tvar checkPosition = options.position,\n\t\t\tcheckCenter = options.center,\n\t\t\tcheckBounds = options.bounds;\n\t\tif (checkSelf && this._parent\n\t\t\t\t&& (checkPosition || checkCenter || checkBounds)) {\n\t\t\tif (checkCenter || checkBounds) {\n\t\t\t\tbounds = this.getInternalBounds();\n\t\t\t}\n\t\t\tres = checkPosition && checkPoint('position') ||\n\t\t\t\t\tcheckCenter && checkPoint('center', 'Center');\n\t\t\tif (!res && checkBounds) {\n\t\t\t\tvar points = [\n\t\t\t\t\t'TopLeft', 'TopRight', 'BottomLeft', 'BottomRight',\n\t\t\t\t\t'LeftCenter', 'TopCenter', 'RightCenter', 'BottomCenter'\n\t\t\t\t];\n\t\t\t\tfor (var i = 0; i < 8 && !res; i++) {\n\t\t\t\t\tres = checkPoint('bounds', points[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tres = filter(res);\n\t\t}\n\n\t\tif (!res) {\n\t\t\tres = this._hitTestChildren(point, options, viewMatrix)\n\t\t\t\t|| checkSelf\n\t\t\t\t\t&& filter(this._hitTestSelf(point, options, viewMatrix,\n\t\t\t\t\t\tthis.getStrokeScaling() ? null\n\t\t\t\t\t\t\t: viewMatrix._shiftless().invert()))\n\t\t\t\t|| null;\n\t\t}\n\t\tif (res && res.point) {\n\t\t\tres.point = matrix.transform(res.point);\n\t\t}\n\t\treturn res;\n\t},\n\n\t_hitTestSelf: function(point, options) {\n\t\tif (options.fill && this.hasFill() && this._contains(point))\n\t\t\treturn new HitResult('fill', this);\n\t},\n\n\tmatches: function(name, compare) {\n\t\tfunction matchObject(obj1, obj2) {\n\t\t\tfor (var i in obj1) {\n\t\t\t\tif (obj1.hasOwnProperty(i)) {\n\t\t\t\t\tvar val1 = obj1[i],\n\t\t\t\t\t\tval2 = obj2[i];\n\t\t\t\t\tif (Base.isPlainObject(val1) && Base.isPlainObject(val2)) {\n\t\t\t\t\t\tif (!matchObject(val1, val2))\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t} else if (!Base.equals(val1, val2)) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\t\tvar type = typeof name;\n\t\tif (type === 'object') {\n\t\t\tfor (var key in name) {\n\t\t\t\tif (name.hasOwnProperty(key) && !this.matches(key, name[key]))\n\t\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t} else if (type === 'function') {\n\t\t\treturn name(this);\n\t\t} else if (name === 'match') {\n\t\t\treturn compare(this);\n\t\t} else {\n\t\t\tvar value = /^(empty|editable)$/.test(name)\n\t\t\t\t\t? this['is' + Base.capitalize(name)]()\n\t\t\t\t\t: name === 'type'\n\t\t\t\t\t\t? Base.hyphenate(this._class)\n\t\t\t\t\t\t: this[name];\n\t\t\tif (name === 'class') {\n\t\t\t\tif (typeof compare === 'function')\n\t\t\t\t\treturn this instanceof compare;\n\t\t\t\tvalue = this._class;\n\t\t\t}\n\t\t\tif (typeof compare === 'function') {\n\t\t\t\treturn !!compare(value);\n\t\t\t} else if (compare) {\n\t\t\t\tif (compare.test) {\n\t\t\t\t\treturn compare.test(value);\n\t\t\t\t} else if (Base.isPlainObject(compare)) {\n\t\t\t\t\treturn matchObject(compare, value);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn Base.equals(value, compare);\n\t\t}\n\t},\n\n\tgetItems: function(options) {\n\t\treturn Item._getItems(this, options, this._matrix);\n\t},\n\n\tgetItem: function(options) {\n\t\treturn Item._getItems(this, options, this._matrix, null, true)[0]\n\t\t\t\t|| null;\n\t},\n\n\tstatics: {\n\t\t_getItems: function _getItems(item, options, matrix, param, firstOnly) {\n\t\t\tif (!param) {\n\t\t\t\tvar obj = typeof options === 'object' && options,\n\t\t\t\t\toverlapping = obj && obj.overlapping,\n\t\t\t\t\tinside = obj && obj.inside,\n\t\t\t\t\tbounds = overlapping || inside,\n\t\t\t\t\trect = bounds && Rectangle.read([bounds]);\n\t\t\t\tparam = {\n\t\t\t\t\titems: [],\n\t\t\t\t\trecursive: obj && obj.recursive !== false,\n\t\t\t\t\tinside: !!inside,\n\t\t\t\t\toverlapping: !!overlapping,\n\t\t\t\t\trect: rect,\n\t\t\t\t\tpath: overlapping && new Path.Rectangle({\n\t\t\t\t\t\trectangle: rect,\n\t\t\t\t\t\tinsert: false\n\t\t\t\t\t})\n\t\t\t\t};\n\t\t\t\tif (obj) {\n\t\t\t\t\toptions = Base.filter({}, options, {\n\t\t\t\t\t\trecursive: true, inside: true, overlapping: true\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t\tvar children = item._children,\n\t\t\t\titems = param.items,\n\t\t\t\trect = param.rect;\n\t\t\tmatrix = rect && (matrix || new Matrix());\n\t\t\tfor (var i = 0, l = children && children.length; i < l; i++) {\n\t\t\t\tvar child = children[i],\n\t\t\t\t\tchildMatrix = matrix && matrix.appended(child._matrix),\n\t\t\t\t\tadd = true;\n\t\t\t\tif (rect) {\n\t\t\t\t\tvar bounds = child.getBounds(childMatrix);\n\t\t\t\t\tif (!rect.intersects(bounds))\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\tif (!(rect.contains(bounds)\n\t\t\t\t\t\t\t|| param.overlapping && (bounds.contains(rect)\n\t\t\t\t\t\t\t\t|| param.path.intersects(child, childMatrix))))\n\t\t\t\t\t\tadd = false;\n\t\t\t\t}\n\t\t\t\tif (add && child.matches(options)) {\n\t\t\t\t\titems.push(child);\n\t\t\t\t\tif (firstOnly)\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tif (param.recursive !== false) {\n\t\t\t\t\t_getItems(child, options, childMatrix, param, firstOnly);\n\t\t\t\t}\n\t\t\t\tif (firstOnly && items.length > 0)\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\treturn items;\n\t\t}\n\t}\n}, {\n\n\timportJSON: function(json) {\n\t\tvar res = Base.importJSON(json, this);\n\t\treturn res !== this ? this.addChild(res) : res;\n\t},\n\n\taddChild: function(item) {\n\t\treturn this.insertChild(undefined, item);\n\t},\n\n\tinsertChild: function(index, item) {\n\t\tvar res = item ? this.insertChildren(index, [item]) : null;\n\t\treturn res && res[0];\n\t},\n\n\taddChildren: function(items) {\n\t\treturn this.insertChildren(this._children.length, items);\n\t},\n\n\tinsertChildren: function(index, items) {\n\t\tvar children = this._children;\n\t\tif (children && items && items.length > 0) {\n\t\t\titems = Base.slice(items);\n\t\t\tvar inserted = {};\n\t\t\tfor (var i = items.length - 1; i >= 0; i--) {\n\t\t\t\tvar item = items[i],\n\t\t\t\t\tid = item && item._id;\n\t\t\t\tif (!item || inserted[id]) {\n\t\t\t\t\titems.splice(i, 1);\n\t\t\t\t} else {\n\t\t\t\t\titem._remove(false, true);\n\t\t\t\t\tinserted[id] = true;\n\t\t\t\t}\n\t\t\t}\n\t\t\tBase.splice(children, items, index, 0);\n\t\t\tvar project = this._project,\n\t\t\t\tnotifySelf = project._changes;\n\t\t\tfor (var i = 0, l = items.length; i < l; i++) {\n\t\t\t\tvar item = items[i],\n\t\t\t\t\tname = item._name;\n\t\t\t\titem._parent = this;\n\t\t\t\titem._setProject(project, true);\n\t\t\t\tif (name)\n\t\t\t\t\titem.setName(name);\n\t\t\t\tif (notifySelf)\n\t\t\t\t\titem._changed(5);\n\t\t\t}\n\t\t\tthis._changed(11);\n\t\t} else {\n\t\t\titems = null;\n\t\t}\n\t\treturn items;\n\t},\n\n\t_insertItem: '#insertChild',\n\n\t_insertAt: function(item, offset) {\n\t\tvar owner = item && item._getOwner(),\n\t\t\tres = item !== this && owner ? this : null;\n\t\tif (res) {\n\t\t\tres._remove(false, true);\n\t\t\towner._insertItem(item._index + offset, res);\n\t\t}\n\t\treturn res;\n\t},\n\n\tinsertAbove: function(item) {\n\t\treturn this._insertAt(item, 1);\n\t},\n\n\tinsertBelow: function(item) {\n\t\treturn this._insertAt(item, 0);\n\t},\n\n\tsendToBack: function() {\n\t\tvar owner = this._getOwner();\n\t\treturn owner ? owner._insertItem(0, this) : null;\n\t},\n\n\tbringToFront: function() {\n\t\tvar owner = this._getOwner();\n\t\treturn owner ? owner._insertItem(undefined, this) : null;\n\t},\n\n\tappendTop: '#addChild',\n\n\tappendBottom: function(item) {\n\t\treturn this.insertChild(0, item);\n\t},\n\n\tmoveAbove: '#insertAbove',\n\n\tmoveBelow: '#insertBelow',\n\n\taddTo: function(owner) {\n\t\treturn owner._insertItem(undefined, this);\n\t},\n\n\tcopyTo: function(owner) {\n\t\treturn this.clone(false).addTo(owner);\n\t},\n\n\treduce: function(options) {\n\t\tvar children = this._children;\n\t\tif (children && children.length === 1) {\n\t\t\tvar child = children[0].reduce(options);\n\t\t\tif (this._parent) {\n\t\t\t\tchild.insertAbove(this);\n\t\t\t\tthis.remove();\n\t\t\t} else {\n\t\t\t\tchild.remove();\n\t\t\t}\n\t\t\treturn child;\n\t\t}\n\t\treturn this;\n\t},\n\n\t_removeNamed: function() {\n\t\tvar owner = this._getOwner();\n\t\tif (owner) {\n\t\t\tvar children = owner._children,\n\t\t\t\tnamedChildren = owner._namedChildren,\n\t\t\t\tname = this._name,\n\t\t\t\tnamedArray = namedChildren[name],\n\t\t\t\tindex = namedArray ? namedArray.indexOf(this) : -1;\n\t\t\tif (index !== -1) {\n\t\t\t\tif (children[name] == this)\n\t\t\t\t\tdelete children[name];\n\t\t\t\tnamedArray.splice(index, 1);\n\t\t\t\tif (namedArray.length) {\n\t\t\t\t\tchildren[name] = namedArray[0];\n\t\t\t\t} else {\n\t\t\t\t\tdelete namedChildren[name];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\n\t_remove: function(notifySelf, notifyParent) {\n\t\tvar owner = this._getOwner(),\n\t\t\tproject = this._project,\n\t\t\tindex = this._index;\n\t\tif (this._style)\n\t\t\tthis._style._dispose();\n\t\tif (owner) {\n\t\t\tif (this._name)\n\t\t\t\tthis._removeNamed();\n\t\t\tif (index != null) {\n\t\t\t\tif (project._activeLayer === this)\n\t\t\t\t\tproject._activeLayer = this.getNextSibling()\n\t\t\t\t\t\t\t|| this.getPreviousSibling();\n\t\t\t\tBase.splice(owner._children, null, index, 1);\n\t\t\t}\n\t\t\tthis._installEvents(false);\n\t\t\tif (notifySelf && project._changes)\n\t\t\t\tthis._changed(5);\n\t\t\tif (notifyParent)\n\t\t\t\towner._changed(11, this);\n\t\t\tthis._parent = null;\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t},\n\n\tremove: function() {\n\t\treturn this._remove(true, true);\n\t},\n\n\treplaceWith: function(item) {\n\t\tvar ok = item && item.insertBelow(this);\n\t\tif (ok)\n\t\t\tthis.remove();\n\t\treturn ok;\n\t},\n\n\tremoveChildren: function(start, end) {\n\t\tif (!this._children)\n\t\t\treturn null;\n\t\tstart = start || 0;\n\t\tend = Base.pick(end, this._children.length);\n\t\tvar removed = Base.splice(this._children, null, start, end - start);\n\t\tfor (var i = removed.length - 1; i >= 0; i--) {\n\t\t\tremoved[i]._remove(true, false);\n\t\t}\n\t\tif (removed.length > 0)\n\t\t\tthis._changed(11);\n\t\treturn removed;\n\t},\n\n\tclear: '#removeChildren',\n\n\treverseChildren: function() {\n\t\tif (this._children) {\n\t\t\tthis._children.reverse();\n\t\t\tfor (var i = 0, l = this._children.length; i < l; i++)\n\t\t\t\tthis._children[i]._index = i;\n\t\t\tthis._changed(11);\n\t\t}\n\t},\n\n\tisEmpty: function() {\n\t\tvar children = this._children;\n\t\treturn !children || !children.length;\n\t},\n\n\tisEditable: function() {\n\t\tvar item = this;\n\t\twhile (item) {\n\t\t\tif (!item._visible || item._locked)\n\t\t\t\treturn false;\n\t\t\titem = item._parent;\n\t\t}\n\t\treturn true;\n\t},\n\n\thasFill: function() {\n\t\treturn this.getStyle().hasFill();\n\t},\n\n\thasStroke: function() {\n\t\treturn this.getStyle().hasStroke();\n\t},\n\n\thasShadow: function() {\n\t\treturn this.getStyle().hasShadow();\n\t},\n\n\t_getOrder: function(item) {\n\t\tfunction getList(item) {\n\t\t\tvar list = [];\n\t\t\tdo {\n\t\t\t\tlist.unshift(item);\n\t\t\t} while (item = item._parent);\n\t\t\treturn list;\n\t\t}\n\t\tvar list1 = getList(this),\n\t\t\tlist2 = getList(item);\n\t\tfor (var i = 0, l = Math.min(list1.length, list2.length); i < l; i++) {\n\t\t\tif (list1[i] != list2[i]) {\n\t\t\t\treturn list1[i]._index < list2[i]._index ? 1 : -1;\n\t\t\t}\n\t\t}\n\t\treturn 0;\n\t},\n\n\thasChildren: function() {\n\t\treturn this._children && this._children.length > 0;\n\t},\n\n\tisInserted: function() {\n\t\treturn this._parent ? this._parent.isInserted() : false;\n\t},\n\n\tisAbove: function(item) {\n\t\treturn this._getOrder(item) === -1;\n\t},\n\n\tisBelow: function(item) {\n\t\treturn this._getOrder(item) === 1;\n\t},\n\n\tisParent: function(item) {\n\t\treturn this._parent === item;\n\t},\n\n\tisChild: function(item) {\n\t\treturn item && item._parent === this;\n\t},\n\n\tisDescendant: function(item) {\n\t\tvar parent = this;\n\t\twhile (parent = parent._parent) {\n\t\t\tif (parent === item)\n\t\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t},\n\n\tisAncestor: function(item) {\n\t\treturn item ? item.isDescendant(this) : false;\n\t},\n\n\tisSibling: function(item) {\n\t\treturn this._parent === item._parent;\n\t},\n\n\tisGroupedWith: function(item) {\n\t\tvar parent = this._parent;\n\t\twhile (parent) {\n\t\t\tif (parent._parent\n\t\t\t\t&& /^(Group|Layer|CompoundPath)$/.test(parent._class)\n\t\t\t\t&& item.isDescendant(parent))\n\t\t\t\t\treturn true;\n\t\t\tparent = parent._parent;\n\t\t}\n\t\treturn false;\n\t},\n\n}, Base.each(['rotate', 'scale', 'shear', 'skew'], function(key) {\n\tvar rotate = key === 'rotate';\n\tthis[key] = function() {\n\t\tvar value = (rotate ? Base : Point).read(arguments),\n\t\t\tcenter = Point.read(arguments, 0, { readNull: true });\n\t\treturn this.transform(new Matrix()[key](value,\n\t\t\t\tcenter || this.getPosition(true)));\n\t};\n}, {\n\ttranslate: function() {\n\t\tvar mx = new Matrix();\n\t\treturn this.transform(mx.translate.apply(mx, arguments));\n\t},\n\n\ttransform: function(matrix, _applyMatrix, _applyRecursively,\n\t\t\t_setApplyMatrix) {\n\t\tvar _matrix = this._matrix,\n\t\t\ttransformMatrix = matrix && !matrix.isIdentity(),\n\t\t\tapplyMatrix = (_applyMatrix || this._applyMatrix)\n\t\t\t\t\t&& ((!_matrix.isIdentity() || transformMatrix)\n\t\t\t\t\t\t|| _applyMatrix && _applyRecursively && this._children);\n\t\tif (!transformMatrix && !applyMatrix)\n\t\t\treturn this;\n\t\tif (transformMatrix) {\n\t\t\tif (!matrix.isInvertible() && _matrix.isInvertible())\n\t\t\t\t_matrix._backup = _matrix.getValues();\n\t\t\t_matrix.prepend(matrix, true);\n\t\t\tvar style = this._style,\n\t\t\t\tfillColor = style.getFillColor(true),\n\t\t\t\tstrokeColor = style.getStrokeColor(true);\n\t\t\tif (fillColor)\n\t\t\t\tfillColor.transform(matrix);\n\t\t\tif (strokeColor)\n\t\t\t\tstrokeColor.transform(matrix);\n\t\t}\n\t\tif (applyMatrix && (applyMatrix = this._transformContent(_matrix,\n\t\t\t\t_applyRecursively, _setApplyMatrix))) {\n\t\t\tvar pivot = this._pivot;\n\t\t\tif (pivot)\n\t\t\t\t_matrix._transformPoint(pivot, pivot, true);\n\t\t\t_matrix.reset(true);\n\t\t\tif (_setApplyMatrix && this._canApplyMatrix)\n\t\t\t\tthis._applyMatrix = true;\n\t\t}\n\t\tvar bounds = this._bounds,\n\t\t\tposition = this._position;\n\t\tif (transformMatrix || applyMatrix) {\n\t\t\tthis._changed(25);\n\t\t}\n\t\tvar decomp = transformMatrix && bounds && matrix.decompose();\n\t\tif (decomp && decomp.skewing.isZero() && decomp.rotation % 90 === 0) {\n\t\t\tfor (var key in bounds) {\n\t\t\t\tvar cache = bounds[key];\n\t\t\t\tif (cache.nonscaling) {\n\t\t\t\t\tdelete bounds[key];\n\t\t\t\t} else if (applyMatrix || !cache.internal) {\n\t\t\t\t\tvar rect = cache.rect;\n\t\t\t\t\tmatrix._transformBounds(rect, rect);\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis._bounds = bounds;\n\t\t\tvar cached = bounds[this._getBoundsCacheKey(\n\t\t\t\tthis._boundsOptions || {})];\n\t\t\tif (cached) {\n\t\t\t\tthis._position = this._getPositionFromBounds(cached.rect);\n\t\t\t}\n\t\t} else if (transformMatrix && position && this._pivot) {\n\t\t\tthis._position = matrix._transformPoint(position, position);\n\t\t}\n\t\treturn this;\n\t},\n\n\t_transformContent: function(matrix, applyRecursively, setApplyMatrix) {\n\t\tvar children = this._children;\n\t\tif (children) {\n\t\t\tfor (var i = 0, l = children.length; i < l; i++)\n\t\t\t\tchildren[i].transform(matrix, true, applyRecursively,\n\t\t\t\t\t\tsetApplyMatrix);\n\t\t\treturn true;\n\t\t}\n\t},\n\n\tglobalToLocal: function() {\n\t\treturn this.getGlobalMatrix(true)._inverseTransform(\n\t\t\t\tPoint.read(arguments));\n\t},\n\n\tlocalToGlobal: function() {\n\t\treturn this.getGlobalMatrix(true)._transformPoint(\n\t\t\t\tPoint.read(arguments));\n\t},\n\n\tparentToLocal: function() {\n\t\treturn this._matrix._inverseTransform(Point.read(arguments));\n\t},\n\n\tlocalToParent: function() {\n\t\treturn this._matrix._transformPoint(Point.read(arguments));\n\t},\n\n\tfitBounds: function(rectangle, fill) {\n\t\trectangle = Rectangle.read(arguments);\n\t\tvar bounds = this.getBounds(),\n\t\t\titemRatio = bounds.height / bounds.width,\n\t\t\trectRatio = rectangle.height / rectangle.width,\n\t\t\tscale = (fill ? itemRatio > rectRatio : itemRatio < rectRatio)\n\t\t\t\t\t? rectangle.width / bounds.width\n\t\t\t\t\t: rectangle.height / bounds.height,\n\t\t\tnewBounds = new Rectangle(new Point(),\n\t\t\t\t\tnew Size(bounds.width * scale, bounds.height * scale));\n\t\tnewBounds.setCenter(rectangle.getCenter());\n\t\tthis.setBounds(newBounds);\n\t}\n}), {\n\n\t_setStyles: function(ctx, param, viewMatrix) {\n\t\tvar style = this._style,\n\t\t\tmatrix = this._matrix;\n\t\tif (style.hasFill()) {\n\t\t\tctx.fillStyle = style.getFillColor().toCanvasStyle(ctx, matrix);\n\t\t}\n\t\tif (style.hasStroke()) {\n\t\t\tctx.strokeStyle = style.getStrokeColor().toCanvasStyle(ctx, matrix);\n\t\t\tctx.lineWidth = style.getStrokeWidth();\n\t\t\tvar strokeJoin = style.getStrokeJoin(),\n\t\t\t\tstrokeCap = style.getStrokeCap(),\n\t\t\t\tmiterLimit = style.getMiterLimit();\n\t\t\tif (strokeJoin)\n\t\t\t\tctx.lineJoin = strokeJoin;\n\t\t\tif (strokeCap)\n\t\t\t\tctx.lineCap = strokeCap;\n\t\t\tif (miterLimit)\n\t\t\t\tctx.miterLimit = miterLimit;\n\t\t\tif (paper.support.nativeDash) {\n\t\t\t\tvar dashArray = style.getDashArray(),\n\t\t\t\t\tdashOffset = style.getDashOffset();\n\t\t\t\tif (dashArray && dashArray.length) {\n\t\t\t\t\tif ('setLineDash' in ctx) {\n\t\t\t\t\t\tctx.setLineDash(dashArray);\n\t\t\t\t\t\tctx.lineDashOffset = dashOffset;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tctx.mozDash = dashArray;\n\t\t\t\t\t\tctx.mozDashOffset = dashOffset;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (style.hasShadow()) {\n\t\t\tvar pixelRatio = param.pixelRatio || 1,\n\t\t\t\tmx = viewMatrix._shiftless().prepend(\n\t\t\t\t\tnew Matrix().scale(pixelRatio, pixelRatio)),\n\t\t\t\tblur = mx.transform(new Point(style.getShadowBlur(), 0)),\n\t\t\t\toffset = mx.transform(this.getShadowOffset());\n\t\t\tctx.shadowColor = style.getShadowColor().toCanvasStyle(ctx);\n\t\t\tctx.shadowBlur = blur.getLength();\n\t\t\tctx.shadowOffsetX = offset.x;\n\t\t\tctx.shadowOffsetY = offset.y;\n\t\t}\n\t},\n\n\tdraw: function(ctx, param, parentStrokeMatrix) {\n\t\tvar updateVersion = this._updateVersion = this._project._updateVersion;\n\t\tif (!this._visible || this._opacity === 0)\n\t\t\treturn;\n\t\tvar matrices = param.matrices,\n\t\t\tviewMatrix = param.viewMatrix,\n\t\t\tmatrix = this._matrix,\n\t\t\tglobalMatrix = matrices[matrices.length - 1].appended(matrix);\n\t\tif (!globalMatrix.isInvertible())\n\t\t\treturn;\n\n\t\tviewMatrix = viewMatrix ? viewMatrix.appended(globalMatrix)\n\t\t\t\t: globalMatrix;\n\n\t\tmatrices.push(globalMatrix);\n\t\tif (param.updateMatrix) {\n\t\t\tthis._globalMatrix = globalMatrix;\n\t\t}\n\n\t\tvar blendMode = this._blendMode,\n\t\t\topacity = this._opacity,\n\t\t\tnormalBlend = blendMode === 'normal',\n\t\t\tnativeBlend = BlendMode.nativeModes[blendMode],\n\t\t\tdirect = normalBlend && opacity === 1\n\t\t\t\t\t|| param.dontStart\n\t\t\t\t\t|| param.clip\n\t\t\t\t\t|| (nativeBlend || normalBlend && opacity < 1)\n\t\t\t\t\t\t&& this._canComposite(),\n\t\t\tpixelRatio = param.pixelRatio || 1,\n\t\t\tmainCtx, itemOffset, prevOffset;\n\t\tif (!direct) {\n\t\t\tvar bounds = this.getStrokeBounds(viewMatrix);\n\t\t\tif (!bounds.width || !bounds.height) {\n\t\t\t\tmatrices.pop();\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tprevOffset = param.offset;\n\t\t\titemOffset = param.offset = bounds.getTopLeft().floor();\n\t\t\tmainCtx = ctx;\n\t\t\tctx = CanvasProvider.getContext(bounds.getSize().ceil().add(1)\n\t\t\t\t\t.multiply(pixelRatio));\n\t\t\tif (pixelRatio !== 1)\n\t\t\t\tctx.scale(pixelRatio, pixelRatio);\n\t\t}\n\t\tctx.save();\n\t\tvar strokeMatrix = parentStrokeMatrix\n\t\t\t\t? parentStrokeMatrix.appended(matrix)\n\t\t\t\t: this._canScaleStroke && !this.getStrokeScaling(true)\n\t\t\t\t\t&& viewMatrix,\n\t\t\tclip = !direct && param.clipItem,\n\t\t\ttransform = !strokeMatrix || clip;\n\t\tif (direct) {\n\t\t\tctx.globalAlpha = opacity;\n\t\t\tif (nativeBlend)\n\t\t\t\tctx.globalCompositeOperation = blendMode;\n\t\t} else if (transform) {\n\t\t\tctx.translate(-itemOffset.x, -itemOffset.y);\n\t\t}\n\t\tif (transform) {\n\t\t\t(direct ? matrix : viewMatrix).applyToContext(ctx);\n\t\t}\n\t\tif (clip) {\n\t\t\tparam.clipItem.draw(ctx, param.extend({ clip: true }));\n\t\t}\n\t\tif (strokeMatrix) {\n\t\t\tctx.setTransform(pixelRatio, 0, 0, pixelRatio, 0, 0);\n\t\t\tvar offset = param.offset;\n\t\t\tif (offset)\n\t\t\t\tctx.translate(-offset.x, -offset.y);\n\t\t}\n\t\tthis._draw(ctx, param, viewMatrix, strokeMatrix);\n\t\tctx.restore();\n\t\tmatrices.pop();\n\t\tif (param.clip && !param.dontFinish)\n\t\t\tctx.clip();\n\t\tif (!direct) {\n\t\t\tBlendMode.process(blendMode, ctx, mainCtx, opacity,\n\t\t\t\t\titemOffset.subtract(prevOffset).multiply(pixelRatio));\n\t\t\tCanvasProvider.release(ctx);\n\t\t\tparam.offset = prevOffset;\n\t\t}\n\t},\n\n\t_isUpdated: function(updateVersion) {\n\t\tvar parent = this._parent;\n\t\tif (parent instanceof CompoundPath)\n\t\t\treturn parent._isUpdated(updateVersion);\n\t\tvar updated = this._updateVersion === updateVersion;\n\t\tif (!updated && parent && parent._visible\n\t\t\t\t&& parent._isUpdated(updateVersion)) {\n\t\t\tthis._updateVersion = updateVersion;\n\t\t\tupdated = true;\n\t\t}\n\t\treturn updated;\n\t},\n\n\t_drawSelection: function(ctx, matrix, size, selectionItems, updateVersion) {\n\t\tvar selection = this._selection,\n\t\t\titemSelected = selection & 1,\n\t\t\tboundsSelected = selection & 2\n\t\t\t\t\t|| itemSelected && this._selectBounds,\n\t\t\tpositionSelected = selection & 4;\n\t\tif (!this._drawSelected)\n\t\t\titemSelected = false;\n\t\tif ((itemSelected || boundsSelected || positionSelected)\n\t\t\t\t&& this._isUpdated(updateVersion)) {\n\t\t\tvar layer,\n\t\t\t\tcolor = this.getSelectedColor(true) || (layer = this.getLayer())\n\t\t\t\t\t&& layer.getSelectedColor(true),\n\t\t\t\tmx = matrix.appended(this.getGlobalMatrix(true)),\n\t\t\t\thalf = size / 2;\n\t\t\tctx.strokeStyle = ctx.fillStyle = color\n\t\t\t\t\t? color.toCanvasStyle(ctx) : '#009dec';\n\t\t\tif (itemSelected)\n\t\t\t\tthis._drawSelected(ctx, mx, selectionItems);\n\t\t\tif (positionSelected) {\n\t\t\t\tvar pos = this.getPosition(true),\n\t\t\t\t\tparent = this._parent,\n\t\t\t\t\tpoint = parent ? parent.localToGlobal(pos) : pos,\n\t\t\t\t\tx = point.x,\n\t\t\t\t\ty = point.y;\n\t\t\t\tctx.beginPath();\n\t\t\t\tctx.arc(x, y, half, 0, Math.PI * 2, true);\n\t\t\t\tctx.stroke();\n\t\t\t\tvar deltas = [[0, -1], [1, 0], [0, 1], [-1, 0]],\n\t\t\t\t\tstart = half,\n\t\t\t\t\tend = size + 1;\n\t\t\t\tfor (var i = 0; i < 4; i++) {\n\t\t\t\t\tvar delta = deltas[i],\n\t\t\t\t\t\tdx = delta[0],\n\t\t\t\t\t\tdy = delta[1];\n\t\t\t\t\tctx.moveTo(x + dx * start, y + dy * start);\n\t\t\t\t\tctx.lineTo(x + dx * end, y + dy * end);\n\t\t\t\t\tctx.stroke();\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (boundsSelected) {\n\t\t\t\tvar coords = mx._transformCorners(this.getInternalBounds());\n\t\t\t\tctx.beginPath();\n\t\t\t\tfor (var i = 0; i < 8; i++) {\n\t\t\t\t\tctx[!i ? 'moveTo' : 'lineTo'](coords[i], coords[++i]);\n\t\t\t\t}\n\t\t\t\tctx.closePath();\n\t\t\t\tctx.stroke();\n\t\t\t\tfor (var i = 0; i < 8; i++) {\n\t\t\t\t\tctx.fillRect(coords[i] - half, coords[++i] - half,\n\t\t\t\t\t\t\tsize, size);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\n\t_canComposite: function() {\n\t\treturn false;\n\t}\n}, Base.each(['down', 'drag', 'up', 'move'], function(key) {\n\tthis['removeOn' + Base.capitalize(key)] = function() {\n\t\tvar hash = {};\n\t\thash[key] = true;\n\t\treturn this.removeOn(hash);\n\t};\n}, {\n\n\tremoveOn: function(obj) {\n\t\tfor (var name in obj) {\n\t\t\tif (obj[name]) {\n\t\t\t\tvar key = 'mouse' + name,\n\t\t\t\t\tproject = this._project,\n\t\t\t\t\tsets = project._removeSets = project._removeSets || {};\n\t\t\t\tsets[key] = sets[key] || {};\n\t\t\t\tsets[key][this._id] = this;\n\t\t\t}\n\t\t}\n\t\treturn this;\n\t}\n}), {\n\ttween: function(from, to, options) {\n\t\tif (!options) {\n\t\t\toptions = to;\n\t\t\tto = from;\n\t\t\tfrom = null;\n\t\t\tif (!options) {\n\t\t\t\toptions = to;\n\t\t\t\tto = null;\n\t\t\t}\n\t\t}\n\t\tvar easing = options && options.easing,\n\t\t\tstart = options && options.start,\n\t\t\tduration = options != null && (\n\t\t\t\ttypeof options === 'number' ? options : options.duration\n\t\t\t),\n\t\t\ttween = new Tween(this, from, to, duration, easing, start);\n\t\tfunction onFrame(event) {\n\t\t\ttween._handleFrame(event.time * 1000);\n\t\t\tif (!tween.running) {\n\t\t\t\tthis.off('frame', onFrame);\n\t\t\t}\n\t\t}\n\t\tif (duration) {\n\t\t\tthis.on('frame', onFrame);\n\t\t}\n\t\treturn tween;\n\t},\n\n\ttweenTo: function(to, options) {\n\t\treturn this.tween(null, to, options);\n\t},\n\n\ttweenFrom: function(from, options) {\n\t\treturn this.tween(from, null, options);\n\t}\n});\n\nvar Group = Item.extend({\n\t_class: 'Group',\n\t_selectBounds: false,\n\t_selectChildren: true,\n\t_serializeFields: {\n\t\tchildren: []\n\t},\n\n\tinitialize: function Group(arg) {\n\t\tthis._children = [];\n\t\tthis._namedChildren = {};\n\t\tif (!this._initialize(arg))\n\t\t\tthis.addChildren(Array.isArray(arg) ? arg : arguments);\n\t},\n\n\t_changed: function _changed(flags) {\n\t\t_changed.base.call(this, flags);\n\t\tif (flags & 2050) {\n\t\t\tthis._clipItem = undefined;\n\t\t}\n\t},\n\n\t_getClipItem: function() {\n\t\tvar clipItem = this._clipItem;\n\t\tif (clipItem === undefined) {\n\t\t\tclipItem = null;\n\t\t\tvar children = this._children;\n\t\t\tfor (var i = 0, l = children.length; i < l; i++) {\n\t\t\t\tif (children[i]._clipMask) {\n\t\t\t\t\tclipItem = children[i];\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis._clipItem = clipItem;\n\t\t}\n\t\treturn clipItem;\n\t},\n\n\tisClipped: function() {\n\t\treturn !!this._getClipItem();\n\t},\n\n\tsetClipped: function(clipped) {\n\t\tvar child = this.getFirstChild();\n\t\tif (child)\n\t\t\tchild.setClipMask(clipped);\n\t},\n\n\t_getBounds: function _getBounds(matrix, options) {\n\t\tvar clipItem = this._getClipItem();\n\t\treturn clipItem\n\t\t\t? clipItem._getCachedBounds(\n\t\t\t\tmatrix && matrix.appended(clipItem._matrix),\n\t\t\t\tBase.set({}, options, { stroke: false }))\n\t\t\t: _getBounds.base.call(this, matrix, options);\n\t},\n\n\t_hitTestChildren: function _hitTestChildren(point, options, viewMatrix) {\n\t\tvar clipItem = this._getClipItem();\n\t\treturn (!clipItem || clipItem.contains(point))\n\t\t\t\t&& _hitTestChildren.base.call(this, point, options, viewMatrix,\n\t\t\t\t\tclipItem);\n\t},\n\n\t_draw: function(ctx, param) {\n\t\tvar clip = param.clip,\n\t\t\tclipItem = !clip && this._getClipItem();\n\t\tparam = param.extend({ clipItem: clipItem, clip: false });\n\t\tif (clip) {\n\t\t\tctx.beginPath();\n\t\t\tparam.dontStart = param.dontFinish = true;\n\t\t} else if (clipItem) {\n\t\t\tclipItem.draw(ctx, param.extend({ clip: true }));\n\t\t}\n\t\tvar children = this._children;\n\t\tfor (var i = 0, l = children.length; i < l; i++) {\n\t\t\tvar item = children[i];\n\t\t\tif (item !== clipItem)\n\t\t\t\titem.draw(ctx, param);\n\t\t}\n\t}\n});\n\nvar Layer = Group.extend({\n\t_class: 'Layer',\n\n\tinitialize: function Layer() {\n\t\tGroup.apply(this, arguments);\n\t},\n\n\t_getOwner: function() {\n\t\treturn this._parent || this._index != null && this._project;\n\t},\n\n\tisInserted: function isInserted() {\n\t\treturn this._parent ? isInserted.base.call(this) : this._index != null;\n\t},\n\n\tactivate: function() {\n\t\tthis._project._activeLayer = this;\n\t},\n\n\t_hitTestSelf: function() {\n\t}\n});\n\nvar Shape = Item.extend({\n\t_class: 'Shape',\n\t_applyMatrix: false,\n\t_canApplyMatrix: false,\n\t_canScaleStroke: true,\n\t_serializeFields: {\n\t\ttype: null,\n\t\tsize: null,\n\t\tradius: null\n\t},\n\n\tinitialize: function Shape(props, point) {\n\t\tthis._initialize(props, point);\n\t},\n\n\t_equals: function(item) {\n\t\treturn this._type === item._type\n\t\t\t&& this._size.equals(item._size)\n\t\t\t&& Base.equals(this._radius, item._radius);\n\t},\n\n\tcopyContent: function(source) {\n\t\tthis.setType(source._type);\n\t\tthis.setSize(source._size);\n\t\tthis.setRadius(source._radius);\n\t},\n\n\tgetType: function() {\n\t\treturn this._type;\n\t},\n\n\tsetType: function(type) {\n\t\tthis._type = type;\n\t},\n\n\tgetShape: '#getType',\n\tsetShape: '#setType',\n\n\tgetSize: function() {\n\t\tvar size = this._size;\n\t\treturn new LinkedSize(size.width, size.height, this, 'setSize');\n\t},\n\n\tsetSize: function() {\n\t\tvar size = Size.read(arguments);\n\t\tif (!this._size) {\n\t\t\tthis._size = size.clone();\n\t\t} else if (!this._size.equals(size)) {\n\t\t\tvar type = this._type,\n\t\t\t\twidth = size.width,\n\t\t\t\theight = size.height;\n\t\t\tif (type === 'rectangle') {\n\t\t\t\tthis._radius.set(Size.min(this._radius, size.divide(2)));\n\t\t\t} else if (type === 'circle') {\n\t\t\t\twidth = height = (width + height) / 2;\n\t\t\t\tthis._radius = width / 2;\n\t\t\t} else if (type === 'ellipse') {\n\t\t\t\tthis._radius._set(width / 2, height / 2);\n\t\t\t}\n\t\t\tthis._size._set(width, height);\n\t\t\tthis._changed(9);\n\t\t}\n\t},\n\n\tgetRadius: function() {\n\t\tvar rad = this._radius;\n\t\treturn this._type === 'circle'\n\t\t\t\t? rad\n\t\t\t\t: new LinkedSize(rad.width, rad.height, this, 'setRadius');\n\t},\n\n\tsetRadius: function(radius) {\n\t\tvar type = this._type;\n\t\tif (type === 'circle') {\n\t\t\tif (radius === this._radius)\n\t\t\t\treturn;\n\t\t\tvar size = radius * 2;\n\t\t\tthis._radius = radius;\n\t\t\tthis._size._set(size, size);\n\t\t} else {\n\t\t\tradius = Size.read(arguments);\n\t\t\tif (!this._radius) {\n\t\t\t\tthis._radius = radius.clone();\n\t\t\t} else {\n\t\t\t\tif (this._radius.equals(radius))\n\t\t\t\t\treturn;\n\t\t\t\tthis._radius.set(radius);\n\t\t\t\tif (type === 'rectangle') {\n\t\t\t\t\tvar size = Size.max(this._size, radius.multiply(2));\n\t\t\t\t\tthis._size.set(size);\n\t\t\t\t} else if (type === 'ellipse') {\n\t\t\t\t\tthis._size._set(radius.width * 2, radius.height * 2);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tthis._changed(9);\n\t},\n\n\tisEmpty: function() {\n\t\treturn false;\n\t},\n\n\ttoPath: function(insert) {\n\t\tvar path = new Path[Base.capitalize(this._type)]({\n\t\t\tcenter: new Point(),\n\t\t\tsize: this._size,\n\t\t\tradius: this._radius,\n\t\t\tinsert: false\n\t\t});\n\t\tpath.copyAttributes(this);\n\t\tif (paper.settings.applyMatrix)\n\t\t\tpath.setApplyMatrix(true);\n\t\tif (insert === undefined || insert)\n\t\t\tpath.insertAbove(this);\n\t\treturn path;\n\t},\n\n\ttoShape: '#clone',\n\n\t_asPathItem: function() {\n\t\treturn this.toPath(false);\n\t},\n\n\t_draw: function(ctx, param, viewMatrix, strokeMatrix) {\n\t\tvar style = this._style,\n\t\t\thasFill = style.hasFill(),\n\t\t\thasStroke = style.hasStroke(),\n\t\t\tdontPaint = param.dontFinish || param.clip,\n\t\t\tuntransformed = !strokeMatrix;\n\t\tif (hasFill || hasStroke || dontPaint) {\n\t\t\tvar type = this._type,\n\t\t\t\tradius = this._radius,\n\t\t\t\tisCircle = type === 'circle';\n\t\t\tif (!param.dontStart)\n\t\t\t\tctx.beginPath();\n\t\t\tif (untransformed && isCircle) {\n\t\t\t\tctx.arc(0, 0, radius, 0, Math.PI * 2, true);\n\t\t\t} else {\n\t\t\t\tvar rx = isCircle ? radius : radius.width,\n\t\t\t\t\try = isCircle ? radius : radius.height,\n\t\t\t\t\tsize = this._size,\n\t\t\t\t\twidth = size.width,\n\t\t\t\t\theight = size.height;\n\t\t\t\tif (untransformed && type === 'rectangle' && rx === 0 && ry === 0) {\n\t\t\t\t\tctx.rect(-width / 2, -height / 2, width, height);\n\t\t\t\t} else {\n\t\t\t\t\tvar x = width / 2,\n\t\t\t\t\t\ty = height / 2,\n\t\t\t\t\t\tkappa = 1 - 0.5522847498307936,\n\t\t\t\t\t\tcx = rx * kappa,\n\t\t\t\t\t\tcy = ry * kappa,\n\t\t\t\t\t\tc = [\n\t\t\t\t\t\t\t-x, -y + ry,\n\t\t\t\t\t\t\t-x, -y + cy,\n\t\t\t\t\t\t\t-x + cx, -y,\n\t\t\t\t\t\t\t-x + rx, -y,\n\t\t\t\t\t\t\tx - rx, -y,\n\t\t\t\t\t\t\tx - cx, -y,\n\t\t\t\t\t\t\tx, -y + cy,\n\t\t\t\t\t\t\tx, -y + ry,\n\t\t\t\t\t\t\tx, y - ry,\n\t\t\t\t\t\t\tx, y - cy,\n\t\t\t\t\t\t\tx - cx, y,\n\t\t\t\t\t\t\tx - rx, y,\n\t\t\t\t\t\t\t-x + rx, y,\n\t\t\t\t\t\t\t-x + cx, y,\n\t\t\t\t\t\t\t-x, y - cy,\n\t\t\t\t\t\t\t-x, y - ry\n\t\t\t\t\t\t];\n\t\t\t\t\tif (strokeMatrix)\n\t\t\t\t\t\tstrokeMatrix.transform(c, c, 32);\n\t\t\t\t\tctx.moveTo(c[0], c[1]);\n\t\t\t\t\tctx.bezierCurveTo(c[2], c[3], c[4], c[5], c[6], c[7]);\n\t\t\t\t\tif (x !== rx)\n\t\t\t\t\t\tctx.lineTo(c[8], c[9]);\n\t\t\t\t\tctx.bezierCurveTo(c[10], c[11], c[12], c[13], c[14], c[15]);\n\t\t\t\t\tif (y !== ry)\n\t\t\t\t\t\tctx.lineTo(c[16], c[17]);\n\t\t\t\t\tctx.bezierCurveTo(c[18], c[19], c[20], c[21], c[22], c[23]);\n\t\t\t\t\tif (x !== rx)\n\t\t\t\t\t\tctx.lineTo(c[24], c[25]);\n\t\t\t\t\tctx.bezierCurveTo(c[26], c[27], c[28], c[29], c[30], c[31]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tctx.closePath();\n\t\t}\n\t\tif (!dontPaint && (hasFill || hasStroke)) {\n\t\t\tthis._setStyles(ctx, param, viewMatrix);\n\t\t\tif (hasFill) {\n\t\t\t\tctx.fill(style.getFillRule());\n\t\t\t\tctx.shadowColor = 'rgba(0,0,0,0)';\n\t\t\t}\n\t\t\tif (hasStroke)\n\t\t\t\tctx.stroke();\n\t\t}\n\t},\n\n\t_canComposite: function() {\n\t\treturn !(this.hasFill() && this.hasStroke());\n\t},\n\n\t_getBounds: function(matrix, options) {\n\t\tvar rect = new Rectangle(this._size).setCenter(0, 0),\n\t\t\tstyle = this._style,\n\t\t\tstrokeWidth = options.stroke && style.hasStroke()\n\t\t\t\t\t&& style.getStrokeWidth();\n\t\tif (matrix)\n\t\t\trect = matrix._transformBounds(rect);\n\t\treturn strokeWidth\n\t\t\t\t? rect.expand(Path._getStrokePadding(strokeWidth,\n\t\t\t\t\tthis._getStrokeMatrix(matrix, options)))\n\t\t\t\t: rect;\n\t}\n},\nnew function() {\n\tfunction getCornerCenter(that, point, expand) {\n\t\tvar radius = that._radius;\n\t\tif (!radius.isZero()) {\n\t\t\tvar halfSize = that._size.divide(2);\n\t\t\tfor (var q = 1; q <= 4; q++) {\n\t\t\t\tvar dir = new Point(q > 1 && q < 4 ? -1 : 1, q > 2 ? -1 : 1),\n\t\t\t\t\tcorner = dir.multiply(halfSize),\n\t\t\t\t\tcenter = corner.subtract(dir.multiply(radius)),\n\t\t\t\t\trect = new Rectangle(\n\t\t\t\t\t\t\texpand ? corner.add(dir.multiply(expand)) : corner,\n\t\t\t\t\t\t\tcenter);\n\t\t\t\tif (rect.contains(point))\n\t\t\t\t\treturn { point: center, quadrant: q };\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction isOnEllipseStroke(point, radius, padding, quadrant) {\n\t\tvar vector = point.divide(radius);\n\t\treturn (!quadrant || vector.isInQuadrant(quadrant)) &&\n\t\t\t\tvector.subtract(vector.normalize()).multiply(radius)\n\t\t\t\t\t.divide(padding).length <= 1;\n\t}\n\n\treturn {\n\t\t_contains: function _contains(point) {\n\t\t\tif (this._type === 'rectangle') {\n\t\t\t\tvar center = getCornerCenter(this, point);\n\t\t\t\treturn center\n\t\t\t\t\t\t? point.subtract(center.point).divide(this._radius)\n\t\t\t\t\t\t\t.getLength() <= 1\n\t\t\t\t\t\t: _contains.base.call(this, point);\n\t\t\t} else {\n\t\t\t\treturn point.divide(this.size).getLength() <= 0.5;\n\t\t\t}\n\t\t},\n\n\t\t_hitTestSelf: function _hitTestSelf(point, options, viewMatrix,\n\t\t\t\tstrokeMatrix) {\n\t\t\tvar hit = false,\n\t\t\t\tstyle = this._style,\n\t\t\t\thitStroke = options.stroke && style.hasStroke(),\n\t\t\t\thitFill = options.fill && style.hasFill();\n\t\t\tif (hitStroke || hitFill) {\n\t\t\t\tvar type = this._type,\n\t\t\t\t\tradius = this._radius,\n\t\t\t\t\tstrokeRadius = hitStroke ? style.getStrokeWidth() / 2 : 0,\n\t\t\t\t\tstrokePadding = options._tolerancePadding.add(\n\t\t\t\t\t\tPath._getStrokePadding(strokeRadius,\n\t\t\t\t\t\t\t!style.getStrokeScaling() && strokeMatrix));\n\t\t\t\tif (type === 'rectangle') {\n\t\t\t\t\tvar padding = strokePadding.multiply(2),\n\t\t\t\t\t\tcenter = getCornerCenter(this, point, padding);\n\t\t\t\t\tif (center) {\n\t\t\t\t\t\thit = isOnEllipseStroke(point.subtract(center.point),\n\t\t\t\t\t\t\t\tradius, strokePadding, center.quadrant);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar rect = new Rectangle(this._size).setCenter(0, 0),\n\t\t\t\t\t\t\touter = rect.expand(padding),\n\t\t\t\t\t\t\tinner = rect.expand(padding.negate());\n\t\t\t\t\t\thit = outer._containsPoint(point)\n\t\t\t\t\t\t\t\t&& !inner._containsPoint(point);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\thit = isOnEllipseStroke(point, radius, strokePadding);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn hit ? new HitResult(hitStroke ? 'stroke' : 'fill', this)\n\t\t\t\t\t: _hitTestSelf.base.apply(this, arguments);\n\t\t}\n\t};\n}, {\n\nstatics: new function() {\n\tfunction createShape(type, point, size, radius, args) {\n\t\tvar item = new Shape(Base.getNamed(args), point);\n\t\titem._type = type;\n\t\titem._size = size;\n\t\titem._radius = radius;\n\t\treturn item;\n\t}\n\n\treturn {\n\t\tCircle: function() {\n\t\t\tvar center = Point.readNamed(arguments, 'center'),\n\t\t\t\tradius = Base.readNamed(arguments, 'radius');\n\t\t\treturn createShape('circle', center, new Size(radius * 2), radius,\n\t\t\t\t\targuments);\n\t\t},\n\n\t\tRectangle: function() {\n\t\t\tvar rect = Rectangle.readNamed(arguments, 'rectangle'),\n\t\t\t\tradius = Size.min(Size.readNamed(arguments, 'radius'),\n\t\t\t\t\t\trect.getSize(true).divide(2));\n\t\t\treturn createShape('rectangle', rect.getCenter(true),\n\t\t\t\t\trect.getSize(true), radius, arguments);\n\t\t},\n\n\t\tEllipse: function() {\n\t\t\tvar ellipse = Shape._readEllipse(arguments),\n\t\t\t\tradius = ellipse.radius;\n\t\t\treturn createShape('ellipse', ellipse.center, radius.multiply(2),\n\t\t\t\t\tradius, arguments);\n\t\t},\n\n\t\t_readEllipse: function(args) {\n\t\t\tvar center,\n\t\t\t\tradius;\n\t\t\tif (Base.hasNamed(args, 'radius')) {\n\t\t\t\tcenter = Point.readNamed(args, 'center');\n\t\t\t\tradius = Size.readNamed(args, 'radius');\n\t\t\t} else {\n\t\t\t\tvar rect = Rectangle.readNamed(args, 'rectangle');\n\t\t\t\tcenter = rect.getCenter(true);\n\t\t\t\tradius = rect.getSize(true).divide(2);\n\t\t\t}\n\t\t\treturn { center: center, radius: radius };\n\t\t}\n\t};\n}});\n\nvar Raster = Item.extend({\n\t_class: 'Raster',\n\t_applyMatrix: false,\n\t_canApplyMatrix: false,\n\t_boundsOptions: { stroke: false, handle: false },\n\t_serializeFields: {\n\t\tcrossOrigin: null,\n\t\tsource: null\n\t},\n\t_prioritize: ['crossOrigin'],\n\t_smoothing: true,\n\n\tinitialize: function Raster(object, position) {\n\t\tif (!this._initialize(object,\n\t\t\t\tposition !== undefined && Point.read(arguments, 1))) {\n\t\t\tvar image = typeof object === 'string'\n\t\t\t\t\t? document.getElementById(object) : object;\n\t\t\tif (image) {\n\t\t\t\tthis.setImage(image);\n\t\t\t} else {\n\t\t\t\tthis.setSource(object);\n\t\t\t}\n\t\t}\n\t\tif (!this._size) {\n\t\t\tthis._size = new Size();\n\t\t\tthis._loaded = false;\n\t\t}\n\t},\n\n\t_equals: function(item) {\n\t\treturn this.getSource() === item.getSource();\n\t},\n\n\tcopyContent: function(source) {\n\t\tvar image = source._image,\n\t\t\tcanvas = source._canvas;\n\t\tif (image) {\n\t\t\tthis._setImage(image);\n\t\t} else if (canvas) {\n\t\t\tvar copyCanvas = CanvasProvider.getCanvas(source._size);\n\t\t\tcopyCanvas.getContext('2d').drawImage(canvas, 0, 0);\n\t\t\tthis._setImage(copyCanvas);\n\t\t}\n\t\tthis._crossOrigin = source._crossOrigin;\n\t},\n\n\tgetSize: function() {\n\t\tvar size = this._size;\n\t\treturn new LinkedSize(size ? size.width : 0, size ? size.height : 0,\n\t\t\t\tthis, 'setSize');\n\t},\n\n\tsetSize: function() {\n\t\tvar size = Size.read(arguments);\n\t\tif (!size.equals(this._size)) {\n\t\t\tif (size.width > 0 && size.height > 0) {\n\t\t\t\tvar element = this.getElement();\n\t\t\t\tthis._setImage(CanvasProvider.getCanvas(size));\n\t\t\t\tif (element)\n\t\t\t\t\tthis.getContext(true).drawImage(element, 0, 0,\n\t\t\t\t\t\t\tsize.width, size.height);\n\t\t\t} else {\n\t\t\t\tif (this._canvas)\n\t\t\t\t\tCanvasProvider.release(this._canvas);\n\t\t\t\tthis._size = size.clone();\n\t\t\t}\n\t\t}\n\t},\n\n\tgetWidth: function() {\n\t\treturn this._size ? this._size.width : 0;\n\t},\n\n\tsetWidth: function(width) {\n\t\tthis.setSize(width, this.getHeight());\n\t},\n\n\tgetHeight: function() {\n\t\treturn this._size ? this._size.height : 0;\n\t},\n\n\tsetHeight: function(height) {\n\t\tthis.setSize(this.getWidth(), height);\n\t},\n\n\tgetLoaded: function() {\n\t\treturn this._loaded;\n\t},\n\n\tisEmpty: function() {\n\t\tvar size = this._size;\n\t\treturn !size || size.width === 0 && size.height === 0;\n\t},\n\n\tgetResolution: function() {\n\t\tvar matrix = this._matrix,\n\t\t\torig = new Point(0, 0).transform(matrix),\n\t\t\tu = new Point(1, 0).transform(matrix).subtract(orig),\n\t\t\tv = new Point(0, 1).transform(matrix).subtract(orig);\n\t\treturn new Size(\n\t\t\t72 / u.getLength(),\n\t\t\t72 / v.getLength()\n\t\t);\n\t},\n\n\tgetPpi: '#getResolution',\n\n\tgetImage: function() {\n\t\treturn this._image;\n\t},\n\n\tsetImage: function(image) {\n\t\tvar that = this;\n\n\t\tfunction emit(event) {\n\t\t\tvar view = that.getView(),\n\t\t\t\ttype = event && event.type || 'load';\n\t\t\tif (view && that.responds(type)) {\n\t\t\t\tpaper = view._scope;\n\t\t\t\tthat.emit(type, new Event(event));\n\t\t\t}\n\t\t}\n\n\t\tthis._setImage(image);\n\t\tif (this._loaded) {\n\t\t\tsetTimeout(emit, 0);\n\t\t} else if (image) {\n\t\t\tDomEvent.add(image, {\n\t\t\t\tload: function(event) {\n\t\t\t\t\tthat._setImage(image);\n\t\t\t\t\temit(event);\n\t\t\t\t},\n\t\t\t\terror: emit\n\t\t\t});\n\t\t}\n\t},\n\n\t_setImage: function(image) {\n\t\tif (this._canvas)\n\t\t\tCanvasProvider.release(this._canvas);\n\t\tif (image && image.getContext) {\n\t\t\tthis._image = null;\n\t\t\tthis._canvas = image;\n\t\t\tthis._loaded = true;\n\t\t} else {\n\t\t\tthis._image = image;\n\t\t\tthis._canvas = null;\n\t\t\tthis._loaded = !!(image && image.src && image.complete);\n\t\t}\n\t\tthis._size = new Size(\n\t\t\t\timage ? image.naturalWidth || image.width : 0,\n\t\t\t\timage ? image.naturalHeight || image.height : 0);\n\t\tthis._context = null;\n\t\tthis._changed(1033);\n\t},\n\n\tgetCanvas: function() {\n\t\tif (!this._canvas) {\n\t\t\tvar ctx = CanvasProvider.getContext(this._size);\n\t\t\ttry {\n\t\t\t\tif (this._image)\n\t\t\t\t\tctx.drawImage(this._image, 0, 0);\n\t\t\t\tthis._canvas = ctx.canvas;\n\t\t\t} catch (e) {\n\t\t\t\tCanvasProvider.release(ctx);\n\t\t\t}\n\t\t}\n\t\treturn this._canvas;\n\t},\n\n\tsetCanvas: '#setImage',\n\n\tgetContext: function(modify) {\n\t\tif (!this._context)\n\t\t\tthis._context = this.getCanvas().getContext('2d');\n\t\tif (modify) {\n\t\t\tthis._image = null;\n\t\t\tthis._changed(1025);\n\t\t}\n\t\treturn this._context;\n\t},\n\n\tsetContext: function(context) {\n\t\tthis._context = context;\n\t},\n\n\tgetSource: function() {\n\t\tvar image = this._image;\n\t\treturn image && image.src || this.toDataURL();\n\t},\n\n\tsetSource: function(src) {\n\t\tvar image = new self.Image(),\n\t\t\tcrossOrigin = this._crossOrigin;\n\t\tif (crossOrigin)\n\t\t\timage.crossOrigin = crossOrigin;\n\t\timage.src = src;\n\t\tthis.setImage(image);\n\t},\n\n\tgetCrossOrigin: function() {\n\t\tvar image = this._image;\n\t\treturn image && image.crossOrigin || this._crossOrigin || '';\n\t},\n\n\tsetCrossOrigin: function(crossOrigin) {\n\t\tthis._crossOrigin = crossOrigin;\n\t\tvar image = this._image;\n\t\tif (image)\n\t\t\timage.crossOrigin = crossOrigin;\n\t},\n\n\tgetSmoothing: function() {\n\t\treturn this._smoothing;\n\t},\n\n\tsetSmoothing: function(smoothing) {\n\t\tthis._smoothing = smoothing;\n\t\tthis._changed(257);\n\t},\n\n\tgetElement: function() {\n\t\treturn this._canvas || this._loaded && this._image;\n\t}\n}, {\n\tbeans: false,\n\n\tgetSubCanvas: function() {\n\t\tvar rect = Rectangle.read(arguments),\n\t\t\tctx = CanvasProvider.getContext(rect.getSize());\n\t\tctx.drawImage(this.getCanvas(), rect.x, rect.y,\n\t\t\t\trect.width, rect.height, 0, 0, rect.width, rect.height);\n\t\treturn ctx.canvas;\n\t},\n\n\tgetSubRaster: function() {\n\t\tvar rect = Rectangle.read(arguments),\n\t\t\traster = new Raster(Item.NO_INSERT);\n\t\traster._setImage(this.getSubCanvas(rect));\n\t\traster.translate(rect.getCenter().subtract(this.getSize().divide(2)));\n\t\traster._matrix.prepend(this._matrix);\n\t\traster.insertAbove(this);\n\t\treturn raster;\n\t},\n\n\ttoDataURL: function() {\n\t\tvar image = this._image,\n\t\t\tsrc = image && image.src;\n\t\tif (/^data:/.test(src))\n\t\t\treturn src;\n\t\tvar canvas = this.getCanvas();\n\t\treturn canvas ? canvas.toDataURL.apply(canvas, arguments) : null;\n\t},\n\n\tdrawImage: function(image ) {\n\t\tvar point = Point.read(arguments, 1);\n\t\tthis.getContext(true).drawImage(image, point.x, point.y);\n\t},\n\n\tgetAverageColor: function(object) {\n\t\tvar bounds, path;\n\t\tif (!object) {\n\t\t\tbounds = this.getBounds();\n\t\t} else if (object instanceof PathItem) {\n\t\t\tpath = object;\n\t\t\tbounds = object.getBounds();\n\t\t} else if (typeof object === 'object') {\n\t\t\tif ('width' in object) {\n\t\t\t\tbounds = new Rectangle(object);\n\t\t\t} else if ('x' in object) {\n\t\t\t\tbounds = new Rectangle(object.x - 0.5, object.y - 0.5, 1, 1);\n\t\t\t}\n\t\t}\n\t\tif (!bounds)\n\t\t\treturn null;\n\t\tvar sampleSize = 32,\n\t\t\twidth = Math.min(bounds.width, sampleSize),\n\t\t\theight = Math.min(bounds.height, sampleSize);\n\t\tvar ctx = Raster._sampleContext;\n\t\tif (!ctx) {\n\t\t\tctx = Raster._sampleContext = CanvasProvider.getContext(\n\t\t\t\t\tnew Size(sampleSize));\n\t\t} else {\n\t\t\tctx.clearRect(0, 0, sampleSize + 1, sampleSize + 1);\n\t\t}\n\t\tctx.save();\n\t\tvar matrix = new Matrix()\n\t\t\t\t.scale(width / bounds.width, height / bounds.height)\n\t\t\t\t.translate(-bounds.x, -bounds.y);\n\t\tmatrix.applyToContext(ctx);\n\t\tif (path)\n\t\t\tpath.draw(ctx, new Base({ clip: true, matrices: [matrix] }));\n\t\tthis._matrix.applyToContext(ctx);\n\t\tvar element = this.getElement(),\n\t\t\tsize = this._size;\n\t\tif (element)\n\t\t\tctx.drawImage(element, -size.width / 2, -size.height / 2);\n\t\tctx.restore();\n\t\tvar pixels = ctx.getImageData(0.5, 0.5, Math.ceil(width),\n\t\t\t\tMath.ceil(height)).data,\n\t\t\tchannels = [0, 0, 0],\n\t\t\ttotal = 0;\n\t\tfor (var i = 0, l = pixels.length; i < l; i += 4) {\n\t\t\tvar alpha = pixels[i + 3];\n\t\t\ttotal += alpha;\n\t\t\talpha /= 255;\n\t\t\tchannels[0] += pixels[i] * alpha;\n\t\t\tchannels[1] += pixels[i + 1] * alpha;\n\t\t\tchannels[2] += pixels[i + 2] * alpha;\n\t\t}\n\t\tfor (var i = 0; i < 3; i++)\n\t\t\tchannels[i] /= total;\n\t\treturn total ? Color.read(channels) : null;\n\t},\n\n\tgetPixel: function() {\n\t\tvar point = Point.read(arguments);\n\t\tvar data = this.getContext().getImageData(point.x, point.y, 1, 1).data;\n\t\treturn new Color('rgb', [data[0] / 255, data[1] / 255, data[2] / 255],\n\t\t\t\tdata[3] / 255);\n\t},\n\n\tsetPixel: function() {\n\t\tvar point = Point.read(arguments),\n\t\t\tcolor = Color.read(arguments),\n\t\t\tcomponents = color._convert('rgb'),\n\t\t\talpha = color._alpha,\n\t\t\tctx = this.getContext(true),\n\t\t\timageData = ctx.createImageData(1, 1),\n\t\t\tdata = imageData.data;\n\t\tdata[0] = components[0] * 255;\n\t\tdata[1] = components[1] * 255;\n\t\tdata[2] = components[2] * 255;\n\t\tdata[3] = alpha != null ? alpha * 255 : 255;\n\t\tctx.putImageData(imageData, point.x, point.y);\n\t},\n\n\tcreateImageData: function() {\n\t\tvar size = Size.read(arguments);\n\t\treturn this.getContext().createImageData(size.width, size.height);\n\t},\n\n\tgetImageData: function() {\n\t\tvar rect = Rectangle.read(arguments);\n\t\tif (rect.isEmpty())\n\t\t\trect = new Rectangle(this._size);\n\t\treturn this.getContext().getImageData(rect.x, rect.y,\n\t\t\t\trect.width, rect.height);\n\t},\n\n\tsetImageData: function(data ) {\n\t\tvar point = Point.read(arguments, 1);\n\t\tthis.getContext(true).putImageData(data, point.x, point.y);\n\t},\n\n\t_getBounds: function(matrix, options) {\n\t\tvar rect = new Rectangle(this._size).setCenter(0, 0);\n\t\treturn matrix ? matrix._transformBounds(rect) : rect;\n\t},\n\n\t_hitTestSelf: function(point) {\n\t\tif (this._contains(point)) {\n\t\t\tvar that = this;\n\t\t\treturn new HitResult('pixel', that, {\n\t\t\t\toffset: point.add(that._size.divide(2)).round(),\n\t\t\t\tcolor: {\n\t\t\t\t\tget: function() {\n\t\t\t\t\t\treturn that.getPixel(this.offset);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t},\n\n\t_draw: function(ctx, param, viewMatrix) {\n\t\tvar element = this.getElement();\n\t\tif (element && element.width > 0 && element.height > 0) {\n\t\t\tctx.globalAlpha = this._opacity;\n\n\t\t\tthis._setStyles(ctx, param, viewMatrix);\n\n\t\t\tDomElement.setPrefixed(\n\t\t\t\tctx, 'imageSmoothingEnabled', this._smoothing\n\t\t\t);\n\n\t\t\tctx.drawImage(element,\n\t\t\t\t\t-this._size.width / 2, -this._size.height / 2);\n\t\t}\n\t},\n\n\t_canComposite: function() {\n\t\treturn true;\n\t}\n});\n\nvar SymbolItem = Item.extend({\n\t_class: 'SymbolItem',\n\t_applyMatrix: false,\n\t_canApplyMatrix: false,\n\t_boundsOptions: { stroke: true },\n\t_serializeFields: {\n\t\tsymbol: null\n\t},\n\n\tinitialize: function SymbolItem(arg0, arg1) {\n\t\tif (!this._initialize(arg0,\n\t\t\t\targ1 !== undefined && Point.read(arguments, 1)))\n\t\t\tthis.setDefinition(arg0 instanceof SymbolDefinition ?\n\t\t\t\t\targ0 : new SymbolDefinition(arg0));\n\t},\n\n\t_equals: function(item) {\n\t\treturn this._definition === item._definition;\n\t},\n\n\tcopyContent: function(source) {\n\t\tthis.setDefinition(source._definition);\n\t},\n\n\tgetDefinition: function() {\n\t\treturn this._definition;\n\t},\n\n\tsetDefinition: function(definition) {\n\t\tthis._definition = definition;\n\t\tthis._changed(9);\n\t},\n\n\tgetSymbol: '#getDefinition',\n\tsetSymbol: '#setDefinition',\n\n\tisEmpty: function() {\n\t\treturn this._definition._item.isEmpty();\n\t},\n\n\t_getBounds: function(matrix, options) {\n\t\tvar item = this._definition._item;\n\t\treturn item._getCachedBounds(item._matrix.prepended(matrix), options);\n\t},\n\n\t_hitTestSelf: function(point, options, viewMatrix) {\n\t\tvar res = this._definition._item._hitTest(point, options, viewMatrix);\n\t\tif (res)\n\t\t\tres.item = this;\n\t\treturn res;\n\t},\n\n\t_draw: function(ctx, param) {\n\t\tthis._definition._item.draw(ctx, param);\n\t}\n\n});\n\nvar SymbolDefinition = Base.extend({\n\t_class: 'SymbolDefinition',\n\n\tinitialize: function SymbolDefinition(item, dontCenter) {\n\t\tthis._id = UID.get();\n\t\tthis.project = paper.project;\n\t\tif (item)\n\t\t\tthis.setItem(item, dontCenter);\n\t},\n\n\t_serialize: function(options, dictionary) {\n\t\treturn dictionary.add(this, function() {\n\t\t\treturn Base.serialize([this._class, this._item],\n\t\t\t\t\toptions, false, dictionary);\n\t\t});\n\t},\n\n\t_changed: function(flags) {\n\t\tif (flags & 8)\n\t\t\tItem._clearBoundsCache(this);\n\t\tif (flags & 1)\n\t\t\tthis.project._changed(flags);\n\t},\n\n\tgetItem: function() {\n\t\treturn this._item;\n\t},\n\n\tsetItem: function(item, _dontCenter) {\n\t\tif (item._symbol)\n\t\t\titem = item.clone();\n\t\tif (this._item)\n\t\t\tthis._item._symbol = null;\n\t\tthis._item = item;\n\t\titem.remove();\n\t\titem.setSelected(false);\n\t\tif (!_dontCenter)\n\t\t\titem.setPosition(new Point());\n\t\titem._symbol = this;\n\t\tthis._changed(9);\n\t},\n\n\tgetDefinition: '#getItem',\n\tsetDefinition: '#setItem',\n\n\tplace: function(position) {\n\t\treturn new SymbolItem(this, position);\n\t},\n\n\tclone: function() {\n\t\treturn new SymbolDefinition(this._item.clone(false));\n\t},\n\n\tequals: function(symbol) {\n\t\treturn symbol === this\n\t\t\t\t|| symbol && this._item.equals(symbol._item)\n\t\t\t\t|| false;\n\t}\n});\n\nvar HitResult = Base.extend({\n\t_class: 'HitResult',\n\n\tinitialize: function HitResult(type, item, values) {\n\t\tthis.type = type;\n\t\tthis.item = item;\n\t\tif (values)\n\t\t\tthis.inject(values);\n\t},\n\n\tstatics: {\n\t\tgetOptions: function(args) {\n\t\t\tvar options = args && Base.read(args);\n\t\t\treturn Base.set({\n\t\t\t\ttype: null,\n\t\t\t\ttolerance: paper.settings.hitTolerance,\n\t\t\t\tfill: !options,\n\t\t\t\tstroke: !options,\n\t\t\t\tsegments: !options,\n\t\t\t\thandles: false,\n\t\t\t\tends: false,\n\t\t\t\tposition: false,\n\t\t\t\tcenter: false,\n\t\t\t\tbounds: false,\n\t\t\t\tguides: false,\n\t\t\t\tselected: false\n\t\t\t}, options);\n\t\t}\n\t}\n});\n\nvar Segment = Base.extend({\n\t_class: 'Segment',\n\tbeans: true,\n\t_selection: 0,\n\n\tinitialize: function Segment(arg0, arg1, arg2, arg3, arg4, arg5) {\n\t\tvar count = arguments.length,\n\t\t\tpoint, handleIn, handleOut, selection;\n\t\tif (count > 0) {\n\t\t\tif (arg0 == null || typeof arg0 === 'object') {\n\t\t\t\tif (count === 1 && arg0 && 'point' in arg0) {\n\t\t\t\t\tpoint = arg0.point;\n\t\t\t\t\thandleIn = arg0.handleIn;\n\t\t\t\t\thandleOut = arg0.handleOut;\n\t\t\t\t\tselection = arg0.selection;\n\t\t\t\t} else {\n\t\t\t\t\tpoint = arg0;\n\t\t\t\t\thandleIn = arg1;\n\t\t\t\t\thandleOut = arg2;\n\t\t\t\t\tselection = arg3;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tpoint = [ arg0, arg1 ];\n\t\t\t\thandleIn = arg2 !== undefined ? [ arg2, arg3 ] : null;\n\t\t\t\thandleOut = arg4 !== undefined ? [ arg4, arg5 ] : null;\n\t\t\t}\n\t\t}\n\t\tnew SegmentPoint(point, this, '_point');\n\t\tnew SegmentPoint(handleIn, this, '_handleIn');\n\t\tnew SegmentPoint(handleOut, this, '_handleOut');\n\t\tif (selection)\n\t\t\tthis.setSelection(selection);\n\t},\n\n\t_serialize: function(options, dictionary) {\n\t\tvar point = this._point,\n\t\t\tselection = this._selection,\n\t\t\tobj = selection || this.hasHandles()\n\t\t\t\t\t? [point, this._handleIn, this._handleOut]\n\t\t\t\t\t: point;\n\t\tif (selection)\n\t\t\tobj.push(selection);\n\t\treturn Base.serialize(obj, options, true, dictionary);\n\t},\n\n\t_changed: function(point) {\n\t\tvar path = this._path;\n\t\tif (!path)\n\t\t\treturn;\n\t\tvar curves = path._curves,\n\t\t\tindex = this._index,\n\t\t\tcurve;\n\t\tif (curves) {\n\t\t\tif ((!point || point === this._point || point === this._handleIn)\n\t\t\t\t\t&& (curve = index > 0 ? curves[index - 1] : path._closed\n\t\t\t\t\t\t? curves[curves.length - 1] : null))\n\t\t\t\tcurve._changed();\n\t\t\tif ((!point || point === this._point || point === this._handleOut)\n\t\t\t\t\t&& (curve = curves[index]))\n\t\t\t\tcurve._changed();\n\t\t}\n\t\tpath._changed(41);\n\t},\n\n\tgetPoint: function() {\n\t\treturn this._point;\n\t},\n\n\tsetPoint: function() {\n\t\tthis._point.set(Point.read(arguments));\n\t},\n\n\tgetHandleIn: function() {\n\t\treturn this._handleIn;\n\t},\n\n\tsetHandleIn: function() {\n\t\tthis._handleIn.set(Point.read(arguments));\n\t},\n\n\tgetHandleOut: function() {\n\t\treturn this._handleOut;\n\t},\n\n\tsetHandleOut: function() {\n\t\tthis._handleOut.set(Point.read(arguments));\n\t},\n\n\thasHandles: function() {\n\t\treturn !this._handleIn.isZero() || !this._handleOut.isZero();\n\t},\n\n\tisSmooth: function() {\n\t\tvar handleIn = this._handleIn,\n\t\t\thandleOut = this._handleOut;\n\t\treturn !handleIn.isZero() && !handleOut.isZero()\n\t\t\t\t&& handleIn.isCollinear(handleOut);\n\t},\n\n\tclearHandles: function() {\n\t\tthis._handleIn._set(0, 0);\n\t\tthis._handleOut._set(0, 0);\n\t},\n\n\tgetSelection: function() {\n\t\treturn this._selection;\n\t},\n\n\tsetSelection: function(selection) {\n\t\tvar oldSelection = this._selection,\n\t\t\tpath = this._path;\n\t\tthis._selection = selection = selection || 0;\n\t\tif (path && selection !== oldSelection) {\n\t\t\tpath._updateSelection(this, oldSelection, selection);\n\t\t\tpath._changed(257);\n\t\t}\n\t},\n\n\t_changeSelection: function(flag, selected) {\n\t\tvar selection = this._selection;\n\t\tthis.setSelection(selected ? selection | flag : selection & ~flag);\n\t},\n\n\tisSelected: function() {\n\t\treturn !!(this._selection & 7);\n\t},\n\n\tsetSelected: function(selected) {\n\t\tthis._changeSelection(7, selected);\n\t},\n\n\tgetIndex: function() {\n\t\treturn this._index !== undefined ? this._index : null;\n\t},\n\n\tgetPath: function() {\n\t\treturn this._path || null;\n\t},\n\n\tgetCurve: function() {\n\t\tvar path = this._path,\n\t\t\tindex = this._index;\n\t\tif (path) {\n\t\t\tif (index > 0 && !path._closed\n\t\t\t\t\t&& index === path._segments.length - 1)\n\t\t\t\tindex--;\n\t\t\treturn path.getCurves()[index] || null;\n\t\t}\n\t\treturn null;\n\t},\n\n\tgetLocation: function() {\n\t\tvar curve = this.getCurve();\n\t\treturn curve\n\t\t\t\t? new CurveLocation(curve, this === curve._segment1 ? 0 : 1)\n\t\t\t\t: null;\n\t},\n\n\tgetNext: function() {\n\t\tvar segments = this._path && this._path._segments;\n\t\treturn segments && (segments[this._index + 1]\n\t\t\t\t|| this._path._closed && segments[0]) || null;\n\t},\n\n\tsmooth: function(options, _first, _last) {\n\t\tvar opts = options || {},\n\t\t\ttype = opts.type,\n\t\t\tfactor = opts.factor,\n\t\t\tprev = this.getPrevious(),\n\t\t\tnext = this.getNext(),\n\t\t\tp0 = (prev || this)._point,\n\t\t\tp1 = this._point,\n\t\t\tp2 = (next || this)._point,\n\t\t\td1 = p0.getDistance(p1),\n\t\t\td2 = p1.getDistance(p2);\n\t\tif (!type || type === 'catmull-rom') {\n\t\t\tvar a = factor === undefined ? 0.5 : factor,\n\t\t\t\td1_a = Math.pow(d1, a),\n\t\t\t\td1_2a = d1_a * d1_a,\n\t\t\t\td2_a = Math.pow(d2, a),\n\t\t\t\td2_2a = d2_a * d2_a;\n\t\t\tif (!_first && prev) {\n\t\t\t\tvar A = 2 * d2_2a + 3 * d2_a * d1_a + d1_2a,\n\t\t\t\t\tN = 3 * d2_a * (d2_a + d1_a);\n\t\t\t\tthis.setHandleIn(N !== 0\n\t\t\t\t\t? new Point(\n\t\t\t\t\t\t(d2_2a * p0._x + A * p1._x - d1_2a * p2._x) / N - p1._x,\n\t\t\t\t\t\t(d2_2a * p0._y + A * p1._y - d1_2a * p2._y) / N - p1._y)\n\t\t\t\t\t: new Point());\n\t\t\t}\n\t\t\tif (!_last && next) {\n\t\t\t\tvar A = 2 * d1_2a + 3 * d1_a * d2_a + d2_2a,\n\t\t\t\t\tN = 3 * d1_a * (d1_a + d2_a);\n\t\t\t\tthis.setHandleOut(N !== 0\n\t\t\t\t\t? new Point(\n\t\t\t\t\t\t(d1_2a * p2._x + A * p1._x - d2_2a * p0._x) / N - p1._x,\n\t\t\t\t\t\t(d1_2a * p2._y + A * p1._y - d2_2a * p0._y) / N - p1._y)\n\t\t\t\t\t: new Point());\n\t\t\t}\n\t\t} else if (type === 'geometric') {\n\t\t\tif (prev && next) {\n\t\t\t\tvar vector = p0.subtract(p2),\n\t\t\t\t\tt = factor === undefined ? 0.4 : factor,\n\t\t\t\t\tk = t * d1 / (d1 + d2);\n\t\t\t\tif (!_first)\n\t\t\t\t\tthis.setHandleIn(vector.multiply(k));\n\t\t\t\tif (!_last)\n\t\t\t\t\tthis.setHandleOut(vector.multiply(k - t));\n\t\t\t}\n\t\t} else {\n\t\t\tthrow new Error('Smoothing method \\'' + type + '\\' not supported.');\n\t\t}\n\t},\n\n\tgetPrevious: function() {\n\t\tvar segments = this._path && this._path._segments;\n\t\treturn segments && (segments[this._index - 1]\n\t\t\t\t|| this._path._closed && segments[segments.length - 1]) || null;\n\t},\n\n\tisFirst: function() {\n\t\treturn !this._index;\n\t},\n\n\tisLast: function() {\n\t\tvar path = this._path;\n\t\treturn path && this._index === path._segments.length - 1 || false;\n\t},\n\n\treverse: function() {\n\t\tvar handleIn = this._handleIn,\n\t\t\thandleOut = this._handleOut,\n\t\t\ttmp = handleIn.clone();\n\t\thandleIn.set(handleOut);\n\t\thandleOut.set(tmp);\n\t},\n\n\treversed: function() {\n\t\treturn new Segment(this._point, this._handleOut, this._handleIn);\n\t},\n\n\tremove: function() {\n\t\treturn this._path ? !!this._path.removeSegment(this._index) : false;\n\t},\n\n\tclone: function() {\n\t\treturn new Segment(this._point, this._handleIn, this._handleOut);\n\t},\n\n\tequals: function(segment) {\n\t\treturn segment === this || segment && this._class === segment._class\n\t\t\t\t&& this._point.equals(segment._point)\n\t\t\t\t&& this._handleIn.equals(segment._handleIn)\n\t\t\t\t&& this._handleOut.equals(segment._handleOut)\n\t\t\t\t|| false;\n\t},\n\n\ttoString: function() {\n\t\tvar parts = [ 'point: ' + this._point ];\n\t\tif (!this._handleIn.isZero())\n\t\t\tparts.push('handleIn: ' + this._handleIn);\n\t\tif (!this._handleOut.isZero())\n\t\t\tparts.push('handleOut: ' + this._handleOut);\n\t\treturn '{ ' + parts.join(', ') + ' }';\n\t},\n\n\ttransform: function(matrix) {\n\t\tthis._transformCoordinates(matrix, new Array(6), true);\n\t\tthis._changed();\n\t},\n\n\tinterpolate: function(from, to, factor) {\n\t\tvar u = 1 - factor,\n\t\t\tv = factor,\n\t\t\tpoint1 = from._point,\n\t\t\tpoint2 = to._point,\n\t\t\thandleIn1 = from._handleIn,\n\t\t\thandleIn2 = to._handleIn,\n\t\t\thandleOut2 = to._handleOut,\n\t\t\thandleOut1 = from._handleOut;\n\t\tthis._point._set(\n\t\t\t\tu * point1._x + v * point2._x,\n\t\t\t\tu * point1._y + v * point2._y, true);\n\t\tthis._handleIn._set(\n\t\t\t\tu * handleIn1._x + v * handleIn2._x,\n\t\t\t\tu * handleIn1._y + v * handleIn2._y, true);\n\t\tthis._handleOut._set(\n\t\t\t\tu * handleOut1._x + v * handleOut2._x,\n\t\t\t\tu * handleOut1._y + v * handleOut2._y, true);\n\t\tthis._changed();\n\t},\n\n\t_transformCoordinates: function(matrix, coords, change) {\n\t\tvar point = this._point,\n\t\t\thandleIn = !change || !this._handleIn.isZero()\n\t\t\t\t\t? this._handleIn : null,\n\t\t\thandleOut = !change || !this._handleOut.isZero()\n\t\t\t\t\t? this._handleOut : null,\n\t\t\tx = point._x,\n\t\t\ty = point._y,\n\t\t\ti = 2;\n\t\tcoords[0] = x;\n\t\tcoords[1] = y;\n\t\tif (handleIn) {\n\t\t\tcoords[i++] = handleIn._x + x;\n\t\t\tcoords[i++] = handleIn._y + y;\n\t\t}\n\t\tif (handleOut) {\n\t\t\tcoords[i++] = handleOut._x + x;\n\t\t\tcoords[i++] = handleOut._y + y;\n\t\t}\n\t\tif (matrix) {\n\t\t\tmatrix._transformCoordinates(coords, coords, i / 2);\n\t\t\tx = coords[0];\n\t\t\ty = coords[1];\n\t\t\tif (change) {\n\t\t\t\tpoint._x = x;\n\t\t\t\tpoint._y = y;\n\t\t\t\ti = 2;\n\t\t\t\tif (handleIn) {\n\t\t\t\t\thandleIn._x = coords[i++] - x;\n\t\t\t\t\thandleIn._y = coords[i++] - y;\n\t\t\t\t}\n\t\t\t\tif (handleOut) {\n\t\t\t\t\thandleOut._x = coords[i++] - x;\n\t\t\t\t\thandleOut._y = coords[i++] - y;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (!handleIn) {\n\t\t\t\t\tcoords[i++] = x;\n\t\t\t\t\tcoords[i++] = y;\n\t\t\t\t}\n\t\t\t\tif (!handleOut) {\n\t\t\t\t\tcoords[i++] = x;\n\t\t\t\t\tcoords[i++] = y;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn coords;\n\t}\n});\n\nvar SegmentPoint = Point.extend({\n\tinitialize: function SegmentPoint(point, owner, key) {\n\t\tvar x, y,\n\t\t\tselected;\n\t\tif (!point) {\n\t\t\tx = y = 0;\n\t\t} else if ((x = point[0]) !== undefined) {\n\t\t\ty = point[1];\n\t\t} else {\n\t\t\tvar pt = point;\n\t\t\tif ((x = pt.x) === undefined) {\n\t\t\t\tpt = Point.read(arguments);\n\t\t\t\tx = pt.x;\n\t\t\t}\n\t\t\ty = pt.y;\n\t\t\tselected = pt.selected;\n\t\t}\n\t\tthis._x = x;\n\t\tthis._y = y;\n\t\tthis._owner = owner;\n\t\towner[key] = this;\n\t\tif (selected)\n\t\t\tthis.setSelected(true);\n\t},\n\n\t_set: function(x, y) {\n\t\tthis._x = x;\n\t\tthis._y = y;\n\t\tthis._owner._changed(this);\n\t\treturn this;\n\t},\n\n\tgetX: function() {\n\t\treturn this._x;\n\t},\n\n\tsetX: function(x) {\n\t\tthis._x = x;\n\t\tthis._owner._changed(this);\n\t},\n\n\tgetY: function() {\n\t\treturn this._y;\n\t},\n\n\tsetY: function(y) {\n\t\tthis._y = y;\n\t\tthis._owner._changed(this);\n\t},\n\n\tisZero: function() {\n\t\tvar isZero = Numerical.isZero;\n\t\treturn isZero(this._x) && isZero(this._y);\n\t},\n\n\tisSelected: function() {\n\t\treturn !!(this._owner._selection & this._getSelection());\n\t},\n\n\tsetSelected: function(selected) {\n\t\tthis._owner._changeSelection(this._getSelection(), selected);\n\t},\n\n\t_getSelection: function() {\n\t\tvar owner = this._owner;\n\t\treturn this === owner._point ? 1\n\t\t\t: this === owner._handleIn ? 2\n\t\t\t: this === owner._handleOut ? 4\n\t\t\t: 0;\n\t}\n});\n\nvar Curve = Base.extend({\n\t_class: 'Curve',\n\tbeans: true,\n\n\tinitialize: function Curve(arg0, arg1, arg2, arg3, arg4, arg5, arg6, arg7) {\n\t\tvar count = arguments.length,\n\t\t\tseg1, seg2,\n\t\t\tpoint1, point2,\n\t\t\thandle1, handle2;\n\t\tif (count === 3) {\n\t\t\tthis._path = arg0;\n\t\t\tseg1 = arg1;\n\t\t\tseg2 = arg2;\n\t\t} else if (!count) {\n\t\t\tseg1 = new Segment();\n\t\t\tseg2 = new Segment();\n\t\t} else if (count === 1) {\n\t\t\tif ('segment1' in arg0) {\n\t\t\t\tseg1 = new Segment(arg0.segment1);\n\t\t\t\tseg2 = new Segment(arg0.segment2);\n\t\t\t} else if ('point1' in arg0) {\n\t\t\t\tpoint1 = arg0.point1;\n\t\t\t\thandle1 = arg0.handle1;\n\t\t\t\thandle2 = arg0.handle2;\n\t\t\t\tpoint2 = arg0.point2;\n\t\t\t} else if (Array.isArray(arg0)) {\n\t\t\t\tpoint1 = [arg0[0], arg0[1]];\n\t\t\t\tpoint2 = [arg0[6], arg0[7]];\n\t\t\t\thandle1 = [arg0[2] - arg0[0], arg0[3] - arg0[1]];\n\t\t\t\thandle2 = [arg0[4] - arg0[6], arg0[5] - arg0[7]];\n\t\t\t}\n\t\t} else if (count === 2) {\n\t\t\tseg1 = new Segment(arg0);\n\t\t\tseg2 = new Segment(arg1);\n\t\t} else if (count === 4) {\n\t\t\tpoint1 = arg0;\n\t\t\thandle1 = arg1;\n\t\t\thandle2 = arg2;\n\t\t\tpoint2 = arg3;\n\t\t} else if (count === 8) {\n\t\t\tpoint1 = [arg0, arg1];\n\t\t\tpoint2 = [arg6, arg7];\n\t\t\thandle1 = [arg2 - arg0, arg3 - arg1];\n\t\t\thandle2 = [arg4 - arg6, arg5 - arg7];\n\t\t}\n\t\tthis._segment1 = seg1 || new Segment(point1, null, handle1);\n\t\tthis._segment2 = seg2 || new Segment(point2, handle2, null);\n\t},\n\n\t_serialize: function(options, dictionary) {\n\t\treturn Base.serialize(this.hasHandles()\n\t\t\t\t? [this.getPoint1(), this.getHandle1(), this.getHandle2(),\n\t\t\t\t\tthis.getPoint2()]\n\t\t\t\t: [this.getPoint1(), this.getPoint2()],\n\t\t\t\toptions, true, dictionary);\n\t},\n\n\t_changed: function() {\n\t\tthis._length = this._bounds = undefined;\n\t},\n\n\tclone: function() {\n\t\treturn new Curve(this._segment1, this._segment2);\n\t},\n\n\ttoString: function() {\n\t\tvar parts = [ 'point1: ' + this._segment1._point ];\n\t\tif (!this._segment1._handleOut.isZero())\n\t\t\tparts.push('handle1: ' + this._segment1._handleOut);\n\t\tif (!this._segment2._handleIn.isZero())\n\t\t\tparts.push('handle2: ' + this._segment2._handleIn);\n\t\tparts.push('point2: ' + this._segment2._point);\n\t\treturn '{ ' + parts.join(', ') + ' }';\n\t},\n\n\tclassify: function() {\n\t\treturn Curve.classify(this.getValues());\n\t},\n\n\tremove: function() {\n\t\tvar removed = false;\n\t\tif (this._path) {\n\t\t\tvar segment2 = this._segment2,\n\t\t\t\thandleOut = segment2._handleOut;\n\t\t\tremoved = segment2.remove();\n\t\t\tif (removed)\n\t\t\t\tthis._segment1._handleOut.set(handleOut);\n\t\t}\n\t\treturn removed;\n\t},\n\n\tgetPoint1: function() {\n\t\treturn this._segment1._point;\n\t},\n\n\tsetPoint1: function() {\n\t\tthis._segment1._point.set(Point.read(arguments));\n\t},\n\n\tgetPoint2: function() {\n\t\treturn this._segment2._point;\n\t},\n\n\tsetPoint2: function() {\n\t\tthis._segment2._point.set(Point.read(arguments));\n\t},\n\n\tgetHandle1: function() {\n\t\treturn this._segment1._handleOut;\n\t},\n\n\tsetHandle1: function() {\n\t\tthis._segment1._handleOut.set(Point.read(arguments));\n\t},\n\n\tgetHandle2: function() {\n\t\treturn this._segment2._handleIn;\n\t},\n\n\tsetHandle2: function() {\n\t\tthis._segment2._handleIn.set(Point.read(arguments));\n\t},\n\n\tgetSegment1: function() {\n\t\treturn this._segment1;\n\t},\n\n\tgetSegment2: function() {\n\t\treturn this._segment2;\n\t},\n\n\tgetPath: function() {\n\t\treturn this._path;\n\t},\n\n\tgetIndex: function() {\n\t\treturn this._segment1._index;\n\t},\n\n\tgetNext: function() {\n\t\tvar curves = this._path && this._path._curves;\n\t\treturn curves && (curves[this._segment1._index + 1]\n\t\t\t\t|| this._path._closed && curves[0]) || null;\n\t},\n\n\tgetPrevious: function() {\n\t\tvar curves = this._path && this._path._curves;\n\t\treturn curves && (curves[this._segment1._index - 1]\n\t\t\t\t|| this._path._closed && curves[curves.length - 1]) || null;\n\t},\n\n\tisFirst: function() {\n\t\treturn !this._segment1._index;\n\t},\n\n\tisLast: function() {\n\t\tvar path = this._path;\n\t\treturn path && this._segment1._index === path._curves.length - 1\n\t\t\t\t|| false;\n\t},\n\n\tisSelected: function() {\n\t\treturn this.getPoint1().isSelected()\n\t\t\t\t&& this.getHandle1().isSelected()\n\t\t\t\t&& this.getHandle2().isSelected()\n\t\t\t\t&& this.getPoint2().isSelected();\n\t},\n\n\tsetSelected: function(selected) {\n\t\tthis.getPoint1().setSelected(selected);\n\t\tthis.getHandle1().setSelected(selected);\n\t\tthis.getHandle2().setSelected(selected);\n\t\tthis.getPoint2().setSelected(selected);\n\t},\n\n\tgetValues: function(matrix) {\n\t\treturn Curve.getValues(this._segment1, this._segment2, matrix);\n\t},\n\n\tgetPoints: function() {\n\t\tvar coords = this.getValues(),\n\t\t\tpoints = [];\n\t\tfor (var i = 0; i < 8; i += 2)\n\t\t\tpoints.push(new Point(coords[i], coords[i + 1]));\n\t\treturn points;\n\t}\n}, {\n\tgetLength: function() {\n\t\tif (this._length == null)\n\t\t\tthis._length = Curve.getLength(this.getValues(), 0, 1);\n\t\treturn this._length;\n\t},\n\n\tgetArea: function() {\n\t\treturn Curve.getArea(this.getValues());\n\t},\n\n\tgetLine: function() {\n\t\treturn new Line(this._segment1._point, this._segment2._point);\n\t},\n\n\tgetPart: function(from, to) {\n\t\treturn new Curve(Curve.getPart(this.getValues(), from, to));\n\t},\n\n\tgetPartLength: function(from, to) {\n\t\treturn Curve.getLength(this.getValues(), from, to);\n\t},\n\n\tdivideAt: function(location) {\n\t\treturn this.divideAtTime(location && location.curve === this\n\t\t\t\t? location.time : this.getTimeAt(location));\n\t},\n\n\tdivideAtTime: function(time, _setHandles) {\n\t\tvar tMin = 1e-8,\n\t\t\ttMax = 1 - tMin,\n\t\t\tres = null;\n\t\tif (time >= tMin && time <= tMax) {\n\t\t\tvar parts = Curve.subdivide(this.getValues(), time),\n\t\t\t\tleft = parts[0],\n\t\t\t\tright = parts[1],\n\t\t\t\tsetHandles = _setHandles || this.hasHandles(),\n\t\t\t\tseg1 = this._segment1,\n\t\t\t\tseg2 = this._segment2,\n\t\t\t\tpath = this._path;\n\t\t\tif (setHandles) {\n\t\t\t\tseg1._handleOut._set(left[2] - left[0], left[3] - left[1]);\n\t\t\t\tseg2._handleIn._set(right[4] - right[6],right[5] - right[7]);\n\t\t\t}\n\t\t\tvar x = left[6], y = left[7],\n\t\t\t\tsegment = new Segment(new Point(x, y),\n\t\t\t\t\t\tsetHandles && new Point(left[4] - x, left[5] - y),\n\t\t\t\t\t\tsetHandles && new Point(right[2] - x, right[3] - y));\n\t\t\tif (path) {\n\t\t\t\tpath.insert(seg1._index + 1, segment);\n\t\t\t\tres = this.getNext();\n\t\t\t} else {\n\t\t\t\tthis._segment2 = segment;\n\t\t\t\tthis._changed();\n\t\t\t\tres = new Curve(segment, seg2);\n\t\t\t}\n\t\t}\n\t\treturn res;\n\t},\n\n\tsplitAt: function(location) {\n\t\tvar path = this._path;\n\t\treturn path ? path.splitAt(location) : null;\n\t},\n\n\tsplitAtTime: function(time) {\n\t\treturn this.splitAt(this.getLocationAtTime(time));\n\t},\n\n\tdivide: function(offset, isTime) {\n\t\treturn this.divideAtTime(offset === undefined ? 0.5 : isTime ? offset\n\t\t\t\t: this.getTimeAt(offset));\n\t},\n\n\tsplit: function(offset, isTime) {\n\t\treturn this.splitAtTime(offset === undefined ? 0.5 : isTime ? offset\n\t\t\t\t: this.getTimeAt(offset));\n\t},\n\n\treversed: function() {\n\t\treturn new Curve(this._segment2.reversed(), this._segment1.reversed());\n\t},\n\n\tclearHandles: function() {\n\t\tthis._segment1._handleOut._set(0, 0);\n\t\tthis._segment2._handleIn._set(0, 0);\n\t},\n\nstatics: {\n\tgetValues: function(segment1, segment2, matrix, straight) {\n\t\tvar p1 = segment1._point,\n\t\t\th1 = segment1._handleOut,\n\t\t\th2 = segment2._handleIn,\n\t\t\tp2 = segment2._point,\n\t\t\tx1 = p1.x, y1 = p1.y,\n\t\t\tx2 = p2.x, y2 = p2.y,\n\t\t\tvalues = straight\n\t\t\t\t? [ x1, y1, x1, y1, x2, y2, x2, y2 ]\n\t\t\t\t: [\n\t\t\t\t\tx1, y1,\n\t\t\t\t\tx1 + h1._x, y1 + h1._y,\n\t\t\t\t\tx2 + h2._x, y2 + h2._y,\n\t\t\t\t\tx2, y2\n\t\t\t\t];\n\t\tif (matrix)\n\t\t\tmatrix._transformCoordinates(values, values, 4);\n\t\treturn values;\n\t},\n\n\tsubdivide: function(v, t) {\n\t\tvar x0 = v[0], y0 = v[1],\n\t\t\tx1 = v[2], y1 = v[3],\n\t\t\tx2 = v[4], y2 = v[5],\n\t\t\tx3 = v[6], y3 = v[7];\n\t\tif (t === undefined)\n\t\t\tt = 0.5;\n\t\tvar u = 1 - t,\n\t\t\tx4 = u * x0 + t * x1, y4 = u * y0 + t * y1,\n\t\t\tx5 = u * x1 + t * x2, y5 = u * y1 + t * y2,\n\t\t\tx6 = u * x2 + t * x3, y6 = u * y2 + t * y3,\n\t\t\tx7 = u * x4 + t * x5, y7 = u * y4 + t * y5,\n\t\t\tx8 = u * x5 + t * x6, y8 = u * y5 + t * y6,\n\t\t\tx9 = u * x7 + t * x8, y9 = u * y7 + t * y8;\n\t\treturn [\n\t\t\t[x0, y0, x4, y4, x7, y7, x9, y9],\n\t\t\t[x9, y9, x8, y8, x6, y6, x3, y3]\n\t\t];\n\t},\n\n\tgetMonoCurves: function(v, dir) {\n\t\tvar curves = [],\n\t\t\tio = dir ? 0 : 1,\n\t\t\to0 = v[io + 0],\n\t\t\to1 = v[io + 2],\n\t\t\to2 = v[io + 4],\n\t\t\to3 = v[io + 6];\n\t\tif ((o0 >= o1) === (o1 >= o2) && (o1 >= o2) === (o2 >= o3)\n\t\t\t\t|| Curve.isStraight(v)) {\n\t\t\tcurves.push(v);\n\t\t} else {\n\t\t\tvar a = 3 * (o1 - o2) - o0 + o3,\n\t\t\t\tb = 2 * (o0 + o2) - 4 * o1,\n\t\t\t\tc = o1 - o0,\n\t\t\t\ttMin = 1e-8,\n\t\t\t\ttMax = 1 - tMin,\n\t\t\t\troots = [],\n\t\t\t\tn = Numerical.solveQuadratic(a, b, c, roots, tMin, tMax);\n\t\t\tif (!n) {\n\t\t\t\tcurves.push(v);\n\t\t\t} else {\n\t\t\t\troots.sort();\n\t\t\t\tvar t = roots[0],\n\t\t\t\t\tparts = Curve.subdivide(v, t);\n\t\t\t\tcurves.push(parts[0]);\n\t\t\t\tif (n > 1) {\n\t\t\t\t\tt = (roots[1] - t) / (1 - t);\n\t\t\t\t\tparts = Curve.subdivide(parts[1], t);\n\t\t\t\t\tcurves.push(parts[0]);\n\t\t\t\t}\n\t\t\t\tcurves.push(parts[1]);\n\t\t\t}\n\t\t}\n\t\treturn curves;\n\t},\n\n\tsolveCubic: function (v, coord, val, roots, min, max) {\n\t\tvar v0 = v[coord],\n\t\t\tv1 = v[coord + 2],\n\t\t\tv2 = v[coord + 4],\n\t\t\tv3 = v[coord + 6],\n\t\t\tres = 0;\n\t\tif (  !(v0 < val && v3 < val && v1 < val && v2 < val ||\n\t\t\t\tv0 > val && v3 > val && v1 > val && v2 > val)) {\n\t\t\tvar c = 3 * (v1 - v0),\n\t\t\t\tb = 3 * (v2 - v1) - c,\n\t\t\t\ta = v3 - v0 - c - b;\n\t\t\tres = Numerical.solveCubic(a, b, c, v0 - val, roots, min, max);\n\t\t}\n\t\treturn res;\n\t},\n\n\tgetTimeOf: function(v, point) {\n\t\tvar p0 = new Point(v[0], v[1]),\n\t\t\tp3 = new Point(v[6], v[7]),\n\t\t\tepsilon = 1e-12,\n\t\t\tgeomEpsilon = 1e-7,\n\t\t\tt = point.isClose(p0, epsilon) ? 0\n\t\t\t  : point.isClose(p3, epsilon) ? 1\n\t\t\t  : null;\n\t\tif (t === null) {\n\t\t\tvar coords = [point.x, point.y],\n\t\t\t\troots = [];\n\t\t\tfor (var c = 0; c < 2; c++) {\n\t\t\t\tvar count = Curve.solveCubic(v, c, coords[c], roots, 0, 1);\n\t\t\t\tfor (var i = 0; i < count; i++) {\n\t\t\t\t\tvar u = roots[i];\n\t\t\t\t\tif (point.isClose(Curve.getPoint(v, u), geomEpsilon))\n\t\t\t\t\t\treturn u;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn point.isClose(p0, geomEpsilon) ? 0\n\t\t\t : point.isClose(p3, geomEpsilon) ? 1\n\t\t\t : null;\n\t},\n\n\tgetNearestTime: function(v, point) {\n\t\tif (Curve.isStraight(v)) {\n\t\t\tvar x0 = v[0], y0 = v[1],\n\t\t\t\tx3 = v[6], y3 = v[7],\n\t\t\t\tvx = x3 - x0, vy = y3 - y0,\n\t\t\t\tdet = vx * vx + vy * vy;\n\t\t\tif (det === 0)\n\t\t\t\treturn 0;\n\t\t\tvar u = ((point.x - x0) * vx + (point.y - y0) * vy) / det;\n\t\t\treturn u < 1e-12 ? 0\n\t\t\t\t : u > 0.999999999999 ? 1\n\t\t\t\t : Curve.getTimeOf(v,\n\t\t\t\t\tnew Point(x0 + u * vx, y0 + u * vy));\n\t\t}\n\n\t\tvar count = 100,\n\t\t\tminDist = Infinity,\n\t\t\tminT = 0;\n\n\t\tfunction refine(t) {\n\t\t\tif (t >= 0 && t <= 1) {\n\t\t\t\tvar dist = point.getDistance(Curve.getPoint(v, t), true);\n\t\t\t\tif (dist < minDist) {\n\t\t\t\t\tminDist = dist;\n\t\t\t\t\tminT = t;\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfor (var i = 0; i <= count; i++)\n\t\t\trefine(i / count);\n\n\t\tvar step = 1 / (count * 2);\n\t\twhile (step > 1e-8) {\n\t\t\tif (!refine(minT - step) && !refine(minT + step))\n\t\t\t\tstep /= 2;\n\t\t}\n\t\treturn minT;\n\t},\n\n\tgetPart: function(v, from, to) {\n\t\tvar flip = from > to;\n\t\tif (flip) {\n\t\t\tvar tmp = from;\n\t\t\tfrom = to;\n\t\t\tto = tmp;\n\t\t}\n\t\tif (from > 0)\n\t\t\tv = Curve.subdivide(v, from)[1];\n\t\tif (to < 1)\n\t\t\tv = Curve.subdivide(v, (to - from) / (1 - from))[0];\n\t\treturn flip\n\t\t\t\t? [v[6], v[7], v[4], v[5], v[2], v[3], v[0], v[1]]\n\t\t\t\t: v;\n\t},\n\n\tisFlatEnough: function(v, flatness) {\n\t\tvar x0 = v[0], y0 = v[1],\n\t\t\tx1 = v[2], y1 = v[3],\n\t\t\tx2 = v[4], y2 = v[5],\n\t\t\tx3 = v[6], y3 = v[7],\n\t\t\tux = 3 * x1 - 2 * x0 - x3,\n\t\t\tuy = 3 * y1 - 2 * y0 - y3,\n\t\t\tvx = 3 * x2 - 2 * x3 - x0,\n\t\t\tvy = 3 * y2 - 2 * y3 - y0;\n\t\treturn Math.max(ux * ux, vx * vx) + Math.max(uy * uy, vy * vy)\n\t\t\t\t<= 16 * flatness * flatness;\n\t},\n\n\tgetArea: function(v) {\n\t\tvar x0 = v[0], y0 = v[1],\n\t\t\tx1 = v[2], y1 = v[3],\n\t\t\tx2 = v[4], y2 = v[5],\n\t\t\tx3 = v[6], y3 = v[7];\n\t\treturn 3 * ((y3 - y0) * (x1 + x2) - (x3 - x0) * (y1 + y2)\n\t\t\t\t+ y1 * (x0 - x2) - x1 * (y0 - y2)\n\t\t\t\t+ y3 * (x2 + x0 / 3) - x3 * (y2 + y0 / 3)) / 20;\n\t},\n\n\tgetBounds: function(v) {\n\t\tvar min = v.slice(0, 2),\n\t\t\tmax = min.slice(),\n\t\t\troots = [0, 0];\n\t\tfor (var i = 0; i < 2; i++)\n\t\t\tCurve._addBounds(v[i], v[i + 2], v[i + 4], v[i + 6],\n\t\t\t\t\ti, 0, min, max, roots);\n\t\treturn new Rectangle(min[0], min[1], max[0] - min[0], max[1] - min[1]);\n\t},\n\n\t_addBounds: function(v0, v1, v2, v3, coord, padding, min, max, roots) {\n\t\tfunction add(value, padding) {\n\t\t\tvar left = value - padding,\n\t\t\t\tright = value + padding;\n\t\t\tif (left < min[coord])\n\t\t\t\tmin[coord] = left;\n\t\t\tif (right > max[coord])\n\t\t\t\tmax[coord] = right;\n\t\t}\n\n\t\tpadding /= 2;\n\t\tvar minPad = min[coord] - padding,\n\t\t\tmaxPad = max[coord] + padding;\n\t\tif (    v0 < minPad || v1 < minPad || v2 < minPad || v3 < minPad ||\n\t\t\t\tv0 > maxPad || v1 > maxPad || v2 > maxPad || v3 > maxPad) {\n\t\t\tif (v1 < v0 != v1 < v3 && v2 < v0 != v2 < v3) {\n\t\t\t\tadd(v0, padding);\n\t\t\t\tadd(v3, padding);\n\t\t\t} else {\n\t\t\t\tvar a = 3 * (v1 - v2) - v0 + v3,\n\t\t\t\t\tb = 2 * (v0 + v2) - 4 * v1,\n\t\t\t\t\tc = v1 - v0,\n\t\t\t\t\tcount = Numerical.solveQuadratic(a, b, c, roots),\n\t\t\t\t\ttMin = 1e-8,\n\t\t\t\t\ttMax = 1 - tMin;\n\t\t\t\tadd(v3, 0);\n\t\t\t\tfor (var i = 0; i < count; i++) {\n\t\t\t\t\tvar t = roots[i],\n\t\t\t\t\t\tu = 1 - t;\n\t\t\t\t\tif (tMin <= t && t <= tMax)\n\t\t\t\t\t\tadd(u * u * u * v0\n\t\t\t\t\t\t\t+ 3 * u * u * t * v1\n\t\t\t\t\t\t\t+ 3 * u * t * t * v2\n\t\t\t\t\t\t\t+ t * t * t * v3,\n\t\t\t\t\t\t\tpadding);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}}, Base.each(\n\t['getBounds', 'getStrokeBounds', 'getHandleBounds'],\n\tfunction(name) {\n\t\tthis[name] = function() {\n\t\t\tif (!this._bounds)\n\t\t\t\tthis._bounds = {};\n\t\t\tvar bounds = this._bounds[name];\n\t\t\tif (!bounds) {\n\t\t\t\tbounds = this._bounds[name] = Path[name](\n\t\t\t\t\t\t[this._segment1, this._segment2], false, this._path);\n\t\t\t}\n\t\t\treturn bounds.clone();\n\t\t};\n\t},\n{\n\n}), Base.each({\n\tisStraight: function(p1, h1, h2, p2) {\n\t\tif (h1.isZero() && h2.isZero()) {\n\t\t\treturn true;\n\t\t} else {\n\t\t\tvar v = p2.subtract(p1);\n\t\t\tif (v.isZero()) {\n\t\t\t\treturn false;\n\t\t\t} else if (v.isCollinear(h1) && v.isCollinear(h2)) {\n\t\t\t\tvar l = new Line(p1, p2),\n\t\t\t\t\tepsilon = 1e-7;\n\t\t\t\tif (l.getDistance(p1.add(h1)) < epsilon &&\n\t\t\t\t\tl.getDistance(p2.add(h2)) < epsilon) {\n\t\t\t\t\tvar div = v.dot(v),\n\t\t\t\t\t\ts1 = v.dot(h1) / div,\n\t\t\t\t\t\ts2 = v.dot(h2) / div;\n\t\t\t\t\treturn s1 >= 0 && s1 <= 1 && s2 <= 0 && s2 >= -1;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t},\n\n\tisLinear: function(p1, h1, h2, p2) {\n\t\tvar third = p2.subtract(p1).divide(3);\n\t\treturn h1.equals(third) && h2.negate().equals(third);\n\t}\n}, function(test, name) {\n\tthis[name] = function(epsilon) {\n\t\tvar seg1 = this._segment1,\n\t\t\tseg2 = this._segment2;\n\t\treturn test(seg1._point, seg1._handleOut, seg2._handleIn, seg2._point,\n\t\t\t\tepsilon);\n\t};\n\n\tthis.statics[name] = function(v, epsilon) {\n\t\tvar x0 = v[0], y0 = v[1],\n\t\t\tx3 = v[6], y3 = v[7];\n\t\treturn test(\n\t\t\t\tnew Point(x0, y0),\n\t\t\t\tnew Point(v[2] - x0, v[3] - y0),\n\t\t\t\tnew Point(v[4] - x3, v[5] - y3),\n\t\t\t\tnew Point(x3, y3), epsilon);\n\t};\n}, {\n\tstatics: {},\n\n\thasHandles: function() {\n\t\treturn !this._segment1._handleOut.isZero()\n\t\t\t\t|| !this._segment2._handleIn.isZero();\n\t},\n\n\thasLength: function(epsilon) {\n\t\treturn (!this.getPoint1().equals(this.getPoint2()) || this.hasHandles())\n\t\t\t\t&& this.getLength() > (epsilon || 0);\n\t},\n\n\tisCollinear: function(curve) {\n\t\treturn curve && this.isStraight() && curve.isStraight()\n\t\t\t\t&& this.getLine().isCollinear(curve.getLine());\n\t},\n\n\tisHorizontal: function() {\n\t\treturn this.isStraight() && Math.abs(this.getTangentAtTime(0.5).y)\n\t\t\t\t< 1e-8;\n\t},\n\n\tisVertical: function() {\n\t\treturn this.isStraight() && Math.abs(this.getTangentAtTime(0.5).x)\n\t\t\t\t< 1e-8;\n\t}\n}), {\n\tbeans: false,\n\n\tgetLocationAt: function(offset, _isTime) {\n\t\treturn this.getLocationAtTime(\n\t\t\t\t_isTime ? offset : this.getTimeAt(offset));\n\t},\n\n\tgetLocationAtTime: function(t) {\n\t\treturn t != null && t >= 0 && t <= 1\n\t\t\t\t? new CurveLocation(this, t)\n\t\t\t\t: null;\n\t},\n\n\tgetTimeAt: function(offset, start) {\n\t\treturn Curve.getTimeAt(this.getValues(), offset, start);\n\t},\n\n\tgetParameterAt: '#getTimeAt',\n\n\tgetTimesWithTangent: function () {\n\t\tvar tangent = Point.read(arguments);\n\t\treturn tangent.isZero()\n\t\t\t\t? []\n\t\t\t\t: Curve.getTimesWithTangent(this.getValues(), tangent);\n\t},\n\n\tgetOffsetAtTime: function(t) {\n\t\treturn this.getPartLength(0, t);\n\t},\n\n\tgetLocationOf: function() {\n\t\treturn this.getLocationAtTime(this.getTimeOf(Point.read(arguments)));\n\t},\n\n\tgetOffsetOf: function() {\n\t\tvar loc = this.getLocationOf.apply(this, arguments);\n\t\treturn loc ? loc.getOffset() : null;\n\t},\n\n\tgetTimeOf: function() {\n\t\treturn Curve.getTimeOf(this.getValues(), Point.read(arguments));\n\t},\n\n\tgetParameterOf: '#getTimeOf',\n\n\tgetNearestLocation: function() {\n\t\tvar point = Point.read(arguments),\n\t\t\tvalues = this.getValues(),\n\t\t\tt = Curve.getNearestTime(values, point),\n\t\t\tpt = Curve.getPoint(values, t);\n\t\treturn new CurveLocation(this, t, pt, null, point.getDistance(pt));\n\t},\n\n\tgetNearestPoint: function() {\n\t\tvar loc = this.getNearestLocation.apply(this, arguments);\n\t\treturn loc ? loc.getPoint() : loc;\n\t}\n\n},\nnew function() {\n\tvar methods = ['getPoint', 'getTangent', 'getNormal', 'getWeightedTangent',\n\t\t'getWeightedNormal', 'getCurvature'];\n\treturn Base.each(methods,\n\t\tfunction(name) {\n\t\t\tthis[name + 'At'] = function(location, _isTime) {\n\t\t\t\tvar values = this.getValues();\n\t\t\t\treturn Curve[name](values, _isTime ? location\n\t\t\t\t\t\t: Curve.getTimeAt(values, location));\n\t\t\t};\n\n\t\t\tthis[name + 'AtTime'] = function(time) {\n\t\t\t\treturn Curve[name](this.getValues(), time);\n\t\t\t};\n\t\t}, {\n\t\t\tstatics: {\n\t\t\t\t_evaluateMethods: methods\n\t\t\t}\n\t\t}\n\t);\n},\nnew function() {\n\n\tfunction getLengthIntegrand(v) {\n\t\tvar x0 = v[0], y0 = v[1],\n\t\t\tx1 = v[2], y1 = v[3],\n\t\t\tx2 = v[4], y2 = v[5],\n\t\t\tx3 = v[6], y3 = v[7],\n\n\t\t\tax = 9 * (x1 - x2) + 3 * (x3 - x0),\n\t\t\tbx = 6 * (x0 + x2) - 12 * x1,\n\t\t\tcx = 3 * (x1 - x0),\n\n\t\t\tay = 9 * (y1 - y2) + 3 * (y3 - y0),\n\t\t\tby = 6 * (y0 + y2) - 12 * y1,\n\t\t\tcy = 3 * (y1 - y0);\n\n\t\treturn function(t) {\n\t\t\tvar dx = (ax * t + bx) * t + cx,\n\t\t\t\tdy = (ay * t + by) * t + cy;\n\t\t\treturn Math.sqrt(dx * dx + dy * dy);\n\t\t};\n\t}\n\n\tfunction getIterations(a, b) {\n\t\treturn Math.max(2, Math.min(16, Math.ceil(Math.abs(b - a) * 32)));\n\t}\n\n\tfunction evaluate(v, t, type, normalized) {\n\t\tif (t == null || t < 0 || t > 1)\n\t\t\treturn null;\n\t\tvar x0 = v[0], y0 = v[1],\n\t\t\tx1 = v[2], y1 = v[3],\n\t\t\tx2 = v[4], y2 = v[5],\n\t\t\tx3 = v[6], y3 = v[7],\n\t\t\tisZero = Numerical.isZero;\n\t\tif (isZero(x1 - x0) && isZero(y1 - y0)) {\n\t\t\tx1 = x0;\n\t\t\ty1 = y0;\n\t\t}\n\t\tif (isZero(x2 - x3) && isZero(y2 - y3)) {\n\t\t\tx2 = x3;\n\t\t\ty2 = y3;\n\t\t}\n\t\tvar cx = 3 * (x1 - x0),\n\t\t\tbx = 3 * (x2 - x1) - cx,\n\t\t\tax = x3 - x0 - cx - bx,\n\t\t\tcy = 3 * (y1 - y0),\n\t\t\tby = 3 * (y2 - y1) - cy,\n\t\t\tay = y3 - y0 - cy - by,\n\t\t\tx, y;\n\t\tif (type === 0) {\n\t\t\tx = t === 0 ? x0 : t === 1 ? x3\n\t\t\t\t\t: ((ax * t + bx) * t + cx) * t + x0;\n\t\t\ty = t === 0 ? y0 : t === 1 ? y3\n\t\t\t\t\t: ((ay * t + by) * t + cy) * t + y0;\n\t\t} else {\n\t\t\tvar tMin = 1e-8,\n\t\t\t\ttMax = 1 - tMin;\n\t\t\tif (t < tMin) {\n\t\t\t\tx = cx;\n\t\t\t\ty = cy;\n\t\t\t} else if (t > tMax) {\n\t\t\t\tx = 3 * (x3 - x2);\n\t\t\t\ty = 3 * (y3 - y2);\n\t\t\t} else {\n\t\t\t\tx = (3 * ax * t + 2 * bx) * t + cx;\n\t\t\t\ty = (3 * ay * t + 2 * by) * t + cy;\n\t\t\t}\n\t\t\tif (normalized) {\n\t\t\t\tif (x === 0 && y === 0 && (t < tMin || t > tMax)) {\n\t\t\t\t\tx = x2 - x1;\n\t\t\t\t\ty = y2 - y1;\n\t\t\t\t}\n\t\t\t\tvar len = Math.sqrt(x * x + y * y);\n\t\t\t\tif (len) {\n\t\t\t\t\tx /= len;\n\t\t\t\t\ty /= len;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (type === 3) {\n\t\t\t\tvar x2 = 6 * ax * t + 2 * bx,\n\t\t\t\t\ty2 = 6 * ay * t + 2 * by,\n\t\t\t\t\td = Math.pow(x * x + y * y, 3 / 2);\n\t\t\t\tx = d !== 0 ? (x * y2 - y * x2) / d : 0;\n\t\t\t\ty = 0;\n\t\t\t}\n\t\t}\n\t\treturn type === 2 ? new Point(y, -x) : new Point(x, y);\n\t}\n\n\treturn { statics: {\n\n\t\tclassify: function(v) {\n\n\t\t\tvar x0 = v[0], y0 = v[1],\n\t\t\t\tx1 = v[2], y1 = v[3],\n\t\t\t\tx2 = v[4], y2 = v[5],\n\t\t\t\tx3 = v[6], y3 = v[7],\n\t\t\t\ta1 = x0 * (y3 - y2) + y0 * (x2 - x3) + x3 * y2 - y3 * x2,\n\t\t\t\ta2 = x1 * (y0 - y3) + y1 * (x3 - x0) + x0 * y3 - y0 * x3,\n\t\t\t\ta3 = x2 * (y1 - y0) + y2 * (x0 - x1) + x1 * y0 - y1 * x0,\n\t\t\t\td3 = 3 * a3,\n\t\t\t\td2 = d3 - a2,\n\t\t\t\td1 = d2 - a2 + a1,\n\t\t\t\tl = Math.sqrt(d1 * d1 + d2 * d2 + d3 * d3),\n\t\t\t\ts = l !== 0 ? 1 / l : 0,\n\t\t\t\tisZero = Numerical.isZero,\n\t\t\t\tserpentine = 'serpentine';\n\t\t\td1 *= s;\n\t\t\td2 *= s;\n\t\t\td3 *= s;\n\n\t\t\tfunction type(type, t1, t2) {\n\t\t\t\tvar hasRoots = t1 !== undefined,\n\t\t\t\t\tt1Ok = hasRoots && t1 > 0 && t1 < 1,\n\t\t\t\t\tt2Ok = hasRoots && t2 > 0 && t2 < 1;\n\t\t\t\tif (hasRoots && (!(t1Ok || t2Ok)\n\t\t\t\t\t\t|| type === 'loop' && !(t1Ok && t2Ok))) {\n\t\t\t\t\ttype = 'arch';\n\t\t\t\t\tt1Ok = t2Ok = false;\n\t\t\t\t}\n\t\t\t\treturn {\n\t\t\t\t\ttype: type,\n\t\t\t\t\troots: t1Ok || t2Ok\n\t\t\t\t\t\t\t? t1Ok && t2Ok\n\t\t\t\t\t\t\t\t? t1 < t2 ? [t1, t2] : [t2, t1]\n\t\t\t\t\t\t\t\t: [t1Ok ? t1 : t2]\n\t\t\t\t\t\t\t: null\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tif (isZero(d1)) {\n\t\t\t\treturn isZero(d2)\n\t\t\t\t\t\t? type(isZero(d3) ? 'line' : 'quadratic')\n\t\t\t\t\t\t: type(serpentine, d3 / (3 * d2));\n\t\t\t}\n\t\t\tvar d = 3 * d2 * d2 - 4 * d1 * d3;\n\t\t\tif (isZero(d)) {\n\t\t\t\treturn type('cusp', d2 / (2 * d1));\n\t\t\t}\n\t\t\tvar f1 = d > 0 ? Math.sqrt(d / 3) : Math.sqrt(-d),\n\t\t\t\tf2 = 2 * d1;\n\t\t\treturn type(d > 0 ? serpentine : 'loop',\n\t\t\t\t\t(d2 + f1) / f2,\n\t\t\t\t\t(d2 - f1) / f2);\n\t\t},\n\n\t\tgetLength: function(v, a, b, ds) {\n\t\t\tif (a === undefined)\n\t\t\t\ta = 0;\n\t\t\tif (b === undefined)\n\t\t\t\tb = 1;\n\t\t\tif (Curve.isStraight(v)) {\n\t\t\t\tvar c = v;\n\t\t\t\tif (b < 1) {\n\t\t\t\t\tc = Curve.subdivide(c, b)[0];\n\t\t\t\t\ta /= b;\n\t\t\t\t}\n\t\t\t\tif (a > 0) {\n\t\t\t\t\tc = Curve.subdivide(c, a)[1];\n\t\t\t\t}\n\t\t\t\tvar dx = c[6] - c[0],\n\t\t\t\t\tdy = c[7] - c[1];\n\t\t\t\treturn Math.sqrt(dx * dx + dy * dy);\n\t\t\t}\n\t\t\treturn Numerical.integrate(ds || getLengthIntegrand(v), a, b,\n\t\t\t\t\tgetIterations(a, b));\n\t\t},\n\n\t\tgetTimeAt: function(v, offset, start) {\n\t\t\tif (start === undefined)\n\t\t\t\tstart = offset < 0 ? 1 : 0;\n\t\t\tif (offset === 0)\n\t\t\t\treturn start;\n\t\t\tvar abs = Math.abs,\n\t\t\t\tepsilon = 1e-12,\n\t\t\t\tforward = offset > 0,\n\t\t\t\ta = forward ? start : 0,\n\t\t\t\tb = forward ? 1 : start,\n\t\t\t\tds = getLengthIntegrand(v),\n\t\t\t\trangeLength = Curve.getLength(v, a, b, ds),\n\t\t\t\tdiff = abs(offset) - rangeLength;\n\t\t\tif (abs(diff) < epsilon) {\n\t\t\t\treturn forward ? b : a;\n\t\t\t} else if (diff > epsilon) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tvar guess = offset / rangeLength,\n\t\t\t\tlength = 0;\n\t\t\tfunction f(t) {\n\t\t\t\tlength += Numerical.integrate(ds, start, t,\n\t\t\t\t\t\tgetIterations(start, t));\n\t\t\t\tstart = t;\n\t\t\t\treturn length - offset;\n\t\t\t}\n\t\t\treturn Numerical.findRoot(f, ds, start + guess, a, b, 32,\n\t\t\t\t\t1e-12);\n\t\t},\n\n\t\tgetPoint: function(v, t) {\n\t\t\treturn evaluate(v, t, 0, false);\n\t\t},\n\n\t\tgetTangent: function(v, t) {\n\t\t\treturn evaluate(v, t, 1, true);\n\t\t},\n\n\t\tgetWeightedTangent: function(v, t) {\n\t\t\treturn evaluate(v, t, 1, false);\n\t\t},\n\n\t\tgetNormal: function(v, t) {\n\t\t\treturn evaluate(v, t, 2, true);\n\t\t},\n\n\t\tgetWeightedNormal: function(v, t) {\n\t\t\treturn evaluate(v, t, 2, false);\n\t\t},\n\n\t\tgetCurvature: function(v, t) {\n\t\t\treturn evaluate(v, t, 3, false).x;\n\t\t},\n\n\t\tgetPeaks: function(v) {\n\t\t\tvar x0 = v[0], y0 = v[1],\n\t\t\t\tx1 = v[2], y1 = v[3],\n\t\t\t\tx2 = v[4], y2 = v[5],\n\t\t\t\tx3 = v[6], y3 = v[7],\n\t\t\t\tax =     -x0 + 3 * x1 - 3 * x2 + x3,\n\t\t\t\tbx =  3 * x0 - 6 * x1 + 3 * x2,\n\t\t\t\tcx = -3 * x0 + 3 * x1,\n\t\t\t\tay =     -y0 + 3 * y1 - 3 * y2 + y3,\n\t\t\t\tby =  3 * y0 - 6 * y1 + 3 * y2,\n\t\t\t\tcy = -3 * y0 + 3 * y1,\n\t\t\t\ttMin = 1e-8,\n\t\t\t\ttMax = 1 - tMin,\n\t\t\t\troots = [];\n\t\t\tNumerical.solveCubic(\n\t\t\t\t\t9 * (ax * ax + ay * ay),\n\t\t\t\t\t9 * (ax * bx + by * ay),\n\t\t\t\t\t2 * (bx * bx + by * by) + 3 * (cx * ax + cy * ay),\n\t\t\t\t\t(cx * bx + by * cy),\n\t\t\t\t\troots, tMin, tMax);\n\t\t\treturn roots.sort();\n\t\t}\n\t}};\n},\nnew function() {\n\n\tfunction addLocation(locations, include, c1, t1, c2, t2, overlap) {\n\t\tvar excludeStart = !overlap && c1.getPrevious() === c2,\n\t\t\texcludeEnd = !overlap && c1 !== c2 && c1.getNext() === c2,\n\t\t\ttMin = 1e-8,\n\t\t\ttMax = 1 - tMin;\n\t\tif (t1 !== null && t1 >= (excludeStart ? tMin : 0) &&\n\t\t\tt1 <= (excludeEnd ? tMax : 1)) {\n\t\t\tif (t2 !== null && t2 >= (excludeEnd ? tMin : 0) &&\n\t\t\t\tt2 <= (excludeStart ? tMax : 1)) {\n\t\t\t\tvar loc1 = new CurveLocation(c1, t1, null, overlap),\n\t\t\t\t\tloc2 = new CurveLocation(c2, t2, null, overlap);\n\t\t\t\tloc1._intersection = loc2;\n\t\t\t\tloc2._intersection = loc1;\n\t\t\t\tif (!include || include(loc1)) {\n\t\t\t\t\tCurveLocation.insert(locations, loc1, true);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction addCurveIntersections(v1, v2, c1, c2, locations, include, flip,\n\t\t\trecursion, calls, tMin, tMax, uMin, uMax) {\n\t\tif (++calls >= 4096 || ++recursion >= 40)\n\t\t\treturn calls;\n\t\tvar fatLineEpsilon = 1e-9,\n\t\t\tq0x = v2[0], q0y = v2[1], q3x = v2[6], q3y = v2[7],\n\t\t\tgetSignedDistance = Line.getSignedDistance,\n\t\t\td1 = getSignedDistance(q0x, q0y, q3x, q3y, v2[2], v2[3]),\n\t\t\td2 = getSignedDistance(q0x, q0y, q3x, q3y, v2[4], v2[5]),\n\t\t\tfactor = d1 * d2 > 0 ? 3 / 4 : 4 / 9,\n\t\t\tdMin = factor * Math.min(0, d1, d2),\n\t\t\tdMax = factor * Math.max(0, d1, d2),\n\t\t\tdp0 = getSignedDistance(q0x, q0y, q3x, q3y, v1[0], v1[1]),\n\t\t\tdp1 = getSignedDistance(q0x, q0y, q3x, q3y, v1[2], v1[3]),\n\t\t\tdp2 = getSignedDistance(q0x, q0y, q3x, q3y, v1[4], v1[5]),\n\t\t\tdp3 = getSignedDistance(q0x, q0y, q3x, q3y, v1[6], v1[7]),\n\t\t\thull = getConvexHull(dp0, dp1, dp2, dp3),\n\t\t\ttop = hull[0],\n\t\t\tbottom = hull[1],\n\t\t\ttMinClip,\n\t\t\ttMaxClip;\n\t\tif (d1 === 0 && d2 === 0\n\t\t\t\t&& dp0 === 0 && dp1 === 0 && dp2 === 0 && dp3 === 0\n\t\t\t|| (tMinClip = clipConvexHull(top, bottom, dMin, dMax)) == null\n\t\t\t|| (tMaxClip = clipConvexHull(top.reverse(), bottom.reverse(),\n\t\t\t\tdMin, dMax)) == null)\n\t\t\treturn calls;\n\t\tvar tMinNew = tMin + (tMax - tMin) * tMinClip,\n\t\t\ttMaxNew = tMin + (tMax - tMin) * tMaxClip;\n\t\tif (Math.max(uMax - uMin, tMaxNew - tMinNew) < fatLineEpsilon) {\n\t\t\tvar t = (tMinNew + tMaxNew) / 2,\n\t\t\t\tu = (uMin + uMax) / 2;\n\t\t\taddLocation(locations, include,\n\t\t\t\t\tflip ? c2 : c1, flip ? u : t,\n\t\t\t\t\tflip ? c1 : c2, flip ? t : u);\n\t\t} else {\n\t\t\tv1 = Curve.getPart(v1, tMinClip, tMaxClip);\n\t\t\tif (tMaxClip - tMinClip > 0.8) {\n\t\t\t\tif (tMaxNew - tMinNew > uMax - uMin) {\n\t\t\t\t\tvar parts = Curve.subdivide(v1, 0.5),\n\t\t\t\t\t\tt = (tMinNew + tMaxNew) / 2;\n\t\t\t\t\tcalls = addCurveIntersections(\n\t\t\t\t\t\t\tv2, parts[0], c2, c1, locations, include, !flip,\n\t\t\t\t\t\t\trecursion, calls, uMin, uMax, tMinNew, t);\n\t\t\t\t\tcalls = addCurveIntersections(\n\t\t\t\t\t\t\tv2, parts[1], c2, c1, locations, include, !flip,\n\t\t\t\t\t\t\trecursion, calls, uMin, uMax, t, tMaxNew);\n\t\t\t\t} else {\n\t\t\t\t\tvar parts = Curve.subdivide(v2, 0.5),\n\t\t\t\t\t\tu = (uMin + uMax) / 2;\n\t\t\t\t\tcalls = addCurveIntersections(\n\t\t\t\t\t\t\tparts[0], v1, c2, c1, locations, include, !flip,\n\t\t\t\t\t\t\trecursion, calls, uMin, u, tMinNew, tMaxNew);\n\t\t\t\t\tcalls = addCurveIntersections(\n\t\t\t\t\t\t\tparts[1], v1, c2, c1, locations, include, !flip,\n\t\t\t\t\t\t\trecursion, calls, u, uMax, tMinNew, tMaxNew);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (uMax - uMin >= fatLineEpsilon) {\n\t\t\t\t\tcalls = addCurveIntersections(\n\t\t\t\t\t\t\tv2, v1, c2, c1, locations, include, !flip,\n\t\t\t\t\t\t\trecursion, calls, uMin, uMax, tMinNew, tMaxNew);\n\t\t\t\t} else {\n\t\t\t\t\tcalls = addCurveIntersections(\n\t\t\t\t\t\t\tv1, v2, c1, c2, locations, include, flip,\n\t\t\t\t\t\t\trecursion, calls, tMinNew, tMaxNew, uMin, uMax);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn calls;\n\t}\n\n\tfunction getConvexHull(dq0, dq1, dq2, dq3) {\n\t\tvar p0 = [ 0, dq0 ],\n\t\t\tp1 = [ 1 / 3, dq1 ],\n\t\t\tp2 = [ 2 / 3, dq2 ],\n\t\t\tp3 = [ 1, dq3 ],\n\t\t\tdist1 = dq1 - (2 * dq0 + dq3) / 3,\n\t\t\tdist2 = dq2 - (dq0 + 2 * dq3) / 3,\n\t\t\thull;\n\t\tif (dist1 * dist2 < 0) {\n\t\t\thull = [[p0, p1, p3], [p0, p2, p3]];\n\t\t} else {\n\t\t\tvar distRatio = dist1 / dist2;\n\t\t\thull = [\n\t\t\t\tdistRatio >= 2 ? [p0, p1, p3]\n\t\t\t\t: distRatio <= 0.5 ? [p0, p2, p3]\n\t\t\t\t: [p0, p1, p2, p3],\n\t\t\t\t[p0, p3]\n\t\t\t];\n\t\t}\n\t\treturn (dist1 || dist2) < 0 ? hull.reverse() : hull;\n\t}\n\n\tfunction clipConvexHull(hullTop, hullBottom, dMin, dMax) {\n\t\tif (hullTop[0][1] < dMin) {\n\t\t\treturn clipConvexHullPart(hullTop, true, dMin);\n\t\t} else if (hullBottom[0][1] > dMax) {\n\t\t\treturn clipConvexHullPart(hullBottom, false, dMax);\n\t\t} else {\n\t\t\treturn hullTop[0][0];\n\t\t}\n\t}\n\n\tfunction clipConvexHullPart(part, top, threshold) {\n\t\tvar px = part[0][0],\n\t\t\tpy = part[0][1];\n\t\tfor (var i = 1, l = part.length; i < l; i++) {\n\t\t\tvar qx = part[i][0],\n\t\t\t\tqy = part[i][1];\n\t\t\tif (top ? qy >= threshold : qy <= threshold) {\n\t\t\t\treturn qy === threshold ? qx\n\t\t\t\t\t\t: px + (threshold - py) * (qx - px) / (qy - py);\n\t\t\t}\n\t\t\tpx = qx;\n\t\t\tpy = qy;\n\t\t}\n\t\treturn null;\n\t}\n\n\tfunction getCurveLineIntersections(v, px, py, vx, vy) {\n\t\tvar isZero = Numerical.isZero;\n\t\tif (isZero(vx) && isZero(vy)) {\n\t\t\tvar t = Curve.getTimeOf(v, new Point(px, py));\n\t\t\treturn t === null ? [] : [t];\n\t\t}\n\t\tvar angle = Math.atan2(-vy, vx),\n\t\t\tsin = Math.sin(angle),\n\t\t\tcos = Math.cos(angle),\n\t\t\trv = [],\n\t\t\troots = [];\n\t\tfor (var i = 0; i < 8; i += 2) {\n\t\t\tvar x = v[i] - px,\n\t\t\t\ty = v[i + 1] - py;\n\t\t\trv.push(\n\t\t\t\tx * cos - y * sin,\n\t\t\t\tx * sin + y * cos);\n\t\t}\n\t\tCurve.solveCubic(rv, 1, 0, roots, 0, 1);\n\t\treturn roots;\n\t}\n\n\tfunction addCurveLineIntersections(v1, v2, c1, c2, locations, include,\n\t\t\tflip) {\n\t\tvar x1 = v2[0], y1 = v2[1],\n\t\t\tx2 = v2[6], y2 = v2[7],\n\t\t\troots = getCurveLineIntersections(v1, x1, y1, x2 - x1, y2 - y1);\n\t\tfor (var i = 0, l = roots.length; i < l; i++) {\n\t\t\tvar t1 = roots[i],\n\t\t\t\tp1 = Curve.getPoint(v1, t1),\n\t\t\t\tt2 = Curve.getTimeOf(v2, p1);\n\t\t\tif (t2 !== null) {\n\t\t\t\taddLocation(locations, include,\n\t\t\t\t\t\tflip ? c2 : c1, flip ? t2 : t1,\n\t\t\t\t\t\tflip ? c1 : c2, flip ? t1 : t2);\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction addLineIntersection(v1, v2, c1, c2, locations, include) {\n\t\tvar pt = Line.intersect(\n\t\t\t\tv1[0], v1[1], v1[6], v1[7],\n\t\t\t\tv2[0], v2[1], v2[6], v2[7]);\n\t\tif (pt) {\n\t\t\taddLocation(locations, include,\n\t\t\t\t\tc1, Curve.getTimeOf(v1, pt),\n\t\t\t\t\tc2, Curve.getTimeOf(v2, pt));\n\t\t}\n\t}\n\n\tfunction getCurveIntersections(v1, v2, c1, c2, locations, include) {\n\t\tvar epsilon = 1e-12,\n\t\t\tmin = Math.min,\n\t\t\tmax = Math.max;\n\n\t\tif (max(v1[0], v1[2], v1[4], v1[6]) + epsilon >\n\t\t\tmin(v2[0], v2[2], v2[4], v2[6]) &&\n\t\t\tmin(v1[0], v1[2], v1[4], v1[6]) - epsilon <\n\t\t\tmax(v2[0], v2[2], v2[4], v2[6]) &&\n\t\t\tmax(v1[1], v1[3], v1[5], v1[7]) + epsilon >\n\t\t\tmin(v2[1], v2[3], v2[5], v2[7]) &&\n\t\t\tmin(v1[1], v1[3], v1[5], v1[7]) - epsilon <\n\t\t\tmax(v2[1], v2[3], v2[5], v2[7])) {\n\t\t\tvar overlaps = getOverlaps(v1, v2);\n\t\t\tif (overlaps) {\n\t\t\t\tfor (var i = 0; i < 2; i++) {\n\t\t\t\t\tvar overlap = overlaps[i];\n\t\t\t\t\taddLocation(locations, include,\n\t\t\t\t\t\t\tc1, overlap[0],\n\t\t\t\t\t\t\tc2, overlap[1], true);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tvar straight1 = Curve.isStraight(v1),\n\t\t\t\t\tstraight2 = Curve.isStraight(v2),\n\t\t\t\t\tstraight = straight1 && straight2,\n\t\t\t\t\tflip = straight1 && !straight2,\n\t\t\t\t\tbefore = locations.length;\n\t\t\t\t(straight\n\t\t\t\t\t? addLineIntersection\n\t\t\t\t\t: straight1 || straight2\n\t\t\t\t\t\t? addCurveLineIntersections\n\t\t\t\t\t\t: addCurveIntersections)(\n\t\t\t\t\t\t\tflip ? v2 : v1, flip ? v1 : v2,\n\t\t\t\t\t\t\tflip ? c2 : c1, flip ? c1 : c2,\n\t\t\t\t\t\t\tlocations, include, flip,\n\t\t\t\t\t\t\t0, 0, 0, 1, 0, 1);\n\t\t\t\tif (!straight || locations.length === before) {\n\t\t\t\t\tfor (var i = 0; i < 4; i++) {\n\t\t\t\t\t\tvar t1 = i >> 1,\n\t\t\t\t\t\t\tt2 = i & 1,\n\t\t\t\t\t\t\ti1 = t1 * 6,\n\t\t\t\t\t\t\ti2 = t2 * 6,\n\t\t\t\t\t\t\tp1 = new Point(v1[i1], v1[i1 + 1]),\n\t\t\t\t\t\t\tp2 = new Point(v2[i2], v2[i2 + 1]);\n\t\t\t\t\t\tif (p1.isClose(p2, epsilon)) {\n\t\t\t\t\t\t\taddLocation(locations, include,\n\t\t\t\t\t\t\t\t\tc1, t1,\n\t\t\t\t\t\t\t\t\tc2, t2);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn locations;\n\t}\n\n\tfunction getLoopIntersection(v1, c1, locations, include) {\n\t\tvar info = Curve.classify(v1);\n\t\tif (info.type === 'loop') {\n\t\t\tvar roots = info.roots;\n\t\t\taddLocation(locations, include,\n\t\t\t\t\tc1, roots[0],\n\t\t\t\t\tc1, roots[1]);\n\t\t}\n\t  return locations;\n\t}\n\n\tfunction getIntersections(curves1, curves2, include, matrix1, matrix2,\n\t\t\t_returnFirst) {\n\t\tvar self = !curves2;\n\t\tif (self)\n\t\t\tcurves2 = curves1;\n\t\tvar length1 = curves1.length,\n\t\t\tlength2 = curves2.length,\n\t\t\tvalues2 = [],\n\t\t\tarrays = [],\n\t\t\tlocations,\n\t\t\tcurrent;\n\t\tfor (var i = 0; i < length2; i++)\n\t\t\tvalues2[i] = curves2[i].getValues(matrix2);\n\t\tfor (var i = 0; i < length1; i++) {\n\t\t\tvar curve1 = curves1[i],\n\t\t\t\tvalues1 = self ? values2[i] : curve1.getValues(matrix1),\n\t\t\t\tpath1 = curve1.getPath();\n\t\t\tif (path1 !== current) {\n\t\t\t\tcurrent = path1;\n\t\t\t\tlocations = [];\n\t\t\t\tarrays.push(locations);\n\t\t\t}\n\t\t\tif (self) {\n\t\t\t\tgetLoopIntersection(values1, curve1, locations, include);\n\t\t\t}\n\t\t\tfor (var j = self ? i + 1 : 0; j < length2; j++) {\n\t\t\t\tif (_returnFirst && locations.length)\n\t\t\t\t\treturn locations;\n\t\t\t\tgetCurveIntersections(values1, values2[j], curve1, curves2[j],\n\t\t\t\t\t\tlocations, include);\n\t\t\t}\n\t\t}\n\t\tlocations = [];\n\t\tfor (var i = 0, l = arrays.length; i < l; i++) {\n\t\t\tBase.push(locations, arrays[i]);\n\t\t}\n\t\treturn locations;\n\t}\n\n\tfunction getOverlaps(v1, v2) {\n\n\t\tfunction getSquaredLineLength(v) {\n\t\t\tvar x = v[6] - v[0],\n\t\t\t\ty = v[7] - v[1];\n\t\t\treturn x * x + y * y;\n\t\t}\n\n\t\tvar abs = Math.abs,\n\t\t\tgetDistance = Line.getDistance,\n\t\t\ttimeEpsilon = 1e-8,\n\t\t\tgeomEpsilon = 1e-7,\n\t\t\tstraight1 = Curve.isStraight(v1),\n\t\t\tstraight2 = Curve.isStraight(v2),\n\t\t\tstraightBoth = straight1 && straight2,\n\t\t\tflip = getSquaredLineLength(v1) < getSquaredLineLength(v2),\n\t\t\tl1 = flip ? v2 : v1,\n\t\t\tl2 = flip ? v1 : v2,\n\t\t\tpx = l1[0], py = l1[1],\n\t\t\tvx = l1[6] - px, vy = l1[7] - py;\n\t\tif (getDistance(px, py, vx, vy, l2[0], l2[1], true) < geomEpsilon &&\n\t\t\tgetDistance(px, py, vx, vy, l2[6], l2[7], true) < geomEpsilon) {\n\t\t\tif (!straightBoth &&\n\t\t\t\tgetDistance(px, py, vx, vy, l1[2], l1[3], true) < geomEpsilon &&\n\t\t\t\tgetDistance(px, py, vx, vy, l1[4], l1[5], true) < geomEpsilon &&\n\t\t\t\tgetDistance(px, py, vx, vy, l2[2], l2[3], true) < geomEpsilon &&\n\t\t\t\tgetDistance(px, py, vx, vy, l2[4], l2[5], true) < geomEpsilon) {\n\t\t\t\tstraight1 = straight2 = straightBoth = true;\n\t\t\t}\n\t\t} else if (straightBoth) {\n\t\t\treturn null;\n\t\t}\n\t\tif (straight1 ^ straight2) {\n\t\t\treturn null;\n\t\t}\n\n\t\tvar v = [v1, v2],\n\t\t\tpairs = [];\n\t\tfor (var i = 0; i < 4 && pairs.length < 2; i++) {\n\t\t\tvar i1 = i & 1,\n\t\t\t\ti2 = i1 ^ 1,\n\t\t\t\tt1 = i >> 1,\n\t\t\t\tt2 = Curve.getTimeOf(v[i1], new Point(\n\t\t\t\t\tv[i2][t1 ? 6 : 0],\n\t\t\t\t\tv[i2][t1 ? 7 : 1]));\n\t\t\tif (t2 != null) {\n\t\t\t\tvar pair = i1 ? [t1, t2] : [t2, t1];\n\t\t\t\tif (!pairs.length ||\n\t\t\t\t\tabs(pair[0] - pairs[0][0]) > timeEpsilon &&\n\t\t\t\t\tabs(pair[1] - pairs[0][1]) > timeEpsilon) {\n\t\t\t\t\tpairs.push(pair);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (i > 2 && !pairs.length)\n\t\t\t\tbreak;\n\t\t}\n\t\tif (pairs.length !== 2) {\n\t\t\tpairs = null;\n\t\t} else if (!straightBoth) {\n\t\t\tvar o1 = Curve.getPart(v1, pairs[0][0], pairs[1][0]),\n\t\t\t\to2 = Curve.getPart(v2, pairs[0][1], pairs[1][1]);\n\t\t\tif (abs(o2[2] - o1[2]) > geomEpsilon ||\n\t\t\t\tabs(o2[3] - o1[3]) > geomEpsilon ||\n\t\t\t\tabs(o2[4] - o1[4]) > geomEpsilon ||\n\t\t\t\tabs(o2[5] - o1[5]) > geomEpsilon)\n\t\t\t\tpairs = null;\n\t\t}\n\t\treturn pairs;\n\t}\n\n\tfunction getTimesWithTangent(v, tangent) {\n\t\tvar x0 = v[0], y0 = v[1],\n\t\t\tx1 = v[2], y1 = v[3],\n\t\t\tx2 = v[4], y2 = v[5],\n\t\t\tx3 = v[6], y3 = v[7],\n\t\t\tnormalized = tangent.normalize(),\n\t\t\ttx = normalized.x,\n\t\t\tty = normalized.y,\n\t\t\tax = 3 * x3 - 9 * x2 + 9 * x1 - 3 * x0,\n\t\t\tay = 3 * y3 - 9 * y2 + 9 * y1 - 3 * y0,\n\t\t\tbx = 6 * x2 - 12 * x1 + 6 * x0,\n\t\t\tby = 6 * y2 - 12 * y1 + 6 * y0,\n\t\t\tcx = 3 * x1 - 3 * x0,\n\t\t\tcy = 3 * y1 - 3 * y0,\n\t\t\tden = 2 * ax * ty - 2 * ay * tx,\n\t\t\ttimes = [];\n\t\tif (Math.abs(den) < Numerical.CURVETIME_EPSILON) {\n\t\t\tvar num = ax * cy - ay * cx,\n\t\t\t\tden = ax * by - ay * bx;\n\t\t\tif (den != 0) {\n\t\t\t\tvar t = -num / den;\n\t\t\t\tif (t >= 0 && t <= 1) times.push(t);\n\t\t\t}\n\t\t} else {\n\t\t\tvar delta = (bx * bx - 4 * ax * cx) * ty * ty +\n\t\t\t\t(-2 * bx * by + 4 * ay * cx + 4 * ax * cy) * tx * ty +\n\t\t\t\t(by * by - 4 * ay * cy) * tx * tx,\n\t\t\t\tk = bx * ty - by * tx;\n\t\t\tif (delta >= 0 && den != 0) {\n\t\t\t\tvar d = Math.sqrt(delta),\n\t\t\t\t\tt0 = -(k + d) / den,\n\t\t\t\t\tt1 = (-k + d) / den;\n\t\t\t\tif (t0 >= 0 && t0 <= 1) times.push(t0);\n\t\t\t\tif (t1 >= 0 && t1 <= 1) times.push(t1);\n\t\t\t}\n\t\t}\n\t\treturn times;\n\t}\n\n\treturn {\n\t\tgetIntersections: function(curve) {\n\t\t\tvar v1 = this.getValues(),\n\t\t\t\tv2 = curve && curve !== this && curve.getValues();\n\t\t\treturn v2 ? getCurveIntersections(v1, v2, this, curve, [])\n\t\t\t\t\t  : getLoopIntersection(v1, this, []);\n\t\t},\n\n\t\tstatics: {\n\t\t\tgetOverlaps: getOverlaps,\n\t\t\tgetIntersections: getIntersections,\n\t\t\tgetCurveLineIntersections: getCurveLineIntersections,\n\t\t\tgetTimesWithTangent: getTimesWithTangent\n\t\t}\n\t};\n});\n\nvar CurveLocation = Base.extend({\n\t_class: 'CurveLocation',\n\n\tinitialize: function CurveLocation(curve, time, point, _overlap, _distance) {\n\t\tif (time >= 0.99999999) {\n\t\t\tvar next = curve.getNext();\n\t\t\tif (next) {\n\t\t\t\ttime = 0;\n\t\t\t\tcurve = next;\n\t\t\t}\n\t\t}\n\t\tthis._setCurve(curve);\n\t\tthis._time = time;\n\t\tthis._point = point || curve.getPointAtTime(time);\n\t\tthis._overlap = _overlap;\n\t\tthis._distance = _distance;\n\t\tthis._intersection = this._next = this._previous = null;\n\t},\n\n\t_setCurve: function(curve) {\n\t\tvar path = curve._path;\n\t\tthis._path = path;\n\t\tthis._version = path ? path._version : 0;\n\t\tthis._curve = curve;\n\t\tthis._segment = null;\n\t\tthis._segment1 = curve._segment1;\n\t\tthis._segment2 = curve._segment2;\n\t},\n\n\t_setSegment: function(segment) {\n\t\tthis._setCurve(segment.getCurve());\n\t\tthis._segment = segment;\n\t\tthis._time = segment === this._segment1 ? 0 : 1;\n\t\tthis._point = segment._point.clone();\n\t},\n\n\tgetSegment: function() {\n\t\tvar segment = this._segment;\n\t\tif (!segment) {\n\t\t\tvar curve = this.getCurve(),\n\t\t\t\ttime = this.getTime();\n\t\t\tif (time === 0) {\n\t\t\t\tsegment = curve._segment1;\n\t\t\t} else if (time === 1) {\n\t\t\t\tsegment = curve._segment2;\n\t\t\t} else if (time != null) {\n\t\t\t\tsegment = curve.getPartLength(0, time)\n\t\t\t\t\t< curve.getPartLength(time, 1)\n\t\t\t\t\t\t? curve._segment1\n\t\t\t\t\t\t: curve._segment2;\n\t\t\t}\n\t\t\tthis._segment = segment;\n\t\t}\n\t\treturn segment;\n\t},\n\n\tgetCurve: function() {\n\t\tvar path = this._path,\n\t\t\tthat = this;\n\t\tif (path && path._version !== this._version) {\n\t\t\tthis._time = this._offset = this._curveOffset = this._curve = null;\n\t\t}\n\n\t\tfunction trySegment(segment) {\n\t\t\tvar curve = segment && segment.getCurve();\n\t\t\tif (curve && (that._time = curve.getTimeOf(that._point)) != null) {\n\t\t\t\tthat._setCurve(curve);\n\t\t\t\treturn curve;\n\t\t\t}\n\t\t}\n\n\t\treturn this._curve\n\t\t\t|| trySegment(this._segment)\n\t\t\t|| trySegment(this._segment1)\n\t\t\t|| trySegment(this._segment2.getPrevious());\n\t},\n\n\tgetPath: function() {\n\t\tvar curve = this.getCurve();\n\t\treturn curve && curve._path;\n\t},\n\n\tgetIndex: function() {\n\t\tvar curve = this.getCurve();\n\t\treturn curve && curve.getIndex();\n\t},\n\n\tgetTime: function() {\n\t\tvar curve = this.getCurve(),\n\t\t\ttime = this._time;\n\t\treturn curve && time == null\n\t\t\t? this._time = curve.getTimeOf(this._point)\n\t\t\t: time;\n\t},\n\n\tgetParameter: '#getTime',\n\n\tgetPoint: function() {\n\t\treturn this._point;\n\t},\n\n\tgetOffset: function() {\n\t\tvar offset = this._offset;\n\t\tif (offset == null) {\n\t\t\toffset = 0;\n\t\t\tvar path = this.getPath(),\n\t\t\t\tindex = this.getIndex();\n\t\t\tif (path && index != null) {\n\t\t\t\tvar curves = path.getCurves();\n\t\t\t\tfor (var i = 0; i < index; i++)\n\t\t\t\t\toffset += curves[i].getLength();\n\t\t\t}\n\t\t\tthis._offset = offset += this.getCurveOffset();\n\t\t}\n\t\treturn offset;\n\t},\n\n\tgetCurveOffset: function() {\n\t\tvar offset = this._curveOffset;\n\t\tif (offset == null) {\n\t\t\tvar curve = this.getCurve(),\n\t\t\t\ttime = this.getTime();\n\t\t\tthis._curveOffset = offset = time != null && curve\n\t\t\t\t\t&& curve.getPartLength(0, time);\n\t\t}\n\t\treturn offset;\n\t},\n\n\tgetIntersection: function() {\n\t\treturn this._intersection;\n\t},\n\n\tgetDistance: function() {\n\t\treturn this._distance;\n\t},\n\n\tdivide: function() {\n\t\tvar curve = this.getCurve(),\n\t\t\tres = curve && curve.divideAtTime(this.getTime());\n\t\tif (res) {\n\t\t\tthis._setSegment(res._segment1);\n\t\t}\n\t\treturn res;\n\t},\n\n\tsplit: function() {\n\t\tvar curve = this.getCurve(),\n\t\t\tpath = curve._path,\n\t\t\tres = curve && curve.splitAtTime(this.getTime());\n\t\tif (res) {\n\t\t\tthis._setSegment(path.getLastSegment());\n\t\t}\n\t\treturn  res;\n\t},\n\n\tequals: function(loc, _ignoreOther) {\n\t\tvar res = this === loc;\n\t\tif (!res && loc instanceof CurveLocation) {\n\t\t\tvar c1 = this.getCurve(),\n\t\t\t\tc2 = loc.getCurve(),\n\t\t\t\tp1 = c1._path,\n\t\t\t\tp2 = c2._path;\n\t\t\tif (p1 === p2) {\n\t\t\t\tvar abs = Math.abs,\n\t\t\t\t\tepsilon = 1e-7,\n\t\t\t\t\tdiff = abs(this.getOffset() - loc.getOffset()),\n\t\t\t\t\ti1 = !_ignoreOther && this._intersection,\n\t\t\t\t\ti2 = !_ignoreOther && loc._intersection;\n\t\t\t\tres = (diff < epsilon\n\t\t\t\t\t\t|| p1 && abs(p1.getLength() - diff) < epsilon)\n\t\t\t\t\t&& (!i1 && !i2 || i1 && i2 && i1.equals(i2, true));\n\t\t\t}\n\t\t}\n\t\treturn res;\n\t},\n\n\ttoString: function() {\n\t\tvar parts = [],\n\t\t\tpoint = this.getPoint(),\n\t\t\tf = Formatter.instance;\n\t\tif (point)\n\t\t\tparts.push('point: ' + point);\n\t\tvar index = this.getIndex();\n\t\tif (index != null)\n\t\t\tparts.push('index: ' + index);\n\t\tvar time = this.getTime();\n\t\tif (time != null)\n\t\t\tparts.push('time: ' + f.number(time));\n\t\tif (this._distance != null)\n\t\t\tparts.push('distance: ' + f.number(this._distance));\n\t\treturn '{ ' + parts.join(', ') + ' }';\n\t},\n\n\tisTouching: function() {\n\t\tvar inter = this._intersection;\n\t\tif (inter && this.getTangent().isCollinear(inter.getTangent())) {\n\t\t\tvar curve1 = this.getCurve(),\n\t\t\t\tcurve2 = inter.getCurve();\n\t\t\treturn !(curve1.isStraight() && curve2.isStraight()\n\t\t\t\t\t&& curve1.getLine().intersect(curve2.getLine()));\n\t\t}\n\t\treturn false;\n\t},\n\n\tisCrossing: function() {\n\t\tvar inter = this._intersection;\n\t\tif (!inter)\n\t\t\treturn false;\n\t\tvar t1 = this.getTime(),\n\t\t\tt2 = inter.getTime(),\n\t\t\ttMin = 1e-8,\n\t\t\ttMax = 1 - tMin,\n\t\t\tt1Inside = t1 >= tMin && t1 <= tMax,\n\t\t\tt2Inside = t2 >= tMin && t2 <= tMax;\n\t\tif (t1Inside && t2Inside)\n\t\t\treturn !this.isTouching();\n\t\tvar c2 = this.getCurve(),\n\t\t\tc1 = t1 < tMin ? c2.getPrevious() : c2,\n\t\t\tc4 = inter.getCurve(),\n\t\t\tc3 = t2 < tMin ? c4.getPrevious() : c4;\n\t\tif (t1 > tMax)\n\t\t\tc2 = c2.getNext();\n\t\tif (t2 > tMax)\n\t\t\tc4 = c4.getNext();\n\t\tif (!c1 || !c2 || !c3 || !c4)\n\t\t\treturn false;\n\n\t\tvar offsets = [];\n\n\t\tfunction addOffsets(curve, end) {\n\t\t\tvar v = curve.getValues(),\n\t\t\t\troots = Curve.classify(v).roots || Curve.getPeaks(v),\n\t\t\t\tcount = roots.length,\n\t\t\t\tt = end && count > 1 ? roots[count - 1]\n\t\t\t\t\t\t: count > 0 ? roots[0]\n\t\t\t\t\t\t: 0.5;\n\t\t\toffsets.push(Curve.getLength(v, end ? t : 0, end ? 1 : t) / 2);\n\t\t}\n\n\t\tfunction isInRange(angle, min, max) {\n\t\t\treturn min < max\n\t\t\t\t\t? angle > min && angle < max\n\t\t\t\t\t: angle > min || angle < max;\n\t\t}\n\n\t\tif (!t1Inside) {\n\t\t\taddOffsets(c1, true);\n\t\t\taddOffsets(c2, false);\n\t\t}\n\t\tif (!t2Inside) {\n\t\t\taddOffsets(c3, true);\n\t\t\taddOffsets(c4, false);\n\t\t}\n\t\tvar pt = this.getPoint(),\n\t\t\toffset = Math.min.apply(Math, offsets),\n\t\t\tv2 = t1Inside ? c2.getTangentAtTime(t1)\n\t\t\t\t\t: c2.getPointAt(offset).subtract(pt),\n\t\t\tv1 = t1Inside ? v2.negate()\n\t\t\t\t\t: c1.getPointAt(-offset).subtract(pt),\n\t\t\tv4 = t2Inside ? c4.getTangentAtTime(t2)\n\t\t\t\t\t: c4.getPointAt(offset).subtract(pt),\n\t\t\tv3 = t2Inside ? v4.negate()\n\t\t\t\t\t: c3.getPointAt(-offset).subtract(pt),\n\t\t\ta1 = v1.getAngle(),\n\t\t\ta2 = v2.getAngle(),\n\t\t\ta3 = v3.getAngle(),\n\t\t\ta4 = v4.getAngle();\n\t\treturn !!(t1Inside\n\t\t\t\t? (isInRange(a1, a3, a4) ^ isInRange(a2, a3, a4)) &&\n\t\t\t\t  (isInRange(a1, a4, a3) ^ isInRange(a2, a4, a3))\n\t\t\t\t: (isInRange(a3, a1, a2) ^ isInRange(a4, a1, a2)) &&\n\t\t\t\t  (isInRange(a3, a2, a1) ^ isInRange(a4, a2, a1)));\n\t},\n\n\thasOverlap: function() {\n\t\treturn !!this._overlap;\n\t}\n}, Base.each(Curve._evaluateMethods, function(name) {\n\tvar get = name + 'At';\n\tthis[name] = function() {\n\t\tvar curve = this.getCurve(),\n\t\t\ttime = this.getTime();\n\t\treturn time != null && curve && curve[get](time, true);\n\t};\n}, {\n\tpreserve: true\n}),\nnew function() {\n\n\tfunction insert(locations, loc, merge) {\n\t\tvar length = locations.length,\n\t\t\tl = 0,\n\t\t\tr = length - 1;\n\n\t\tfunction search(index, dir) {\n\t\t\tfor (var i = index + dir; i >= -1 && i <= length; i += dir) {\n\t\t\t\tvar loc2 = locations[((i % length) + length) % length];\n\t\t\t\tif (!loc.getPoint().isClose(loc2.getPoint(),\n\t\t\t\t\t\t1e-7))\n\t\t\t\t\tbreak;\n\t\t\t\tif (loc.equals(loc2))\n\t\t\t\t\treturn loc2;\n\t\t\t}\n\t\t\treturn null;\n\t\t}\n\n\t\twhile (l <= r) {\n\t\t\tvar m = (l + r) >>> 1,\n\t\t\t\tloc2 = locations[m],\n\t\t\t\tfound;\n\t\t\tif (merge && (found = loc.equals(loc2) ? loc2\n\t\t\t\t\t: (search(m, -1) || search(m, 1)))) {\n\t\t\t\tif (loc._overlap) {\n\t\t\t\t\tfound._overlap = found._intersection._overlap = true;\n\t\t\t\t}\n\t\t\t\treturn found;\n\t\t\t}\n\t\tvar path1 = loc.getPath(),\n\t\t\tpath2 = loc2.getPath(),\n\t\t\tdiff = path1 !== path2\n\t\t\t\t? path1._id - path2._id\n\t\t\t\t: (loc.getIndex() + loc.getTime())\n\t\t\t\t- (loc2.getIndex() + loc2.getTime());\n\t\t\tif (diff < 0) {\n\t\t\t\tr = m - 1;\n\t\t\t} else {\n\t\t\t\tl = m + 1;\n\t\t\t}\n\t\t}\n\t\tlocations.splice(l, 0, loc);\n\t\treturn loc;\n\t}\n\n\treturn { statics: {\n\t\tinsert: insert,\n\n\t\texpand: function(locations) {\n\t\t\tvar expanded = locations.slice();\n\t\t\tfor (var i = locations.length - 1; i >= 0; i--) {\n\t\t\t\tinsert(expanded, locations[i]._intersection, false);\n\t\t\t}\n\t\t\treturn expanded;\n\t\t}\n\t}};\n});\n\nvar PathItem = Item.extend({\n\t_class: 'PathItem',\n\t_selectBounds: false,\n\t_canScaleStroke: true,\n\tbeans: true,\n\n\tinitialize: function PathItem() {\n\t},\n\n\tstatics: {\n\t\tcreate: function(arg) {\n\t\t\tvar data,\n\t\t\t\tsegments,\n\t\t\t\tcompound;\n\t\t\tif (Base.isPlainObject(arg)) {\n\t\t\t\tsegments = arg.segments;\n\t\t\t\tdata = arg.pathData;\n\t\t\t} else if (Array.isArray(arg)) {\n\t\t\t\tsegments = arg;\n\t\t\t} else if (typeof arg === 'string') {\n\t\t\t\tdata = arg;\n\t\t\t}\n\t\t\tif (segments) {\n\t\t\t\tvar first = segments[0];\n\t\t\t\tcompound = first && Array.isArray(first[0]);\n\t\t\t} else if (data) {\n\t\t\t\tcompound = (data.match(/m/gi) || []).length > 1\n\t\t\t\t\t\t|| /z\\s*\\S+/i.test(data);\n\t\t\t}\n\t\t\tvar ctor = compound ? CompoundPath : Path;\n\t\t\treturn new ctor(arg);\n\t\t}\n\t},\n\n\t_asPathItem: function() {\n\t\treturn this;\n\t},\n\n\tisClockwise: function() {\n\t\treturn this.getArea() >= 0;\n\t},\n\n\tsetClockwise: function(clockwise) {\n\t\tif (this.isClockwise() != (clockwise = !!clockwise))\n\t\t\tthis.reverse();\n\t},\n\n\tsetPathData: function(data) {\n\n\t\tvar parts = data && data.match(/[mlhvcsqtaz][^mlhvcsqtaz]*/ig),\n\t\t\tcoords,\n\t\t\trelative = false,\n\t\t\tprevious,\n\t\t\tcontrol,\n\t\t\tcurrent = new Point(),\n\t\t\tstart = new Point();\n\n\t\tfunction getCoord(index, coord) {\n\t\t\tvar val = +coords[index];\n\t\t\tif (relative)\n\t\t\t\tval += current[coord];\n\t\t\treturn val;\n\t\t}\n\n\t\tfunction getPoint(index) {\n\t\t\treturn new Point(\n\t\t\t\tgetCoord(index, 'x'),\n\t\t\t\tgetCoord(index + 1, 'y')\n\t\t\t);\n\t\t}\n\n\t\tthis.clear();\n\n\t\tfor (var i = 0, l = parts && parts.length; i < l; i++) {\n\t\t\tvar part = parts[i],\n\t\t\t\tcommand = part[0],\n\t\t\t\tlower = command.toLowerCase();\n\t\t\tcoords = part.match(/[+-]?(?:\\d*\\.\\d+|\\d+\\.?)(?:[eE][+-]?\\d+)?/g);\n\t\t\tvar length = coords && coords.length;\n\t\t\trelative = command === lower;\n\t\t\tif (previous === 'z' && !/[mz]/.test(lower))\n\t\t\t\tthis.moveTo(current);\n\t\t\tswitch (lower) {\n\t\t\tcase 'm':\n\t\t\tcase 'l':\n\t\t\t\tvar move = lower === 'm';\n\t\t\t\tfor (var j = 0; j < length; j += 2) {\n\t\t\t\t\tthis[move ? 'moveTo' : 'lineTo'](current = getPoint(j));\n\t\t\t\t\tif (move) {\n\t\t\t\t\t\tstart = current;\n\t\t\t\t\t\tmove = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tcontrol = current;\n\t\t\t\tbreak;\n\t\t\tcase 'h':\n\t\t\tcase 'v':\n\t\t\t\tvar coord = lower === 'h' ? 'x' : 'y';\n\t\t\t\tcurrent = current.clone();\n\t\t\t\tfor (var j = 0; j < length; j++) {\n\t\t\t\t\tcurrent[coord] = getCoord(j, coord);\n\t\t\t\t\tthis.lineTo(current);\n\t\t\t\t}\n\t\t\t\tcontrol = current;\n\t\t\t\tbreak;\n\t\t\tcase 'c':\n\t\t\t\tfor (var j = 0; j < length; j += 6) {\n\t\t\t\t\tthis.cubicCurveTo(\n\t\t\t\t\t\t\tgetPoint(j),\n\t\t\t\t\t\t\tcontrol = getPoint(j + 2),\n\t\t\t\t\t\t\tcurrent = getPoint(j + 4));\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 's':\n\t\t\t\tfor (var j = 0; j < length; j += 4) {\n\t\t\t\t\tthis.cubicCurveTo(\n\t\t\t\t\t\t\t/[cs]/.test(previous)\n\t\t\t\t\t\t\t\t\t? current.multiply(2).subtract(control)\n\t\t\t\t\t\t\t\t\t: current,\n\t\t\t\t\t\t\tcontrol = getPoint(j),\n\t\t\t\t\t\t\tcurrent = getPoint(j + 2));\n\t\t\t\t\tprevious = lower;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'q':\n\t\t\t\tfor (var j = 0; j < length; j += 4) {\n\t\t\t\t\tthis.quadraticCurveTo(\n\t\t\t\t\t\t\tcontrol = getPoint(j),\n\t\t\t\t\t\t\tcurrent = getPoint(j + 2));\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 't':\n\t\t\t\tfor (var j = 0; j < length; j += 2) {\n\t\t\t\t\tthis.quadraticCurveTo(\n\t\t\t\t\t\t\tcontrol = (/[qt]/.test(previous)\n\t\t\t\t\t\t\t\t\t? current.multiply(2).subtract(control)\n\t\t\t\t\t\t\t\t\t: current),\n\t\t\t\t\t\t\tcurrent = getPoint(j));\n\t\t\t\t\tprevious = lower;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'a':\n\t\t\t\tfor (var j = 0; j < length; j += 7) {\n\t\t\t\t\tthis.arcTo(current = getPoint(j + 5),\n\t\t\t\t\t\t\tnew Size(+coords[j], +coords[j + 1]),\n\t\t\t\t\t\t\t+coords[j + 2], +coords[j + 4], +coords[j + 3]);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'z':\n\t\t\t\tthis.closePath(1e-12);\n\t\t\t\tcurrent = start;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprevious = lower;\n\t\t}\n\t},\n\n\t_canComposite: function() {\n\t\treturn !(this.hasFill() && this.hasStroke());\n\t},\n\n\t_contains: function(point) {\n\t\tvar winding = point.isInside(\n\t\t\t\tthis.getBounds({ internal: true, handle: true }))\n\t\t\t\t\t? this._getWinding(point)\n\t\t\t\t\t: {};\n\t\treturn winding.onPath || !!(this.getFillRule() === 'evenodd'\n\t\t\t\t? winding.windingL & 1 || winding.windingR & 1\n\t\t\t\t: winding.winding);\n\t},\n\n\tgetIntersections: function(path, include, _matrix, _returnFirst) {\n\t\tvar self = this === path || !path,\n\t\t\tmatrix1 = this._matrix._orNullIfIdentity(),\n\t\t\tmatrix2 = self ? matrix1\n\t\t\t\t: (_matrix || path._matrix)._orNullIfIdentity();\n\t\treturn self || this.getBounds(matrix1).intersects(\n\t\t\t\tpath.getBounds(matrix2), 1e-12)\n\t\t\t\t? Curve.getIntersections(\n\t\t\t\t\t\tthis.getCurves(), !self && path.getCurves(), include,\n\t\t\t\t\t\tmatrix1, matrix2, _returnFirst)\n\t\t\t\t: [];\n\t},\n\n\tgetCrossings: function(path) {\n\t\treturn this.getIntersections(path, function(inter) {\n\t\t\treturn inter.hasOverlap() || inter.isCrossing();\n\t\t});\n\t},\n\n\tgetNearestLocation: function() {\n\t\tvar point = Point.read(arguments),\n\t\t\tcurves = this.getCurves(),\n\t\t\tminDist = Infinity,\n\t\t\tminLoc = null;\n\t\tfor (var i = 0, l = curves.length; i < l; i++) {\n\t\t\tvar loc = curves[i].getNearestLocation(point);\n\t\t\tif (loc._distance < minDist) {\n\t\t\t\tminDist = loc._distance;\n\t\t\t\tminLoc = loc;\n\t\t\t}\n\t\t}\n\t\treturn minLoc;\n\t},\n\n\tgetNearestPoint: function() {\n\t\tvar loc = this.getNearestLocation.apply(this, arguments);\n\t\treturn loc ? loc.getPoint() : loc;\n\t},\n\n\tinterpolate: function(from, to, factor) {\n\t\tvar isPath = !this._children,\n\t\t\tname = isPath ? '_segments' : '_children',\n\t\t\titemsFrom = from[name],\n\t\t\titemsTo = to[name],\n\t\t\titems = this[name];\n\t\tif (!itemsFrom || !itemsTo || itemsFrom.length !== itemsTo.length) {\n\t\t\tthrow new Error('Invalid operands in interpolate() call: ' +\n\t\t\t\t\tfrom + ', ' + to);\n\t\t}\n\t\tvar current = items.length,\n\t\t\tlength = itemsTo.length;\n\t\tif (current < length) {\n\t\t\tvar ctor = isPath ? Segment : Path;\n\t\t\tfor (var i = current; i < length; i++) {\n\t\t\t\tthis.add(new ctor());\n\t\t\t}\n\t\t} else if (current > length) {\n\t\t\tthis[isPath ? 'removeSegments' : 'removeChildren'](length, current);\n\t\t}\n\t\tfor (var i = 0; i < length; i++) {\n\t\t\titems[i].interpolate(itemsFrom[i], itemsTo[i], factor);\n\t\t}\n\t\tif (isPath) {\n\t\t\tthis.setClosed(from._closed);\n\t\t\tthis._changed(9);\n\t\t}\n\t},\n\n\tcompare: function(path) {\n\t\tvar ok = false;\n\t\tif (path) {\n\t\t\tvar paths1 = this._children || [this],\n\t\t\t\tpaths2 = path._children ? path._children.slice() : [path],\n\t\t\t\tlength1 = paths1.length,\n\t\t\t\tlength2 = paths2.length,\n\t\t\t\tmatched = [],\n\t\t\t\tcount = 0;\n\t\t\tok = true;\n\t\t\tfor (var i1 = length1 - 1; i1 >= 0 && ok; i1--) {\n\t\t\t\tvar path1 = paths1[i1];\n\t\t\t\tok = false;\n\t\t\t\tfor (var i2 = length2 - 1; i2 >= 0 && !ok; i2--) {\n\t\t\t\t\tif (path1.compare(paths2[i2])) {\n\t\t\t\t\t\tif (!matched[i2]) {\n\t\t\t\t\t\t\tmatched[i2] = true;\n\t\t\t\t\t\t\tcount++;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tok = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tok = ok && count === length2;\n\t\t}\n\t\treturn ok;\n\t},\n\n});\n\nvar Path = PathItem.extend({\n\t_class: 'Path',\n\t_serializeFields: {\n\t\tsegments: [],\n\t\tclosed: false\n\t},\n\n\tinitialize: function Path(arg) {\n\t\tthis._closed = false;\n\t\tthis._segments = [];\n\t\tthis._version = 0;\n\t\tvar segments = Array.isArray(arg)\n\t\t\t? typeof arg[0] === 'object'\n\t\t\t\t? arg\n\t\t\t\t: arguments\n\t\t\t: arg && (arg.size === undefined && (arg.x !== undefined\n\t\t\t\t\t|| arg.point !== undefined))\n\t\t\t\t? arguments\n\t\t\t\t: null;\n\t\tif (segments && segments.length > 0) {\n\t\t\tthis.setSegments(segments);\n\t\t} else {\n\t\t\tthis._curves = undefined;\n\t\t\tthis._segmentSelection = 0;\n\t\t\tif (!segments && typeof arg === 'string') {\n\t\t\t\tthis.setPathData(arg);\n\t\t\t\targ = null;\n\t\t\t}\n\t\t}\n\t\tthis._initialize(!segments && arg);\n\t},\n\n\t_equals: function(item) {\n\t\treturn this._closed === item._closed\n\t\t\t\t&& Base.equals(this._segments, item._segments);\n\t},\n\n\tcopyContent: function(source) {\n\t\tthis.setSegments(source._segments);\n\t\tthis._closed = source._closed;\n\t},\n\n\t_changed: function _changed(flags) {\n\t\t_changed.base.call(this, flags);\n\t\tif (flags & 8) {\n\t\t\tthis._length = this._area = undefined;\n\t\t\tif (flags & 32) {\n\t\t\t\tthis._version++;\n\t\t\t} else if (this._curves) {\n\t\t\t   for (var i = 0, l = this._curves.length; i < l; i++)\n\t\t\t\t\tthis._curves[i]._changed();\n\t\t\t}\n\t\t} else if (flags & 64) {\n\t\t\tthis._bounds = undefined;\n\t\t}\n\t},\n\n\tgetStyle: function() {\n\t\tvar parent = this._parent;\n\t\treturn (parent instanceof CompoundPath ? parent : this)._style;\n\t},\n\n\tgetSegments: function() {\n\t\treturn this._segments;\n\t},\n\n\tsetSegments: function(segments) {\n\t\tvar fullySelected = this.isFullySelected(),\n\t\t\tlength = segments && segments.length;\n\t\tthis._segments.length = 0;\n\t\tthis._segmentSelection = 0;\n\t\tthis._curves = undefined;\n\t\tif (length) {\n\t\t\tvar last = segments[length - 1];\n\t\t\tif (typeof last === 'boolean') {\n\t\t\t\tthis.setClosed(last);\n\t\t\t\tlength--;\n\t\t\t}\n\t\t\tthis._add(Segment.readList(segments, 0, {}, length));\n\t\t}\n\t\tif (fullySelected)\n\t\t\tthis.setFullySelected(true);\n\t},\n\n\tgetFirstSegment: function() {\n\t\treturn this._segments[0];\n\t},\n\n\tgetLastSegment: function() {\n\t\treturn this._segments[this._segments.length - 1];\n\t},\n\n\tgetCurves: function() {\n\t\tvar curves = this._curves,\n\t\t\tsegments = this._segments;\n\t\tif (!curves) {\n\t\t\tvar length = this._countCurves();\n\t\t\tcurves = this._curves = new Array(length);\n\t\t\tfor (var i = 0; i < length; i++)\n\t\t\t\tcurves[i] = new Curve(this, segments[i],\n\t\t\t\t\tsegments[i + 1] || segments[0]);\n\t\t}\n\t\treturn curves;\n\t},\n\n\tgetFirstCurve: function() {\n\t\treturn this.getCurves()[0];\n\t},\n\n\tgetLastCurve: function() {\n\t\tvar curves = this.getCurves();\n\t\treturn curves[curves.length - 1];\n\t},\n\n\tisClosed: function() {\n\t\treturn this._closed;\n\t},\n\n\tsetClosed: function(closed) {\n\t\tif (this._closed != (closed = !!closed)) {\n\t\t\tthis._closed = closed;\n\t\t\tif (this._curves) {\n\t\t\t\tvar length = this._curves.length = this._countCurves();\n\t\t\t\tif (closed)\n\t\t\t\t\tthis._curves[length - 1] = new Curve(this,\n\t\t\t\t\t\tthis._segments[length - 1], this._segments[0]);\n\t\t\t}\n\t\t\tthis._changed(41);\n\t\t}\n\t}\n}, {\n\tbeans: true,\n\n\tgetPathData: function(_matrix, _precision) {\n\t\tvar segments = this._segments,\n\t\t\tlength = segments.length,\n\t\t\tf = new Formatter(_precision),\n\t\t\tcoords = new Array(6),\n\t\t\tfirst = true,\n\t\t\tcurX, curY,\n\t\t\tprevX, prevY,\n\t\t\tinX, inY,\n\t\t\toutX, outY,\n\t\t\tparts = [];\n\n\t\tfunction addSegment(segment, skipLine) {\n\t\t\tsegment._transformCoordinates(_matrix, coords);\n\t\t\tcurX = coords[0];\n\t\t\tcurY = coords[1];\n\t\t\tif (first) {\n\t\t\t\tparts.push('M' + f.pair(curX, curY));\n\t\t\t\tfirst = false;\n\t\t\t} else {\n\t\t\t\tinX = coords[2];\n\t\t\t\tinY = coords[3];\n\t\t\t\tif (inX === curX && inY === curY\n\t\t\t\t\t\t&& outX === prevX && outY === prevY) {\n\t\t\t\t\tif (!skipLine) {\n\t\t\t\t\t\tvar dx = curX - prevX,\n\t\t\t\t\t\t\tdy = curY - prevY;\n\t\t\t\t\t\tparts.push(\n\t\t\t\t\t\t\t  dx === 0 ? 'v' + f.number(dy)\n\t\t\t\t\t\t\t: dy === 0 ? 'h' + f.number(dx)\n\t\t\t\t\t\t\t: 'l' + f.pair(dx, dy));\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tparts.push('c' + f.pair(outX - prevX, outY - prevY)\n\t\t\t\t\t\t\t + ' ' + f.pair( inX - prevX,  inY - prevY)\n\t\t\t\t\t\t\t + ' ' + f.pair(curX - prevX, curY - prevY));\n\t\t\t\t}\n\t\t\t}\n\t\t\tprevX = curX;\n\t\t\tprevY = curY;\n\t\t\toutX = coords[4];\n\t\t\toutY = coords[5];\n\t\t}\n\n\t\tif (!length)\n\t\t\treturn '';\n\n\t\tfor (var i = 0; i < length; i++)\n\t\t\taddSegment(segments[i]);\n\t\tif (this._closed && length > 0) {\n\t\t\taddSegment(segments[0], true);\n\t\t\tparts.push('z');\n\t\t}\n\t\treturn parts.join('');\n\t},\n\n\tisEmpty: function() {\n\t\treturn !this._segments.length;\n\t},\n\n\t_transformContent: function(matrix) {\n\t\tvar segments = this._segments,\n\t\t\tcoords = new Array(6);\n\t\tfor (var i = 0, l = segments.length; i < l; i++)\n\t\t\tsegments[i]._transformCoordinates(matrix, coords, true);\n\t\treturn true;\n\t},\n\n\t_add: function(segs, index) {\n\t\tvar segments = this._segments,\n\t\t\tcurves = this._curves,\n\t\t\tamount = segs.length,\n\t\t\tappend = index == null,\n\t\t\tindex = append ? segments.length : index;\n\t\tfor (var i = 0; i < amount; i++) {\n\t\t\tvar segment = segs[i];\n\t\t\tif (segment._path)\n\t\t\t\tsegment = segs[i] = segment.clone();\n\t\t\tsegment._path = this;\n\t\t\tsegment._index = index + i;\n\t\t\tif (segment._selection)\n\t\t\t\tthis._updateSelection(segment, 0, segment._selection);\n\t\t}\n\t\tif (append) {\n\t\t\tBase.push(segments, segs);\n\t\t} else {\n\t\t\tsegments.splice.apply(segments, [index, 0].concat(segs));\n\t\t\tfor (var i = index + amount, l = segments.length; i < l; i++)\n\t\t\t\tsegments[i]._index = i;\n\t\t}\n\t\tif (curves) {\n\t\t\tvar total = this._countCurves(),\n\t\t\t\tstart = index > 0 && index + amount - 1 === total ? index - 1\n\t\t\t\t\t: index,\n\t\t\t\tinsert = start,\n\t\t\t\tend = Math.min(start + amount, total);\n\t\t\tif (segs._curves) {\n\t\t\t\tcurves.splice.apply(curves, [start, 0].concat(segs._curves));\n\t\t\t\tinsert += segs._curves.length;\n\t\t\t}\n\t\t\tfor (var i = insert; i < end; i++)\n\t\t\t\tcurves.splice(i, 0, new Curve(this, null, null));\n\t\t\tthis._adjustCurves(start, end);\n\t\t}\n\t\tthis._changed(41);\n\t\treturn segs;\n\t},\n\n\t_adjustCurves: function(start, end) {\n\t\tvar segments = this._segments,\n\t\t\tcurves = this._curves,\n\t\t\tcurve;\n\t\tfor (var i = start; i < end; i++) {\n\t\t\tcurve = curves[i];\n\t\t\tcurve._path = this;\n\t\t\tcurve._segment1 = segments[i];\n\t\t\tcurve._segment2 = segments[i + 1] || segments[0];\n\t\t\tcurve._changed();\n\t\t}\n\t\tif (curve = curves[this._closed && !start ? segments.length - 1\n\t\t\t\t: start - 1]) {\n\t\t\tcurve._segment2 = segments[start] || segments[0];\n\t\t\tcurve._changed();\n\t\t}\n\t\tif (curve = curves[end]) {\n\t\t\tcurve._segment1 = segments[end];\n\t\t\tcurve._changed();\n\t\t}\n\t},\n\n\t_countCurves: function() {\n\t\tvar length = this._segments.length;\n\t\treturn !this._closed && length > 0 ? length - 1 : length;\n\t},\n\n\tadd: function(segment1 ) {\n\t\treturn arguments.length > 1 && typeof segment1 !== 'number'\n\t\t\t? this._add(Segment.readList(arguments))\n\t\t\t: this._add([ Segment.read(arguments) ])[0];\n\t},\n\n\tinsert: function(index, segment1 ) {\n\t\treturn arguments.length > 2 && typeof segment1 !== 'number'\n\t\t\t? this._add(Segment.readList(arguments, 1), index)\n\t\t\t: this._add([ Segment.read(arguments, 1) ], index)[0];\n\t},\n\n\taddSegment: function() {\n\t\treturn this._add([ Segment.read(arguments) ])[0];\n\t},\n\n\tinsertSegment: function(index ) {\n\t\treturn this._add([ Segment.read(arguments, 1) ], index)[0];\n\t},\n\n\taddSegments: function(segments) {\n\t\treturn this._add(Segment.readList(segments));\n\t},\n\n\tinsertSegments: function(index, segments) {\n\t\treturn this._add(Segment.readList(segments), index);\n\t},\n\n\tremoveSegment: function(index) {\n\t\treturn this.removeSegments(index, index + 1)[0] || null;\n\t},\n\n\tremoveSegments: function(start, end, _includeCurves) {\n\t\tstart = start || 0;\n\t\tend = Base.pick(end, this._segments.length);\n\t\tvar segments = this._segments,\n\t\t\tcurves = this._curves,\n\t\t\tcount = segments.length,\n\t\t\tremoved = segments.splice(start, end - start),\n\t\t\tamount = removed.length;\n\t\tif (!amount)\n\t\t\treturn removed;\n\t\tfor (var i = 0; i < amount; i++) {\n\t\t\tvar segment = removed[i];\n\t\t\tif (segment._selection)\n\t\t\t\tthis._updateSelection(segment, segment._selection, 0);\n\t\t\tsegment._index = segment._path = null;\n\t\t}\n\t\tfor (var i = start, l = segments.length; i < l; i++)\n\t\t\tsegments[i]._index = i;\n\t\tif (curves) {\n\t\t\tvar index = start > 0 && end === count + (this._closed ? 1 : 0)\n\t\t\t\t\t? start - 1\n\t\t\t\t\t: start,\n\t\t\t\tcurves = curves.splice(index, amount);\n\t\t\tfor (var i = curves.length - 1; i >= 0; i--)\n\t\t\t\tcurves[i]._path = null;\n\t\t\tif (_includeCurves)\n\t\t\t\tremoved._curves = curves.slice(1);\n\t\t\tthis._adjustCurves(index, index);\n\t\t}\n\t\tthis._changed(41);\n\t\treturn removed;\n\t},\n\n\tclear: '#removeSegments',\n\n\thasHandles: function() {\n\t\tvar segments = this._segments;\n\t\tfor (var i = 0, l = segments.length; i < l; i++) {\n\t\t\tif (segments[i].hasHandles())\n\t\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t},\n\n\tclearHandles: function() {\n\t\tvar segments = this._segments;\n\t\tfor (var i = 0, l = segments.length; i < l; i++)\n\t\t\tsegments[i].clearHandles();\n\t},\n\n\tgetLength: function() {\n\t\tif (this._length == null) {\n\t\t\tvar curves = this.getCurves(),\n\t\t\t\tlength = 0;\n\t\t\tfor (var i = 0, l = curves.length; i < l; i++)\n\t\t\t\tlength += curves[i].getLength();\n\t\t\tthis._length = length;\n\t\t}\n\t\treturn this._length;\n\t},\n\n\tgetArea: function() {\n\t\tvar area = this._area;\n\t\tif (area == null) {\n\t\t\tvar segments = this._segments,\n\t\t\t\tclosed = this._closed;\n\t\t\tarea = 0;\n\t\t\tfor (var i = 0, l = segments.length; i < l; i++) {\n\t\t\t\tvar last = i + 1 === l;\n\t\t\t\tarea += Curve.getArea(Curve.getValues(\n\t\t\t\t\t\tsegments[i], segments[last ? 0 : i + 1],\n\t\t\t\t\t\tnull, last && !closed));\n\t\t\t}\n\t\t\tthis._area = area;\n\t\t}\n\t\treturn area;\n\t},\n\n\tisFullySelected: function() {\n\t\tvar length = this._segments.length;\n\t\treturn this.isSelected() && length > 0 && this._segmentSelection\n\t\t\t\t=== length * 7;\n\t},\n\n\tsetFullySelected: function(selected) {\n\t\tif (selected)\n\t\t\tthis._selectSegments(true);\n\t\tthis.setSelected(selected);\n\t},\n\n\tsetSelection: function setSelection(selection) {\n\t\tif (!(selection & 1))\n\t\t\tthis._selectSegments(false);\n\t\tsetSelection.base.call(this, selection);\n\t},\n\n\t_selectSegments: function(selected) {\n\t\tvar segments = this._segments,\n\t\t\tlength = segments.length,\n\t\t\tselection = selected ? 7 : 0;\n\t\tthis._segmentSelection = selection * length;\n\t\tfor (var i = 0; i < length; i++)\n\t\t\tsegments[i]._selection = selection;\n\t},\n\n\t_updateSelection: function(segment, oldSelection, newSelection) {\n\t\tsegment._selection = newSelection;\n\t\tvar selection = this._segmentSelection += newSelection - oldSelection;\n\t\tif (selection > 0)\n\t\t\tthis.setSelected(true);\n\t},\n\n\tdivideAt: function(location) {\n\t\tvar loc = this.getLocationAt(location),\n\t\t\tcurve;\n\t\treturn loc && (curve = loc.getCurve().divideAt(loc.getCurveOffset()))\n\t\t\t\t? curve._segment1\n\t\t\t\t: null;\n\t},\n\n\tsplitAt: function(location) {\n\t\tvar loc = this.getLocationAt(location),\n\t\t\tindex = loc && loc.index,\n\t\t\ttime = loc && loc.time,\n\t\t\ttMin = 1e-8,\n\t\t\ttMax = 1 - tMin;\n\t\tif (time > tMax) {\n\t\t\tindex++;\n\t\t\ttime = 0;\n\t\t}\n\t\tvar curves = this.getCurves();\n\t\tif (index >= 0 && index < curves.length) {\n\t\t\tif (time >= tMin) {\n\t\t\t\tcurves[index++].divideAtTime(time);\n\t\t\t}\n\t\t\tvar segs = this.removeSegments(index, this._segments.length, true),\n\t\t\t\tpath;\n\t\t\tif (this._closed) {\n\t\t\t\tthis.setClosed(false);\n\t\t\t\tpath = this;\n\t\t\t} else {\n\t\t\t\tpath = new Path(Item.NO_INSERT);\n\t\t\t\tpath.insertAbove(this);\n\t\t\t\tpath.copyAttributes(this);\n\t\t\t}\n\t\t\tpath._add(segs, 0);\n\t\t\tthis.addSegment(segs[0]);\n\t\t\treturn path;\n\t\t}\n\t\treturn null;\n\t},\n\n\tsplit: function(index, time) {\n\t\tvar curve,\n\t\t\tlocation = time === undefined ? index\n\t\t\t\t: (curve = this.getCurves()[index])\n\t\t\t\t\t&& curve.getLocationAtTime(time);\n\t\treturn location != null ? this.splitAt(location) : null;\n\t},\n\n\tjoin: function(path, tolerance) {\n\t\tvar epsilon = tolerance || 0;\n\t\tif (path && path !== this) {\n\t\t\tvar segments = path._segments,\n\t\t\t\tlast1 = this.getLastSegment(),\n\t\t\t\tlast2 = path.getLastSegment();\n\t\t\tif (!last2)\n\t\t\t\treturn this;\n\t\t\tif (last1 && last1._point.isClose(last2._point, epsilon))\n\t\t\t\tpath.reverse();\n\t\t\tvar first2 = path.getFirstSegment();\n\t\t\tif (last1 && last1._point.isClose(first2._point, epsilon)) {\n\t\t\t\tlast1.setHandleOut(first2._handleOut);\n\t\t\t\tthis._add(segments.slice(1));\n\t\t\t} else {\n\t\t\t\tvar first1 = this.getFirstSegment();\n\t\t\t\tif (first1 && first1._point.isClose(first2._point, epsilon))\n\t\t\t\t\tpath.reverse();\n\t\t\t\tlast2 = path.getLastSegment();\n\t\t\t\tif (first1 && first1._point.isClose(last2._point, epsilon)) {\n\t\t\t\t\tfirst1.setHandleIn(last2._handleIn);\n\t\t\t\t\tthis._add(segments.slice(0, segments.length - 1), 0);\n\t\t\t\t} else {\n\t\t\t\t\tthis._add(segments.slice());\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (path._closed)\n\t\t\t\tthis._add([segments[0]]);\n\t\t\tpath.remove();\n\t\t}\n\t\tvar first = this.getFirstSegment(),\n\t\t\tlast = this.getLastSegment();\n\t\tif (first !== last && first._point.isClose(last._point, epsilon)) {\n\t\t\tfirst.setHandleIn(last._handleIn);\n\t\t\tlast.remove();\n\t\t\tthis.setClosed(true);\n\t\t}\n\t\treturn this;\n\t},\n\n\treduce: function(options) {\n\t\tvar curves = this.getCurves(),\n\t\t\tsimplify = options && options.simplify,\n\t\t\ttolerance = simplify ? 1e-7 : 0;\n\t\tfor (var i = curves.length - 1; i >= 0; i--) {\n\t\t\tvar curve = curves[i];\n\t\t\tif (!curve.hasHandles() && (!curve.hasLength(tolerance)\n\t\t\t\t\t|| simplify && curve.isCollinear(curve.getNext())))\n\t\t\t\tcurve.remove();\n\t\t}\n\t\treturn this;\n\t},\n\n\treverse: function() {\n\t\tthis._segments.reverse();\n\t\tfor (var i = 0, l = this._segments.length; i < l; i++) {\n\t\t\tvar segment = this._segments[i];\n\t\t\tvar handleIn = segment._handleIn;\n\t\t\tsegment._handleIn = segment._handleOut;\n\t\t\tsegment._handleOut = handleIn;\n\t\t\tsegment._index = i;\n\t\t}\n\t\tthis._curves = null;\n\t\tthis._changed(9);\n\t},\n\n\tflatten: function(flatness) {\n\t\tvar flattener = new PathFlattener(this, flatness || 0.25, 256, true),\n\t\t\tparts = flattener.parts,\n\t\t\tlength = parts.length,\n\t\t\tsegments = [];\n\t\tfor (var i = 0; i < length; i++) {\n\t\t\tsegments.push(new Segment(parts[i].curve.slice(0, 2)));\n\t\t}\n\t\tif (!this._closed && length > 0) {\n\t\t\tsegments.push(new Segment(parts[length - 1].curve.slice(6)));\n\t\t}\n\t\tthis.setSegments(segments);\n\t},\n\n\tsimplify: function(tolerance) {\n\t\tvar segments = new PathFitter(this).fit(tolerance || 2.5);\n\t\tif (segments)\n\t\t\tthis.setSegments(segments);\n\t\treturn !!segments;\n\t},\n\n\tsmooth: function(options) {\n\t\tvar that = this,\n\t\t\topts = options || {},\n\t\t\ttype = opts.type || 'asymmetric',\n\t\t\tsegments = this._segments,\n\t\t\tlength = segments.length,\n\t\t\tclosed = this._closed;\n\n\t\tfunction getIndex(value, _default) {\n\t\t\tvar index = value && value.index;\n\t\t\tif (index != null) {\n\t\t\t\tvar path = value.path;\n\t\t\t\tif (path && path !== that)\n\t\t\t\t\tthrow new Error(value._class + ' ' + index + ' of ' + path\n\t\t\t\t\t\t\t+ ' is not part of ' + that);\n\t\t\t\tif (_default && value instanceof Curve)\n\t\t\t\t\tindex++;\n\t\t\t} else {\n\t\t\t\tindex = typeof value === 'number' ? value : _default;\n\t\t\t}\n\t\t\treturn Math.min(index < 0 && closed\n\t\t\t\t\t? index % length\n\t\t\t\t\t: index < 0 ? index + length : index, length - 1);\n\t\t}\n\n\t\tvar loop = closed && opts.from === undefined && opts.to === undefined,\n\t\t\tfrom = getIndex(opts.from, 0),\n\t\t\tto = getIndex(opts.to, length - 1);\n\n\t\tif (from > to) {\n\t\t\tif (closed) {\n\t\t\t\tfrom -= length;\n\t\t\t} else {\n\t\t\t\tvar tmp = from;\n\t\t\t\tfrom = to;\n\t\t\t\tto = tmp;\n\t\t\t}\n\t\t}\n\t\tif (/^(?:asymmetric|continuous)$/.test(type)) {\n\t\t\tvar asymmetric = type === 'asymmetric',\n\t\t\t\tmin = Math.min,\n\t\t\t\tamount = to - from + 1,\n\t\t\t\tn = amount - 1,\n\t\t\t\tpadding = loop ? min(amount, 4) : 1,\n\t\t\t\tpaddingLeft = padding,\n\t\t\t\tpaddingRight = padding,\n\t\t\t\tknots = [];\n\t\t\tif (!closed) {\n\t\t\t\tpaddingLeft = min(1, from);\n\t\t\t\tpaddingRight = min(1, length - to - 1);\n\t\t\t}\n\t\t\tn += paddingLeft + paddingRight;\n\t\t\tif (n <= 1)\n\t\t\t\treturn;\n\t\t\tfor (var i = 0, j = from - paddingLeft; i <= n; i++, j++) {\n\t\t\t\tknots[i] = segments[(j < 0 ? j + length : j) % length]._point;\n\t\t\t}\n\n\t\t\tvar x = knots[0]._x + 2 * knots[1]._x,\n\t\t\t\ty = knots[0]._y + 2 * knots[1]._y,\n\t\t\t\tf = 2,\n\t\t\t\tn_1 = n - 1,\n\t\t\t\trx = [x],\n\t\t\t\try = [y],\n\t\t\t\trf = [f],\n\t\t\t\tpx = [],\n\t\t\t\tpy = [];\n\t\t\tfor (var i = 1; i < n; i++) {\n\t\t\t\tvar internal = i < n_1,\n\t\t\t\t\ta = internal ? 1 : asymmetric ? 1 : 2,\n\t\t\t\t\tb = internal ? 4 : asymmetric ? 2 : 7,\n\t\t\t\t\tu = internal ? 4 : asymmetric ? 3 : 8,\n\t\t\t\t\tv = internal ? 2 : asymmetric ? 0 : 1,\n\t\t\t\t\tm = a / f;\n\t\t\t\tf = rf[i] = b - m;\n\t\t\t\tx = rx[i] = u * knots[i]._x + v * knots[i + 1]._x - m * x;\n\t\t\t\ty = ry[i] = u * knots[i]._y + v * knots[i + 1]._y - m * y;\n\t\t\t}\n\n\t\t\tpx[n_1] = rx[n_1] / rf[n_1];\n\t\t\tpy[n_1] = ry[n_1] / rf[n_1];\n\t\t\tfor (var i = n - 2; i >= 0; i--) {\n\t\t\t\tpx[i] = (rx[i] - px[i + 1]) / rf[i];\n\t\t\t\tpy[i] = (ry[i] - py[i + 1]) / rf[i];\n\t\t\t}\n\t\t\tpx[n] = (3 * knots[n]._x - px[n_1]) / 2;\n\t\t\tpy[n] = (3 * knots[n]._y - py[n_1]) / 2;\n\n\t\t\tfor (var i = paddingLeft, max = n - paddingRight, j = from;\n\t\t\t\t\ti <= max; i++, j++) {\n\t\t\t\tvar segment = segments[j < 0 ? j + length : j],\n\t\t\t\t\tpt = segment._point,\n\t\t\t\t\thx = px[i] - pt._x,\n\t\t\t\t\thy = py[i] - pt._y;\n\t\t\t\tif (loop || i < max)\n\t\t\t\t\tsegment.setHandleOut(hx, hy);\n\t\t\t\tif (loop || i > paddingLeft)\n\t\t\t\t\tsegment.setHandleIn(-hx, -hy);\n\t\t\t}\n\t\t} else {\n\t\t\tfor (var i = from; i <= to; i++) {\n\t\t\t\tsegments[i < 0 ? i + length : i].smooth(opts,\n\t\t\t\t\t\t!loop && i === from, !loop && i === to);\n\t\t\t}\n\t\t}\n\t},\n\n\ttoShape: function(insert) {\n\t\tif (!this._closed)\n\t\t\treturn null;\n\n\t\tvar segments = this._segments,\n\t\t\ttype,\n\t\t\tsize,\n\t\t\tradius,\n\t\t\ttopCenter;\n\n\t\tfunction isCollinear(i, j) {\n\t\t\tvar seg1 = segments[i],\n\t\t\t\tseg2 = seg1.getNext(),\n\t\t\t\tseg3 = segments[j],\n\t\t\t\tseg4 = seg3.getNext();\n\t\t\treturn seg1._handleOut.isZero() && seg2._handleIn.isZero()\n\t\t\t\t\t&& seg3._handleOut.isZero() && seg4._handleIn.isZero()\n\t\t\t\t\t&& seg2._point.subtract(seg1._point).isCollinear(\n\t\t\t\t\t\tseg4._point.subtract(seg3._point));\n\t\t}\n\n\t\tfunction isOrthogonal(i) {\n\t\t\tvar seg2 = segments[i],\n\t\t\t\tseg1 = seg2.getPrevious(),\n\t\t\t\tseg3 = seg2.getNext();\n\t\t\treturn seg1._handleOut.isZero() && seg2._handleIn.isZero()\n\t\t\t\t\t&& seg2._handleOut.isZero() && seg3._handleIn.isZero()\n\t\t\t\t\t&& seg2._point.subtract(seg1._point).isOrthogonal(\n\t\t\t\t\t\tseg3._point.subtract(seg2._point));\n\t\t}\n\n\t\tfunction isArc(i) {\n\t\t\tvar seg1 = segments[i],\n\t\t\t\tseg2 = seg1.getNext(),\n\t\t\t\thandle1 = seg1._handleOut,\n\t\t\t\thandle2 = seg2._handleIn,\n\t\t\t\tkappa = 0.5522847498307936;\n\t\t\tif (handle1.isOrthogonal(handle2)) {\n\t\t\t\tvar pt1 = seg1._point,\n\t\t\t\t\tpt2 = seg2._point,\n\t\t\t\t\tcorner = new Line(pt1, handle1, true).intersect(\n\t\t\t\t\t\t\tnew Line(pt2, handle2, true), true);\n\t\t\t\treturn corner && Numerical.isZero(handle1.getLength() /\n\t\t\t\t\t\tcorner.subtract(pt1).getLength() - kappa)\n\t\t\t\t\t&& Numerical.isZero(handle2.getLength() /\n\t\t\t\t\t\tcorner.subtract(pt2).getLength() - kappa);\n\t\t\t}\n\t\t\treturn false;\n\t\t}\n\n\t\tfunction getDistance(i, j) {\n\t\t\treturn segments[i]._point.getDistance(segments[j]._point);\n\t\t}\n\n\t\tif (!this.hasHandles() && segments.length === 4\n\t\t\t\t&& isCollinear(0, 2) && isCollinear(1, 3) && isOrthogonal(1)) {\n\t\t\ttype = Shape.Rectangle;\n\t\t\tsize = new Size(getDistance(0, 3), getDistance(0, 1));\n\t\t\ttopCenter = segments[1]._point.add(segments[2]._point).divide(2);\n\t\t} else if (segments.length === 8 && isArc(0) && isArc(2) && isArc(4)\n\t\t\t\t&& isArc(6) && isCollinear(1, 5) && isCollinear(3, 7)) {\n\t\t\ttype = Shape.Rectangle;\n\t\t\tsize = new Size(getDistance(1, 6), getDistance(0, 3));\n\t\t\tradius = size.subtract(new Size(getDistance(0, 7),\n\t\t\t\t\tgetDistance(1, 2))).divide(2);\n\t\t\ttopCenter = segments[3]._point.add(segments[4]._point).divide(2);\n\t\t} else if (segments.length === 4\n\t\t\t\t&& isArc(0) && isArc(1) && isArc(2) && isArc(3)) {\n\t\t\tif (Numerical.isZero(getDistance(0, 2) - getDistance(1, 3))) {\n\t\t\t\ttype = Shape.Circle;\n\t\t\t\tradius = getDistance(0, 2) / 2;\n\t\t\t} else {\n\t\t\t\ttype = Shape.Ellipse;\n\t\t\t\tradius = new Size(getDistance(2, 0) / 2, getDistance(3, 1) / 2);\n\t\t\t}\n\t\t\ttopCenter = segments[1]._point;\n\t\t}\n\n\t\tif (type) {\n\t\t\tvar center = this.getPosition(true),\n\t\t\t\tshape = new type({\n\t\t\t\t\tcenter: center,\n\t\t\t\t\tsize: size,\n\t\t\t\t\tradius: radius,\n\t\t\t\t\tinsert: false\n\t\t\t\t});\n\t\t\tshape.copyAttributes(this, true);\n\t\t\tshape._matrix.prepend(this._matrix);\n\t\t\tshape.rotate(topCenter.subtract(center).getAngle() + 90);\n\t\t\tif (insert === undefined || insert)\n\t\t\t\tshape.insertAbove(this);\n\t\t\treturn shape;\n\t\t}\n\t\treturn null;\n\t},\n\n\ttoPath: '#clone',\n\n\tcompare: function compare(path) {\n\t\tif (!path || path instanceof CompoundPath)\n\t\t\treturn compare.base.call(this, path);\n\t\tvar curves1 = this.getCurves(),\n\t\t\tcurves2 = path.getCurves(),\n\t\t\tlength1 = curves1.length,\n\t\t\tlength2 = curves2.length;\n\t\tif (!length1 || !length2) {\n\t\t\treturn length1 == length2;\n\t\t}\n\t\tvar v1 = curves1[0].getValues(),\n\t\t\tvalues2 = [],\n\t\t\tpos1 = 0, pos2,\n\t\t\tend1 = 0, end2;\n\t\tfor (var i = 0; i < length2; i++) {\n\t\t\tvar v2 = curves2[i].getValues();\n\t\t\tvalues2.push(v2);\n\t\t\tvar overlaps = Curve.getOverlaps(v1, v2);\n\t\t\tif (overlaps) {\n\t\t\t\tpos2 = !i && overlaps[0][0] > 0 ? length2 - 1 : i;\n\t\t\t\tend2 = overlaps[0][1];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tvar abs = Math.abs,\n\t\t\tepsilon = 1e-8,\n\t\t\tv2 = values2[pos2],\n\t\t\tstart2;\n\t\twhile (v1 && v2) {\n\t\t\tvar overlaps = Curve.getOverlaps(v1, v2);\n\t\t\tif (overlaps) {\n\t\t\t\tvar t1 = overlaps[0][0];\n\t\t\t\tif (abs(t1 - end1) < epsilon) {\n\t\t\t\t\tend1 = overlaps[1][0];\n\t\t\t\t\tif (end1 === 1) {\n\t\t\t\t\t\tv1 = ++pos1 < length1 ? curves1[pos1].getValues() : null;\n\t\t\t\t\t\tend1 = 0;\n\t\t\t\t\t}\n\t\t\t\t\tvar t2 = overlaps[0][1];\n\t\t\t\t\tif (abs(t2 - end2) < epsilon) {\n\t\t\t\t\t\tif (!start2)\n\t\t\t\t\t\t\tstart2 = [pos2, t2];\n\t\t\t\t\t\tend2 = overlaps[1][1];\n\t\t\t\t\t\tif (end2 === 1) {\n\t\t\t\t\t\t\tif (++pos2 >= length2)\n\t\t\t\t\t\t\t\tpos2 = 0;\n\t\t\t\t\t\t\tv2 = values2[pos2] || curves2[pos2].getValues();\n\t\t\t\t\t\t\tend2 = 0;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!v1) {\n\t\t\t\t\t\t\treturn start2[0] === pos2 && start2[1] === end2;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t\treturn false;\n\t},\n\n\t_hitTestSelf: function(point, options, viewMatrix, strokeMatrix) {\n\t\tvar that = this,\n\t\t\tstyle = this.getStyle(),\n\t\t\tsegments = this._segments,\n\t\t\tnumSegments = segments.length,\n\t\t\tclosed = this._closed,\n\t\t\ttolerancePadding = options._tolerancePadding,\n\t\t\tstrokePadding = tolerancePadding,\n\t\t\tjoin, cap, miterLimit,\n\t\t\tarea, loc, res,\n\t\t\thitStroke = options.stroke && style.hasStroke(),\n\t\t\thitFill = options.fill && style.hasFill(),\n\t\t\thitCurves = options.curves,\n\t\t\tstrokeRadius = hitStroke\n\t\t\t\t\t? style.getStrokeWidth() / 2\n\t\t\t\t\t: hitFill && options.tolerance > 0 || hitCurves\n\t\t\t\t\t\t? 0 : null;\n\t\tif (strokeRadius !== null) {\n\t\t\tif (strokeRadius > 0) {\n\t\t\t\tjoin = style.getStrokeJoin();\n\t\t\t\tcap = style.getStrokeCap();\n\t\t\t\tmiterLimit = style.getMiterLimit();\n\t\t\t\tstrokePadding = strokePadding.add(\n\t\t\t\t\tPath._getStrokePadding(strokeRadius, strokeMatrix));\n\t\t\t} else {\n\t\t\t\tjoin = cap = 'round';\n\t\t\t}\n\t\t}\n\n\t\tfunction isCloseEnough(pt, padding) {\n\t\t\treturn point.subtract(pt).divide(padding).length <= 1;\n\t\t}\n\n\t\tfunction checkSegmentPoint(seg, pt, name) {\n\t\t\tif (!options.selected || pt.isSelected()) {\n\t\t\t\tvar anchor = seg._point;\n\t\t\t\tif (pt !== anchor)\n\t\t\t\t\tpt = pt.add(anchor);\n\t\t\t\tif (isCloseEnough(pt, strokePadding)) {\n\t\t\t\t\treturn new HitResult(name, that, {\n\t\t\t\t\t\tsegment: seg,\n\t\t\t\t\t\tpoint: pt\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfunction checkSegmentPoints(seg, ends) {\n\t\t\treturn (ends || options.segments)\n\t\t\t\t&& checkSegmentPoint(seg, seg._point, 'segment')\n\t\t\t\t|| (!ends && options.handles) && (\n\t\t\t\t\tcheckSegmentPoint(seg, seg._handleIn, 'handle-in') ||\n\t\t\t\t\tcheckSegmentPoint(seg, seg._handleOut, 'handle-out'));\n\t\t}\n\n\t\tfunction addToArea(point) {\n\t\t\tarea.add(point);\n\t\t}\n\n\t\tfunction checkSegmentStroke(segment) {\n\t\t\tvar isJoin = closed || segment._index > 0\n\t\t\t\t\t&& segment._index < numSegments - 1;\n\t\t\tif ((isJoin ? join : cap) === 'round') {\n\t\t\t\treturn isCloseEnough(segment._point, strokePadding);\n\t\t\t} else {\n\t\t\t\tarea = new Path({ internal: true, closed: true });\n\t\t\t\tif (isJoin) {\n\t\t\t\t\tif (!segment.isSmooth()) {\n\t\t\t\t\t\tPath._addBevelJoin(segment, join, strokeRadius,\n\t\t\t\t\t\t\t   miterLimit, null, strokeMatrix, addToArea, true);\n\t\t\t\t\t}\n\t\t\t\t} else if (cap === 'square') {\n\t\t\t\t\tPath._addSquareCap(segment, cap, strokeRadius, null,\n\t\t\t\t\t\t\tstrokeMatrix, addToArea, true);\n\t\t\t\t}\n\t\t\t\tif (!area.isEmpty()) {\n\t\t\t\t\tvar loc;\n\t\t\t\t\treturn area.contains(point)\n\t\t\t\t\t\t|| (loc = area.getNearestLocation(point))\n\t\t\t\t\t\t\t&& isCloseEnough(loc.getPoint(), tolerancePadding);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (options.ends && !options.segments && !closed) {\n\t\t\tif (res = checkSegmentPoints(segments[0], true)\n\t\t\t\t\t|| checkSegmentPoints(segments[numSegments - 1], true))\n\t\t\t\treturn res;\n\t\t} else if (options.segments || options.handles) {\n\t\t\tfor (var i = 0; i < numSegments; i++)\n\t\t\t\tif (res = checkSegmentPoints(segments[i]))\n\t\t\t\t\treturn res;\n\t\t}\n\t\tif (strokeRadius !== null) {\n\t\t\tloc = this.getNearestLocation(point);\n\t\t\tif (loc) {\n\t\t\t\tvar time = loc.getTime();\n\t\t\t\tif (time === 0 || time === 1 && numSegments > 1) {\n\t\t\t\t\tif (!checkSegmentStroke(loc.getSegment()))\n\t\t\t\t\t\tloc = null;\n\t\t\t\t} else if (!isCloseEnough(loc.getPoint(), strokePadding)) {\n\t\t\t\t\tloc = null;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!loc && join === 'miter' && numSegments > 1) {\n\t\t\t\tfor (var i = 0; i < numSegments; i++) {\n\t\t\t\t\tvar segment = segments[i];\n\t\t\t\t\tif (point.getDistance(segment._point)\n\t\t\t\t\t\t\t<= miterLimit * strokeRadius\n\t\t\t\t\t\t\t&& checkSegmentStroke(segment)) {\n\t\t\t\t\t\tloc = segment.getLocation();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn !loc && hitFill && this._contains(point)\n\t\t\t\t|| loc && !hitStroke && !hitCurves\n\t\t\t\t\t? new HitResult('fill', this)\n\t\t\t\t\t: loc\n\t\t\t\t\t\t? new HitResult(hitStroke ? 'stroke' : 'curve', this, {\n\t\t\t\t\t\t\tlocation: loc,\n\t\t\t\t\t\t\tpoint: loc.getPoint()\n\t\t\t\t\t\t})\n\t\t\t\t\t\t: null;\n\t}\n\n}, Base.each(Curve._evaluateMethods,\n\tfunction(name) {\n\t\tthis[name + 'At'] = function(offset) {\n\t\t\tvar loc = this.getLocationAt(offset);\n\t\t\treturn loc && loc[name]();\n\t\t};\n\t},\n{\n\tbeans: false,\n\n\tgetLocationOf: function() {\n\t\tvar point = Point.read(arguments),\n\t\t\tcurves = this.getCurves();\n\t\tfor (var i = 0, l = curves.length; i < l; i++) {\n\t\t\tvar loc = curves[i].getLocationOf(point);\n\t\t\tif (loc)\n\t\t\t\treturn loc;\n\t\t}\n\t\treturn null;\n\t},\n\n\tgetOffsetOf: function() {\n\t\tvar loc = this.getLocationOf.apply(this, arguments);\n\t\treturn loc ? loc.getOffset() : null;\n\t},\n\n\tgetLocationAt: function(offset) {\n\t\tif (typeof offset === 'number') {\n\t\t\tvar curves = this.getCurves(),\n\t\t\t\tlength = 0;\n\t\t\tfor (var i = 0, l = curves.length; i < l; i++) {\n\t\t\t\tvar start = length,\n\t\t\t\t\tcurve = curves[i];\n\t\t\t\tlength += curve.getLength();\n\t\t\t\tif (length > offset) {\n\t\t\t\t\treturn curve.getLocationAt(offset - start);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (curves.length > 0 && offset <= this.getLength()) {\n\t\t\t\treturn new CurveLocation(curves[curves.length - 1], 1);\n\t\t\t}\n\t\t} else if (offset && offset.getPath && offset.getPath() === this) {\n\t\t\treturn offset;\n\t\t}\n\t\treturn null;\n\t},\n\n\tgetOffsetsWithTangent: function() {\n\t\tvar tangent = Point.read(arguments);\n\t\tif (tangent.isZero()) {\n\t\t\treturn [];\n\t\t}\n\n\t\tvar offsets = [];\n\t\tvar curveStart = 0;\n\t\tvar curves = this.getCurves();\n\t\tfor (var i = 0, l = curves.length; i < l; i++) {\n\t\t\tvar curve = curves[i];\n\t\t\tvar curveTimes = curve.getTimesWithTangent(tangent);\n\t\t\tfor (var j = 0, m = curveTimes.length; j < m; j++) {\n\t\t\t\tvar offset = curveStart + curve.getOffsetAtTime(curveTimes[j]);\n\t\t\t\tif (offsets.indexOf(offset) < 0) {\n\t\t\t\t\toffsets.push(offset);\n\t\t\t\t}\n\t\t\t}\n\t\t\tcurveStart += curve.length;\n\t\t}\n\t\treturn offsets;\n\t}\n}),\nnew function() {\n\n\tfunction drawHandles(ctx, segments, matrix, size) {\n\t\tvar half = size / 2,\n\t\t\tcoords = new Array(6),\n\t\t\tpX, pY;\n\n\t\tfunction drawHandle(index) {\n\t\t\tvar hX = coords[index],\n\t\t\t\thY = coords[index + 1];\n\t\t\tif (pX != hX || pY != hY) {\n\t\t\t\tctx.beginPath();\n\t\t\t\tctx.moveTo(pX, pY);\n\t\t\t\tctx.lineTo(hX, hY);\n\t\t\t\tctx.stroke();\n\t\t\t\tctx.beginPath();\n\t\t\t\tctx.arc(hX, hY, half, 0, Math.PI * 2, true);\n\t\t\t\tctx.fill();\n\t\t\t}\n\t\t}\n\n\t\tfor (var i = 0, l = segments.length; i < l; i++) {\n\t\t\tvar segment = segments[i],\n\t\t\t\tselection = segment._selection;\n\t\t\tsegment._transformCoordinates(matrix, coords);\n\t\t\tpX = coords[0];\n\t\t\tpY = coords[1];\n\t\t\tif (selection & 2)\n\t\t\t\tdrawHandle(2);\n\t\t\tif (selection & 4)\n\t\t\t\tdrawHandle(4);\n\t\t\tctx.fillRect(pX - half, pY - half, size, size);\n\t\t\tif (!(selection & 1)) {\n\t\t\t\tvar fillStyle = ctx.fillStyle;\n\t\t\t\tctx.fillStyle = '#ffffff';\n\t\t\t\tctx.fillRect(pX - half + 1, pY - half + 1, size - 2, size - 2);\n\t\t\t\tctx.fillStyle = fillStyle;\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction drawSegments(ctx, path, matrix) {\n\t\tvar segments = path._segments,\n\t\t\tlength = segments.length,\n\t\t\tcoords = new Array(6),\n\t\t\tfirst = true,\n\t\t\tcurX, curY,\n\t\t\tprevX, prevY,\n\t\t\tinX, inY,\n\t\t\toutX, outY;\n\n\t\tfunction drawSegment(segment) {\n\t\t\tif (matrix) {\n\t\t\t\tsegment._transformCoordinates(matrix, coords);\n\t\t\t\tcurX = coords[0];\n\t\t\t\tcurY = coords[1];\n\t\t\t} else {\n\t\t\t\tvar point = segment._point;\n\t\t\t\tcurX = point._x;\n\t\t\t\tcurY = point._y;\n\t\t\t}\n\t\t\tif (first) {\n\t\t\t\tctx.moveTo(curX, curY);\n\t\t\t\tfirst = false;\n\t\t\t} else {\n\t\t\t\tif (matrix) {\n\t\t\t\t\tinX = coords[2];\n\t\t\t\t\tinY = coords[3];\n\t\t\t\t} else {\n\t\t\t\t\tvar handle = segment._handleIn;\n\t\t\t\t\tinX = curX + handle._x;\n\t\t\t\t\tinY = curY + handle._y;\n\t\t\t\t}\n\t\t\t\tif (inX === curX && inY === curY\n\t\t\t\t\t\t&& outX === prevX && outY === prevY) {\n\t\t\t\t\tctx.lineTo(curX, curY);\n\t\t\t\t} else {\n\t\t\t\t\tctx.bezierCurveTo(outX, outY, inX, inY, curX, curY);\n\t\t\t\t}\n\t\t\t}\n\t\t\tprevX = curX;\n\t\t\tprevY = curY;\n\t\t\tif (matrix) {\n\t\t\t\toutX = coords[4];\n\t\t\t\toutY = coords[5];\n\t\t\t} else {\n\t\t\t\tvar handle = segment._handleOut;\n\t\t\t\toutX = prevX + handle._x;\n\t\t\t\toutY = prevY + handle._y;\n\t\t\t}\n\t\t}\n\n\t\tfor (var i = 0; i < length; i++)\n\t\t\tdrawSegment(segments[i]);\n\t\tif (path._closed && length > 0)\n\t\t\tdrawSegment(segments[0]);\n\t}\n\n\treturn {\n\t\t_draw: function(ctx, param, viewMatrix, strokeMatrix) {\n\t\t\tvar dontStart = param.dontStart,\n\t\t\t\tdontPaint = param.dontFinish || param.clip,\n\t\t\t\tstyle = this.getStyle(),\n\t\t\t\thasFill = style.hasFill(),\n\t\t\t\thasStroke = style.hasStroke(),\n\t\t\t\tdashArray = style.getDashArray(),\n\t\t\t\tdashLength = !paper.support.nativeDash && hasStroke\n\t\t\t\t\t\t&& dashArray && dashArray.length;\n\n\t\t\tif (!dontStart)\n\t\t\t\tctx.beginPath();\n\n\t\t\tif (hasFill || hasStroke && !dashLength || dontPaint) {\n\t\t\t\tdrawSegments(ctx, this, strokeMatrix);\n\t\t\t\tif (this._closed)\n\t\t\t\t\tctx.closePath();\n\t\t\t}\n\n\t\t\tfunction getOffset(i) {\n\t\t\t\treturn dashArray[((i % dashLength) + dashLength) % dashLength];\n\t\t\t}\n\n\t\t\tif (!dontPaint && (hasFill || hasStroke)) {\n\t\t\t\tthis._setStyles(ctx, param, viewMatrix);\n\t\t\t\tif (hasFill) {\n\t\t\t\t\tctx.fill(style.getFillRule());\n\t\t\t\t\tctx.shadowColor = 'rgba(0,0,0,0)';\n\t\t\t\t}\n\t\t\t\tif (hasStroke) {\n\t\t\t\t\tif (dashLength) {\n\t\t\t\t\t\tif (!dontStart)\n\t\t\t\t\t\t\tctx.beginPath();\n\t\t\t\t\t\tvar flattener = new PathFlattener(this, 0.25, 32, false,\n\t\t\t\t\t\t\t\tstrokeMatrix),\n\t\t\t\t\t\t\tlength = flattener.length,\n\t\t\t\t\t\t\tfrom = -style.getDashOffset(), to,\n\t\t\t\t\t\t\ti = 0;\n\t\t\t\t\t\tfrom = from % length;\n\t\t\t\t\t\twhile (from > 0) {\n\t\t\t\t\t\t\tfrom -= getOffset(i--) + getOffset(i--);\n\t\t\t\t\t\t}\n\t\t\t\t\t\twhile (from < length) {\n\t\t\t\t\t\t\tto = from + getOffset(i++);\n\t\t\t\t\t\t\tif (from > 0 || to > 0)\n\t\t\t\t\t\t\t\tflattener.drawPart(ctx,\n\t\t\t\t\t\t\t\t\t\tMath.max(from, 0), Math.max(to, 0));\n\t\t\t\t\t\t\tfrom = to + getOffset(i++);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tctx.stroke();\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t_drawSelected: function(ctx, matrix) {\n\t\t\tctx.beginPath();\n\t\t\tdrawSegments(ctx, this, matrix);\n\t\t\tctx.stroke();\n\t\t\tdrawHandles(ctx, this._segments, matrix, paper.settings.handleSize);\n\t\t}\n\t};\n},\nnew function() {\n\tfunction getCurrentSegment(that) {\n\t\tvar segments = that._segments;\n\t\tif (!segments.length)\n\t\t\tthrow new Error('Use a moveTo() command first');\n\t\treturn segments[segments.length - 1];\n\t}\n\n\treturn {\n\t\tmoveTo: function() {\n\t\t\tvar segments = this._segments;\n\t\t\tif (segments.length === 1)\n\t\t\t\tthis.removeSegment(0);\n\t\t\tif (!segments.length)\n\t\t\t\tthis._add([ new Segment(Point.read(arguments)) ]);\n\t\t},\n\n\t\tmoveBy: function() {\n\t\t\tthrow new Error('moveBy() is unsupported on Path items.');\n\t\t},\n\n\t\tlineTo: function() {\n\t\t\tthis._add([ new Segment(Point.read(arguments)) ]);\n\t\t},\n\n\t\tcubicCurveTo: function() {\n\t\t\tvar handle1 = Point.read(arguments),\n\t\t\t\thandle2 = Point.read(arguments),\n\t\t\t\tto = Point.read(arguments),\n\t\t\t\tcurrent = getCurrentSegment(this);\n\t\t\tcurrent.setHandleOut(handle1.subtract(current._point));\n\t\t\tthis._add([ new Segment(to, handle2.subtract(to)) ]);\n\t\t},\n\n\t\tquadraticCurveTo: function() {\n\t\t\tvar handle = Point.read(arguments),\n\t\t\t\tto = Point.read(arguments),\n\t\t\t\tcurrent = getCurrentSegment(this)._point;\n\t\t\tthis.cubicCurveTo(\n\t\t\t\thandle.add(current.subtract(handle).multiply(1 / 3)),\n\t\t\t\thandle.add(to.subtract(handle).multiply(1 / 3)),\n\t\t\t\tto\n\t\t\t);\n\t\t},\n\n\t\tcurveTo: function() {\n\t\t\tvar through = Point.read(arguments),\n\t\t\t\tto = Point.read(arguments),\n\t\t\t\tt = Base.pick(Base.read(arguments), 0.5),\n\t\t\t\tt1 = 1 - t,\n\t\t\t\tcurrent = getCurrentSegment(this)._point,\n\t\t\t\thandle = through.subtract(current.multiply(t1 * t1))\n\t\t\t\t\t.subtract(to.multiply(t * t)).divide(2 * t * t1);\n\t\t\tif (handle.isNaN())\n\t\t\t\tthrow new Error(\n\t\t\t\t\t'Cannot put a curve through points with parameter = ' + t);\n\t\t\tthis.quadraticCurveTo(handle, to);\n\t\t},\n\n\t\tarcTo: function() {\n\t\t\tvar abs = Math.abs,\n\t\t\t\tsqrt = Math.sqrt,\n\t\t\t\tcurrent = getCurrentSegment(this),\n\t\t\t\tfrom = current._point,\n\t\t\t\tto = Point.read(arguments),\n\t\t\t\tthrough,\n\t\t\t\tpeek = Base.peek(arguments),\n\t\t\t\tclockwise = Base.pick(peek, true),\n\t\t\t\tcenter, extent, vector, matrix;\n\t\t\tif (typeof clockwise === 'boolean') {\n\t\t\t\tvar middle = from.add(to).divide(2),\n\t\t\t\tthrough = middle.add(middle.subtract(from).rotate(\n\t\t\t\t\t\tclockwise ? -90 : 90));\n\t\t\t} else if (Base.remain(arguments) <= 2) {\n\t\t\t\tthrough = to;\n\t\t\t\tto = Point.read(arguments);\n\t\t\t} else {\n\t\t\t\tvar radius = Size.read(arguments),\n\t\t\t\t\tisZero = Numerical.isZero;\n\t\t\t\tif (isZero(radius.width) || isZero(radius.height))\n\t\t\t\t\treturn this.lineTo(to);\n\t\t\t\tvar rotation = Base.read(arguments),\n\t\t\t\t\tclockwise = !!Base.read(arguments),\n\t\t\t\t\tlarge = !!Base.read(arguments),\n\t\t\t\t\tmiddle = from.add(to).divide(2),\n\t\t\t\t\tpt = from.subtract(middle).rotate(-rotation),\n\t\t\t\t\tx = pt.x,\n\t\t\t\t\ty = pt.y,\n\t\t\t\t\trx = abs(radius.width),\n\t\t\t\t\try = abs(radius.height),\n\t\t\t\t\trxSq = rx * rx,\n\t\t\t\t\trySq = ry * ry,\n\t\t\t\t\txSq = x * x,\n\t\t\t\t\tySq = y * y;\n\t\t\t\tvar factor = sqrt(xSq / rxSq + ySq / rySq);\n\t\t\t\tif (factor > 1) {\n\t\t\t\t\trx *= factor;\n\t\t\t\t\try *= factor;\n\t\t\t\t\trxSq = rx * rx;\n\t\t\t\t\trySq = ry * ry;\n\t\t\t\t}\n\t\t\t\tfactor = (rxSq * rySq - rxSq * ySq - rySq * xSq) /\n\t\t\t\t\t\t(rxSq * ySq + rySq * xSq);\n\t\t\t\tif (abs(factor) < 1e-12)\n\t\t\t\t\tfactor = 0;\n\t\t\t\tif (factor < 0)\n\t\t\t\t\tthrow new Error(\n\t\t\t\t\t\t\t'Cannot create an arc with the given arguments');\n\t\t\t\tcenter = new Point(rx * y / ry, -ry * x / rx)\n\t\t\t\t\t\t.multiply((large === clockwise ? -1 : 1) * sqrt(factor))\n\t\t\t\t\t\t.rotate(rotation).add(middle);\n\t\t\t\tmatrix = new Matrix().translate(center).rotate(rotation)\n\t\t\t\t\t\t.scale(rx, ry);\n\t\t\t\tvector = matrix._inverseTransform(from);\n\t\t\t\textent = vector.getDirectedAngle(matrix._inverseTransform(to));\n\t\t\t\tif (!clockwise && extent > 0)\n\t\t\t\t\textent -= 360;\n\t\t\t\telse if (clockwise && extent < 0)\n\t\t\t\t\textent += 360;\n\t\t\t}\n\t\t\tif (through) {\n\t\t\t\tvar l1 = new Line(from.add(through).divide(2),\n\t\t\t\t\t\t\tthrough.subtract(from).rotate(90), true),\n\t\t\t\t\tl2 = new Line(through.add(to).divide(2),\n\t\t\t\t\t\t\tto.subtract(through).rotate(90), true),\n\t\t\t\t\tline = new Line(from, to),\n\t\t\t\t\tthroughSide = line.getSide(through);\n\t\t\t\tcenter = l1.intersect(l2, true);\n\t\t\t\tif (!center) {\n\t\t\t\t\tif (!throughSide)\n\t\t\t\t\t\treturn this.lineTo(to);\n\t\t\t\t\tthrow new Error(\n\t\t\t\t\t\t\t'Cannot create an arc with the given arguments');\n\t\t\t\t}\n\t\t\t\tvector = from.subtract(center);\n\t\t\t\textent = vector.getDirectedAngle(to.subtract(center));\n\t\t\t\tvar centerSide = line.getSide(center, true);\n\t\t\t\tif (centerSide === 0) {\n\t\t\t\t\textent = throughSide * abs(extent);\n\t\t\t\t} else if (throughSide === centerSide) {\n\t\t\t\t\textent += extent < 0 ? 360 : -360;\n\t\t\t\t}\n\t\t\t}\n\t\t\tvar epsilon = 1e-7,\n\t\t\t\text = abs(extent),\n\t\t\t\tcount = ext >= 360 ? 4 : Math.ceil((ext - epsilon) / 90),\n\t\t\t\tinc = extent / count,\n\t\t\t\thalf = inc * Math.PI / 360,\n\t\t\t\tz = 4 / 3 * Math.sin(half) / (1 + Math.cos(half)),\n\t\t\t\tsegments = [];\n\t\t\tfor (var i = 0; i <= count; i++) {\n\t\t\t\tvar pt = to,\n\t\t\t\t\tout = null;\n\t\t\t\tif (i < count) {\n\t\t\t\t\tout = vector.rotate(90).multiply(z);\n\t\t\t\t\tif (matrix) {\n\t\t\t\t\t\tpt = matrix._transformPoint(vector);\n\t\t\t\t\t\tout = matrix._transformPoint(vector.add(out))\n\t\t\t\t\t\t\t\t.subtract(pt);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tpt = center.add(vector);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (!i) {\n\t\t\t\t\tcurrent.setHandleOut(out);\n\t\t\t\t} else {\n\t\t\t\t\tvar _in = vector.rotate(-90).multiply(z);\n\t\t\t\t\tif (matrix) {\n\t\t\t\t\t\t_in = matrix._transformPoint(vector.add(_in))\n\t\t\t\t\t\t\t\t.subtract(pt);\n\t\t\t\t\t}\n\t\t\t\t\tsegments.push(new Segment(pt, _in, out));\n\t\t\t\t}\n\t\t\t\tvector = vector.rotate(inc);\n\t\t\t}\n\t\t\tthis._add(segments);\n\t\t},\n\n\t\tlineBy: function() {\n\t\t\tvar to = Point.read(arguments),\n\t\t\t\tcurrent = getCurrentSegment(this)._point;\n\t\t\tthis.lineTo(current.add(to));\n\t\t},\n\n\t\tcurveBy: function() {\n\t\t\tvar through = Point.read(arguments),\n\t\t\t\tto = Point.read(arguments),\n\t\t\t\tparameter = Base.read(arguments),\n\t\t\t\tcurrent = getCurrentSegment(this)._point;\n\t\t\tthis.curveTo(current.add(through), current.add(to), parameter);\n\t\t},\n\n\t\tcubicCurveBy: function() {\n\t\t\tvar handle1 = Point.read(arguments),\n\t\t\t\thandle2 = Point.read(arguments),\n\t\t\t\tto = Point.read(arguments),\n\t\t\t\tcurrent = getCurrentSegment(this)._point;\n\t\t\tthis.cubicCurveTo(current.add(handle1), current.add(handle2),\n\t\t\t\t\tcurrent.add(to));\n\t\t},\n\n\t\tquadraticCurveBy: function() {\n\t\t\tvar handle = Point.read(arguments),\n\t\t\t\tto = Point.read(arguments),\n\t\t\t\tcurrent = getCurrentSegment(this)._point;\n\t\t\tthis.quadraticCurveTo(current.add(handle), current.add(to));\n\t\t},\n\n\t\tarcBy: function() {\n\t\t\tvar current = getCurrentSegment(this)._point,\n\t\t\t\tpoint = current.add(Point.read(arguments)),\n\t\t\t\tclockwise = Base.pick(Base.peek(arguments), true);\n\t\t\tif (typeof clockwise === 'boolean') {\n\t\t\t\tthis.arcTo(point, clockwise);\n\t\t\t} else {\n\t\t\t\tthis.arcTo(point, current.add(Point.read(arguments)));\n\t\t\t}\n\t\t},\n\n\t\tclosePath: function(tolerance) {\n\t\t\tthis.setClosed(true);\n\t\t\tthis.join(this, tolerance);\n\t\t}\n\t};\n}, {\n\n\t_getBounds: function(matrix, options) {\n\t\tvar method = options.handle\n\t\t\t\t? 'getHandleBounds'\n\t\t\t\t: options.stroke\n\t\t\t\t? 'getStrokeBounds'\n\t\t\t\t: 'getBounds';\n\t\treturn Path[method](this._segments, this._closed, this, matrix, options);\n\t},\n\nstatics: {\n\tgetBounds: function(segments, closed, path, matrix, options, strokePadding) {\n\t\tvar first = segments[0];\n\t\tif (!first)\n\t\t\treturn new Rectangle();\n\t\tvar coords = new Array(6),\n\t\t\tprevCoords = first._transformCoordinates(matrix, new Array(6)),\n\t\t\tmin = prevCoords.slice(0, 2),\n\t\t\tmax = min.slice(),\n\t\t\troots = new Array(2);\n\n\t\tfunction processSegment(segment) {\n\t\t\tsegment._transformCoordinates(matrix, coords);\n\t\t\tfor (var i = 0; i < 2; i++) {\n\t\t\t\tCurve._addBounds(\n\t\t\t\t\tprevCoords[i],\n\t\t\t\t\tprevCoords[i + 4],\n\t\t\t\t\tcoords[i + 2],\n\t\t\t\t\tcoords[i],\n\t\t\t\t\ti, strokePadding ? strokePadding[i] : 0, min, max, roots);\n\t\t\t}\n\t\t\tvar tmp = prevCoords;\n\t\t\tprevCoords = coords;\n\t\t\tcoords = tmp;\n\t\t}\n\n\t\tfor (var i = 1, l = segments.length; i < l; i++)\n\t\t\tprocessSegment(segments[i]);\n\t\tif (closed)\n\t\t\tprocessSegment(first);\n\t\treturn new Rectangle(min[0], min[1], max[0] - min[0], max[1] - min[1]);\n\t},\n\n\tgetStrokeBounds: function(segments, closed, path, matrix, options) {\n\t\tvar style = path.getStyle(),\n\t\t\tstroke = style.hasStroke(),\n\t\t\tstrokeWidth = style.getStrokeWidth(),\n\t\t\tstrokeMatrix = stroke && path._getStrokeMatrix(matrix, options),\n\t\t\tstrokePadding = stroke && Path._getStrokePadding(strokeWidth,\n\t\t\t\tstrokeMatrix),\n\t\t\tbounds = Path.getBounds(segments, closed, path, matrix, options,\n\t\t\t\tstrokePadding);\n\t\tif (!stroke)\n\t\t\treturn bounds;\n\t\tvar strokeRadius = strokeWidth / 2,\n\t\t\tjoin = style.getStrokeJoin(),\n\t\t\tcap = style.getStrokeCap(),\n\t\t\tmiterLimit = style.getMiterLimit(),\n\t\t\tjoinBounds = new Rectangle(new Size(strokePadding));\n\n\t\tfunction addPoint(point) {\n\t\t\tbounds = bounds.include(point);\n\t\t}\n\n\t\tfunction addRound(segment) {\n\t\t\tbounds = bounds.unite(\n\t\t\t\t\tjoinBounds.setCenter(segment._point.transform(matrix)));\n\t\t}\n\n\t\tfunction addJoin(segment, join) {\n\t\t\tif (join === 'round' || segment.isSmooth()) {\n\t\t\t\taddRound(segment);\n\t\t\t} else {\n\t\t\t\tPath._addBevelJoin(segment, join, strokeRadius, miterLimit,\n\t\t\t\t\t\tmatrix, strokeMatrix, addPoint);\n\t\t\t}\n\t\t}\n\n\t\tfunction addCap(segment, cap) {\n\t\t\tif (cap === 'round') {\n\t\t\t\taddRound(segment);\n\t\t\t} else {\n\t\t\t\tPath._addSquareCap(segment, cap, strokeRadius, matrix,\n\t\t\t\t\t\tstrokeMatrix, addPoint);\n\t\t\t}\n\t\t}\n\n\t\tvar length = segments.length - (closed ? 0 : 1);\n\t\tfor (var i = 1; i < length; i++)\n\t\t\taddJoin(segments[i], join);\n\t\tif (closed) {\n\t\t\taddJoin(segments[0], join);\n\t\t} else if (length > 0) {\n\t\t\taddCap(segments[0], cap);\n\t\t\taddCap(segments[segments.length - 1], cap);\n\t\t}\n\t\treturn bounds;\n\t},\n\n\t_getStrokePadding: function(radius, matrix) {\n\t\tif (!matrix)\n\t\t\treturn [radius, radius];\n\t\tvar hor = new Point(radius, 0).transform(matrix),\n\t\t\tver = new Point(0, radius).transform(matrix),\n\t\t\tphi = hor.getAngleInRadians(),\n\t\t\ta = hor.getLength(),\n\t\t\tb = ver.getLength();\n\t\tvar sin = Math.sin(phi),\n\t\t\tcos = Math.cos(phi),\n\t\t\ttan = Math.tan(phi),\n\t\t\ttx = Math.atan2(b * tan, a),\n\t\t\tty = Math.atan2(b, tan * a);\n\t\treturn [Math.abs(a * Math.cos(tx) * cos + b * Math.sin(tx) * sin),\n\t\t\t\tMath.abs(b * Math.sin(ty) * cos + a * Math.cos(ty) * sin)];\n\t},\n\n\t_addBevelJoin: function(segment, join, radius, miterLimit, matrix,\n\t\t\tstrokeMatrix, addPoint, isArea) {\n\t\tvar curve2 = segment.getCurve(),\n\t\t\tcurve1 = curve2.getPrevious(),\n\t\t\tpoint = curve2.getPoint1().transform(matrix),\n\t\t\tnormal1 = curve1.getNormalAtTime(1).multiply(radius)\n\t\t\t\t.transform(strokeMatrix),\n\t\t\tnormal2 = curve2.getNormalAtTime(0).multiply(radius)\n\t\t\t\t.transform(strokeMatrix);\n\t\tif (normal1.getDirectedAngle(normal2) < 0) {\n\t\t\tnormal1 = normal1.negate();\n\t\t\tnormal2 = normal2.negate();\n\t\t}\n\t\tif (isArea)\n\t\t\taddPoint(point);\n\t\taddPoint(point.add(normal1));\n\t\tif (join === 'miter') {\n\t\t\tvar corner = new Line(point.add(normal1),\n\t\t\t\t\tnew Point(-normal1.y, normal1.x), true\n\t\t\t\t).intersect(new Line(point.add(normal2),\n\t\t\t\t\tnew Point(-normal2.y, normal2.x), true\n\t\t\t\t), true);\n\t\t\tif (corner && point.getDistance(corner) <= miterLimit * radius) {\n\t\t\t\taddPoint(corner);\n\t\t\t}\n\t\t}\n\t\taddPoint(point.add(normal2));\n\t},\n\n\t_addSquareCap: function(segment, cap, radius, matrix, strokeMatrix,\n\t\t\taddPoint, isArea) {\n\t\tvar point = segment._point.transform(matrix),\n\t\t\tloc = segment.getLocation(),\n\t\t\tnormal = loc.getNormal()\n\t\t\t\t\t.multiply(loc.getTime() === 0 ? radius : -radius)\n\t\t\t\t\t.transform(strokeMatrix);\n\t\tif (cap === 'square') {\n\t\t\tif (isArea) {\n\t\t\t\taddPoint(point.subtract(normal));\n\t\t\t\taddPoint(point.add(normal));\n\t\t\t}\n\t\t\tpoint = point.add(normal.rotate(-90));\n\t\t}\n\t\taddPoint(point.add(normal));\n\t\taddPoint(point.subtract(normal));\n\t},\n\n\tgetHandleBounds: function(segments, closed, path, matrix, options) {\n\t\tvar style = path.getStyle(),\n\t\t\tstroke = options.stroke && style.hasStroke(),\n\t\t\tstrokePadding,\n\t\t\tjoinPadding;\n\t\tif (stroke) {\n\t\t\tvar strokeMatrix = path._getStrokeMatrix(matrix, options),\n\t\t\t\tstrokeRadius = style.getStrokeWidth() / 2,\n\t\t\t\tjoinRadius = strokeRadius;\n\t\t\tif (style.getStrokeJoin() === 'miter')\n\t\t\t\tjoinRadius = strokeRadius * style.getMiterLimit();\n\t\t\tif (style.getStrokeCap() === 'square')\n\t\t\t\tjoinRadius = Math.max(joinRadius, strokeRadius * Math.SQRT2);\n\t\t\tstrokePadding = Path._getStrokePadding(strokeRadius, strokeMatrix);\n\t\t\tjoinPadding = Path._getStrokePadding(joinRadius, strokeMatrix);\n\t\t}\n\t\tvar coords = new Array(6),\n\t\t\tx1 = Infinity,\n\t\t\tx2 = -x1,\n\t\t\ty1 = x1,\n\t\t\ty2 = x2;\n\t\tfor (var i = 0, l = segments.length; i < l; i++) {\n\t\t\tvar segment = segments[i];\n\t\t\tsegment._transformCoordinates(matrix, coords);\n\t\t\tfor (var j = 0; j < 6; j += 2) {\n\t\t\t\tvar padding = !j ? joinPadding : strokePadding,\n\t\t\t\t\tpaddingX = padding ? padding[0] : 0,\n\t\t\t\t\tpaddingY = padding ? padding[1] : 0,\n\t\t\t\t\tx = coords[j],\n\t\t\t\t\ty = coords[j + 1],\n\t\t\t\t\txn = x - paddingX,\n\t\t\t\t\txx = x + paddingX,\n\t\t\t\t\tyn = y - paddingY,\n\t\t\t\t\tyx = y + paddingY;\n\t\t\t\tif (xn < x1) x1 = xn;\n\t\t\t\tif (xx > x2) x2 = xx;\n\t\t\t\tif (yn < y1) y1 = yn;\n\t\t\t\tif (yx > y2) y2 = yx;\n\t\t\t}\n\t\t}\n\t\treturn new Rectangle(x1, y1, x2 - x1, y2 - y1);\n\t}\n}});\n\nPath.inject({ statics: new function() {\n\n\tvar kappa = 0.5522847498307936,\n\t\tellipseSegments = [\n\t\t\tnew Segment([-1, 0], [0, kappa ], [0, -kappa]),\n\t\t\tnew Segment([0, -1], [-kappa, 0], [kappa, 0 ]),\n\t\t\tnew Segment([1, 0], [0, -kappa], [0, kappa ]),\n\t\t\tnew Segment([0, 1], [kappa, 0 ], [-kappa, 0])\n\t\t];\n\n\tfunction createPath(segments, closed, args) {\n\t\tvar props = Base.getNamed(args),\n\t\t\tpath = new Path(props && props.insert == false && Item.NO_INSERT);\n\t\tpath._add(segments);\n\t\tpath._closed = closed;\n\t\treturn path.set(props, { insert: true });\n\t}\n\n\tfunction createEllipse(center, radius, args) {\n\t\tvar segments = new Array(4);\n\t\tfor (var i = 0; i < 4; i++) {\n\t\t\tvar segment = ellipseSegments[i];\n\t\t\tsegments[i] = new Segment(\n\t\t\t\tsegment._point.multiply(radius).add(center),\n\t\t\t\tsegment._handleIn.multiply(radius),\n\t\t\t\tsegment._handleOut.multiply(radius)\n\t\t\t);\n\t\t}\n\t\treturn createPath(segments, true, args);\n\t}\n\n\treturn {\n\t\tLine: function() {\n\t\t\treturn createPath([\n\t\t\t\tnew Segment(Point.readNamed(arguments, 'from')),\n\t\t\t\tnew Segment(Point.readNamed(arguments, 'to'))\n\t\t\t], false, arguments);\n\t\t},\n\n\t\tCircle: function() {\n\t\t\tvar center = Point.readNamed(arguments, 'center'),\n\t\t\t\tradius = Base.readNamed(arguments, 'radius');\n\t\t\treturn createEllipse(center, new Size(radius), arguments);\n\t\t},\n\n\t\tRectangle: function() {\n\t\t\tvar rect = Rectangle.readNamed(arguments, 'rectangle'),\n\t\t\t\tradius = Size.readNamed(arguments, 'radius', 0,\n\t\t\t\t\t\t{ readNull: true }),\n\t\t\t\tbl = rect.getBottomLeft(true),\n\t\t\t\ttl = rect.getTopLeft(true),\n\t\t\t\ttr = rect.getTopRight(true),\n\t\t\t\tbr = rect.getBottomRight(true),\n\t\t\t\tsegments;\n\t\t\tif (!radius || radius.isZero()) {\n\t\t\t\tsegments = [\n\t\t\t\t\tnew Segment(bl),\n\t\t\t\t\tnew Segment(tl),\n\t\t\t\t\tnew Segment(tr),\n\t\t\t\t\tnew Segment(br)\n\t\t\t\t];\n\t\t\t} else {\n\t\t\t\tradius = Size.min(radius, rect.getSize(true).divide(2));\n\t\t\t\tvar rx = radius.width,\n\t\t\t\t\try = radius.height,\n\t\t\t\t\thx = rx * kappa,\n\t\t\t\t\thy = ry * kappa;\n\t\t\t\tsegments = [\n\t\t\t\t\tnew Segment(bl.add(rx, 0), null, [-hx, 0]),\n\t\t\t\t\tnew Segment(bl.subtract(0, ry), [0, hy]),\n\t\t\t\t\tnew Segment(tl.add(0, ry), null, [0, -hy]),\n\t\t\t\t\tnew Segment(tl.add(rx, 0), [-hx, 0], null),\n\t\t\t\t\tnew Segment(tr.subtract(rx, 0), null, [hx, 0]),\n\t\t\t\t\tnew Segment(tr.add(0, ry), [0, -hy], null),\n\t\t\t\t\tnew Segment(br.subtract(0, ry), null, [0, hy]),\n\t\t\t\t\tnew Segment(br.subtract(rx, 0), [hx, 0])\n\t\t\t\t];\n\t\t\t}\n\t\t\treturn createPath(segments, true, arguments);\n\t\t},\n\n\t\tRoundRectangle: '#Rectangle',\n\n\t\tEllipse: function() {\n\t\t\tvar ellipse = Shape._readEllipse(arguments);\n\t\t\treturn createEllipse(ellipse.center, ellipse.radius, arguments);\n\t\t},\n\n\t\tOval: '#Ellipse',\n\n\t\tArc: function() {\n\t\t\tvar from = Point.readNamed(arguments, 'from'),\n\t\t\t\tthrough = Point.readNamed(arguments, 'through'),\n\t\t\t\tto = Point.readNamed(arguments, 'to'),\n\t\t\t\tprops = Base.getNamed(arguments),\n\t\t\t\tpath = new Path(props && props.insert == false\n\t\t\t\t\t\t&& Item.NO_INSERT);\n\t\t\tpath.moveTo(from);\n\t\t\tpath.arcTo(through, to);\n\t\t\treturn path.set(props);\n\t\t},\n\n\t\tRegularPolygon: function() {\n\t\t\tvar center = Point.readNamed(arguments, 'center'),\n\t\t\t\tsides = Base.readNamed(arguments, 'sides'),\n\t\t\t\tradius = Base.readNamed(arguments, 'radius'),\n\t\t\t\tstep = 360 / sides,\n\t\t\t\tthree = sides % 3 === 0,\n\t\t\t\tvector = new Point(0, three ? -radius : radius),\n\t\t\t\toffset = three ? -1 : 0.5,\n\t\t\t\tsegments = new Array(sides);\n\t\t\tfor (var i = 0; i < sides; i++)\n\t\t\t\tsegments[i] = new Segment(center.add(\n\t\t\t\t\tvector.rotate((i + offset) * step)));\n\t\t\treturn createPath(segments, true, arguments);\n\t\t},\n\n\t\tStar: function() {\n\t\t\tvar center = Point.readNamed(arguments, 'center'),\n\t\t\t\tpoints = Base.readNamed(arguments, 'points') * 2,\n\t\t\t\tradius1 = Base.readNamed(arguments, 'radius1'),\n\t\t\t\tradius2 = Base.readNamed(arguments, 'radius2'),\n\t\t\t\tstep = 360 / points,\n\t\t\t\tvector = new Point(0, -1),\n\t\t\t\tsegments = new Array(points);\n\t\t\tfor (var i = 0; i < points; i++)\n\t\t\t\tsegments[i] = new Segment(center.add(vector.rotate(step * i)\n\t\t\t\t\t\t.multiply(i % 2 ? radius2 : radius1)));\n\t\t\treturn createPath(segments, true, arguments);\n\t\t}\n\t};\n}});\n\nvar CompoundPath = PathItem.extend({\n\t_class: 'CompoundPath',\n\t_serializeFields: {\n\t\tchildren: []\n\t},\n\tbeans: true,\n\n\tinitialize: function CompoundPath(arg) {\n\t\tthis._children = [];\n\t\tthis._namedChildren = {};\n\t\tif (!this._initialize(arg)) {\n\t\t\tif (typeof arg === 'string') {\n\t\t\t\tthis.setPathData(arg);\n\t\t\t} else {\n\t\t\t\tthis.addChildren(Array.isArray(arg) ? arg : arguments);\n\t\t\t}\n\t\t}\n\t},\n\n\tinsertChildren: function insertChildren(index, items) {\n\t\tvar list = items,\n\t\t\tfirst = list[0];\n\t\tif (first && typeof first[0] === 'number')\n\t\t\tlist = [list];\n\t\tfor (var i = items.length - 1; i >= 0; i--) {\n\t\t\tvar item = list[i];\n\t\t\tif (list === items && !(item instanceof Path))\n\t\t\t\tlist = Base.slice(list);\n\t\t\tif (Array.isArray(item)) {\n\t\t\t\tlist[i] = new Path({ segments: item, insert: false });\n\t\t\t} else if (item instanceof CompoundPath) {\n\t\t\t\tlist.splice.apply(list, [i, 1].concat(item.removeChildren()));\n\t\t\t\titem.remove();\n\t\t\t}\n\t\t}\n\t\treturn insertChildren.base.call(this, index, list);\n\t},\n\n\treduce: function reduce(options) {\n\t\tvar children = this._children;\n\t\tfor (var i = children.length - 1; i >= 0; i--) {\n\t\t\tvar path = children[i].reduce(options);\n\t\t\tif (path.isEmpty())\n\t\t\t\tpath.remove();\n\t\t}\n\t\tif (!children.length) {\n\t\t\tvar path = new Path(Item.NO_INSERT);\n\t\t\tpath.copyAttributes(this);\n\t\t\tpath.insertAbove(this);\n\t\t\tthis.remove();\n\t\t\treturn path;\n\t\t}\n\t\treturn reduce.base.call(this);\n\t},\n\n\tisClosed: function() {\n\t\tvar children = this._children;\n\t\tfor (var i = 0, l = children.length; i < l; i++) {\n\t\t\tif (!children[i]._closed)\n\t\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t},\n\n\tsetClosed: function(closed) {\n\t\tvar children = this._children;\n\t\tfor (var i = 0, l = children.length; i < l; i++) {\n\t\t\tchildren[i].setClosed(closed);\n\t\t}\n\t},\n\n\tgetFirstSegment: function() {\n\t\tvar first = this.getFirstChild();\n\t\treturn first && first.getFirstSegment();\n\t},\n\n\tgetLastSegment: function() {\n\t\tvar last = this.getLastChild();\n\t\treturn last && last.getLastSegment();\n\t},\n\n\tgetCurves: function() {\n\t\tvar children = this._children,\n\t\t\tcurves = [];\n\t\tfor (var i = 0, l = children.length; i < l; i++) {\n\t\t\tBase.push(curves, children[i].getCurves());\n\t\t}\n\t\treturn curves;\n\t},\n\n\tgetFirstCurve: function() {\n\t\tvar first = this.getFirstChild();\n\t\treturn first && first.getFirstCurve();\n\t},\n\n\tgetLastCurve: function() {\n\t\tvar last = this.getLastChild();\n\t\treturn last && last.getLastCurve();\n\t},\n\n\tgetArea: function() {\n\t\tvar children = this._children,\n\t\t\tarea = 0;\n\t\tfor (var i = 0, l = children.length; i < l; i++)\n\t\t\tarea += children[i].getArea();\n\t\treturn area;\n\t},\n\n\tgetLength: function() {\n\t\tvar children = this._children,\n\t\t\tlength = 0;\n\t\tfor (var i = 0, l = children.length; i < l; i++)\n\t\t\tlength += children[i].getLength();\n\t\treturn length;\n\t},\n\n\tgetPathData: function(_matrix, _precision) {\n\t\tvar children = this._children,\n\t\t\tpaths = [];\n\t\tfor (var i = 0, l = children.length; i < l; i++) {\n\t\t\tvar child = children[i],\n\t\t\t\tmx = child._matrix;\n\t\t\tpaths.push(child.getPathData(_matrix && !mx.isIdentity()\n\t\t\t\t\t? _matrix.appended(mx) : _matrix, _precision));\n\t\t}\n\t\treturn paths.join('');\n\t},\n\n\t_hitTestChildren: function _hitTestChildren(point, options, viewMatrix) {\n\t\treturn _hitTestChildren.base.call(this, point,\n\t\t\t\toptions.class === Path || options.type === 'path' ? options\n\t\t\t\t\t: Base.set({}, options, { fill: false }),\n\t\t\t\tviewMatrix);\n\t},\n\n\t_draw: function(ctx, param, viewMatrix, strokeMatrix) {\n\t\tvar children = this._children;\n\t\tif (!children.length)\n\t\t\treturn;\n\n\t\tparam = param.extend({ dontStart: true, dontFinish: true });\n\t\tctx.beginPath();\n\t\tfor (var i = 0, l = children.length; i < l; i++)\n\t\t\tchildren[i].draw(ctx, param, strokeMatrix);\n\n\t\tif (!param.clip) {\n\t\t\tthis._setStyles(ctx, param, viewMatrix);\n\t\t\tvar style = this._style;\n\t\t\tif (style.hasFill()) {\n\t\t\t\tctx.fill(style.getFillRule());\n\t\t\t\tctx.shadowColor = 'rgba(0,0,0,0)';\n\t\t\t}\n\t\t\tif (style.hasStroke())\n\t\t\t\tctx.stroke();\n\t\t}\n\t},\n\n\t_drawSelected: function(ctx, matrix, selectionItems) {\n\t\tvar children = this._children;\n\t\tfor (var i = 0, l = children.length; i < l; i++) {\n\t\t\tvar child = children[i],\n\t\t\t\tmx = child._matrix;\n\t\t\tif (!selectionItems[child._id]) {\n\t\t\t\tchild._drawSelected(ctx, mx.isIdentity() ? matrix\n\t\t\t\t\t\t: matrix.appended(mx));\n\t\t\t}\n\t\t}\n\t}\n},\nnew function() {\n\tfunction getCurrentPath(that, check) {\n\t\tvar children = that._children;\n\t\tif (check && !children.length)\n\t\t\tthrow new Error('Use a moveTo() command first');\n\t\treturn children[children.length - 1];\n\t}\n\n\treturn Base.each(['lineTo', 'cubicCurveTo', 'quadraticCurveTo', 'curveTo',\n\t\t\t'arcTo', 'lineBy', 'cubicCurveBy', 'quadraticCurveBy', 'curveBy',\n\t\t\t'arcBy'],\n\t\tfunction(key) {\n\t\t\tthis[key] = function() {\n\t\t\t\tvar path = getCurrentPath(this, true);\n\t\t\t\tpath[key].apply(path, arguments);\n\t\t\t};\n\t\t}, {\n\t\t\tmoveTo: function() {\n\t\t\t\tvar current = getCurrentPath(this),\n\t\t\t\t\tpath = current && current.isEmpty() ? current\n\t\t\t\t\t\t\t: new Path(Item.NO_INSERT);\n\t\t\t\tif (path !== current)\n\t\t\t\t\tthis.addChild(path);\n\t\t\t\tpath.moveTo.apply(path, arguments);\n\t\t\t},\n\n\t\t\tmoveBy: function() {\n\t\t\t\tvar current = getCurrentPath(this, true),\n\t\t\t\t\tlast = current && current.getLastSegment(),\n\t\t\t\t\tpoint = Point.read(arguments);\n\t\t\t\tthis.moveTo(last ? point.add(last._point) : point);\n\t\t\t},\n\n\t\t\tclosePath: function(tolerance) {\n\t\t\t\tgetCurrentPath(this, true).closePath(tolerance);\n\t\t\t}\n\t\t}\n\t);\n}, Base.each(['reverse', 'flatten', 'simplify', 'smooth'], function(key) {\n\tthis[key] = function(param) {\n\t\tvar children = this._children,\n\t\t\tres;\n\t\tfor (var i = 0, l = children.length; i < l; i++) {\n\t\t\tres = children[i][key](param) || res;\n\t\t}\n\t\treturn res;\n\t};\n}, {}));\n\nPathItem.inject(new function() {\n\tvar min = Math.min,\n\t\tmax = Math.max,\n\t\tabs = Math.abs,\n\t\toperators = {\n\t\t\tunite:     { '1': true, '2': true },\n\t\t\tintersect: { '2': true },\n\t\t\tsubtract:  { '1': true },\n\t\t\texclude:   { '1': true, '-1': true }\n\t\t};\n\n\tfunction preparePath(path, resolve) {\n\t\tvar res = path.clone(false).reduce({ simplify: true })\n\t\t\t\t.transform(null, true, true);\n\t\treturn resolve\n\t\t\t\t? res.resolveCrossings().reorient(\n\t\t\t\t\tres.getFillRule() === 'nonzero', true)\n\t\t\t\t: res;\n\t}\n\n\tfunction createResult(paths, simplify, path1, path2, options) {\n\t\tvar result = new CompoundPath(Item.NO_INSERT);\n\t\tresult.addChildren(paths, true);\n\t\tresult = result.reduce({ simplify: simplify });\n\t\tif (!(options && options.insert == false)) {\n\t\t\tresult.insertAbove(path2 && path1.isSibling(path2)\n\t\t\t\t\t&& path1.getIndex() < path2.getIndex() ? path2 : path1);\n\t\t}\n\t\tresult.copyAttributes(path1, true);\n\t\treturn result;\n\t}\n\n\tfunction traceBoolean(path1, path2, operation, options) {\n\t\tif (options && (options.trace == false || options.stroke) &&\n\t\t\t\t/^(subtract|intersect)$/.test(operation))\n\t\t\treturn splitBoolean(path1, path2, operation);\n\t\tvar _path1 = preparePath(path1, true),\n\t\t\t_path2 = path2 && path1 !== path2 && preparePath(path2, true),\n\t\t\toperator = operators[operation];\n\t\toperator[operation] = true;\n\t\tif (_path2 && (operator.subtract || operator.exclude)\n\t\t\t\t^ (_path2.isClockwise() ^ _path1.isClockwise()))\n\t\t\t_path2.reverse();\n\t\tvar crossings = divideLocations(\n\t\t\t\tCurveLocation.expand(_path1.getCrossings(_path2))),\n\t\t\tpaths1 = _path1._children || [_path1],\n\t\t\tpaths2 = _path2 && (_path2._children || [_path2]),\n\t\t\tsegments = [],\n\t\t\tcurves = [],\n\t\t\tpaths;\n\n\t\tfunction collect(paths) {\n\t\t\tfor (var i = 0, l = paths.length; i < l; i++) {\n\t\t\t\tvar path = paths[i];\n\t\t\t\tBase.push(segments, path._segments);\n\t\t\t\tBase.push(curves, path.getCurves());\n\t\t\t\tpath._overlapsOnly = true;\n\t\t\t}\n\t\t}\n\n\t\tif (crossings.length) {\n\t\t\tcollect(paths1);\n\t\t\tif (paths2)\n\t\t\t\tcollect(paths2);\n\t\t\tfor (var i = 0, l = crossings.length; i < l; i++) {\n\t\t\t\tpropagateWinding(crossings[i]._segment, _path1, _path2, curves,\n\t\t\t\t\t\toperator);\n\t\t\t}\n\t\t\tfor (var i = 0, l = segments.length; i < l; i++) {\n\t\t\t\tvar segment = segments[i],\n\t\t\t\t\tinter = segment._intersection;\n\t\t\t\tif (!segment._winding) {\n\t\t\t\t\tpropagateWinding(segment, _path1, _path2, curves, operator);\n\t\t\t\t}\n\t\t\t\tif (!(inter && inter._overlap))\n\t\t\t\t\tsegment._path._overlapsOnly = false;\n\t\t\t}\n\t\t\tpaths = tracePaths(segments, operator);\n\t\t} else {\n\t\t\tpaths = reorientPaths(\n\t\t\t\t\tpaths2 ? paths1.concat(paths2) : paths1.slice(),\n\t\t\t\t\tfunction(w) {\n\t\t\t\t\t\treturn !!operator[w];\n\t\t\t\t\t});\n\t\t}\n\n\t\treturn createResult(paths, true, path1, path2, options);\n\t}\n\n\tfunction splitBoolean(path1, path2, operation) {\n\t\tvar _path1 = preparePath(path1),\n\t\t\t_path2 = preparePath(path2),\n\t\t\tcrossings = _path1.getCrossings(_path2),\n\t\t\tsubtract = operation === 'subtract',\n\t\t\tdivide = operation === 'divide',\n\t\t\tadded = {},\n\t\t\tpaths = [];\n\n\t\tfunction addPath(path) {\n\t\t\tif (!added[path._id] && (divide ||\n\t\t\t\t\t_path2.contains(path.getPointAt(path.getLength() / 2))\n\t\t\t\t\t\t^ subtract)) {\n\t\t\t\tpaths.unshift(path);\n\t\t\t\treturn added[path._id] = true;\n\t\t\t}\n\t\t}\n\n\t\tfor (var i = crossings.length - 1; i >= 0; i--) {\n\t\t\tvar path = crossings[i].split();\n\t\t\tif (path) {\n\t\t\t\tif (addPath(path))\n\t\t\t\t\tpath.getFirstSegment().setHandleIn(0, 0);\n\t\t\t\t_path1.getLastSegment().setHandleOut(0, 0);\n\t\t\t}\n\t\t}\n\t\taddPath(_path1);\n\t\treturn createResult(paths, false, path1, path2);\n\t}\n\n\tfunction linkIntersections(from, to) {\n\t\tvar prev = from;\n\t\twhile (prev) {\n\t\t\tif (prev === to)\n\t\t\t\treturn;\n\t\t\tprev = prev._previous;\n\t\t}\n\t\twhile (from._next && from._next !== to)\n\t\t\tfrom = from._next;\n\t\tif (!from._next) {\n\t\t\twhile (to._previous)\n\t\t\t\tto = to._previous;\n\t\t\tfrom._next = to;\n\t\t\tto._previous = from;\n\t\t}\n\t}\n\n\tfunction clearCurveHandles(curves) {\n\t\tfor (var i = curves.length - 1; i >= 0; i--)\n\t\t\tcurves[i].clearHandles();\n\t}\n\n\tfunction reorientPaths(paths, isInside, clockwise) {\n\t\tvar length = paths && paths.length;\n\t\tif (length) {\n\t\t\tvar lookup = Base.each(paths, function (path, i) {\n\t\t\t\t\tthis[path._id] = {\n\t\t\t\t\t\tcontainer: null,\n\t\t\t\t\t\twinding: path.isClockwise() ? 1 : -1,\n\t\t\t\t\t\tindex: i\n\t\t\t\t\t};\n\t\t\t\t}, {}),\n\t\t\t\tsorted = paths.slice().sort(function (a, b) {\n\t\t\t\t\treturn abs(b.getArea()) - abs(a.getArea());\n\t\t\t\t}),\n\t\t\t\tfirst = sorted[0];\n\t\t\tif (clockwise == null)\n\t\t\t\tclockwise = first.isClockwise();\n\t\t\tfor (var i = 0; i < length; i++) {\n\t\t\t\tvar path1 = sorted[i],\n\t\t\t\t\tentry1 = lookup[path1._id],\n\t\t\t\t\tpoint = path1.getInteriorPoint(),\n\t\t\t\t\tcontainerWinding = 0;\n\t\t\t\tfor (var j = i - 1; j >= 0; j--) {\n\t\t\t\t\tvar path2 = sorted[j];\n\t\t\t\t\tif (path2.contains(point)) {\n\t\t\t\t\t\tvar entry2 = lookup[path2._id];\n\t\t\t\t\t\tcontainerWinding = entry2.winding;\n\t\t\t\t\t\tentry1.winding += containerWinding;\n\t\t\t\t\t\tentry1.container = entry2.exclude ? entry2.container\n\t\t\t\t\t\t\t\t: path2;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (isInside(entry1.winding) === isInside(containerWinding)) {\n\t\t\t\t\tentry1.exclude = true;\n\t\t\t\t\tpaths[entry1.index] = null;\n\t\t\t\t} else {\n\t\t\t\t\tvar container = entry1.container;\n\t\t\t\t\tpath1.setClockwise(container ? !container.isClockwise()\n\t\t\t\t\t\t\t: clockwise);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn paths;\n\t}\n\n\tfunction divideLocations(locations, include, clearLater) {\n\t\tvar results = include && [],\n\t\t\ttMin = 1e-8,\n\t\t\ttMax = 1 - tMin,\n\t\t\tclearHandles = false,\n\t\t\tclearCurves = clearLater || [],\n\t\t\tclearLookup = clearLater && {},\n\t\t\trenormalizeLocs,\n\t\t\tprevCurve,\n\t\t\tprevTime;\n\n\t\tfunction getId(curve) {\n\t\t\treturn curve._path._id + '.' + curve._segment1._index;\n\t\t}\n\n\t\tfor (var i = (clearLater && clearLater.length) - 1; i >= 0; i--) {\n\t\t\tvar curve = clearLater[i];\n\t\t\tif (curve._path)\n\t\t\t\tclearLookup[getId(curve)] = true;\n\t\t}\n\n\t\tfor (var i = locations.length - 1; i >= 0; i--) {\n\t\t\tvar loc = locations[i],\n\t\t\t\ttime = loc._time,\n\t\t\t\torigTime = time,\n\t\t\t\texclude = include && !include(loc),\n\t\t\t\tcurve = loc._curve,\n\t\t\t\tsegment;\n\t\t\tif (curve) {\n\t\t\t\tif (curve !== prevCurve) {\n\t\t\t\t\tclearHandles = !curve.hasHandles()\n\t\t\t\t\t\t\t|| clearLookup && clearLookup[getId(curve)];\n\t\t\t\t\trenormalizeLocs = [];\n\t\t\t\t\tprevTime = null;\n\t\t\t\t\tprevCurve = curve;\n\t\t\t\t} else if (prevTime >= tMin) {\n\t\t\t\t\ttime /= prevTime;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (exclude) {\n\t\t\t\tif (renormalizeLocs)\n\t\t\t\t\trenormalizeLocs.push(loc);\n\t\t\t\tcontinue;\n\t\t\t} else if (include) {\n\t\t\t\tresults.unshift(loc);\n\t\t\t}\n\t\t\tprevTime = origTime;\n\t\t\tif (time < tMin) {\n\t\t\t\tsegment = curve._segment1;\n\t\t\t} else if (time > tMax) {\n\t\t\t\tsegment = curve._segment2;\n\t\t\t} else {\n\t\t\t\tvar newCurve = curve.divideAtTime(time, true);\n\t\t\t\tif (clearHandles)\n\t\t\t\t\tclearCurves.push(curve, newCurve);\n\t\t\t\tsegment = newCurve._segment1;\n\t\t\t\tfor (var j = renormalizeLocs.length - 1; j >= 0; j--) {\n\t\t\t\t\tvar l = renormalizeLocs[j];\n\t\t\t\t\tl._time = (l._time - time) / (1 - time);\n\t\t\t\t}\n\t\t\t}\n\t\t\tloc._setSegment(segment);\n\t\t\tvar inter = segment._intersection,\n\t\t\t\tdest = loc._intersection;\n\t\t\tif (inter) {\n\t\t\t\tlinkIntersections(inter, dest);\n\t\t\t\tvar other = inter;\n\t\t\t\twhile (other) {\n\t\t\t\t\tlinkIntersections(other._intersection, inter);\n\t\t\t\t\tother = other._next;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tsegment._intersection = dest;\n\t\t\t}\n\t\t}\n\t\tif (!clearLater)\n\t\t\tclearCurveHandles(clearCurves);\n\t\treturn results || locations;\n\t}\n\n\tfunction getWinding(point, curves, dir, closed, dontFlip) {\n\t\tvar ia = dir ? 1 : 0,\n\t\t\tio = ia ^ 1,\n\t\t\tpv = [point.x, point.y],\n\t\t\tpa = pv[ia],\n\t\t\tpo = pv[io],\n\t\t\twindingEpsilon = 1e-9,\n\t\t\tqualityEpsilon = 1e-6,\n\t\t\tpaL = pa - windingEpsilon,\n\t\t\tpaR = pa + windingEpsilon,\n\t\t\twindingL = 0,\n\t\t\twindingR = 0,\n\t\t\tpathWindingL = 0,\n\t\t\tpathWindingR = 0,\n\t\t\tonPath = false,\n\t\t\tonAnyPath = false,\n\t\t\tquality = 1,\n\t\t\troots = [],\n\t\t\tvPrev,\n\t\t\tvClose;\n\n\t\tfunction addWinding(v) {\n\t\t\tvar o0 = v[io + 0],\n\t\t\t\to3 = v[io + 6];\n\t\t\tif (po < min(o0, o3) || po > max(o0, o3)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar a0 = v[ia + 0],\n\t\t\t\ta1 = v[ia + 2],\n\t\t\t\ta2 = v[ia + 4],\n\t\t\t\ta3 = v[ia + 6];\n\t\t\tif (o0 === o3) {\n\t\t\t\tif (a0 < paR && a3 > paL || a3 < paR && a0 > paL) {\n\t\t\t\t\tonPath = true;\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar t =   po === o0 ? 0\n\t\t\t\t\t: po === o3 ? 1\n\t\t\t\t\t: paL > max(a0, a1, a2, a3) || paR < min(a0, a1, a2, a3)\n\t\t\t\t\t? 1\n\t\t\t\t\t: Curve.solveCubic(v, io, po, roots, 0, 1) > 0\n\t\t\t\t\t\t? roots[0]\n\t\t\t\t\t\t: 1,\n\t\t\t\ta =   t === 0 ? a0\n\t\t\t\t\t: t === 1 ? a3\n\t\t\t\t\t: Curve.getPoint(v, t)[dir ? 'y' : 'x'],\n\t\t\t\twinding = o0 > o3 ? 1 : -1,\n\t\t\t\twindingPrev = vPrev[io] > vPrev[io + 6] ? 1 : -1,\n\t\t\t\ta3Prev = vPrev[ia + 6];\n\t\t\tif (po !== o0) {\n\t\t\t\tif (a < paL) {\n\t\t\t\t\tpathWindingL += winding;\n\t\t\t\t} else if (a > paR) {\n\t\t\t\t\tpathWindingR += winding;\n\t\t\t\t} else {\n\t\t\t\t\tonPath = true;\n\t\t\t\t}\n\t\t\t\tif (a > pa - qualityEpsilon && a < pa + qualityEpsilon)\n\t\t\t\t\tquality /= 2;\n\t\t\t} else {\n\t\t\t\tif (winding !== windingPrev) {\n\t\t\t\t\tif (a0 < paL) {\n\t\t\t\t\t\tpathWindingL += winding;\n\t\t\t\t\t} else if (a0 > paR) {\n\t\t\t\t\t\tpathWindingR += winding;\n\t\t\t\t\t}\n\t\t\t\t} else if (a0 != a3Prev) {\n\t\t\t\t\tif (a3Prev < paR && a > paR) {\n\t\t\t\t\t\tpathWindingR += winding;\n\t\t\t\t\t\tonPath = true;\n\t\t\t\t\t} else if (a3Prev > paL && a < paL) {\n\t\t\t\t\t\tpathWindingL += winding;\n\t\t\t\t\t\tonPath = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tquality = 0;\n\t\t\t}\n\t\t\tvPrev = v;\n\t\t\treturn !dontFlip && a > paL && a < paR\n\t\t\t\t\t&& Curve.getTangent(v, t)[dir ? 'x' : 'y'] === 0\n\t\t\t\t\t&& getWinding(point, curves, !dir, closed, true);\n\t\t}\n\n\t\tfunction handleCurve(v) {\n\t\t\tvar o0 = v[io + 0],\n\t\t\t\to1 = v[io + 2],\n\t\t\t\to2 = v[io + 4],\n\t\t\t\to3 = v[io + 6];\n\t\t\tif (po <= max(o0, o1, o2, o3) && po >= min(o0, o1, o2, o3)) {\n\t\t\t\tvar a0 = v[ia + 0],\n\t\t\t\t\ta1 = v[ia + 2],\n\t\t\t\t\ta2 = v[ia + 4],\n\t\t\t\t\ta3 = v[ia + 6],\n\t\t\t\t\tmonoCurves = paL > max(a0, a1, a2, a3) ||\n\t\t\t\t\t\t\t\t paR < min(a0, a1, a2, a3)\n\t\t\t\t\t\t\t? [v] : Curve.getMonoCurves(v, dir),\n\t\t\t\t\tres;\n\t\t\t\tfor (var i = 0, l = monoCurves.length; i < l; i++) {\n\t\t\t\t\tif (res = addWinding(monoCurves[i]))\n\t\t\t\t\t\treturn res;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfor (var i = 0, l = curves.length; i < l; i++) {\n\t\t\tvar curve = curves[i],\n\t\t\t\tpath = curve._path,\n\t\t\t\tv = curve.getValues(),\n\t\t\t\tres;\n\t\t\tif (!i || curves[i - 1]._path !== path) {\n\t\t\t\tvPrev = null;\n\t\t\t\tif (!path._closed) {\n\t\t\t\t\tvClose = Curve.getValues(\n\t\t\t\t\t\t\tpath.getLastCurve().getSegment2(),\n\t\t\t\t\t\t\tcurve.getSegment1(),\n\t\t\t\t\t\t\tnull, !closed);\n\t\t\t\t\tif (vClose[io] !== vClose[io + 6]) {\n\t\t\t\t\t\tvPrev = vClose;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (!vPrev) {\n\t\t\t\t\tvPrev = v;\n\t\t\t\t\tvar prev = path.getLastCurve();\n\t\t\t\t\twhile (prev && prev !== curve) {\n\t\t\t\t\t\tvar v2 = prev.getValues();\n\t\t\t\t\t\tif (v2[io] !== v2[io + 6]) {\n\t\t\t\t\t\t\tvPrev = v2;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tprev = prev.getPrevious();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (res = handleCurve(v))\n\t\t\t\treturn res;\n\n\t\t\tif (i + 1 === l || curves[i + 1]._path !== path) {\n\t\t\t\tif (vClose && (res = handleCurve(vClose)))\n\t\t\t\t\treturn res;\n\t\t\t\tif (onPath && !pathWindingL && !pathWindingR) {\n\t\t\t\t\tpathWindingL = pathWindingR = path.isClockwise(closed) ^ dir\n\t\t\t\t\t\t\t? 1 : -1;\n\t\t\t\t}\n\t\t\t\twindingL += pathWindingL;\n\t\t\t\twindingR += pathWindingR;\n\t\t\t\tpathWindingL = pathWindingR = 0;\n\t\t\t\tif (onPath) {\n\t\t\t\t\tonAnyPath = true;\n\t\t\t\t\tonPath = false;\n\t\t\t\t}\n\t\t\t\tvClose = null;\n\t\t\t}\n\t\t}\n\t\twindingL = abs(windingL);\n\t\twindingR = abs(windingR);\n\t\treturn {\n\t\t\twinding: max(windingL, windingR),\n\t\t\twindingL: windingL,\n\t\t\twindingR: windingR,\n\t\t\tquality: quality,\n\t\t\tonPath: onAnyPath\n\t\t};\n\t}\n\n\tfunction propagateWinding(segment, path1, path2, curves, operator) {\n\t\tvar chain = [],\n\t\t\tstart = segment,\n\t\t\ttotalLength = 0,\n\t\t\twinding;\n\t\tdo {\n\t\t\tvar curve = segment.getCurve(),\n\t\t\t\tlength = curve.getLength();\n\t\t\tchain.push({ segment: segment, curve: curve, length: length });\n\t\t\ttotalLength += length;\n\t\t\tsegment = segment.getNext();\n\t\t} while (segment && !segment._intersection && segment !== start);\n\t\tvar offsets = [0.5, 0.25, 0.75],\n\t\t\twinding = { winding: 0, quality: -1 },\n\t\t\ttMin = 1e-8,\n\t\t\ttMax = 1 - tMin;\n\t\tfor (var i = 0; i < offsets.length && winding.quality < 0.5; i++) {\n\t\t\tvar length = totalLength * offsets[i];\n\t\t\tfor (var j = 0, l = chain.length; j < l; j++) {\n\t\t\t\tvar entry = chain[j],\n\t\t\t\t\tcurveLength = entry.length;\n\t\t\t\tif (length <= curveLength) {\n\t\t\t\t\tvar curve = entry.curve,\n\t\t\t\t\t\tpath = curve._path,\n\t\t\t\t\t\tparent = path._parent,\n\t\t\t\t\t\toperand = parent instanceof CompoundPath ? parent : path,\n\t\t\t\t\t\tt = Numerical.clamp(curve.getTimeAt(length), tMin, tMax),\n\t\t\t\t\t\tpt = curve.getPointAtTime(t),\n\t\t\t\t\t\tdir = abs(curve.getTangentAtTime(t).y) < Math.SQRT1_2;\n\t\t\t\t\tvar wind = null;\n\t\t\t\t\tif (operator.subtract && path2) {\n\t\t\t\t\t\tvar pathWinding = operand === path1\n\t\t\t\t\t\t\t\t\t\t  ? path2._getWinding(pt, dir, true)\n\t\t\t\t\t\t\t\t\t\t  : path1._getWinding(pt, dir, true);\n\t\t\t\t\t\tif (operand === path1 && pathWinding.winding ||\n\t\t\t\t\t\t\toperand === path2 && !pathWinding.winding) {\n\t\t\t\t\t\t\tif (pathWinding.quality < 1) {\n\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\twind = { winding: 0, quality: 1 };\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\twind = wind || getWinding(pt, curves, dir, true);\n\t\t\t\t\tif (wind.quality > winding.quality)\n\t\t\t\t\t\twinding = wind;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tlength -= curveLength;\n\t\t\t}\n\t\t}\n\t\tfor (var j = chain.length - 1; j >= 0; j--) {\n\t\t\tchain[j].segment._winding = winding;\n\t\t}\n\t}\n\n\tfunction tracePaths(segments, operator) {\n\t\tvar paths = [],\n\t\t\tstarts;\n\n\t\tfunction isValid(seg) {\n\t\t\tvar winding;\n\t\t\treturn !!(seg && !seg._visited && (!operator\n\t\t\t\t\t|| operator[(winding = seg._winding || {}).winding]\n\t\t\t\t\t\t&& !(operator.unite && winding.winding === 2\n\t\t\t\t\t\t\t&& winding.windingL && winding.windingR)));\n\t\t}\n\n\t\tfunction isStart(seg) {\n\t\t\tif (seg) {\n\t\t\t\tfor (var i = 0, l = starts.length; i < l; i++) {\n\t\t\t\t\tif (seg === starts[i])\n\t\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn false;\n\t\t}\n\n\t\tfunction visitPath(path) {\n\t\t\tvar segments = path._segments;\n\t\t\tfor (var i = 0, l = segments.length; i < l; i++) {\n\t\t\t\tsegments[i]._visited = true;\n\t\t\t}\n\t\t}\n\n\t\tfunction getCrossingSegments(segment, collectStarts) {\n\t\t\tvar inter = segment._intersection,\n\t\t\t\tstart = inter,\n\t\t\t\tcrossings = [];\n\t\t\tif (collectStarts)\n\t\t\t\tstarts = [segment];\n\n\t\t\tfunction collect(inter, end) {\n\t\t\t\twhile (inter && inter !== end) {\n\t\t\t\t\tvar other = inter._segment,\n\t\t\t\t\t\tpath = other && other._path;\n\t\t\t\t\tif (path) {\n\t\t\t\t\t\tvar next = other.getNext() || path.getFirstSegment(),\n\t\t\t\t\t\t\tnextInter = next._intersection;\n\t\t\t\t\t\tif (other !== segment && (isStart(other)\n\t\t\t\t\t\t\t|| isStart(next)\n\t\t\t\t\t\t\t|| next && (isValid(other) && (isValid(next)\n\t\t\t\t\t\t\t\t|| nextInter && isValid(nextInter._segment))))\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\tcrossings.push(other);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (collectStarts)\n\t\t\t\t\t\t\tstarts.push(other);\n\t\t\t\t\t}\n\t\t\t\t\tinter = inter._next;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (inter) {\n\t\t\t\tcollect(inter);\n\t\t\t\twhile (inter && inter._prev)\n\t\t\t\t\tinter = inter._prev;\n\t\t\t\tcollect(inter, start);\n\t\t\t}\n\t\t\treturn crossings;\n\t\t}\n\n\t\tsegments.sort(function(seg1, seg2) {\n\t\t\tvar inter1 = seg1._intersection,\n\t\t\t\tinter2 = seg2._intersection,\n\t\t\t\tover1 = !!(inter1 && inter1._overlap),\n\t\t\t\tover2 = !!(inter2 && inter2._overlap),\n\t\t\t\tpath1 = seg1._path,\n\t\t\t\tpath2 = seg2._path;\n\t\t\treturn over1 ^ over2\n\t\t\t\t\t? over1 ? 1 : -1\n\t\t\t\t\t: !inter1 ^ !inter2\n\t\t\t\t\t\t? inter1 ? 1 : -1\n\t\t\t\t\t\t: path1 !== path2\n\t\t\t\t\t\t\t? path1._id - path2._id\n\t\t\t\t\t\t\t: seg1._index - seg2._index;\n\t\t});\n\n\t\tfor (var i = 0, l = segments.length; i < l; i++) {\n\t\t\tvar seg = segments[i],\n\t\t\t\tvalid = isValid(seg),\n\t\t\t\tpath = null,\n\t\t\t\tfinished = false,\n\t\t\t\tclosed = true,\n\t\t\t\tbranches = [],\n\t\t\t\tbranch,\n\t\t\t\tvisited,\n\t\t\t\thandleIn;\n\t\t\tif (valid && seg._path._overlapsOnly) {\n\t\t\t\tvar path1 = seg._path,\n\t\t\t\t\tpath2 = seg._intersection._segment._path;\n\t\t\t\tif (path1.compare(path2)) {\n\t\t\t\t\tif (path1.getArea())\n\t\t\t\t\t\tpaths.push(path1.clone(false));\n\t\t\t\t\tvisitPath(path1);\n\t\t\t\t\tvisitPath(path2);\n\t\t\t\t\tvalid = false;\n\t\t\t\t}\n\t\t\t}\n\t\t\twhile (valid) {\n\t\t\t\tvar first = !path,\n\t\t\t\t\tcrossings = getCrossingSegments(seg, first),\n\t\t\t\t\tother = crossings.shift(),\n\t\t\t\t\tfinished = !first && (isStart(seg) || isStart(other)),\n\t\t\t\t\tcross = !finished && other;\n\t\t\t\tif (first) {\n\t\t\t\t\tpath = new Path(Item.NO_INSERT);\n\t\t\t\t\tbranch = null;\n\t\t\t\t}\n\t\t\t\tif (finished) {\n\t\t\t\t\tif (seg.isFirst() || seg.isLast())\n\t\t\t\t\t\tclosed = seg._path._closed;\n\t\t\t\t\tseg._visited = true;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tif (cross && branch) {\n\t\t\t\t\tbranches.push(branch);\n\t\t\t\t\tbranch = null;\n\t\t\t\t}\n\t\t\t\tif (!branch) {\n\t\t\t\t\tif (cross)\n\t\t\t\t\t\tcrossings.push(seg);\n\t\t\t\t\tbranch = {\n\t\t\t\t\t\tstart: path._segments.length,\n\t\t\t\t\t\tcrossings: crossings,\n\t\t\t\t\t\tvisited: visited = [],\n\t\t\t\t\t\thandleIn: handleIn\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\tif (cross)\n\t\t\t\t\tseg = other;\n\t\t\t\tif (!isValid(seg)) {\n\t\t\t\t\tpath.removeSegments(branch.start);\n\t\t\t\t\tfor (var j = 0, k = visited.length; j < k; j++) {\n\t\t\t\t\t\tvisited[j]._visited = false;\n\t\t\t\t\t}\n\t\t\t\t\tvisited.length = 0;\n\t\t\t\t\tdo {\n\t\t\t\t\t\tseg = branch && branch.crossings.shift();\n\t\t\t\t\t\tif (!seg || !seg._path) {\n\t\t\t\t\t\t\tseg = null;\n\t\t\t\t\t\t\tbranch = branches.pop();\n\t\t\t\t\t\t\tif (branch) {\n\t\t\t\t\t\t\t\tvisited = branch.visited;\n\t\t\t\t\t\t\t\thandleIn = branch.handleIn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} while (branch && !isValid(seg));\n\t\t\t\t\tif (!seg)\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tvar next = seg.getNext();\n\t\t\t\tpath.add(new Segment(seg._point, handleIn,\n\t\t\t\t\t\tnext && seg._handleOut));\n\t\t\t\tseg._visited = true;\n\t\t\t\tvisited.push(seg);\n\t\t\t\tseg = next || seg._path.getFirstSegment();\n\t\t\t\thandleIn = next && next._handleIn;\n\t\t\t}\n\t\t\tif (finished) {\n\t\t\t\tif (closed) {\n\t\t\t\t\tpath.getFirstSegment().setHandleIn(handleIn);\n\t\t\t\t\tpath.setClosed(closed);\n\t\t\t\t}\n\t\t\t\tif (path.getArea() !== 0) {\n\t\t\t\t\tpaths.push(path);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn paths;\n\t}\n\n\treturn {\n\t\t_getWinding: function(point, dir, closed) {\n\t\t\treturn getWinding(point, this.getCurves(), dir, closed);\n\t\t},\n\n\t\tunite: function(path, options) {\n\t\t\treturn traceBoolean(this, path, 'unite', options);\n\t\t},\n\n\t\tintersect: function(path, options) {\n\t\t\treturn traceBoolean(this, path, 'intersect', options);\n\t\t},\n\n\t\tsubtract: function(path, options) {\n\t\t\treturn traceBoolean(this, path, 'subtract', options);\n\t\t},\n\n\t\texclude: function(path, options) {\n\t\t\treturn traceBoolean(this, path, 'exclude', options);\n\t\t},\n\n\t\tdivide: function(path, options) {\n\t\t\treturn options && (options.trace == false || options.stroke)\n\t\t\t\t\t? splitBoolean(this, path, 'divide')\n\t\t\t\t\t: createResult([\n\t\t\t\t\t\tthis.subtract(path, options),\n\t\t\t\t\t\tthis.intersect(path, options)\n\t\t\t\t\t], true, this, path, options);\n\t\t},\n\n\t\tresolveCrossings: function() {\n\t\t\tvar children = this._children,\n\t\t\t\tpaths = children || [this];\n\n\t\t\tfunction hasOverlap(seg, path) {\n\t\t\t\tvar inter = seg && seg._intersection;\n\t\t\t\treturn inter && inter._overlap && inter._path === path;\n\t\t\t}\n\n\t\t\tvar hasOverlaps = false,\n\t\t\t\thasCrossings = false,\n\t\t\t\tintersections = this.getIntersections(null, function(inter) {\n\t\t\t\t\treturn inter.hasOverlap() && (hasOverlaps = true) ||\n\t\t\t\t\t\t\tinter.isCrossing() && (hasCrossings = true);\n\t\t\t\t}),\n\t\t\t\tclearCurves = hasOverlaps && hasCrossings && [];\n\t\t\tintersections = CurveLocation.expand(intersections);\n\t\t\tif (hasOverlaps) {\n\t\t\t\tvar overlaps = divideLocations(intersections, function(inter) {\n\t\t\t\t\treturn inter.hasOverlap();\n\t\t\t\t}, clearCurves);\n\t\t\t\tfor (var i = overlaps.length - 1; i >= 0; i--) {\n\t\t\t\t\tvar overlap = overlaps[i],\n\t\t\t\t\t\tpath = overlap._path,\n\t\t\t\t\t\tseg = overlap._segment,\n\t\t\t\t\t\tprev = seg.getPrevious(),\n\t\t\t\t\t\tnext = seg.getNext();\n\t\t\t\t\tif (hasOverlap(prev, path) && hasOverlap(next, path)) {\n\t\t\t\t\t\tseg.remove();\n\t\t\t\t\t\tprev._handleOut._set(0, 0);\n\t\t\t\t\t\tnext._handleIn._set(0, 0);\n\t\t\t\t\t\tif (prev !== seg && !prev.getCurve().hasLength()) {\n\t\t\t\t\t\t\tnext._handleIn.set(prev._handleIn);\n\t\t\t\t\t\t\tprev.remove();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (hasCrossings) {\n\t\t\t\tdivideLocations(intersections, hasOverlaps && function(inter) {\n\t\t\t\t\tvar curve1 = inter.getCurve(),\n\t\t\t\t\t\tseg1 = inter.getSegment(),\n\t\t\t\t\t\tother = inter._intersection,\n\t\t\t\t\t\tcurve2 = other._curve,\n\t\t\t\t\t\tseg2 = other._segment;\n\t\t\t\t\tif (curve1 && curve2 && curve1._path && curve2._path)\n\t\t\t\t\t\treturn true;\n\t\t\t\t\tif (seg1)\n\t\t\t\t\t\tseg1._intersection = null;\n\t\t\t\t\tif (seg2)\n\t\t\t\t\t\tseg2._intersection = null;\n\t\t\t\t}, clearCurves);\n\t\t\t\tif (clearCurves)\n\t\t\t\t\tclearCurveHandles(clearCurves);\n\t\t\t\tpaths = tracePaths(Base.each(paths, function(path) {\n\t\t\t\t\tBase.push(this, path._segments);\n\t\t\t\t}, []));\n\t\t\t}\n\t\t\tvar length = paths.length,\n\t\t\t\titem;\n\t\t\tif (length > 1 && children) {\n\t\t\t\tif (paths !== children)\n\t\t\t\t\tthis.setChildren(paths);\n\t\t\t\titem = this;\n\t\t\t} else if (length === 1 && !children) {\n\t\t\t\tif (paths[0] !== this)\n\t\t\t\t\tthis.setSegments(paths[0].removeSegments());\n\t\t\t\titem = this;\n\t\t\t}\n\t\t\tif (!item) {\n\t\t\t\titem = new CompoundPath(Item.NO_INSERT);\n\t\t\t\titem.addChildren(paths);\n\t\t\t\titem = item.reduce();\n\t\t\t\titem.copyAttributes(this);\n\t\t\t\tthis.replaceWith(item);\n\t\t\t}\n\t\t\treturn item;\n\t\t},\n\n\t\treorient: function(nonZero, clockwise) {\n\t\t\tvar children = this._children;\n\t\t\tif (children && children.length) {\n\t\t\t\tthis.setChildren(reorientPaths(this.removeChildren(),\n\t\t\t\t\t\tfunction(w) {\n\t\t\t\t\t\t\treturn !!(nonZero ? w : w & 1);\n\t\t\t\t\t\t},\n\t\t\t\t\t\tclockwise));\n\t\t\t} else if (clockwise !== undefined) {\n\t\t\t\tthis.setClockwise(clockwise);\n\t\t\t}\n\t\t\treturn this;\n\t\t},\n\n\t\tgetInteriorPoint: function() {\n\t\t\tvar bounds = this.getBounds(),\n\t\t\t\tpoint = bounds.getCenter(true);\n\t\t\tif (!this.contains(point)) {\n\t\t\t\tvar curves = this.getCurves(),\n\t\t\t\t\ty = point.y,\n\t\t\t\t\tintercepts = [],\n\t\t\t\t\troots = [];\n\t\t\t\tfor (var i = 0, l = curves.length; i < l; i++) {\n\t\t\t\t\tvar v = curves[i].getValues(),\n\t\t\t\t\t\to0 = v[1],\n\t\t\t\t\t\to1 = v[3],\n\t\t\t\t\t\to2 = v[5],\n\t\t\t\t\t\to3 = v[7];\n\t\t\t\t\tif (y >= min(o0, o1, o2, o3) && y <= max(o0, o1, o2, o3)) {\n\t\t\t\t\t\tvar monoCurves = Curve.getMonoCurves(v);\n\t\t\t\t\t\tfor (var j = 0, m = monoCurves.length; j < m; j++) {\n\t\t\t\t\t\t\tvar mv = monoCurves[j],\n\t\t\t\t\t\t\t\tmo0 = mv[1],\n\t\t\t\t\t\t\t\tmo3 = mv[7];\n\t\t\t\t\t\t\tif ((mo0 !== mo3) &&\n\t\t\t\t\t\t\t\t(y >= mo0 && y <= mo3 || y >= mo3 && y <= mo0)){\n\t\t\t\t\t\t\t\tvar x = y === mo0 ? mv[0]\n\t\t\t\t\t\t\t\t\t: y === mo3 ? mv[6]\n\t\t\t\t\t\t\t\t\t: Curve.solveCubic(mv, 1, y, roots, 0, 1)\n\t\t\t\t\t\t\t\t\t\t=== 1\n\t\t\t\t\t\t\t\t\t\t? Curve.getPoint(mv, roots[0]).x\n\t\t\t\t\t\t\t\t\t\t: (mv[0] + mv[6]) / 2;\n\t\t\t\t\t\t\t\tintercepts.push(x);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (intercepts.length > 1) {\n\t\t\t\t\tintercepts.sort(function(a, b) { return a - b; });\n\t\t\t\t\tpoint.x = (intercepts[0] + intercepts[1]) / 2;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn point;\n\t\t}\n\t};\n});\n\nvar PathFlattener = Base.extend({\n\t_class: 'PathFlattener',\n\n\tinitialize: function(path, flatness, maxRecursion, ignoreStraight, matrix) {\n\t\tvar curves = [],\n\t\t\tparts = [],\n\t\t\tlength = 0,\n\t\t\tminSpan = 1 / (maxRecursion || 32),\n\t\t\tsegments = path._segments,\n\t\t\tsegment1 = segments[0],\n\t\t\tsegment2;\n\n\t\tfunction addCurve(segment1, segment2) {\n\t\t\tvar curve = Curve.getValues(segment1, segment2, matrix);\n\t\t\tcurves.push(curve);\n\t\t\tcomputeParts(curve, segment1._index, 0, 1);\n\t\t}\n\n\t\tfunction computeParts(curve, index, t1, t2) {\n\t\t\tif ((t2 - t1) > minSpan\n\t\t\t\t\t&& !(ignoreStraight && Curve.isStraight(curve))\n\t\t\t\t\t&& !Curve.isFlatEnough(curve, flatness || 0.25)) {\n\t\t\t\tvar halves = Curve.subdivide(curve, 0.5),\n\t\t\t\t\ttMid = (t1 + t2) / 2;\n\t\t\t\tcomputeParts(halves[0], index, t1, tMid);\n\t\t\t\tcomputeParts(halves[1], index, tMid, t2);\n\t\t\t} else {\n\t\t\t\tvar dx = curve[6] - curve[0],\n\t\t\t\t\tdy = curve[7] - curve[1],\n\t\t\t\t\tdist = Math.sqrt(dx * dx + dy * dy);\n\t\t\t\tif (dist > 0) {\n\t\t\t\t\tlength += dist;\n\t\t\t\t\tparts.push({\n\t\t\t\t\t\toffset: length,\n\t\t\t\t\t\tcurve: curve,\n\t\t\t\t\t\tindex: index,\n\t\t\t\t\t\ttime: t2,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfor (var i = 1, l = segments.length; i < l; i++) {\n\t\t\tsegment2 = segments[i];\n\t\t\taddCurve(segment1, segment2);\n\t\t\tsegment1 = segment2;\n\t\t}\n\t\tif (path._closed)\n\t\t\taddCurve(segment2 || segment1, segments[0]);\n\t\tthis.curves = curves;\n\t\tthis.parts = parts;\n\t\tthis.length = length;\n\t\tthis.index = 0;\n\t},\n\n\t_get: function(offset) {\n\t\tvar parts = this.parts,\n\t\t\tlength = parts.length,\n\t\t\tstart,\n\t\t\ti, j = this.index;\n\t\tfor (;;) {\n\t\t\ti = j;\n\t\t\tif (!j || parts[--j].offset < offset)\n\t\t\t\tbreak;\n\t\t}\n\t\tfor (; i < length; i++) {\n\t\t\tvar part = parts[i];\n\t\t\tif (part.offset >= offset) {\n\t\t\t\tthis.index = i;\n\t\t\t\tvar prev = parts[i - 1],\n\t\t\t\t\tprevTime = prev && prev.index === part.index ? prev.time : 0,\n\t\t\t\t\tprevOffset = prev ? prev.offset : 0;\n\t\t\t\treturn {\n\t\t\t\t\tindex: part.index,\n\t\t\t\t\ttime: prevTime + (part.time - prevTime)\n\t\t\t\t\t\t* (offset - prevOffset) / (part.offset - prevOffset)\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\t\treturn {\n\t\t\tindex: parts[length - 1].index,\n\t\t\ttime: 1\n\t\t};\n\t},\n\n\tdrawPart: function(ctx, from, to) {\n\t\tvar start = this._get(from),\n\t\t\tend = this._get(to);\n\t\tfor (var i = start.index, l = end.index; i <= l; i++) {\n\t\t\tvar curve = Curve.getPart(this.curves[i],\n\t\t\t\t\ti === start.index ? start.time : 0,\n\t\t\t\t\ti === end.index ? end.time : 1);\n\t\t\tif (i === start.index)\n\t\t\t\tctx.moveTo(curve[0], curve[1]);\n\t\t\tctx.bezierCurveTo.apply(ctx, curve.slice(2));\n\t\t}\n\t}\n}, Base.each(Curve._evaluateMethods,\n\tfunction(name) {\n\t\tthis[name + 'At'] = function(offset) {\n\t\t\tvar param = this._get(offset);\n\t\t\treturn Curve[name](this.curves[param.index], param.time);\n\t\t};\n\t}, {})\n);\n\nvar PathFitter = Base.extend({\n\tinitialize: function(path) {\n\t\tvar points = this.points = [],\n\t\t\tsegments = path._segments,\n\t\t\tclosed = path._closed;\n\t\tfor (var i = 0, prev, l = segments.length; i < l; i++) {\n\t\t\tvar point = segments[i].point;\n\t\t\tif (!prev || !prev.equals(point)) {\n\t\t\t\tpoints.push(prev = point.clone());\n\t\t\t}\n\t\t}\n\t\tif (closed) {\n\t\t\tpoints.unshift(points[points.length - 1]);\n\t\t\tpoints.push(points[1]);\n\t\t}\n\t\tthis.closed = closed;\n\t},\n\n\tfit: function(error) {\n\t\tvar points = this.points,\n\t\t\tlength = points.length,\n\t\t\tsegments = null;\n\t\tif (length > 0) {\n\t\t\tsegments = [new Segment(points[0])];\n\t\t\tif (length > 1) {\n\t\t\t\tthis.fitCubic(segments, error, 0, length - 1,\n\t\t\t\t\t\tpoints[1].subtract(points[0]),\n\t\t\t\t\t\tpoints[length - 2].subtract(points[length - 1]));\n\t\t\t\tif (this.closed) {\n\t\t\t\t\tsegments.shift();\n\t\t\t\t\tsegments.pop();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn segments;\n\t},\n\n\tfitCubic: function(segments, error, first, last, tan1, tan2) {\n\t\tvar points = this.points;\n\t\tif (last - first === 1) {\n\t\t\tvar pt1 = points[first],\n\t\t\t\tpt2 = points[last],\n\t\t\t\tdist = pt1.getDistance(pt2) / 3;\n\t\t\tthis.addCurve(segments, [pt1, pt1.add(tan1.normalize(dist)),\n\t\t\t\t\tpt2.add(tan2.normalize(dist)), pt2]);\n\t\t\treturn;\n\t\t}\n\t\tvar uPrime = this.chordLengthParameterize(first, last),\n\t\t\tmaxError = Math.max(error, error * error),\n\t\t\tsplit,\n\t\t\tparametersInOrder = true;\n\t\tfor (var i = 0; i <= 4; i++) {\n\t\t\tvar curve = this.generateBezier(first, last, uPrime, tan1, tan2);\n\t\t\tvar max = this.findMaxError(first, last, curve, uPrime);\n\t\t\tif (max.error < error && parametersInOrder) {\n\t\t\t\tthis.addCurve(segments, curve);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tsplit = max.index;\n\t\t\tif (max.error >= maxError)\n\t\t\t\tbreak;\n\t\t\tparametersInOrder = this.reparameterize(first, last, uPrime, curve);\n\t\t\tmaxError = max.error;\n\t\t}\n\t\tvar tanCenter = points[split - 1].subtract(points[split + 1]);\n\t\tthis.fitCubic(segments, error, first, split, tan1, tanCenter);\n\t\tthis.fitCubic(segments, error, split, last, tanCenter.negate(), tan2);\n\t},\n\n\taddCurve: function(segments, curve) {\n\t\tvar prev = segments[segments.length - 1];\n\t\tprev.setHandleOut(curve[1].subtract(curve[0]));\n\t\tsegments.push(new Segment(curve[3], curve[2].subtract(curve[3])));\n\t},\n\n\tgenerateBezier: function(first, last, uPrime, tan1, tan2) {\n\t\tvar epsilon = 1e-12,\n\t\t\tabs = Math.abs,\n\t\t\tpoints = this.points,\n\t\t\tpt1 = points[first],\n\t\t\tpt2 = points[last],\n\t\t\tC = [[0, 0], [0, 0]],\n\t\t\tX = [0, 0];\n\n\t\tfor (var i = 0, l = last - first + 1; i < l; i++) {\n\t\t\tvar u = uPrime[i],\n\t\t\t\tt = 1 - u,\n\t\t\t\tb = 3 * u * t,\n\t\t\t\tb0 = t * t * t,\n\t\t\t\tb1 = b * t,\n\t\t\t\tb2 = b * u,\n\t\t\t\tb3 = u * u * u,\n\t\t\t\ta1 = tan1.normalize(b1),\n\t\t\t\ta2 = tan2.normalize(b2),\n\t\t\t\ttmp = points[first + i]\n\t\t\t\t\t.subtract(pt1.multiply(b0 + b1))\n\t\t\t\t\t.subtract(pt2.multiply(b2 + b3));\n\t\t\tC[0][0] += a1.dot(a1);\n\t\t\tC[0][1] += a1.dot(a2);\n\t\t\tC[1][0] = C[0][1];\n\t\t\tC[1][1] += a2.dot(a2);\n\t\t\tX[0] += a1.dot(tmp);\n\t\t\tX[1] += a2.dot(tmp);\n\t\t}\n\n\t\tvar detC0C1 = C[0][0] * C[1][1] - C[1][0] * C[0][1],\n\t\t\talpha1,\n\t\t\talpha2;\n\t\tif (abs(detC0C1) > epsilon) {\n\t\t\tvar detC0X = C[0][0] * X[1]    - C[1][0] * X[0],\n\t\t\t\tdetXC1 = X[0]    * C[1][1] - X[1]    * C[0][1];\n\t\t\talpha1 = detXC1 / detC0C1;\n\t\t\talpha2 = detC0X / detC0C1;\n\t\t} else {\n\t\t\tvar c0 = C[0][0] + C[0][1],\n\t\t\t\tc1 = C[1][0] + C[1][1];\n\t\t\talpha1 = alpha2 = abs(c0) > epsilon ? X[0] / c0\n\t\t\t\t\t\t\t: abs(c1) > epsilon ? X[1] / c1\n\t\t\t\t\t\t\t: 0;\n\t\t}\n\n\t\tvar segLength = pt2.getDistance(pt1),\n\t\t\teps = epsilon * segLength,\n\t\t\thandle1,\n\t\t\thandle2;\n\t\tif (alpha1 < eps || alpha2 < eps) {\n\t\t\talpha1 = alpha2 = segLength / 3;\n\t\t} else {\n\t\t\tvar line = pt2.subtract(pt1);\n\t\t\thandle1 = tan1.normalize(alpha1);\n\t\t\thandle2 = tan2.normalize(alpha2);\n\t\t\tif (handle1.dot(line) - handle2.dot(line) > segLength * segLength) {\n\t\t\t\talpha1 = alpha2 = segLength / 3;\n\t\t\t\thandle1 = handle2 = null;\n\t\t\t}\n\t\t}\n\n\t\treturn [pt1,\n\t\t\t\tpt1.add(handle1 || tan1.normalize(alpha1)),\n\t\t\t\tpt2.add(handle2 || tan2.normalize(alpha2)),\n\t\t\t\tpt2];\n\t},\n\n\treparameterize: function(first, last, u, curve) {\n\t\tfor (var i = first; i <= last; i++) {\n\t\t\tu[i - first] = this.findRoot(curve, this.points[i], u[i - first]);\n\t\t}\n\t\tfor (var i = 1, l = u.length; i < l; i++) {\n\t\t\tif (u[i] <= u[i - 1])\n\t\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t},\n\n\tfindRoot: function(curve, point, u) {\n\t\tvar curve1 = [],\n\t\t\tcurve2 = [];\n\t\tfor (var i = 0; i <= 2; i++) {\n\t\t\tcurve1[i] = curve[i + 1].subtract(curve[i]).multiply(3);\n\t\t}\n\t\tfor (var i = 0; i <= 1; i++) {\n\t\t\tcurve2[i] = curve1[i + 1].subtract(curve1[i]).multiply(2);\n\t\t}\n\t\tvar pt = this.evaluate(3, curve, u),\n\t\t\tpt1 = this.evaluate(2, curve1, u),\n\t\t\tpt2 = this.evaluate(1, curve2, u),\n\t\t\tdiff = pt.subtract(point),\n\t\t\tdf = pt1.dot(pt1) + diff.dot(pt2);\n\t\treturn Numerical.isZero(df) ? u : u - diff.dot(pt1) / df;\n\t},\n\n\tevaluate: function(degree, curve, t) {\n\t\tvar tmp = curve.slice();\n\t\tfor (var i = 1; i <= degree; i++) {\n\t\t\tfor (var j = 0; j <= degree - i; j++) {\n\t\t\t\ttmp[j] = tmp[j].multiply(1 - t).add(tmp[j + 1].multiply(t));\n\t\t\t}\n\t\t}\n\t\treturn tmp[0];\n\t},\n\n\tchordLengthParameterize: function(first, last) {\n\t\tvar u = [0];\n\t\tfor (var i = first + 1; i <= last; i++) {\n\t\t\tu[i - first] = u[i - first - 1]\n\t\t\t\t\t+ this.points[i].getDistance(this.points[i - 1]);\n\t\t}\n\t\tfor (var i = 1, m = last - first; i <= m; i++) {\n\t\t\tu[i] /= u[m];\n\t\t}\n\t\treturn u;\n\t},\n\n\tfindMaxError: function(first, last, curve, u) {\n\t\tvar index = Math.floor((last - first + 1) / 2),\n\t\t\tmaxDist = 0;\n\t\tfor (var i = first + 1; i < last; i++) {\n\t\t\tvar P = this.evaluate(3, curve, u[i - first]);\n\t\t\tvar v = P.subtract(this.points[i]);\n\t\t\tvar dist = v.x * v.x + v.y * v.y;\n\t\t\tif (dist >= maxDist) {\n\t\t\t\tmaxDist = dist;\n\t\t\t\tindex = i;\n\t\t\t}\n\t\t}\n\t\treturn {\n\t\t\terror: maxDist,\n\t\t\tindex: index\n\t\t};\n\t}\n});\n\nvar TextItem = Item.extend({\n\t_class: 'TextItem',\n\t_applyMatrix: false,\n\t_canApplyMatrix: false,\n\t_serializeFields: {\n\t\tcontent: null\n\t},\n\t_boundsOptions: { stroke: false, handle: false },\n\n\tinitialize: function TextItem(arg) {\n\t\tthis._content = '';\n\t\tthis._lines = [];\n\t\tvar hasProps = arg && Base.isPlainObject(arg)\n\t\t\t\t&& arg.x === undefined && arg.y === undefined;\n\t\tthis._initialize(hasProps && arg, !hasProps && Point.read(arguments));\n\t},\n\n\t_equals: function(item) {\n\t\treturn this._content === item._content;\n\t},\n\n\tcopyContent: function(source) {\n\t\tthis.setContent(source._content);\n\t},\n\n\tgetContent: function() {\n\t\treturn this._content;\n\t},\n\n\tsetContent: function(content) {\n\t\tthis._content = '' + content;\n\t\tthis._lines = this._content.split(/\\r\\n|\\n|\\r/mg);\n\t\tthis._changed(521);\n\t},\n\n\tisEmpty: function() {\n\t\treturn !this._content;\n\t},\n\n\tgetCharacterStyle: '#getStyle',\n\tsetCharacterStyle: '#setStyle',\n\n\tgetParagraphStyle: '#getStyle',\n\tsetParagraphStyle: '#setStyle'\n});\n\nvar PointText = TextItem.extend({\n\t_class: 'PointText',\n\n\tinitialize: function PointText() {\n\t\tTextItem.apply(this, arguments);\n\t},\n\n\tgetPoint: function() {\n\t\tvar point = this._matrix.getTranslation();\n\t\treturn new LinkedPoint(point.x, point.y, this, 'setPoint');\n\t},\n\n\tsetPoint: function() {\n\t\tvar point = Point.read(arguments);\n\t\tthis.translate(point.subtract(this._matrix.getTranslation()));\n\t},\n\n\t_draw: function(ctx, param, viewMatrix) {\n\t\tif (!this._content)\n\t\t\treturn;\n\t\tthis._setStyles(ctx, param, viewMatrix);\n\t\tvar lines = this._lines,\n\t\t\tstyle = this._style,\n\t\t\thasFill = style.hasFill(),\n\t\t\thasStroke = style.hasStroke(),\n\t\t\tleading = style.getLeading(),\n\t\t\tshadowColor = ctx.shadowColor;\n\t\tctx.font = style.getFontStyle();\n\t\tctx.textAlign = style.getJustification();\n\t\tfor (var i = 0, l = lines.length; i < l; i++) {\n\t\t\tctx.shadowColor = shadowColor;\n\t\t\tvar line = lines[i];\n\t\t\tif (hasFill) {\n\t\t\t\tctx.fillText(line, 0, 0);\n\t\t\t\tctx.shadowColor = 'rgba(0,0,0,0)';\n\t\t\t}\n\t\t\tif (hasStroke)\n\t\t\t\tctx.strokeText(line, 0, 0);\n\t\t\tctx.translate(0, leading);\n\t\t}\n\t},\n\n\t_getBounds: function(matrix, options) {\n\t\tvar style = this._style,\n\t\t\tlines = this._lines,\n\t\t\tnumLines = lines.length,\n\t\t\tjustification = style.getJustification(),\n\t\t\tleading = style.getLeading(),\n\t\t\twidth = this.getView().getTextWidth(style.getFontStyle(), lines),\n\t\t\tx = 0;\n\t\tif (justification !== 'left')\n\t\t\tx -= width / (justification === 'center' ? 2: 1);\n\t\tvar rect = new Rectangle(x,\n\t\t\t\t\tnumLines ? - 0.75 * leading : 0,\n\t\t\t\t\twidth, numLines * leading);\n\t\treturn matrix ? matrix._transformBounds(rect, rect) : rect;\n\t}\n});\n\nvar Color = Base.extend(new function() {\n\tvar types = {\n\t\tgray: ['gray'],\n\t\trgb: ['red', 'green', 'blue'],\n\t\thsb: ['hue', 'saturation', 'brightness'],\n\t\thsl: ['hue', 'saturation', 'lightness'],\n\t\tgradient: ['gradient', 'origin', 'destination', 'highlight']\n\t};\n\n\tvar componentParsers = {},\n\t\tnamedColors = {\n\t\t\ttransparent: [0, 0, 0, 0]\n\t\t},\n\t\tcolorCtx;\n\n\tfunction fromCSS(string) {\n\t\tvar match = string.match(\n\t\t\t\t/^#([\\da-f]{2})([\\da-f]{2})([\\da-f]{2})([\\da-f]{2})?$/i\n\t\t\t) || string.match(\n\t\t\t\t/^#([\\da-f])([\\da-f])([\\da-f])([\\da-f])?$/i\n\t\t\t),\n\t\t\ttype = 'rgb',\n\t\t\tcomponents;\n\t\tif (match) {\n\t\t\tvar amount = match[4] ? 4 : 3;\n\t\t\tcomponents = new Array(amount);\n\t\t\tfor (var i = 0; i < amount; i++) {\n\t\t\t\tvar value = match[i + 1];\n\t\t\t\tcomponents[i] = parseInt(value.length == 1\n\t\t\t\t\t\t? value + value : value, 16) / 255;\n\t\t\t}\n\t\t} else if (match = string.match(/^(rgb|hsl)a?\\((.*)\\)$/)) {\n\t\t\ttype = match[1];\n\t\t\tcomponents = match[2].split(/[,\\s]+/g);\n\t\t\tvar isHSL = type === 'hsl';\n\t\t\tfor (var i = 0, l = Math.min(components.length, 4); i < l; i++) {\n\t\t\t\tvar component = components[i];\n\t\t\t\tvar value = parseFloat(component);\n\t\t\t\tif (isHSL) {\n\t\t\t\t\tif (i === 0) {\n\t\t\t\t\t\tvar unit = component.match(/([a-z]*)$/)[1];\n\t\t\t\t\t\tvalue *= ({\n\t\t\t\t\t\t\tturn: 360,\n\t\t\t\t\t\t\trad: 180 / Math.PI,\n\t\t\t\t\t\t\tgrad: 0.9\n\t\t\t\t\t\t}[unit] || 1);\n\t\t\t\t\t} else if (i < 3) {\n\t\t\t\t\t\tvalue /= 100;\n\t\t\t\t\t}\n\t\t\t\t} else if (i < 3) {\n\t\t\t\t\tvalue /= 255;\n\t\t\t\t}\n\t\t\t\tcomponents[i] = value;\n\t\t\t}\n\t\t} else {\n\t\t\tvar color = namedColors[string];\n\t\t\tif (!color) {\n\t\t\t\tif (window) {\n\t\t\t\t\tif (!colorCtx) {\n\t\t\t\t\t\tcolorCtx = CanvasProvider.getContext(1, 1);\n\t\t\t\t\t\tcolorCtx.globalCompositeOperation = 'copy';\n\t\t\t\t\t}\n\t\t\t\t\tcolorCtx.fillStyle = 'rgba(0,0,0,0)';\n\t\t\t\t\tcolorCtx.fillStyle = string;\n\t\t\t\t\tcolorCtx.fillRect(0, 0, 1, 1);\n\t\t\t\t\tvar data = colorCtx.getImageData(0, 0, 1, 1).data;\n\t\t\t\t\tcolor = namedColors[string] = [\n\t\t\t\t\t\tdata[0] / 255,\n\t\t\t\t\t\tdata[1] / 255,\n\t\t\t\t\t\tdata[2] / 255\n\t\t\t\t\t];\n\t\t\t\t} else {\n\t\t\t\t\tcolor = [0, 0, 0];\n\t\t\t\t}\n\t\t\t}\n\t\t\tcomponents = color.slice();\n\t\t}\n\t\treturn [type, components];\n\t}\n\n\tvar hsbIndices = [\n\t\t[0, 3, 1],\n\t\t[2, 0, 1],\n\t\t[1, 0, 3],\n\t\t[1, 2, 0],\n\t\t[3, 1, 0],\n\t\t[0, 1, 2]\n\t];\n\n\tvar converters = {\n\t\t'rgb-hsb': function(r, g, b) {\n\t\t\tvar max = Math.max(r, g, b),\n\t\t\t\tmin = Math.min(r, g, b),\n\t\t\t\tdelta = max - min,\n\t\t\t\th = delta === 0 ? 0\n\t\t\t\t\t:   ( max == r ? (g - b) / delta + (g < b ? 6 : 0)\n\t\t\t\t\t\t: max == g ? (b - r) / delta + 2\n\t\t\t\t\t\t:            (r - g) / delta + 4) * 60;\n\t\t\treturn [h, max === 0 ? 0 : delta / max, max];\n\t\t},\n\n\t\t'hsb-rgb': function(h, s, b) {\n\t\t\th = (((h / 60) % 6) + 6) % 6;\n\t\t\tvar i = Math.floor(h),\n\t\t\t\tf = h - i,\n\t\t\t\ti = hsbIndices[i],\n\t\t\t\tv = [\n\t\t\t\t\tb,\n\t\t\t\t\tb * (1 - s),\n\t\t\t\t\tb * (1 - s * f),\n\t\t\t\t\tb * (1 - s * (1 - f))\n\t\t\t\t];\n\t\t\treturn [v[i[0]], v[i[1]], v[i[2]]];\n\t\t},\n\n\t\t'rgb-hsl': function(r, g, b) {\n\t\t\tvar max = Math.max(r, g, b),\n\t\t\t\tmin = Math.min(r, g, b),\n\t\t\t\tdelta = max - min,\n\t\t\t\tachromatic = delta === 0,\n\t\t\t\th = achromatic ? 0\n\t\t\t\t\t:   ( max == r ? (g - b) / delta + (g < b ? 6 : 0)\n\t\t\t\t\t\t: max == g ? (b - r) / delta + 2\n\t\t\t\t\t\t:            (r - g) / delta + 4) * 60,\n\t\t\t\tl = (max + min) / 2,\n\t\t\t\ts = achromatic ? 0 : l < 0.5\n\t\t\t\t\t\t? delta / (max + min)\n\t\t\t\t\t\t: delta / (2 - max - min);\n\t\t\treturn [h, s, l];\n\t\t},\n\n\t\t'hsl-rgb': function(h, s, l) {\n\t\t\th = (((h / 360) % 1) + 1) % 1;\n\t\t\tif (s === 0)\n\t\t\t\treturn [l, l, l];\n\t\t\tvar t3s = [ h + 1 / 3, h, h - 1 / 3 ],\n\t\t\t\tt2 = l < 0.5 ? l * (1 + s) : l + s - l * s,\n\t\t\t\tt1 = 2 * l - t2,\n\t\t\t\tc = [];\n\t\t\tfor (var i = 0; i < 3; i++) {\n\t\t\t\tvar t3 = t3s[i];\n\t\t\t\tif (t3 < 0) t3 += 1;\n\t\t\t\tif (t3 > 1) t3 -= 1;\n\t\t\t\tc[i] = 6 * t3 < 1\n\t\t\t\t\t? t1 + (t2 - t1) * 6 * t3\n\t\t\t\t\t: 2 * t3 < 1\n\t\t\t\t\t\t? t2\n\t\t\t\t\t\t: 3 * t3 < 2\n\t\t\t\t\t\t\t? t1 + (t2 - t1) * ((2 / 3) - t3) * 6\n\t\t\t\t\t\t\t: t1;\n\t\t\t}\n\t\t\treturn c;\n\t\t},\n\n\t\t'rgb-gray': function(r, g, b) {\n\t\t\treturn [r * 0.2989 + g * 0.587 + b * 0.114];\n\t\t},\n\n\t\t'gray-rgb': function(g) {\n\t\t\treturn [g, g, g];\n\t\t},\n\n\t\t'gray-hsb': function(g) {\n\t\t\treturn [0, 0, g];\n\t\t},\n\n\t\t'gray-hsl': function(g) {\n\t\t\treturn [0, 0, g];\n\t\t},\n\n\t\t'gradient-rgb': function() {\n\t\t\treturn [];\n\t\t},\n\n\t\t'rgb-gradient': function() {\n\t\t\treturn [];\n\t\t}\n\n\t};\n\n\treturn Base.each(types, function(properties, type) {\n\t\tcomponentParsers[type] = [];\n\t\tBase.each(properties, function(name, index) {\n\t\t\tvar part = Base.capitalize(name),\n\t\t\t\thasOverlap = /^(hue|saturation)$/.test(name),\n\t\t\t\tparser = componentParsers[type][index] = type === 'gradient'\n\t\t\t\t\t? name === 'gradient'\n\t\t\t\t\t\t? function(value) {\n\t\t\t\t\t\t\tvar current = this._components[0];\n\t\t\t\t\t\t\tvalue = Gradient.read(\n\t\t\t\t\t\t\t\tArray.isArray(value)\n\t\t\t\t\t\t\t\t\t? value\n\t\t\t\t\t\t\t\t\t: arguments, 0, { readNull: true }\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tif (current !== value) {\n\t\t\t\t\t\t\t\tif (current)\n\t\t\t\t\t\t\t\t\tcurrent._removeOwner(this);\n\t\t\t\t\t\t\t\tif (value)\n\t\t\t\t\t\t\t\t\tvalue._addOwner(this);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn value;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t: function() {\n\t\t\t\t\t\t\treturn Point.read(arguments, 0, {\n\t\t\t\t\t\t\t\t\treadNull: name === 'highlight',\n\t\t\t\t\t\t\t\t\tclone: true\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t: function(value) {\n\t\t\t\t\t\treturn value == null || isNaN(value) ? 0 : +value;\n\t\t\t\t\t};\n\t\t\tthis['get' + part] = function() {\n\t\t\t\treturn this._type === type\n\t\t\t\t\t|| hasOverlap && /^hs[bl]$/.test(this._type)\n\t\t\t\t\t\t? this._components[index]\n\t\t\t\t\t\t: this._convert(type)[index];\n\t\t\t};\n\n\t\t\tthis['set' + part] = function(value) {\n\t\t\t\tif (this._type !== type\n\t\t\t\t\t\t&& !(hasOverlap && /^hs[bl]$/.test(this._type))) {\n\t\t\t\t\tthis._components = this._convert(type);\n\t\t\t\t\tthis._properties = types[type];\n\t\t\t\t\tthis._type = type;\n\t\t\t\t}\n\t\t\t\tthis._components[index] = parser.call(this, value);\n\t\t\t\tthis._changed();\n\t\t\t};\n\t\t}, this);\n\t}, {\n\t\t_class: 'Color',\n\t\t_readIndex: true,\n\n\t\tinitialize: function Color(arg) {\n\t\t\tvar args = arguments,\n\t\t\t\treading = this.__read,\n\t\t\t\tread = 0,\n\t\t\t\ttype,\n\t\t\t\tcomponents,\n\t\t\t\talpha,\n\t\t\t\tvalues;\n\t\t\tif (Array.isArray(arg)) {\n\t\t\t\targs = arg;\n\t\t\t\targ = args[0];\n\t\t\t}\n\t\t\tvar argType = arg != null && typeof arg;\n\t\t\tif (argType === 'string' && arg in types) {\n\t\t\t\ttype = arg;\n\t\t\t\targ = args[1];\n\t\t\t\tif (Array.isArray(arg)) {\n\t\t\t\t\tcomponents = arg;\n\t\t\t\t\talpha = args[2];\n\t\t\t\t} else {\n\t\t\t\t\tif (reading)\n\t\t\t\t\t\tread = 1;\n\t\t\t\t\targs = Base.slice(args, 1);\n\t\t\t\t\targType = typeof arg;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!components) {\n\t\t\t\tvalues = argType === 'number'\n\t\t\t\t\t\t? args\n\t\t\t\t\t\t: argType === 'object' && arg.length != null\n\t\t\t\t\t\t\t? arg\n\t\t\t\t\t\t\t: null;\n\t\t\t\tif (values) {\n\t\t\t\t\tif (!type)\n\t\t\t\t\t\ttype = values.length >= 3\n\t\t\t\t\t\t\t\t? 'rgb'\n\t\t\t\t\t\t\t\t: 'gray';\n\t\t\t\t\tvar length = types[type].length;\n\t\t\t\t\talpha = values[length];\n\t\t\t\t\tif (reading) {\n\t\t\t\t\t\tread += values === arguments\n\t\t\t\t\t\t\t? length + (alpha != null ? 1 : 0)\n\t\t\t\t\t\t\t: 1;\n\t\t\t\t\t}\n\t\t\t\t\tif (values.length > length)\n\t\t\t\t\t\tvalues = Base.slice(values, 0, length);\n\t\t\t\t} else if (argType === 'string') {\n\t\t\t\t\tvar converted = fromCSS(arg);\n\t\t\t\t\ttype = converted[0];\n\t\t\t\t\tcomponents = converted[1];\n\t\t\t\t\tif (components.length === 4) {\n\t\t\t\t\t\talpha = components[3];\n\t\t\t\t\t\tcomponents.length--;\n\t\t\t\t\t}\n\t\t\t\t} else if (argType === 'object') {\n\t\t\t\t\tif (arg.constructor === Color) {\n\t\t\t\t\t\ttype = arg._type;\n\t\t\t\t\t\tcomponents = arg._components.slice();\n\t\t\t\t\t\talpha = arg._alpha;\n\t\t\t\t\t\tif (type === 'gradient') {\n\t\t\t\t\t\t\tfor (var i = 1, l = components.length; i < l; i++) {\n\t\t\t\t\t\t\t\tvar point = components[i];\n\t\t\t\t\t\t\t\tif (point)\n\t\t\t\t\t\t\t\t\tcomponents[i] = point.clone();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (arg.constructor === Gradient) {\n\t\t\t\t\t\ttype = 'gradient';\n\t\t\t\t\t\tvalues = args;\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttype = 'hue' in arg\n\t\t\t\t\t\t\t? 'lightness' in arg\n\t\t\t\t\t\t\t\t? 'hsl'\n\t\t\t\t\t\t\t\t: 'hsb'\n\t\t\t\t\t\t\t: 'gradient' in arg || 'stops' in arg\n\t\t\t\t\t\t\t\t\t|| 'radial' in arg\n\t\t\t\t\t\t\t\t? 'gradient'\n\t\t\t\t\t\t\t\t: 'gray' in arg\n\t\t\t\t\t\t\t\t\t? 'gray'\n\t\t\t\t\t\t\t\t\t: 'rgb';\n\t\t\t\t\t\tvar properties = types[type],\n\t\t\t\t\t\t\tparsers = componentParsers[type];\n\t\t\t\t\t\tthis._components = components = [];\n\t\t\t\t\t\tfor (var i = 0, l = properties.length; i < l; i++) {\n\t\t\t\t\t\t\tvar value = arg[properties[i]];\n\t\t\t\t\t\t\tif (value == null && !i && type === 'gradient'\n\t\t\t\t\t\t\t\t\t&& 'stops' in arg) {\n\t\t\t\t\t\t\t\tvalue = {\n\t\t\t\t\t\t\t\t\tstops: arg.stops,\n\t\t\t\t\t\t\t\t\tradial: arg.radial\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tvalue = parsers[i].call(this, value);\n\t\t\t\t\t\t\tif (value != null)\n\t\t\t\t\t\t\t\tcomponents[i] = value;\n\t\t\t\t\t\t}\n\t\t\t\t\t\talpha = arg.alpha;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (reading && type)\n\t\t\t\t\tread = 1;\n\t\t\t}\n\t\t\tthis._type = type || 'rgb';\n\t\t\tif (!components) {\n\t\t\t\tthis._components = components = [];\n\t\t\t\tvar parsers = componentParsers[this._type];\n\t\t\t\tfor (var i = 0, l = parsers.length; i < l; i++) {\n\t\t\t\t\tvar value = parsers[i].call(this, values && values[i]);\n\t\t\t\t\tif (value != null)\n\t\t\t\t\t\tcomponents[i] = value;\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis._components = components;\n\t\t\tthis._properties = types[this._type];\n\t\t\tthis._alpha = alpha;\n\t\t\tif (reading)\n\t\t\t\tthis.__read = read;\n\t\t\treturn this;\n\t\t},\n\n\t\tset: '#initialize',\n\n\t\t_serialize: function(options, dictionary) {\n\t\t\tvar components = this.getComponents();\n\t\t\treturn Base.serialize(\n\t\t\t\t\t/^(gray|rgb)$/.test(this._type)\n\t\t\t\t\t\t? components\n\t\t\t\t\t\t: [this._type].concat(components),\n\t\t\t\t\toptions, true, dictionary);\n\t\t},\n\n\t\t_changed: function() {\n\t\t\tthis._canvasStyle = null;\n\t\t\tif (this._owner)\n\t\t\t\tthis._owner._changed(129);\n\t\t},\n\n\t\t_convert: function(type) {\n\t\t\tvar converter;\n\t\t\treturn this._type === type\n\t\t\t\t\t? this._components.slice()\n\t\t\t\t\t: (converter = converters[this._type + '-' + type])\n\t\t\t\t\t\t? converter.apply(this, this._components)\n\t\t\t\t\t\t: converters['rgb-' + type].apply(this,\n\t\t\t\t\t\t\tconverters[this._type + '-rgb'].apply(this,\n\t\t\t\t\t\t\t\tthis._components));\n\t\t},\n\n\t\tconvert: function(type) {\n\t\t\treturn new Color(type, this._convert(type), this._alpha);\n\t\t},\n\n\t\tgetType: function() {\n\t\t\treturn this._type;\n\t\t},\n\n\t\tsetType: function(type) {\n\t\t\tthis._components = this._convert(type);\n\t\t\tthis._properties = types[type];\n\t\t\tthis._type = type;\n\t\t},\n\n\t\tgetComponents: function() {\n\t\t\tvar components = this._components.slice();\n\t\t\tif (this._alpha != null)\n\t\t\t\tcomponents.push(this._alpha);\n\t\t\treturn components;\n\t\t},\n\n\t\tgetAlpha: function() {\n\t\t\treturn this._alpha != null ? this._alpha : 1;\n\t\t},\n\n\t\tsetAlpha: function(alpha) {\n\t\t\tthis._alpha = alpha == null ? null : Math.min(Math.max(alpha, 0), 1);\n\t\t\tthis._changed();\n\t\t},\n\n\t\thasAlpha: function() {\n\t\t\treturn this._alpha != null;\n\t\t},\n\n\t\tequals: function(color) {\n\t\t\tvar col = Base.isPlainValue(color, true)\n\t\t\t\t\t? Color.read(arguments)\n\t\t\t\t\t: color;\n\t\t\treturn col === this || col && this._class === col._class\n\t\t\t\t\t&& this._type === col._type\n\t\t\t\t\t&& this.getAlpha() === col.getAlpha()\n\t\t\t\t\t&& Base.equals(this._components, col._components)\n\t\t\t\t\t|| false;\n\t\t},\n\n\t\ttoString: function() {\n\t\t\tvar properties = this._properties,\n\t\t\t\tparts = [],\n\t\t\t\tisGradient = this._type === 'gradient',\n\t\t\t\tf = Formatter.instance;\n\t\t\tfor (var i = 0, l = properties.length; i < l; i++) {\n\t\t\t\tvar value = this._components[i];\n\t\t\t\tif (value != null)\n\t\t\t\t\tparts.push(properties[i] + ': '\n\t\t\t\t\t\t\t+ (isGradient ? value : f.number(value)));\n\t\t\t}\n\t\t\tif (this._alpha != null)\n\t\t\t\tparts.push('alpha: ' + f.number(this._alpha));\n\t\t\treturn '{ ' + parts.join(', ') + ' }';\n\t\t},\n\n\t\ttoCSS: function(hex) {\n\t\t\tvar components = this._convert('rgb'),\n\t\t\t\talpha = hex || this._alpha == null ? 1 : this._alpha;\n\t\t\tfunction convert(val) {\n\t\t\t\treturn Math.round((val < 0 ? 0 : val > 1 ? 1 : val) * 255);\n\t\t\t}\n\t\t\tcomponents = [\n\t\t\t\tconvert(components[0]),\n\t\t\t\tconvert(components[1]),\n\t\t\t\tconvert(components[2])\n\t\t\t];\n\t\t\tif (alpha < 1)\n\t\t\t\tcomponents.push(alpha < 0 ? 0 : alpha);\n\t\t\treturn hex\n\t\t\t\t\t? '#' + ((1 << 24) + (components[0] << 16)\n\t\t\t\t\t\t+ (components[1] << 8)\n\t\t\t\t\t\t+ components[2]).toString(16).slice(1)\n\t\t\t\t\t: (components.length == 4 ? 'rgba(' : 'rgb(')\n\t\t\t\t\t\t+ components.join(',') + ')';\n\t\t},\n\n\t\ttoCanvasStyle: function(ctx, matrix) {\n\t\t\tif (this._canvasStyle)\n\t\t\t\treturn this._canvasStyle;\n\t\t\tif (this._type !== 'gradient')\n\t\t\t\treturn this._canvasStyle = this.toCSS();\n\t\t\tvar components = this._components,\n\t\t\t\tgradient = components[0],\n\t\t\t\tstops = gradient._stops,\n\t\t\t\torigin = components[1],\n\t\t\t\tdestination = components[2],\n\t\t\t\thighlight = components[3],\n\t\t\t\tinverse = matrix && matrix.inverted(),\n\t\t\t\tcanvasGradient;\n\t\t\tif (inverse) {\n\t\t\t\torigin = inverse._transformPoint(origin);\n\t\t\t\tdestination = inverse._transformPoint(destination);\n\t\t\t\tif (highlight)\n\t\t\t\t\thighlight = inverse._transformPoint(highlight);\n\t\t\t}\n\t\t\tif (gradient._radial) {\n\t\t\t\tvar radius = destination.getDistance(origin);\n\t\t\t\tif (highlight) {\n\t\t\t\t\tvar vector = highlight.subtract(origin);\n\t\t\t\t\tif (vector.getLength() > radius)\n\t\t\t\t\t\thighlight = origin.add(vector.normalize(radius - 0.1));\n\t\t\t\t}\n\t\t\t\tvar start = highlight || origin;\n\t\t\t\tcanvasGradient = ctx.createRadialGradient(start.x, start.y,\n\t\t\t\t\t\t0, origin.x, origin.y, radius);\n\t\t\t} else {\n\t\t\t\tcanvasGradient = ctx.createLinearGradient(origin.x, origin.y,\n\t\t\t\t\t\tdestination.x, destination.y);\n\t\t\t}\n\t\t\tfor (var i = 0, l = stops.length; i < l; i++) {\n\t\t\t\tvar stop = stops[i],\n\t\t\t\t\toffset = stop._offset;\n\t\t\t\tcanvasGradient.addColorStop(\n\t\t\t\t\t\toffset == null ? i / (l - 1) : offset,\n\t\t\t\t\t\tstop._color.toCanvasStyle());\n\t\t\t}\n\t\t\treturn this._canvasStyle = canvasGradient;\n\t\t},\n\n\t\ttransform: function(matrix) {\n\t\t\tif (this._type === 'gradient') {\n\t\t\t\tvar components = this._components;\n\t\t\t\tfor (var i = 1, l = components.length; i < l; i++) {\n\t\t\t\t\tvar point = components[i];\n\t\t\t\t\tmatrix._transformPoint(point, point, true);\n\t\t\t\t}\n\t\t\t\tthis._changed();\n\t\t\t}\n\t\t},\n\n\t\tstatics: {\n\t\t\t_types: types,\n\n\t\t\trandom: function() {\n\t\t\t\tvar random = Math.random;\n\t\t\t\treturn new Color(random(), random(), random());\n\t\t\t}\n\t\t}\n\t});\n},\nnew function() {\n\tvar operators = {\n\t\tadd: function(a, b) {\n\t\t\treturn a + b;\n\t\t},\n\n\t\tsubtract: function(a, b) {\n\t\t\treturn a - b;\n\t\t},\n\n\t\tmultiply: function(a, b) {\n\t\t\treturn a * b;\n\t\t},\n\n\t\tdivide: function(a, b) {\n\t\t\treturn a / b;\n\t\t}\n\t};\n\n\treturn Base.each(operators, function(operator, name) {\n\t\tthis[name] = function(color) {\n\t\t\tcolor = Color.read(arguments);\n\t\t\tvar type = this._type,\n\t\t\t\tcomponents1 = this._components,\n\t\t\t\tcomponents2 = color._convert(type);\n\t\t\tfor (var i = 0, l = components1.length; i < l; i++)\n\t\t\t\tcomponents2[i] = operator(components1[i], components2[i]);\n\t\t\treturn new Color(type, components2,\n\t\t\t\t\tthis._alpha != null\n\t\t\t\t\t\t\t? operator(this._alpha, color.getAlpha())\n\t\t\t\t\t\t\t: null);\n\t\t};\n\t}, {\n\t});\n});\n\nvar Gradient = Base.extend({\n\t_class: 'Gradient',\n\n\tinitialize: function Gradient(stops, radial) {\n\t\tthis._id = UID.get();\n\t\tif (stops && Base.isPlainObject(stops)) {\n\t\t\tthis.set(stops);\n\t\t\tstops = radial = null;\n\t\t}\n\t\tif (this._stops == null) {\n\t\t\tthis.setStops(stops || ['white', 'black']);\n\t\t}\n\t\tif (this._radial == null) {\n\t\t\tthis.setRadial(typeof radial === 'string' && radial === 'radial'\n\t\t\t\t\t|| radial || false);\n\t\t}\n\t},\n\n\t_serialize: function(options, dictionary) {\n\t\treturn dictionary.add(this, function() {\n\t\t\treturn Base.serialize([this._stops, this._radial],\n\t\t\t\t\toptions, true, dictionary);\n\t\t});\n\t},\n\n\t_changed: function() {\n\t\tfor (var i = 0, l = this._owners && this._owners.length; i < l; i++) {\n\t\t\tthis._owners[i]._changed();\n\t\t}\n\t},\n\n\t_addOwner: function(color) {\n\t\tif (!this._owners)\n\t\t\tthis._owners = [];\n\t\tthis._owners.push(color);\n\t},\n\n\t_removeOwner: function(color) {\n\t\tvar index = this._owners ? this._owners.indexOf(color) : -1;\n\t\tif (index != -1) {\n\t\t\tthis._owners.splice(index, 1);\n\t\t\tif (!this._owners.length)\n\t\t\t\tthis._owners = undefined;\n\t\t}\n\t},\n\n\tclone: function() {\n\t\tvar stops = [];\n\t\tfor (var i = 0, l = this._stops.length; i < l; i++) {\n\t\t\tstops[i] = this._stops[i].clone();\n\t\t}\n\t\treturn new Gradient(stops, this._radial);\n\t},\n\n\tgetStops: function() {\n\t\treturn this._stops;\n\t},\n\n\tsetStops: function(stops) {\n\t\tif (stops.length < 2) {\n\t\t\tthrow new Error(\n\t\t\t\t\t'Gradient stop list needs to contain at least two stops.');\n\t\t}\n\t\tvar _stops = this._stops;\n\t\tif (_stops) {\n\t\t\tfor (var i = 0, l = _stops.length; i < l; i++)\n\t\t\t\t_stops[i]._owner = undefined;\n\t\t}\n\t\t_stops = this._stops = GradientStop.readList(stops, 0, { clone: true });\n\t\tfor (var i = 0, l = _stops.length; i < l; i++)\n\t\t\t_stops[i]._owner = this;\n\t\tthis._changed();\n\t},\n\n\tgetRadial: function() {\n\t\treturn this._radial;\n\t},\n\n\tsetRadial: function(radial) {\n\t\tthis._radial = radial;\n\t\tthis._changed();\n\t},\n\n\tequals: function(gradient) {\n\t\tif (gradient === this)\n\t\t\treturn true;\n\t\tif (gradient && this._class === gradient._class) {\n\t\t\tvar stops1 = this._stops,\n\t\t\t\tstops2 = gradient._stops,\n\t\t\t\tlength = stops1.length;\n\t\t\tif (length === stops2.length) {\n\t\t\t\tfor (var i = 0; i < length; i++) {\n\t\t\t\t\tif (!stops1[i].equals(stops2[i]))\n\t\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n});\n\nvar GradientStop = Base.extend({\n\t_class: 'GradientStop',\n\n\tinitialize: function GradientStop(arg0, arg1) {\n\t\tvar color = arg0,\n\t\t\toffset = arg1;\n\t\tif (typeof arg0 === 'object' && arg1 === undefined) {\n\t\t\tif (Array.isArray(arg0) && typeof arg0[0] !== 'number') {\n\t\t\t\tcolor = arg0[0];\n\t\t\t\toffset = arg0[1];\n\t\t\t} else if ('color' in arg0 || 'offset' in arg0\n\t\t\t\t\t|| 'rampPoint' in arg0) {\n\t\t\t\tcolor = arg0.color;\n\t\t\t\toffset = arg0.offset || arg0.rampPoint || 0;\n\t\t\t}\n\t\t}\n\t\tthis.setColor(color);\n\t\tthis.setOffset(offset);\n\t},\n\n\tclone: function() {\n\t\treturn new GradientStop(this._color.clone(), this._offset);\n\t},\n\n\t_serialize: function(options, dictionary) {\n\t\tvar color = this._color,\n\t\t\toffset = this._offset;\n\t\treturn Base.serialize(offset == null ? [color] : [color, offset],\n\t\t\t\toptions, true, dictionary);\n\t},\n\n\t_changed: function() {\n\t\tif (this._owner)\n\t\t\tthis._owner._changed(129);\n\t},\n\n\tgetOffset: function() {\n\t\treturn this._offset;\n\t},\n\n\tsetOffset: function(offset) {\n\t\tthis._offset = offset;\n\t\tthis._changed();\n\t},\n\n\tgetRampPoint: '#getOffset',\n\tsetRampPoint: '#setOffset',\n\n\tgetColor: function() {\n\t\treturn this._color;\n\t},\n\n\tsetColor: function() {\n\t\tvar color = Color.read(arguments, 0, { clone: true });\n\t\tif (color)\n\t\t\tcolor._owner = this;\n\t\tthis._color = color;\n\t\tthis._changed();\n\t},\n\n\tequals: function(stop) {\n\t\treturn stop === this || stop && this._class === stop._class\n\t\t\t\t&& this._color.equals(stop._color)\n\t\t\t\t&& this._offset == stop._offset\n\t\t\t\t|| false;\n\t}\n});\n\nvar Style = Base.extend(new function() {\n\tvar itemDefaults = {\n\t\tfillColor: null,\n\t\tfillRule: 'nonzero',\n\t\tstrokeColor: null,\n\t\tstrokeWidth: 1,\n\t\tstrokeCap: 'butt',\n\t\tstrokeJoin: 'miter',\n\t\tstrokeScaling: true,\n\t\tmiterLimit: 10,\n\t\tdashOffset: 0,\n\t\tdashArray: [],\n\t\tshadowColor: null,\n\t\tshadowBlur: 0,\n\t\tshadowOffset: new Point(),\n\t\tselectedColor: null\n\t},\n\tgroupDefaults = Base.set({}, itemDefaults, {\n\t\tfontFamily: 'sans-serif',\n\t\tfontWeight: 'normal',\n\t\tfontSize: 12,\n\t\tleading: null,\n\t\tjustification: 'left'\n\t}),\n\ttextDefaults = Base.set({}, groupDefaults, {\n\t\tfillColor: new Color()\n\t}),\n\tflags = {\n\t\tstrokeWidth: 193,\n\t\tstrokeCap: 193,\n\t\tstrokeJoin: 193,\n\t\tstrokeScaling: 201,\n\t\tmiterLimit: 193,\n\t\tfontFamily: 9,\n\t\tfontWeight: 9,\n\t\tfontSize: 9,\n\t\tfont: 9,\n\t\tleading: 9,\n\t\tjustification: 9\n\t},\n\titem = {\n\t\tbeans: true\n\t},\n\tfields = {\n\t\t_class: 'Style',\n\t\tbeans: true,\n\n\t\tinitialize: function Style(style, _owner, _project) {\n\t\t\tthis._values = {};\n\t\t\tthis._owner = _owner;\n\t\t\tthis._project = _owner && _owner._project || _project\n\t\t\t\t\t|| paper.project;\n\t\t\tthis._defaults = !_owner || _owner instanceof Group ? groupDefaults\n\t\t\t\t\t: _owner instanceof TextItem ? textDefaults\n\t\t\t\t\t: itemDefaults;\n\t\t\tif (style)\n\t\t\t\tthis.set(style);\n\t\t}\n\t};\n\n\tBase.each(groupDefaults, function(value, key) {\n\t\tvar isColor = /Color$/.test(key),\n\t\t\tisPoint = key === 'shadowOffset',\n\t\t\tpart = Base.capitalize(key),\n\t\t\tflag = flags[key],\n\t\t\tset = 'set' + part,\n\t\t\tget = 'get' + part;\n\n\t\tfields[set] = function(value) {\n\t\t\tvar owner = this._owner,\n\t\t\t\tchildren = owner && owner._children,\n\t\t\t\tapplyToChildren = children && children.length > 0\n\t\t\t\t\t&& !(owner instanceof CompoundPath);\n\t\t\tif (applyToChildren) {\n\t\t\t\tfor (var i = 0, l = children.length; i < l; i++)\n\t\t\t\t\tchildren[i]._style[set](value);\n\t\t\t}\n\t\t\tif ((key === 'selectedColor' || !applyToChildren)\n\t\t\t\t\t&& key in this._defaults) {\n\t\t\t\tvar old = this._values[key];\n\t\t\t\tif (old !== value) {\n\t\t\t\t\tif (isColor) {\n\t\t\t\t\t\tif (old && old._owner !== undefined) {\n\t\t\t\t\t\t\told._owner = undefined;\n\t\t\t\t\t\t\told._canvasStyle = null;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (value && value.constructor === Color) {\n\t\t\t\t\t\t\tif (value._owner)\n\t\t\t\t\t\t\t\tvalue = value.clone();\n\t\t\t\t\t\t\tvalue._owner = owner;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tthis._values[key] = value;\n\t\t\t\t\tif (owner)\n\t\t\t\t\t\towner._changed(flag || 129);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tfields[get] = function(_dontMerge) {\n\t\t\tvar owner = this._owner,\n\t\t\t\tchildren = owner && owner._children,\n\t\t\t\tvalue;\n\t\t\tif (key in this._defaults && (!children || !children.length\n\t\t\t\t\t|| _dontMerge || owner instanceof CompoundPath)) {\n\t\t\t\tvar value = this._values[key];\n\t\t\t\tif (value === undefined) {\n\t\t\t\t\tvalue = this._defaults[key];\n\t\t\t\t\tif (value && value.clone)\n\t\t\t\t\t\tvalue = value.clone();\n\t\t\t\t} else {\n\t\t\t\t\tvar ctor = isColor ? Color : isPoint ? Point : null;\n\t\t\t\t\tif (ctor && !(value && value.constructor === ctor)) {\n\t\t\t\t\t\tthis._values[key] = value = ctor.read([value], 0,\n\t\t\t\t\t\t\t\t{ readNull: true, clone: true });\n\t\t\t\t\t\tif (value && isColor)\n\t\t\t\t\t\t\tvalue._owner = owner;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else if (children) {\n\t\t\t\tfor (var i = 0, l = children.length; i < l; i++) {\n\t\t\t\t\tvar childValue = children[i]._style[get]();\n\t\t\t\t\tif (!i) {\n\t\t\t\t\t\tvalue = childValue;\n\t\t\t\t\t} else if (!Base.equals(value, childValue)) {\n\t\t\t\t\t\treturn undefined;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn value;\n\t\t};\n\n\t\titem[get] = function(_dontMerge) {\n\t\t\treturn this._style[get](_dontMerge);\n\t\t};\n\n\t\titem[set] = function(value) {\n\t\t\tthis._style[set](value);\n\t\t};\n\t});\n\n\tBase.each({\n\t\tFont: 'FontFamily',\n\t\tWindingRule: 'FillRule'\n\t}, function(value, key) {\n\t\tvar get = 'get' + key,\n\t\t\tset = 'set' + key;\n\t\tfields[get] = item[get] = '#get' + value;\n\t\tfields[set] = item[set] = '#set' + value;\n\t});\n\n\tItem.inject(item);\n\treturn fields;\n}, {\n\tset: function(style) {\n\t\tvar isStyle = style instanceof Style,\n\t\t\tvalues = isStyle ? style._values : style;\n\t\tif (values) {\n\t\t\tfor (var key in values) {\n\t\t\t\tif (key in this._defaults) {\n\t\t\t\t\tvar value = values[key];\n\t\t\t\t\tthis[key] = value && isStyle && value.clone\n\t\t\t\t\t\t\t? value.clone() : value;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\n\tequals: function(style) {\n\t\tfunction compare(style1, style2, secondary) {\n\t\t\tvar values1 = style1._values,\n\t\t\t\tvalues2 = style2._values,\n\t\t\t\tdefaults2 = style2._defaults;\n\t\t\tfor (var key in values1) {\n\t\t\t\tvar value1 = values1[key],\n\t\t\t\t\tvalue2 = values2[key];\n\t\t\t\tif (!(secondary && key in values2) && !Base.equals(value1,\n\t\t\t\t\t\tvalue2 === undefined ? defaults2[key] : value2))\n\t\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\n\t\treturn style === this || style && this._class === style._class\n\t\t\t\t&& compare(this, style)\n\t\t\t\t&& compare(style, this, true)\n\t\t\t\t|| false;\n\t},\n\n\t_dispose: function() {\n\t\tvar color;\n\t\tcolor = this.getFillColor();\n\t\tif (color) color._canvasStyle = null;\n\t\tcolor = this.getStrokeColor();\n\t\tif (color) color._canvasStyle = null;\n\t\tcolor = this.getShadowColor();\n\t\tif (color) color._canvasStyle = null;\n\t},\n\n\thasFill: function() {\n\t\tvar color = this.getFillColor();\n\t\treturn !!color && color.alpha > 0;\n\t},\n\n\thasStroke: function() {\n\t\tvar color = this.getStrokeColor();\n\t\treturn !!color && color.alpha > 0 && this.getStrokeWidth() > 0;\n\t},\n\n\thasShadow: function() {\n\t\tvar color = this.getShadowColor();\n\t\treturn !!color && color.alpha > 0 && (this.getShadowBlur() > 0\n\t\t\t\t|| !this.getShadowOffset().isZero());\n\t},\n\n\tgetView: function() {\n\t\treturn this._project._view;\n\t},\n\n\tgetFontStyle: function() {\n\t\tvar fontSize = this.getFontSize();\n\t\treturn this.getFontWeight()\n\t\t\t\t+ ' ' + fontSize + (/[a-z]/i.test(fontSize + '') ? ' ' : 'px ')\n\t\t\t\t+ this.getFontFamily();\n\t},\n\n\tgetFont: '#getFontFamily',\n\tsetFont: '#setFontFamily',\n\n\tgetLeading: function getLeading() {\n\t\tvar leading = getLeading.base.call(this),\n\t\t\tfontSize = this.getFontSize();\n\t\tif (/pt|em|%|px/.test(fontSize))\n\t\t\tfontSize = this.getView().getPixelSize(fontSize);\n\t\treturn leading != null ? leading : fontSize * 1.2;\n\t}\n\n});\n\nvar DomElement = new function() {\n\tfunction handlePrefix(el, name, set, value) {\n\t\tvar prefixes = ['', 'webkit', 'moz', 'Moz', 'ms', 'o'],\n\t\t\tsuffix = name[0].toUpperCase() + name.substring(1);\n\t\tfor (var i = 0; i < 6; i++) {\n\t\t\tvar prefix = prefixes[i],\n\t\t\t\tkey = prefix ? prefix + suffix : name;\n\t\t\tif (key in el) {\n\t\t\t\tif (set) {\n\t\t\t\t\tel[key] = value;\n\t\t\t\t} else {\n\t\t\t\t\treturn el[key];\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\treturn {\n\t\tgetStyles: function(el) {\n\t\t\tvar doc = el && el.nodeType !== 9 ? el.ownerDocument : el,\n\t\t\t\tview = doc && doc.defaultView;\n\t\t\treturn view && view.getComputedStyle(el, '');\n\t\t},\n\n\t\tgetBounds: function(el, viewport) {\n\t\t\tvar doc = el.ownerDocument,\n\t\t\t\tbody = doc.body,\n\t\t\t\thtml = doc.documentElement,\n\t\t\t\trect;\n\t\t\ttry {\n\t\t\t\trect = el.getBoundingClientRect();\n\t\t\t} catch (e) {\n\t\t\t\trect = { left: 0, top: 0, width: 0, height: 0 };\n\t\t\t}\n\t\t\tvar x = rect.left - (html.clientLeft || body.clientLeft || 0),\n\t\t\t\ty = rect.top - (html.clientTop || body.clientTop || 0);\n\t\t\tif (!viewport) {\n\t\t\t\tvar view = doc.defaultView;\n\t\t\t\tx += view.pageXOffset || html.scrollLeft || body.scrollLeft;\n\t\t\t\ty += view.pageYOffset || html.scrollTop || body.scrollTop;\n\t\t\t}\n\t\t\treturn new Rectangle(x, y, rect.width, rect.height);\n\t\t},\n\n\t\tgetViewportBounds: function(el) {\n\t\t\tvar doc = el.ownerDocument,\n\t\t\t\tview = doc.defaultView,\n\t\t\t\thtml = doc.documentElement;\n\t\t\treturn new Rectangle(0, 0,\n\t\t\t\tview.innerWidth || html.clientWidth,\n\t\t\t\tview.innerHeight || html.clientHeight\n\t\t\t);\n\t\t},\n\n\t\tgetOffset: function(el, viewport) {\n\t\t\treturn DomElement.getBounds(el, viewport).getPoint();\n\t\t},\n\n\t\tgetSize: function(el) {\n\t\t\treturn DomElement.getBounds(el, true).getSize();\n\t\t},\n\n\t\tisInvisible: function(el) {\n\t\t\treturn DomElement.getSize(el).equals(new Size(0, 0));\n\t\t},\n\n\t\tisInView: function(el) {\n\t\t\treturn !DomElement.isInvisible(el)\n\t\t\t\t\t&& DomElement.getViewportBounds(el).intersects(\n\t\t\t\t\t\tDomElement.getBounds(el, true));\n\t\t},\n\n\t\tisInserted: function(el) {\n\t\t\treturn document.body.contains(el);\n\t\t},\n\n\t\tgetPrefixed: function(el, name) {\n\t\t\treturn el && handlePrefix(el, name);\n\t\t},\n\n\t\tsetPrefixed: function(el, name, value) {\n\t\t\tif (typeof name === 'object') {\n\t\t\t\tfor (var key in name)\n\t\t\t\t\thandlePrefix(el, key, true, name[key]);\n\t\t\t} else {\n\t\t\t\thandlePrefix(el, name, true, value);\n\t\t\t}\n\t\t}\n\t};\n};\n\nvar DomEvent = {\n\tadd: function(el, events) {\n\t\tif (el) {\n\t\t\tfor (var type in events) {\n\t\t\t\tvar func = events[type],\n\t\t\t\t\tparts = type.split(/[\\s,]+/g);\n\t\t\t\tfor (var i = 0, l = parts.length; i < l; i++) {\n\t\t\t\t\tvar name = parts[i];\n\t\t\t\t\tvar options = (\n\t\t\t\t\t\tel === document\n\t\t\t\t\t\t&& (name === 'touchstart' || name === 'touchmove')\n\t\t\t\t\t) ? { passive: false } : false;\n\t\t\t\t\tel.addEventListener(name, func, options);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\n\tremove: function(el, events) {\n\t\tif (el) {\n\t\t\tfor (var type in events) {\n\t\t\t\tvar func = events[type],\n\t\t\t\t\tparts = type.split(/[\\s,]+/g);\n\t\t\t\tfor (var i = 0, l = parts.length; i < l; i++)\n\t\t\t\t\tel.removeEventListener(parts[i], func, false);\n\t\t\t}\n\t\t}\n\t},\n\n\tgetPoint: function(event) {\n\t\tvar pos = event.targetTouches\n\t\t\t\t? event.targetTouches.length\n\t\t\t\t\t? event.targetTouches[0]\n\t\t\t\t\t: event.changedTouches[0]\n\t\t\t\t: event;\n\t\treturn new Point(\n\t\t\tpos.pageX || pos.clientX + document.documentElement.scrollLeft,\n\t\t\tpos.pageY || pos.clientY + document.documentElement.scrollTop\n\t\t);\n\t},\n\n\tgetTarget: function(event) {\n\t\treturn event.target || event.srcElement;\n\t},\n\n\tgetRelatedTarget: function(event) {\n\t\treturn event.relatedTarget || event.toElement;\n\t},\n\n\tgetOffset: function(event, target) {\n\t\treturn DomEvent.getPoint(event).subtract(DomElement.getOffset(\n\t\t\t\ttarget || DomEvent.getTarget(event)));\n\t}\n};\n\nDomEvent.requestAnimationFrame = new function() {\n\tvar nativeRequest = DomElement.getPrefixed(window, 'requestAnimationFrame'),\n\t\trequested = false,\n\t\tcallbacks = [],\n\t\ttimer;\n\n\tfunction handleCallbacks() {\n\t\tvar functions = callbacks;\n\t\tcallbacks = [];\n\t\tfor (var i = 0, l = functions.length; i < l; i++)\n\t\t\tfunctions[i]();\n\t\trequested = nativeRequest && callbacks.length;\n\t\tif (requested)\n\t\t\tnativeRequest(handleCallbacks);\n\t}\n\n\treturn function(callback) {\n\t\tcallbacks.push(callback);\n\t\tif (nativeRequest) {\n\t\t\tif (!requested) {\n\t\t\t\tnativeRequest(handleCallbacks);\n\t\t\t\trequested = true;\n\t\t\t}\n\t\t} else if (!timer) {\n\t\t\ttimer = setInterval(handleCallbacks, 1000 / 60);\n\t\t}\n\t};\n};\n\nvar View = Base.extend(Emitter, {\n\t_class: 'View',\n\n\tinitialize: function View(project, element) {\n\n\t\tfunction getSize(name) {\n\t\t\treturn element[name] || parseInt(element.getAttribute(name), 10);\n\t\t}\n\n\t\tfunction getCanvasSize() {\n\t\t\tvar size = DomElement.getSize(element);\n\t\t\treturn size.isNaN() || size.isZero()\n\t\t\t\t\t? new Size(getSize('width'), getSize('height'))\n\t\t\t\t\t: size;\n\t\t}\n\n\t\tvar size;\n\t\tif (window && element) {\n\t\t\tthis._id = element.getAttribute('id');\n\t\t\tif (this._id == null)\n\t\t\t\telement.setAttribute('id', this._id = 'view-' + View._id++);\n\t\t\tDomEvent.add(element, this._viewEvents);\n\t\t\tvar none = 'none';\n\t\t\tDomElement.setPrefixed(element.style, {\n\t\t\t\tuserDrag: none,\n\t\t\t\tuserSelect: none,\n\t\t\t\ttouchCallout: none,\n\t\t\t\tcontentZooming: none,\n\t\t\t\ttapHighlightColor: 'rgba(0,0,0,0)'\n\t\t\t});\n\n\t\t\tif (PaperScope.hasAttribute(element, 'resize')) {\n\t\t\t\tvar that = this;\n\t\t\t\tDomEvent.add(window, this._windowEvents = {\n\t\t\t\t\tresize: function() {\n\t\t\t\t\t\tthat.setViewSize(getCanvasSize());\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tsize = getCanvasSize();\n\n\t\t\tif (PaperScope.hasAttribute(element, 'stats')\n\t\t\t\t\t&& typeof Stats !== 'undefined') {\n\t\t\t\tthis._stats = new Stats();\n\t\t\t\tvar stats = this._stats.domElement,\n\t\t\t\t\tstyle = stats.style,\n\t\t\t\t\toffset = DomElement.getOffset(element);\n\t\t\t\tstyle.position = 'absolute';\n\t\t\t\tstyle.left = offset.x + 'px';\n\t\t\t\tstyle.top = offset.y + 'px';\n\t\t\t\tdocument.body.appendChild(stats);\n\t\t\t}\n\t\t} else {\n\t\t\tsize = new Size(element);\n\t\t\telement = null;\n\t\t}\n\t\tthis._project = project;\n\t\tthis._scope = project._scope;\n\t\tthis._element = element;\n\t\tif (!this._pixelRatio)\n\t\t\tthis._pixelRatio = window && window.devicePixelRatio || 1;\n\t\tthis._setElementSize(size.width, size.height);\n\t\tthis._viewSize = size;\n\t\tView._views.push(this);\n\t\tView._viewsById[this._id] = this;\n\t\t(this._matrix = new Matrix())._owner = this;\n\t\tif (!View._focused)\n\t\t\tView._focused = this;\n\t\tthis._frameItems = {};\n\t\tthis._frameItemCount = 0;\n\t\tthis._itemEvents = { native: {}, virtual: {} };\n\t\tthis._autoUpdate = !paper.agent.node;\n\t\tthis._needsUpdate = false;\n\t},\n\n\tremove: function() {\n\t\tif (!this._project)\n\t\t\treturn false;\n\t\tif (View._focused === this)\n\t\t\tView._focused = null;\n\t\tView._views.splice(View._views.indexOf(this), 1);\n\t\tdelete View._viewsById[this._id];\n\t\tvar project = this._project;\n\t\tif (project._view === this)\n\t\t\tproject._view = null;\n\t\tDomEvent.remove(this._element, this._viewEvents);\n\t\tDomEvent.remove(window, this._windowEvents);\n\t\tthis._element = this._project = null;\n\t\tthis.off('frame');\n\t\tthis._animate = false;\n\t\tthis._frameItems = {};\n\t\treturn true;\n\t},\n\n\t_events: Base.each(\n\t\tItem._itemHandlers.concat(['onResize', 'onKeyDown', 'onKeyUp']),\n\t\tfunction(name) {\n\t\t\tthis[name] = {};\n\t\t}, {\n\t\t\tonFrame: {\n\t\t\t\tinstall: function() {\n\t\t\t\t\tthis.play();\n\t\t\t\t},\n\n\t\t\t\tuninstall: function() {\n\t\t\t\t\tthis.pause();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t),\n\n\t_animate: false,\n\t_time: 0,\n\t_count: 0,\n\n\tgetAutoUpdate: function() {\n\t\treturn this._autoUpdate;\n\t},\n\n\tsetAutoUpdate: function(autoUpdate) {\n\t\tthis._autoUpdate = autoUpdate;\n\t\tif (autoUpdate)\n\t\t\tthis.requestUpdate();\n\t},\n\n\tupdate: function() {\n\t},\n\n\tdraw: function() {\n\t\tthis.update();\n\t},\n\n\trequestUpdate: function() {\n\t\tif (!this._requested) {\n\t\t\tvar that = this;\n\t\t\tDomEvent.requestAnimationFrame(function() {\n\t\t\t\tthat._requested = false;\n\t\t\t\tif (that._animate) {\n\t\t\t\t\tthat.requestUpdate();\n\t\t\t\t\tvar element = that._element;\n\t\t\t\t\tif ((!DomElement.getPrefixed(document, 'hidden')\n\t\t\t\t\t\t\t|| PaperScope.getAttribute(element, 'keepalive')\n\t\t\t\t\t\t\t\t=== 'true') && DomElement.isInView(element)) {\n\t\t\t\t\t\tthat._handleFrame();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (that._autoUpdate)\n\t\t\t\t\tthat.update();\n\t\t\t});\n\t\t\tthis._requested = true;\n\t\t}\n\t},\n\n\tplay: function() {\n\t\tthis._animate = true;\n\t\tthis.requestUpdate();\n\t},\n\n\tpause: function() {\n\t\tthis._animate = false;\n\t},\n\n\t_handleFrame: function() {\n\t\tpaper = this._scope;\n\t\tvar now = Date.now() / 1000,\n\t\t\tdelta = this._last ? now - this._last : 0;\n\t\tthis._last = now;\n\t\tthis.emit('frame', new Base({\n\t\t\tdelta: delta,\n\t\t\ttime: this._time += delta,\n\t\t\tcount: this._count++\n\t\t}));\n\t\tif (this._stats)\n\t\t\tthis._stats.update();\n\t},\n\n\t_animateItem: function(item, animate) {\n\t\tvar items = this._frameItems;\n\t\tif (animate) {\n\t\t\titems[item._id] = {\n\t\t\t\titem: item,\n\t\t\t\ttime: 0,\n\t\t\t\tcount: 0\n\t\t\t};\n\t\t\tif (++this._frameItemCount === 1)\n\t\t\t\tthis.on('frame', this._handleFrameItems);\n\t\t} else {\n\t\t\tdelete items[item._id];\n\t\t\tif (--this._frameItemCount === 0) {\n\t\t\t\tthis.off('frame', this._handleFrameItems);\n\t\t\t}\n\t\t}\n\t},\n\n\t_handleFrameItems: function(event) {\n\t\tfor (var i in this._frameItems) {\n\t\t\tvar entry = this._frameItems[i];\n\t\t\tentry.item.emit('frame', new Base(event, {\n\t\t\t\ttime: entry.time += event.delta,\n\t\t\t\tcount: entry.count++\n\t\t\t}));\n\t\t}\n\t},\n\n\t_changed: function() {\n\t\tthis._project._changed(4097);\n\t\tthis._bounds = this._decomposed = undefined;\n\t},\n\n\tgetElement: function() {\n\t\treturn this._element;\n\t},\n\n\tgetPixelRatio: function() {\n\t\treturn this._pixelRatio;\n\t},\n\n\tgetResolution: function() {\n\t\treturn this._pixelRatio * 72;\n\t},\n\n\tgetViewSize: function() {\n\t\tvar size = this._viewSize;\n\t\treturn new LinkedSize(size.width, size.height, this, 'setViewSize');\n\t},\n\n\tsetViewSize: function() {\n\t\tvar size = Size.read(arguments),\n\t\t\tdelta = size.subtract(this._viewSize);\n\t\tif (delta.isZero())\n\t\t\treturn;\n\t\tthis._setElementSize(size.width, size.height);\n\t\tthis._viewSize.set(size);\n\t\tthis._changed();\n\t\tthis.emit('resize', { size: size, delta: delta });\n\t\tif (this._autoUpdate) {\n\t\t\tthis.update();\n\t\t}\n\t},\n\n\t_setElementSize: function(width, height) {\n\t\tvar element = this._element;\n\t\tif (element) {\n\t\t\tif (element.width !== width)\n\t\t\t\telement.width = width;\n\t\t\tif (element.height !== height)\n\t\t\t\telement.height = height;\n\t\t}\n\t},\n\n\tgetBounds: function() {\n\t\tif (!this._bounds)\n\t\t\tthis._bounds = this._matrix.inverted()._transformBounds(\n\t\t\t\t\tnew Rectangle(new Point(), this._viewSize));\n\t\treturn this._bounds;\n\t},\n\n\tgetSize: function() {\n\t\treturn this.getBounds().getSize();\n\t},\n\n\tisVisible: function() {\n\t\treturn DomElement.isInView(this._element);\n\t},\n\n\tisInserted: function() {\n\t\treturn DomElement.isInserted(this._element);\n\t},\n\n\tgetPixelSize: function(size) {\n\t\tvar element = this._element,\n\t\t\tpixels;\n\t\tif (element) {\n\t\t\tvar parent = element.parentNode,\n\t\t\t\ttemp = document.createElement('div');\n\t\t\ttemp.style.fontSize = size;\n\t\t\tparent.appendChild(temp);\n\t\t\tpixels = parseFloat(DomElement.getStyles(temp).fontSize);\n\t\t\tparent.removeChild(temp);\n\t\t} else {\n\t\t\tpixels = parseFloat(pixels);\n\t\t}\n\t\treturn pixels;\n\t},\n\n\tgetTextWidth: function(font, lines) {\n\t\treturn 0;\n\t}\n}, Base.each(['rotate', 'scale', 'shear', 'skew'], function(key) {\n\tvar rotate = key === 'rotate';\n\tthis[key] = function() {\n\t\tvar value = (rotate ? Base : Point).read(arguments),\n\t\t\tcenter = Point.read(arguments, 0, { readNull: true });\n\t\treturn this.transform(new Matrix()[key](value,\n\t\t\t\tcenter || this.getCenter(true)));\n\t};\n}, {\n\t_decompose: function() {\n\t\treturn this._decomposed || (this._decomposed = this._matrix.decompose());\n\t},\n\n\ttranslate: function() {\n\t\tvar mx = new Matrix();\n\t\treturn this.transform(mx.translate.apply(mx, arguments));\n\t},\n\n\tgetCenter: function() {\n\t\treturn this.getBounds().getCenter();\n\t},\n\n\tsetCenter: function() {\n\t\tvar center = Point.read(arguments);\n\t\tthis.translate(this.getCenter().subtract(center));\n\t},\n\n\tgetZoom: function() {\n\t\tvar scaling = this._decompose().scaling;\n\t\treturn (scaling.x + scaling.y) / 2;\n\t},\n\n\tsetZoom: function(zoom) {\n\t\tthis.transform(new Matrix().scale(zoom / this.getZoom(),\n\t\t\tthis.getCenter()));\n\t},\n\n\tgetRotation: function() {\n\t\treturn this._decompose().rotation;\n\t},\n\n\tsetRotation: function(rotation) {\n\t\tvar current = this.getRotation();\n\t\tif (current != null && rotation != null) {\n\t\t\tthis.rotate(rotation - current);\n\t\t}\n\t},\n\n\tgetScaling: function() {\n\t\tvar scaling = this._decompose().scaling;\n\t\treturn new LinkedPoint(scaling.x, scaling.y, this, 'setScaling');\n\t},\n\n\tsetScaling: function() {\n\t\tvar current = this.getScaling(),\n\t\t\tscaling = Point.read(arguments, 0, { clone: true, readNull: true });\n\t\tif (current && scaling) {\n\t\t\tthis.scale(scaling.x / current.x, scaling.y / current.y);\n\t\t}\n\t},\n\n\tgetMatrix: function() {\n\t\treturn this._matrix;\n\t},\n\n\tsetMatrix: function() {\n\t\tvar matrix = this._matrix;\n\t\tmatrix.initialize.apply(matrix, arguments);\n\t},\n\n\ttransform: function(matrix) {\n\t\tthis._matrix.append(matrix);\n\t},\n\n\tscrollBy: function() {\n\t\tthis.translate(Point.read(arguments).negate());\n\t}\n}), {\n\n\tprojectToView: function() {\n\t\treturn this._matrix._transformPoint(Point.read(arguments));\n\t},\n\n\tviewToProject: function() {\n\t\treturn this._matrix._inverseTransform(Point.read(arguments));\n\t},\n\n\tgetEventPoint: function(event) {\n\t\treturn this.viewToProject(DomEvent.getOffset(event, this._element));\n\t},\n\n}, {\n\tstatics: {\n\t\t_views: [],\n\t\t_viewsById: {},\n\t\t_id: 0,\n\n\t\tcreate: function(project, element) {\n\t\t\tif (document && typeof element === 'string')\n\t\t\t\telement = document.getElementById(element);\n\t\t\tvar ctor = window ? CanvasView : View;\n\t\t\treturn new ctor(project, element);\n\t\t}\n\t}\n},\nnew function() {\n\tif (!window)\n\t\treturn;\n\tvar prevFocus,\n\t\ttempFocus,\n\t\tdragging = false,\n\t\tmouseDown = false;\n\n\tfunction getView(event) {\n\t\tvar target = DomEvent.getTarget(event);\n\t\treturn target.getAttribute && View._viewsById[\n\t\t\t\ttarget.getAttribute('id')];\n\t}\n\n\tfunction updateFocus() {\n\t\tvar view = View._focused;\n\t\tif (!view || !view.isVisible()) {\n\t\t\tfor (var i = 0, l = View._views.length; i < l; i++) {\n\t\t\t\tif ((view = View._views[i]).isVisible()) {\n\t\t\t\t\tView._focused = tempFocus = view;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction handleMouseMove(view, event, point) {\n\t\tview._handleMouseEvent('mousemove', event, point);\n\t}\n\n\tvar navigator = window.navigator,\n\t\tmousedown, mousemove, mouseup;\n\tif (navigator.pointerEnabled || navigator.msPointerEnabled) {\n\t\tmousedown = 'pointerdown MSPointerDown';\n\t\tmousemove = 'pointermove MSPointerMove';\n\t\tmouseup = 'pointerup pointercancel MSPointerUp MSPointerCancel';\n\t} else {\n\t\tmousedown = 'touchstart';\n\t\tmousemove = 'touchmove';\n\t\tmouseup = 'touchend touchcancel';\n\t\tif (!('ontouchstart' in window && navigator.userAgent.match(\n\t\t\t\t/mobile|tablet|ip(ad|hone|od)|android|silk/i))) {\n\t\t\tmousedown += ' mousedown';\n\t\t\tmousemove += ' mousemove';\n\t\t\tmouseup += ' mouseup';\n\t\t}\n\t}\n\n\tvar viewEvents = {},\n\t\tdocEvents = {\n\t\t\tmouseout: function(event) {\n\t\t\t\tvar view = View._focused,\n\t\t\t\t\ttarget = DomEvent.getRelatedTarget(event);\n\t\t\t\tif (view && (!target || target.nodeName === 'HTML')) {\n\t\t\t\t\tvar offset = DomEvent.getOffset(event, view._element),\n\t\t\t\t\t\tx = offset.x,\n\t\t\t\t\t\tabs = Math.abs,\n\t\t\t\t\t\tax = abs(x),\n\t\t\t\t\t\tmax = 1 << 25,\n\t\t\t\t\t\tdiff = ax - max;\n\t\t\t\t\toffset.x = abs(diff) < ax ? diff * (x < 0 ? -1 : 1) : x;\n\t\t\t\t\thandleMouseMove(view, event, view.viewToProject(offset));\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tscroll: updateFocus\n\t\t};\n\n\tviewEvents[mousedown] = function(event) {\n\t\tvar view = View._focused = getView(event);\n\t\tif (!dragging) {\n\t\t\tdragging = true;\n\t\t\tview._handleMouseEvent('mousedown', event);\n\t\t}\n\t};\n\n\tdocEvents[mousemove] = function(event) {\n\t\tvar view = View._focused;\n\t\tif (!mouseDown) {\n\t\t\tvar target = getView(event);\n\t\t\tif (target) {\n\t\t\t\tif (view !== target) {\n\t\t\t\t\tif (view)\n\t\t\t\t\t\thandleMouseMove(view, event);\n\t\t\t\t\tif (!prevFocus)\n\t\t\t\t\t\tprevFocus = view;\n\t\t\t\t\tview = View._focused = tempFocus = target;\n\t\t\t\t}\n\t\t\t} else if (tempFocus && tempFocus === view) {\n\t\t\t\tif (prevFocus && !prevFocus.isInserted())\n\t\t\t\t\tprevFocus = null;\n\t\t\t\tview = View._focused = prevFocus;\n\t\t\t\tprevFocus = null;\n\t\t\t\tupdateFocus();\n\t\t\t}\n\t\t}\n\t\tif (view)\n\t\t\thandleMouseMove(view, event);\n\t};\n\n\tdocEvents[mousedown] = function() {\n\t\tmouseDown = true;\n\t};\n\n\tdocEvents[mouseup] = function(event) {\n\t\tvar view = View._focused;\n\t\tif (view && dragging)\n\t\t\tview._handleMouseEvent('mouseup', event);\n\t\tmouseDown = dragging = false;\n\t};\n\n\tDomEvent.add(document, docEvents);\n\n\tDomEvent.add(window, {\n\t\tload: updateFocus\n\t});\n\n\tvar called = false,\n\t\tprevented = false,\n\t\tfallbacks = {\n\t\t\tdoubleclick: 'click',\n\t\t\tmousedrag: 'mousemove'\n\t\t},\n\t\twasInView = false,\n\t\toverView,\n\t\tdownPoint,\n\t\tlastPoint,\n\t\tdownItem,\n\t\toverItem,\n\t\tdragItem,\n\t\tclickItem,\n\t\tclickTime,\n\t\tdblClick;\n\n\tfunction emitMouseEvent(obj, target, type, event, point, prevPoint,\n\t\t\tstopItem) {\n\t\tvar stopped = false,\n\t\t\tmouseEvent;\n\n\t\tfunction emit(obj, type) {\n\t\t\tif (obj.responds(type)) {\n\t\t\t\tif (!mouseEvent) {\n\t\t\t\t\tmouseEvent = new MouseEvent(type, event, point,\n\t\t\t\t\t\t\ttarget || obj,\n\t\t\t\t\t\t\tprevPoint ? point.subtract(prevPoint) : null);\n\t\t\t\t}\n\t\t\t\tif (obj.emit(type, mouseEvent)) {\n\t\t\t\t\tcalled = true;\n\t\t\t\t\tif (mouseEvent.prevented)\n\t\t\t\t\t\tprevented = true;\n\t\t\t\t\tif (mouseEvent.stopped)\n\t\t\t\t\t\treturn stopped = true;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tvar fallback = fallbacks[type];\n\t\t\t\tif (fallback)\n\t\t\t\t\treturn emit(obj, fallback);\n\t\t\t}\n\t\t}\n\n\t\twhile (obj && obj !== stopItem) {\n\t\t\tif (emit(obj, type))\n\t\t\t\tbreak;\n\t\t\tobj = obj._parent;\n\t\t}\n\t\treturn stopped;\n\t}\n\n\tfunction emitMouseEvents(view, hitItem, type, event, point, prevPoint) {\n\t\tview._project.removeOn(type);\n\t\tprevented = called = false;\n\t\treturn (dragItem && emitMouseEvent(dragItem, null, type, event,\n\t\t\t\t\tpoint, prevPoint)\n\t\t\t|| hitItem && hitItem !== dragItem\n\t\t\t\t&& !hitItem.isDescendant(dragItem)\n\t\t\t\t&& emitMouseEvent(hitItem, null, type === 'mousedrag' ?\n\t\t\t\t\t'mousemove' : type, event, point, prevPoint, dragItem)\n\t\t\t|| emitMouseEvent(view, dragItem || hitItem || view, type, event,\n\t\t\t\t\tpoint, prevPoint));\n\t}\n\n\tvar itemEventsMap = {\n\t\tmousedown: {\n\t\t\tmousedown: 1,\n\t\t\tmousedrag: 1,\n\t\t\tclick: 1,\n\t\t\tdoubleclick: 1\n\t\t},\n\t\tmouseup: {\n\t\t\tmouseup: 1,\n\t\t\tmousedrag: 1,\n\t\t\tclick: 1,\n\t\t\tdoubleclick: 1\n\t\t},\n\t\tmousemove: {\n\t\t\tmousedrag: 1,\n\t\t\tmousemove: 1,\n\t\t\tmouseenter: 1,\n\t\t\tmouseleave: 1\n\t\t}\n\t};\n\n\treturn {\n\t\t_viewEvents: viewEvents,\n\n\t\t_handleMouseEvent: function(type, event, point) {\n\t\t\tvar itemEvents = this._itemEvents,\n\t\t\t\thitItems = itemEvents.native[type],\n\t\t\t\tnativeMove = type === 'mousemove',\n\t\t\t\ttool = this._scope.tool,\n\t\t\t\tview = this;\n\n\t\t\tfunction responds(type) {\n\t\t\t\treturn itemEvents.virtual[type] || view.responds(type)\n\t\t\t\t\t\t|| tool && tool.responds(type);\n\t\t\t}\n\n\t\t\tif (nativeMove && dragging && responds('mousedrag'))\n\t\t\t\ttype = 'mousedrag';\n\t\t\tif (!point)\n\t\t\t\tpoint = this.getEventPoint(event);\n\n\t\t\tvar inView = this.getBounds().contains(point),\n\t\t\t\thit = hitItems && inView && view._project.hitTest(point, {\n\t\t\t\t\ttolerance: 0,\n\t\t\t\t\tfill: true,\n\t\t\t\t\tstroke: true\n\t\t\t\t}),\n\t\t\t\thitItem = hit && hit.item || null,\n\t\t\t\thandle = false,\n\t\t\t\tmouse = {};\n\t\t\tmouse[type.substr(5)] = true;\n\n\t\t\tif (hitItems && hitItem !== overItem) {\n\t\t\t\tif (overItem) {\n\t\t\t\t\temitMouseEvent(overItem, null, 'mouseleave', event, point);\n\t\t\t\t}\n\t\t\t\tif (hitItem) {\n\t\t\t\t\temitMouseEvent(hitItem, null, 'mouseenter', event, point);\n\t\t\t\t}\n\t\t\t\toverItem = hitItem;\n\t\t\t}\n\t\t\tif (wasInView ^ inView) {\n\t\t\t\temitMouseEvent(this, null, inView ? 'mouseenter' : 'mouseleave',\n\t\t\t\t\t\tevent, point);\n\t\t\t\toverView = inView ? this : null;\n\t\t\t\thandle = true;\n\t\t\t}\n\t\t\tif ((inView || mouse.drag) && !point.equals(lastPoint)) {\n\t\t\t\temitMouseEvents(this, hitItem, nativeMove ? type : 'mousemove',\n\t\t\t\t\t\tevent, point, lastPoint);\n\t\t\t\thandle = true;\n\t\t\t}\n\t\t\twasInView = inView;\n\t\t\tif (mouse.down && inView || mouse.up && downPoint) {\n\t\t\t\temitMouseEvents(this, hitItem, type, event, point, downPoint);\n\t\t\t\tif (mouse.down) {\n\t\t\t\t\tdblClick = hitItem === clickItem\n\t\t\t\t\t\t&& (Date.now() - clickTime < 300);\n\t\t\t\t\tdownItem = clickItem = hitItem;\n\t\t\t\t\tif (!prevented && hitItem) {\n\t\t\t\t\t\tvar item = hitItem;\n\t\t\t\t\t\twhile (item && !item.responds('mousedrag'))\n\t\t\t\t\t\t\titem = item._parent;\n\t\t\t\t\t\tif (item)\n\t\t\t\t\t\t\tdragItem = hitItem;\n\t\t\t\t\t}\n\t\t\t\t\tdownPoint = point;\n\t\t\t\t} else if (mouse.up) {\n\t\t\t\t\tif (!prevented && hitItem === downItem) {\n\t\t\t\t\t\tclickTime = Date.now();\n\t\t\t\t\t\temitMouseEvents(this, hitItem, dblClick ? 'doubleclick'\n\t\t\t\t\t\t\t\t: 'click', event, point, downPoint);\n\t\t\t\t\t\tdblClick = false;\n\t\t\t\t\t}\n\t\t\t\t\tdownItem = dragItem = null;\n\t\t\t\t}\n\t\t\t\twasInView = false;\n\t\t\t\thandle = true;\n\t\t\t}\n\t\t\tlastPoint = point;\n\t\t\tif (handle && tool) {\n\t\t\t\tcalled = tool._handleMouseEvent(type, event, point, mouse)\n\t\t\t\t\t|| called;\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\tevent.cancelable !== false\n\t\t\t\t&& (called && !mouse.move || mouse.down && responds('mouseup'))\n\t\t\t) {\n\t\t\t\tevent.preventDefault();\n\t\t\t}\n\t\t},\n\n\t\t_handleKeyEvent: function(type, event, key, character) {\n\t\t\tvar scope = this._scope,\n\t\t\t\ttool = scope.tool,\n\t\t\t\tkeyEvent;\n\n\t\t\tfunction emit(obj) {\n\t\t\t\tif (obj.responds(type)) {\n\t\t\t\t\tpaper = scope;\n\t\t\t\t\tobj.emit(type, keyEvent = keyEvent\n\t\t\t\t\t\t\t|| new KeyEvent(type, event, key, character));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (this.isVisible()) {\n\t\t\t\temit(this);\n\t\t\t\tif (tool && tool.responds(type))\n\t\t\t\t\temit(tool);\n\t\t\t}\n\t\t},\n\n\t\t_countItemEvent: function(type, sign) {\n\t\t\tvar itemEvents = this._itemEvents,\n\t\t\t\tnative = itemEvents.native,\n\t\t\t\tvirtual = itemEvents.virtual;\n\t\t\tfor (var key in itemEventsMap) {\n\t\t\t\tnative[key] = (native[key] || 0)\n\t\t\t\t\t\t+ (itemEventsMap[key][type] || 0) * sign;\n\t\t\t}\n\t\t\tvirtual[type] = (virtual[type] || 0) + sign;\n\t\t},\n\n\t\tstatics: {\n\t\t\tupdateFocus: updateFocus,\n\n\t\t\t_resetState: function() {\n\t\t\t\tdragging = mouseDown = called = wasInView = false;\n\t\t\t\tprevFocus = tempFocus = overView = downPoint = lastPoint =\n\t\t\t\t\tdownItem = overItem = dragItem = clickItem = clickTime =\n\t\t\t\t\tdblClick = null;\n\t\t\t}\n\t\t}\n\t};\n});\n\nvar CanvasView = View.extend({\n\t_class: 'CanvasView',\n\n\tinitialize: function CanvasView(project, canvas) {\n\t\tif (!(canvas instanceof window.HTMLCanvasElement)) {\n\t\t\tvar size = Size.read(arguments, 1);\n\t\t\tif (size.isZero())\n\t\t\t\tthrow new Error(\n\t\t\t\t\t\t'Cannot create CanvasView with the provided argument: '\n\t\t\t\t\t\t+ Base.slice(arguments, 1));\n\t\t\tcanvas = CanvasProvider.getCanvas(size);\n\t\t}\n\t\tvar ctx = this._context = canvas.getContext('2d');\n\t\tctx.save();\n\t\tthis._pixelRatio = 1;\n\t\tif (!/^off|false$/.test(PaperScope.getAttribute(canvas, 'hidpi'))) {\n\t\t\tvar deviceRatio = window.devicePixelRatio || 1,\n\t\t\t\tbackingStoreRatio = DomElement.getPrefixed(ctx,\n\t\t\t\t\t\t'backingStorePixelRatio') || 1;\n\t\t\tthis._pixelRatio = deviceRatio / backingStoreRatio;\n\t\t}\n\t\tView.call(this, project, canvas);\n\t\tthis._needsUpdate = true;\n\t},\n\n\tremove: function remove() {\n\t\tthis._context.restore();\n\t\treturn remove.base.call(this);\n\t},\n\n\t_setElementSize: function _setElementSize(width, height) {\n\t\tvar pixelRatio = this._pixelRatio;\n\t\t_setElementSize.base.call(this, width * pixelRatio, height * pixelRatio);\n\t\tif (pixelRatio !== 1) {\n\t\t\tvar element = this._element,\n\t\t\t\tctx = this._context;\n\t\t\tif (!PaperScope.hasAttribute(element, 'resize')) {\n\t\t\t\tvar style = element.style;\n\t\t\t\tstyle.width = width + 'px';\n\t\t\t\tstyle.height = height + 'px';\n\t\t\t}\n\t\t\tctx.restore();\n\t\t\tctx.save();\n\t\t\tctx.scale(pixelRatio, pixelRatio);\n\t\t}\n\t},\n\n\tgetPixelSize: function getPixelSize(size) {\n\t\tvar agent = paper.agent,\n\t\t\tpixels;\n\t\tif (agent && agent.firefox) {\n\t\t\tpixels = getPixelSize.base.call(this, size);\n\t\t} else {\n\t\t\tvar ctx = this._context,\n\t\t\t\tprevFont = ctx.font;\n\t\t\tctx.font = size + ' serif';\n\t\t\tpixels = parseFloat(ctx.font);\n\t\t\tctx.font = prevFont;\n\t\t}\n\t\treturn pixels;\n\t},\n\n\tgetTextWidth: function(font, lines) {\n\t\tvar ctx = this._context,\n\t\t\tprevFont = ctx.font,\n\t\t\twidth = 0;\n\t\tctx.font = font;\n\t\tfor (var i = 0, l = lines.length; i < l; i++)\n\t\t\twidth = Math.max(width, ctx.measureText(lines[i]).width);\n\t\tctx.font = prevFont;\n\t\treturn width;\n\t},\n\n\tupdate: function() {\n\t\tif (!this._needsUpdate)\n\t\t\treturn false;\n\t\tvar project = this._project,\n\t\t\tctx = this._context,\n\t\t\tsize = this._viewSize;\n\t\tctx.clearRect(0, 0, size.width + 1, size.height + 1);\n\t\tif (project)\n\t\t\tproject.draw(ctx, this._matrix, this._pixelRatio);\n\t\tthis._needsUpdate = false;\n\t\treturn true;\n\t}\n});\n\nvar Event = Base.extend({\n\t_class: 'Event',\n\n\tinitialize: function Event(event) {\n\t\tthis.event = event;\n\t\tthis.type = event && event.type;\n\t},\n\n\tprevented: false,\n\tstopped: false,\n\n\tpreventDefault: function() {\n\t\tthis.prevented = true;\n\t\tthis.event.preventDefault();\n\t},\n\n\tstopPropagation: function() {\n\t\tthis.stopped = true;\n\t\tthis.event.stopPropagation();\n\t},\n\n\tstop: function() {\n\t\tthis.stopPropagation();\n\t\tthis.preventDefault();\n\t},\n\n\tgetTimeStamp: function() {\n\t\treturn this.event.timeStamp;\n\t},\n\n\tgetModifiers: function() {\n\t\treturn Key.modifiers;\n\t}\n});\n\nvar KeyEvent = Event.extend({\n\t_class: 'KeyEvent',\n\n\tinitialize: function KeyEvent(type, event, key, character) {\n\t\tthis.type = type;\n\t\tthis.event = event;\n\t\tthis.key = key;\n\t\tthis.character = character;\n\t},\n\n\ttoString: function() {\n\t\treturn \"{ type: '\" + this.type\n\t\t\t\t+ \"', key: '\" + this.key\n\t\t\t\t+ \"', character: '\" + this.character\n\t\t\t\t+ \"', modifiers: \" + this.getModifiers()\n\t\t\t\t+ \" }\";\n\t}\n});\n\nvar Key = new function() {\n\tvar keyLookup = {\n\t\t\t'\\t': 'tab',\n\t\t\t' ': 'space',\n\t\t\t'\\b': 'backspace',\n\t\t\t'\\x7f': 'delete',\n\t\t\t'Spacebar': 'space',\n\t\t\t'Del': 'delete',\n\t\t\t'Win': 'meta',\n\t\t\t'Esc': 'escape'\n\t\t},\n\n\t\tcharLookup = {\n\t\t\t'tab': '\\t',\n\t\t\t'space': ' ',\n\t\t\t'enter': '\\r'\n\t\t},\n\n\t\tkeyMap = {},\n\t\tcharMap = {},\n\t\tmetaFixMap,\n\t\tdownKey,\n\n\t\tmodifiers = new Base({\n\t\t\tshift: false,\n\t\t\tcontrol: false,\n\t\t\talt: false,\n\t\t\tmeta: false,\n\t\t\tcapsLock: false,\n\t\t\tspace: false\n\t\t}).inject({\n\t\t\toption: {\n\t\t\t\tget: function() {\n\t\t\t\t\treturn this.alt;\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tcommand: {\n\t\t\t\tget: function() {\n\t\t\t\t\tvar agent = paper && paper.agent;\n\t\t\t\t\treturn agent && agent.mac ? this.meta : this.control;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\tfunction getKey(event) {\n\t\tvar key = event.key || event.keyIdentifier;\n\t\tkey = /^U\\+/.test(key)\n\t\t\t\t? String.fromCharCode(parseInt(key.substr(2), 16))\n\t\t\t\t: /^Arrow[A-Z]/.test(key) ? key.substr(5)\n\t\t\t\t: key === 'Unidentified'  || key === undefined\n\t\t\t\t\t? String.fromCharCode(event.keyCode)\n\t\t\t\t\t: key;\n\t\treturn keyLookup[key] ||\n\t\t\t\t(key.length > 1 ? Base.hyphenate(key) : key.toLowerCase());\n\t}\n\n\tfunction handleKey(down, key, character, event) {\n\t\tvar type = down ? 'keydown' : 'keyup',\n\t\t\tview = View._focused,\n\t\t\tname;\n\t\tkeyMap[key] = down;\n\t\tif (down) {\n\t\t\tcharMap[key] = character;\n\t\t} else {\n\t\t\tdelete charMap[key];\n\t\t}\n\t\tif (key.length > 1 && (name = Base.camelize(key)) in modifiers) {\n\t\t\tmodifiers[name] = down;\n\t\t\tvar agent = paper && paper.agent;\n\t\t\tif (name === 'meta' && agent && agent.mac) {\n\t\t\t\tif (down) {\n\t\t\t\t\tmetaFixMap = {};\n\t\t\t\t} else {\n\t\t\t\t\tfor (var k in metaFixMap) {\n\t\t\t\t\t\tif (k in charMap)\n\t\t\t\t\t\t\thandleKey(false, k, metaFixMap[k], event);\n\t\t\t\t\t}\n\t\t\t\t\tmetaFixMap = null;\n\t\t\t\t}\n\t\t\t}\n\t\t} else if (down && metaFixMap) {\n\t\t\tmetaFixMap[key] = character;\n\t\t}\n\t\tif (view) {\n\t\t\tview._handleKeyEvent(down ? 'keydown' : 'keyup', event, key,\n\t\t\t\t\tcharacter);\n\t\t}\n\t}\n\n\tDomEvent.add(document, {\n\t\tkeydown: function(event) {\n\t\t\tvar key = getKey(event),\n\t\t\t\tagent = paper && paper.agent;\n\t\t\tif (key.length > 1 || agent && (agent.chrome && (event.altKey\n\t\t\t\t\t\t|| agent.mac && event.metaKey\n\t\t\t\t\t\t|| !agent.mac && event.ctrlKey))) {\n\t\t\t\thandleKey(true, key,\n\t\t\t\t\t\tcharLookup[key] || (key.length > 1 ? '' : key), event);\n\t\t\t} else {\n\t\t\t\tdownKey = key;\n\t\t\t}\n\t\t},\n\n\t\tkeypress: function(event) {\n\t\t\tif (downKey) {\n\t\t\t\tvar key = getKey(event),\n\t\t\t\t\tcode = event.charCode,\n\t\t\t\t\tcharacter = code >= 32 ? String.fromCharCode(code)\n\t\t\t\t\t\t: key.length > 1 ? '' : key;\n\t\t\t\tif (key !== downKey) {\n\t\t\t\t\tkey = character.toLowerCase();\n\t\t\t\t}\n\t\t\t\thandleKey(true, key, character, event);\n\t\t\t\tdownKey = null;\n\t\t\t}\n\t\t},\n\n\t\tkeyup: function(event) {\n\t\t\tvar key = getKey(event);\n\t\t\tif (key in charMap)\n\t\t\t\thandleKey(false, key, charMap[key], event);\n\t\t}\n\t});\n\n\tDomEvent.add(window, {\n\t\tblur: function(event) {\n\t\t\tfor (var key in charMap)\n\t\t\t\thandleKey(false, key, charMap[key], event);\n\t\t}\n\t});\n\n\treturn {\n\t\tmodifiers: modifiers,\n\n\t\tisDown: function(key) {\n\t\t\treturn !!keyMap[key];\n\t\t}\n\t};\n};\n\nvar MouseEvent = Event.extend({\n\t_class: 'MouseEvent',\n\n\tinitialize: function MouseEvent(type, event, point, target, delta) {\n\t\tthis.type = type;\n\t\tthis.event = event;\n\t\tthis.point = point;\n\t\tthis.target = target;\n\t\tthis.delta = delta;\n\t},\n\n\ttoString: function() {\n\t\treturn \"{ type: '\" + this.type\n\t\t\t\t+ \"', point: \" + this.point\n\t\t\t\t+ ', target: ' + this.target\n\t\t\t\t+ (this.delta ? ', delta: ' + this.delta : '')\n\t\t\t\t+ ', modifiers: ' + this.getModifiers()\n\t\t\t\t+ ' }';\n\t}\n});\n\nvar ToolEvent = Event.extend({\n\t_class: 'ToolEvent',\n\t_item: null,\n\n\tinitialize: function ToolEvent(tool, type, event) {\n\t\tthis.tool = tool;\n\t\tthis.type = type;\n\t\tthis.event = event;\n\t},\n\n\t_choosePoint: function(point, toolPoint) {\n\t\treturn point ? point : toolPoint ? toolPoint.clone() : null;\n\t},\n\n\tgetPoint: function() {\n\t\treturn this._choosePoint(this._point, this.tool._point);\n\t},\n\n\tsetPoint: function(point) {\n\t\tthis._point = point;\n\t},\n\n\tgetLastPoint: function() {\n\t\treturn this._choosePoint(this._lastPoint, this.tool._lastPoint);\n\t},\n\n\tsetLastPoint: function(lastPoint) {\n\t\tthis._lastPoint = lastPoint;\n\t},\n\n\tgetDownPoint: function() {\n\t\treturn this._choosePoint(this._downPoint, this.tool._downPoint);\n\t},\n\n\tsetDownPoint: function(downPoint) {\n\t\tthis._downPoint = downPoint;\n\t},\n\n\tgetMiddlePoint: function() {\n\t\tif (!this._middlePoint && this.tool._lastPoint) {\n\t\t\treturn this.tool._point.add(this.tool._lastPoint).divide(2);\n\t\t}\n\t\treturn this._middlePoint;\n\t},\n\n\tsetMiddlePoint: function(middlePoint) {\n\t\tthis._middlePoint = middlePoint;\n\t},\n\n\tgetDelta: function() {\n\t\treturn !this._delta && this.tool._lastPoint\n\t\t\t\t? this.tool._point.subtract(this.tool._lastPoint)\n\t\t\t\t: this._delta;\n\t},\n\n\tsetDelta: function(delta) {\n\t\tthis._delta = delta;\n\t},\n\n\tgetCount: function() {\n\t\treturn this.tool[/^mouse(down|up)$/.test(this.type)\n\t\t\t\t? '_downCount' : '_moveCount'];\n\t},\n\n\tsetCount: function(count) {\n\t\tthis.tool[/^mouse(down|up)$/.test(this.type) ? 'downCount' : 'count']\n\t\t\t= count;\n\t},\n\n\tgetItem: function() {\n\t\tif (!this._item) {\n\t\t\tvar result = this.tool._scope.project.hitTest(this.getPoint());\n\t\t\tif (result) {\n\t\t\t\tvar item = result.item,\n\t\t\t\t\tparent = item._parent;\n\t\t\t\twhile (/^(Group|CompoundPath)$/.test(parent._class)) {\n\t\t\t\t\titem = parent;\n\t\t\t\t\tparent = parent._parent;\n\t\t\t\t}\n\t\t\t\tthis._item = item;\n\t\t\t}\n\t\t}\n\t\treturn this._item;\n\t},\n\n\tsetItem: function(item) {\n\t\tthis._item = item;\n\t},\n\n\ttoString: function() {\n\t\treturn '{ type: ' + this.type\n\t\t\t\t+ ', point: ' + this.getPoint()\n\t\t\t\t+ ', count: ' + this.getCount()\n\t\t\t\t+ ', modifiers: ' + this.getModifiers()\n\t\t\t\t+ ' }';\n\t}\n});\n\nvar Tool = PaperScopeItem.extend({\n\t_class: 'Tool',\n\t_list: 'tools',\n\t_reference: 'tool',\n\t_events: ['onMouseDown', 'onMouseUp', 'onMouseDrag', 'onMouseMove',\n\t\t\t'onActivate', 'onDeactivate', 'onEditOptions', 'onKeyDown',\n\t\t\t'onKeyUp'],\n\n\tinitialize: function Tool(props) {\n\t\tPaperScopeItem.call(this);\n\t\tthis._moveCount = -1;\n\t\tthis._downCount = -1;\n\t\tthis.set(props);\n\t},\n\n\tgetMinDistance: function() {\n\t\treturn this._minDistance;\n\t},\n\n\tsetMinDistance: function(minDistance) {\n\t\tthis._minDistance = minDistance;\n\t\tif (minDistance != null && this._maxDistance != null\n\t\t\t\t&& minDistance > this._maxDistance) {\n\t\t\tthis._maxDistance = minDistance;\n\t\t}\n\t},\n\n\tgetMaxDistance: function() {\n\t\treturn this._maxDistance;\n\t},\n\n\tsetMaxDistance: function(maxDistance) {\n\t\tthis._maxDistance = maxDistance;\n\t\tif (this._minDistance != null && maxDistance != null\n\t\t\t\t&& maxDistance < this._minDistance) {\n\t\t\tthis._minDistance = maxDistance;\n\t\t}\n\t},\n\n\tgetFixedDistance: function() {\n\t\treturn this._minDistance == this._maxDistance\n\t\t\t? this._minDistance : null;\n\t},\n\n\tsetFixedDistance: function(distance) {\n\t\tthis._minDistance = this._maxDistance = distance;\n\t},\n\n\t_handleMouseEvent: function(type, event, point, mouse) {\n\t\tpaper = this._scope;\n\t\tif (mouse.drag && !this.responds(type))\n\t\t\ttype = 'mousemove';\n\t\tvar move = mouse.move || mouse.drag,\n\t\t\tresponds = this.responds(type),\n\t\t\tminDistance = this.minDistance,\n\t\t\tmaxDistance = this.maxDistance,\n\t\t\tcalled = false,\n\t\t\ttool = this;\n\t\tfunction update(minDistance, maxDistance) {\n\t\t\tvar pt = point,\n\t\t\t\ttoolPoint = move ? tool._point : (tool._downPoint || pt);\n\t\t\tif (move) {\n\t\t\t\tif (tool._moveCount >= 0 && pt.equals(toolPoint)) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tif (toolPoint && (minDistance != null || maxDistance != null)) {\n\t\t\t\t\tvar vector = pt.subtract(toolPoint),\n\t\t\t\t\t\tdistance = vector.getLength();\n\t\t\t\t\tif (distance < (minDistance || 0))\n\t\t\t\t\t\treturn false;\n\t\t\t\t\tif (maxDistance) {\n\t\t\t\t\t\tpt = toolPoint.add(vector.normalize(\n\t\t\t\t\t\t\t\tMath.min(distance, maxDistance)));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\ttool._moveCount++;\n\t\t\t}\n\t\t\ttool._point = pt;\n\t\t\ttool._lastPoint = toolPoint || pt;\n\t\t\tif (mouse.down) {\n\t\t\t\ttool._moveCount = -1;\n\t\t\t\ttool._downPoint = pt;\n\t\t\t\ttool._downCount++;\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\n\t\tfunction emit() {\n\t\t\tif (responds) {\n\t\t\t\tcalled = tool.emit(type, new ToolEvent(tool, type, event))\n\t\t\t\t\t\t|| called;\n\t\t\t}\n\t\t}\n\n\t\tif (mouse.down) {\n\t\t\tupdate();\n\t\t\temit();\n\t\t} else if (mouse.up) {\n\t\t\tupdate(null, maxDistance);\n\t\t\temit();\n\t\t} else if (responds) {\n\t\t\twhile (update(minDistance, maxDistance))\n\t\t\t\temit();\n\t\t}\n\t\treturn called;\n\t}\n\n});\n\nvar Tween = Base.extend(Emitter, {\n\t_class: 'Tween',\n\n\tstatics: {\n\t\teasings: {\n\t\t\tlinear: function(t) {\n\t\t\t\treturn t;\n\t\t\t},\n\n\t\t\teaseInQuad: function(t) {\n\t\t\t\treturn t * t;\n\t\t\t},\n\n\t\t\teaseOutQuad: function(t) {\n\t\t\t\treturn t * (2 - t);\n\t\t\t},\n\n\t\t\teaseInOutQuad: function(t) {\n\t\t\t\treturn t < 0.5\n\t\t\t\t\t? 2 * t * t\n\t\t\t\t\t: -1 + 2 * (2 - t) * t;\n\t\t\t},\n\n\t\t\teaseInCubic: function(t) {\n\t\t\t\treturn t * t * t;\n\t\t\t},\n\n\t\t\teaseOutCubic: function(t) {\n\t\t\t\treturn --t * t * t + 1;\n\t\t\t},\n\n\t\t\teaseInOutCubic: function(t) {\n\t\t\t\treturn t < 0.5\n\t\t\t\t\t? 4 * t * t * t\n\t\t\t\t\t: (t - 1) * (2 * t - 2) * (2 * t - 2) + 1;\n\t\t\t},\n\n\t\t\teaseInQuart: function(t) {\n\t\t\t\treturn t * t * t * t;\n\t\t\t},\n\n\t\t\teaseOutQuart: function(t) {\n\t\t\t\treturn 1 - (--t) * t * t * t;\n\t\t\t},\n\n\t\t\teaseInOutQuart: function(t) {\n\t\t\t\treturn t < 0.5\n\t\t\t\t\t? 8 * t * t * t * t\n\t\t\t\t\t: 1 - 8 * (--t) * t * t * t;\n\t\t\t},\n\n\t\t\teaseInQuint: function(t) {\n\t\t\t\treturn t * t * t * t * t;\n\t\t\t},\n\n\t\t\teaseOutQuint: function(t) {\n\t\t\t\treturn 1 + --t * t * t * t * t;\n\t\t\t},\n\n\t\t\teaseInOutQuint: function(t) {\n\t\t\t\treturn t < 0.5\n\t\t\t\t\t? 16 * t * t * t * t * t\n\t\t\t\t\t: 1 + 16 * (--t) * t * t * t * t;\n\t\t\t}\n\t\t}\n\t},\n\n\tinitialize: function Tween(object, from, to, duration, easing, start) {\n\t\tthis.object = object;\n\t\tvar type = typeof easing;\n\t\tvar isFunction = type === 'function';\n\t\tthis.type = isFunction\n\t\t\t? type\n\t\t\t: type === 'string'\n\t\t\t\t? easing\n\t\t\t\t: 'linear';\n\t\tthis.easing = isFunction ? easing : Tween.easings[this.type];\n\t\tthis.duration = duration;\n\t\tthis.running = false;\n\n\t\tthis._then = null;\n\t\tthis._startTime = null;\n\t\tvar state = from || to;\n\t\tthis._keys = state ? Object.keys(state) : [];\n\t\tthis._parsedKeys = this._parseKeys(this._keys);\n\t\tthis._from = state && this._getState(from);\n\t\tthis._to = state && this._getState(to);\n\t\tif (start !== false) {\n\t\t\tthis.start();\n\t\t}\n\t},\n\n\tthen: function(then) {\n\t\tthis._then = then;\n\t\treturn this;\n\t},\n\n\tstart: function() {\n\t\tthis._startTime = null;\n\t\tthis.running = true;\n\t\treturn this;\n\t},\n\n\tstop: function() {\n\t\tthis.running = false;\n\t\treturn this;\n\t},\n\n\tupdate: function(progress) {\n\t\tif (this.running) {\n\t\t\tif (progress > 1) {\n\t\t\t\tprogress = 1;\n\t\t\t\tthis.running = false;\n\t\t\t}\n\n\t\t\tvar factor = this.easing(progress),\n\t\t\t\tkeys = this._keys,\n\t\t\t\tgetValue = function(value) {\n\t\t\t\t\treturn typeof value === 'function'\n\t\t\t\t\t\t? value(factor, progress)\n\t\t\t\t\t\t: value;\n\t\t\t\t};\n\t\t\tfor (var i = 0, l = keys && keys.length; i < l; i++) {\n\t\t\t\tvar key = keys[i],\n\t\t\t\t\tfrom = getValue(this._from[key]),\n\t\t\t\t\tto = getValue(this._to[key]),\n\t\t\t\t\tvalue = (from && to && from.__add && to.__add)\n\t\t\t\t\t\t? to.__subtract(from).__multiply(factor).__add(from)\n\t\t\t\t\t\t: ((to - from) * factor) + from;\n\t\t\t\tthis._setProperty(this._parsedKeys[key], value);\n\t\t\t}\n\n\t\t\tif (!this.running && this._then) {\n\t\t\t\tthis._then(this.object);\n\t\t\t}\n\t\t\tif (this.responds('update')) {\n\t\t\t\tthis.emit('update', new Base({\n\t\t\t\t\tprogress: progress,\n\t\t\t\t\tfactor: factor\n\t\t\t\t}));\n\t\t\t}\n\t\t}\n\t\treturn this;\n\t},\n\n\t_events: {\n\t\tonUpdate: {}\n\t},\n\n\t_handleFrame: function(time) {\n\t\tvar startTime = this._startTime,\n\t\t\tprogress = startTime\n\t\t\t\t? (time - startTime) / this.duration\n\t\t\t\t: 0;\n\t\tif (!startTime) {\n\t\t\tthis._startTime = time;\n\t\t}\n\t\tthis.update(progress);\n\t},\n\n\t_getState: function(state) {\n\t\tvar keys = this._keys,\n\t\t\tresult = {};\n\t\tfor (var i = 0, l = keys.length; i < l; i++) {\n\t\t\tvar key = keys[i],\n\t\t\t\tpath = this._parsedKeys[key],\n\t\t\t\tcurrent = this._getProperty(path),\n\t\t\t\tvalue;\n\t\t\tif (state) {\n\t\t\t\tvar resolved = this._resolveValue(current, state[key]);\n\t\t\t\tthis._setProperty(path, resolved);\n\t\t\t\tvalue = this._getProperty(path);\n\t\t\t\tvalue = value && value.clone ? value.clone() : value;\n\t\t\t\tthis._setProperty(path, current);\n\t\t\t} else {\n\t\t\t\tvalue = current && current.clone ? current.clone() : current;\n\t\t\t}\n\t\t\tresult[key] = value;\n\t\t}\n\t\treturn result;\n\t},\n\n\t_resolveValue: function(current, value) {\n\t\tif (value) {\n\t\t\tif (Array.isArray(value) && value.length === 2) {\n\t\t\t\tvar operator = value[0];\n\t\t\t\treturn (\n\t\t\t\t\toperator &&\n\t\t\t\t\toperator.match &&\n\t\t\t\t\toperator.match(/^[+\\-*/]=/)\n\t\t\t\t)\n\t\t\t\t\t? this._calculate(current, operator[0], value[1])\n\t\t\t\t\t: value;\n\t\t\t} else if (typeof value === 'string') {\n\t\t\t\tvar match = value.match(/^[+\\-*/]=(.*)/);\n\t\t\t\tif (match) {\n\t\t\t\t\tvar parsed = JSON.parse(match[1].replace(\n\t\t\t\t\t\t/(['\"])?([a-zA-Z0-9_]+)(['\"])?:/g,\n\t\t\t\t\t\t'\"$2\": '\n\t\t\t\t\t));\n\t\t\t\t\treturn this._calculate(current, value[0], parsed);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn value;\n\t},\n\n\t_calculate: function(left, operator, right) {\n\t\treturn paper.PaperScript.calculateBinary(left, operator, right);\n\t},\n\n\t_parseKeys: function(keys) {\n\t\tvar parsed = {};\n\t\tfor (var i = 0, l = keys.length; i < l; i++) {\n\t\t\tvar key = keys[i],\n\t\t\t\tpath = key\n\t\t\t\t\t.replace(/\\.([^.]*)/g, '/$1')\n\t\t\t\t\t.replace(/\\[['\"]?([^'\"\\]]*)['\"]?\\]/g, '/$1');\n\t\t\tparsed[key] = path.split('/');\n\t\t}\n\t\treturn parsed;\n\t},\n\n\t_getProperty: function(path, offset) {\n\t\tvar obj = this.object;\n\t\tfor (var i = 0, l = path.length - (offset || 0); i < l && obj; i++) {\n\t\t\tobj = obj[path[i]];\n\t\t}\n\t\treturn obj;\n\t},\n\n\t_setProperty: function(path, value) {\n\t\tvar dest = this._getProperty(path, 1);\n\t\tif (dest) {\n\t\t\tdest[path[path.length - 1]] = value;\n\t\t}\n\t}\n});\n\nvar Http = {\n\trequest: function(options) {\n\t\tvar xhr = new self.XMLHttpRequest();\n\t\txhr.open((options.method || 'get').toUpperCase(), options.url,\n\t\t\t\tBase.pick(options.async, true));\n\t\tif (options.mimeType)\n\t\t\txhr.overrideMimeType(options.mimeType);\n\t\txhr.onload = function() {\n\t\t\tvar status = xhr.status;\n\t\t\tif (status === 0 || status === 200) {\n\t\t\t\tif (options.onLoad) {\n\t\t\t\t\toptions.onLoad.call(xhr, xhr.responseText);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\txhr.onerror();\n\t\t\t}\n\t\t};\n\t\txhr.onerror = function() {\n\t\t\tvar status = xhr.status,\n\t\t\t\tmessage = 'Could not load \"' + options.url + '\" (Status: '\n\t\t\t\t\t\t+ status + ')';\n\t\t\tif (options.onError) {\n\t\t\t\toptions.onError(message, status);\n\t\t\t} else {\n\t\t\t\tthrow new Error(message);\n\t\t\t}\n\t\t};\n\t\treturn xhr.send(null);\n\t}\n};\n\nvar CanvasProvider = {\n\tcanvases: [],\n\n\tgetCanvas: function(width, height) {\n\t\tif (!window)\n\t\t\treturn null;\n\t\tvar canvas,\n\t\t\tclear = true;\n\t\tif (typeof width === 'object') {\n\t\t\theight = width.height;\n\t\t\twidth = width.width;\n\t\t}\n\t\tif (this.canvases.length) {\n\t\t\tcanvas = this.canvases.pop();\n\t\t} else {\n\t\t\tcanvas = document.createElement('canvas');\n\t\t\tclear = false;\n\t\t}\n\t\tvar ctx = canvas.getContext('2d');\n\t\tif (!ctx) {\n\t\t\tthrow new Error('Canvas ' + canvas +\n\t\t\t\t\t' is unable to provide a 2D context.');\n\t\t}\n\t\tif (canvas.width === width && canvas.height === height) {\n\t\t\tif (clear)\n\t\t\t\tctx.clearRect(0, 0, width + 1, height + 1);\n\t\t} else {\n\t\t\tcanvas.width = width;\n\t\t\tcanvas.height = height;\n\t\t}\n\t\tctx.save();\n\t\treturn canvas;\n\t},\n\n\tgetContext: function(width, height) {\n\t\tvar canvas = this.getCanvas(width, height);\n\t\treturn canvas ? canvas.getContext('2d') : null;\n\t},\n\n\trelease: function(obj) {\n\t\tvar canvas = obj && obj.canvas ? obj.canvas : obj;\n\t\tif (canvas && canvas.getContext) {\n\t\t\tcanvas.getContext('2d').restore();\n\t\t\tthis.canvases.push(canvas);\n\t\t}\n\t}\n};\n\nvar BlendMode = new function() {\n\tvar min = Math.min,\n\t\tmax = Math.max,\n\t\tabs = Math.abs,\n\t\tsr, sg, sb, sa,\n\t\tbr, bg, bb, ba,\n\t\tdr, dg, db;\n\n\tfunction getLum(r, g, b) {\n\t\treturn 0.2989 * r + 0.587 * g + 0.114 * b;\n\t}\n\n\tfunction setLum(r, g, b, l) {\n\t\tvar d = l - getLum(r, g, b);\n\t\tdr = r + d;\n\t\tdg = g + d;\n\t\tdb = b + d;\n\t\tvar l = getLum(dr, dg, db),\n\t\t\tmn = min(dr, dg, db),\n\t\t\tmx = max(dr, dg, db);\n\t\tif (mn < 0) {\n\t\t\tvar lmn = l - mn;\n\t\t\tdr = l + (dr - l) * l / lmn;\n\t\t\tdg = l + (dg - l) * l / lmn;\n\t\t\tdb = l + (db - l) * l / lmn;\n\t\t}\n\t\tif (mx > 255) {\n\t\t\tvar ln = 255 - l,\n\t\t\t\tmxl = mx - l;\n\t\t\tdr = l + (dr - l) * ln / mxl;\n\t\t\tdg = l + (dg - l) * ln / mxl;\n\t\t\tdb = l + (db - l) * ln / mxl;\n\t\t}\n\t}\n\n\tfunction getSat(r, g, b) {\n\t\treturn max(r, g, b) - min(r, g, b);\n\t}\n\n\tfunction setSat(r, g, b, s) {\n\t\tvar col = [r, g, b],\n\t\t\tmx = max(r, g, b),\n\t\t\tmn = min(r, g, b),\n\t\t\tmd;\n\t\tmn = mn === r ? 0 : mn === g ? 1 : 2;\n\t\tmx = mx === r ? 0 : mx === g ? 1 : 2;\n\t\tmd = min(mn, mx) === 0 ? max(mn, mx) === 1 ? 2 : 1 : 0;\n\t\tif (col[mx] > col[mn]) {\n\t\t\tcol[md] = (col[md] - col[mn]) * s / (col[mx] - col[mn]);\n\t\t\tcol[mx] = s;\n\t\t} else {\n\t\t\tcol[md] = col[mx] = 0;\n\t\t}\n\t\tcol[mn] = 0;\n\t\tdr = col[0];\n\t\tdg = col[1];\n\t\tdb = col[2];\n\t}\n\n\tvar modes = {\n\t\tmultiply: function() {\n\t\t\tdr = br * sr / 255;\n\t\t\tdg = bg * sg / 255;\n\t\t\tdb = bb * sb / 255;\n\t\t},\n\n\t\tscreen: function() {\n\t\t\tdr = br + sr - (br * sr / 255);\n\t\t\tdg = bg + sg - (bg * sg / 255);\n\t\t\tdb = bb + sb - (bb * sb / 255);\n\t\t},\n\n\t\toverlay: function() {\n\t\t\tdr = br < 128 ? 2 * br * sr / 255 : 255 - 2 * (255 - br) * (255 - sr) / 255;\n\t\t\tdg = bg < 128 ? 2 * bg * sg / 255 : 255 - 2 * (255 - bg) * (255 - sg) / 255;\n\t\t\tdb = bb < 128 ? 2 * bb * sb / 255 : 255 - 2 * (255 - bb) * (255 - sb) / 255;\n\t\t},\n\n\t\t'soft-light': function() {\n\t\t\tvar t = sr * br / 255;\n\t\t\tdr = t + br * (255 - (255 - br) * (255 - sr) / 255 - t) / 255;\n\t\t\tt = sg * bg / 255;\n\t\t\tdg = t + bg * (255 - (255 - bg) * (255 - sg) / 255 - t) / 255;\n\t\t\tt = sb * bb / 255;\n\t\t\tdb = t + bb * (255 - (255 - bb) * (255 - sb) / 255 - t) / 255;\n\t\t},\n\n\t\t'hard-light': function() {\n\t\t\tdr = sr < 128 ? 2 * sr * br / 255 : 255 - 2 * (255 - sr) * (255 - br) / 255;\n\t\t\tdg = sg < 128 ? 2 * sg * bg / 255 : 255 - 2 * (255 - sg) * (255 - bg) / 255;\n\t\t\tdb = sb < 128 ? 2 * sb * bb / 255 : 255 - 2 * (255 - sb) * (255 - bb) / 255;\n\t\t},\n\n\t\t'color-dodge': function() {\n\t\t\tdr = br === 0 ? 0 : sr === 255 ? 255 : min(255, 255 * br / (255 - sr));\n\t\t\tdg = bg === 0 ? 0 : sg === 255 ? 255 : min(255, 255 * bg / (255 - sg));\n\t\t\tdb = bb === 0 ? 0 : sb === 255 ? 255 : min(255, 255 * bb / (255 - sb));\n\t\t},\n\n\t\t'color-burn': function() {\n\t\t\tdr = br === 255 ? 255 : sr === 0 ? 0 : max(0, 255 - (255 - br) * 255 / sr);\n\t\t\tdg = bg === 255 ? 255 : sg === 0 ? 0 : max(0, 255 - (255 - bg) * 255 / sg);\n\t\t\tdb = bb === 255 ? 255 : sb === 0 ? 0 : max(0, 255 - (255 - bb) * 255 / sb);\n\t\t},\n\n\t\tdarken: function() {\n\t\t\tdr = br < sr ? br : sr;\n\t\t\tdg = bg < sg ? bg : sg;\n\t\t\tdb = bb < sb ? bb : sb;\n\t\t},\n\n\t\tlighten: function() {\n\t\t\tdr = br > sr ? br : sr;\n\t\t\tdg = bg > sg ? bg : sg;\n\t\t\tdb = bb > sb ? bb : sb;\n\t\t},\n\n\t\tdifference: function() {\n\t\t\tdr = br - sr;\n\t\t\tif (dr < 0)\n\t\t\t\tdr = -dr;\n\t\t\tdg = bg - sg;\n\t\t\tif (dg < 0)\n\t\t\t\tdg = -dg;\n\t\t\tdb = bb - sb;\n\t\t\tif (db < 0)\n\t\t\t\tdb = -db;\n\t\t},\n\n\t\texclusion: function() {\n\t\t\tdr = br + sr * (255 - br - br) / 255;\n\t\t\tdg = bg + sg * (255 - bg - bg) / 255;\n\t\t\tdb = bb + sb * (255 - bb - bb) / 255;\n\t\t},\n\n\t\thue: function() {\n\t\t\tsetSat(sr, sg, sb, getSat(br, bg, bb));\n\t\t\tsetLum(dr, dg, db, getLum(br, bg, bb));\n\t\t},\n\n\t\tsaturation: function() {\n\t\t\tsetSat(br, bg, bb, getSat(sr, sg, sb));\n\t\t\tsetLum(dr, dg, db, getLum(br, bg, bb));\n\t\t},\n\n\t\tluminosity: function() {\n\t\t\tsetLum(br, bg, bb, getLum(sr, sg, sb));\n\t\t},\n\n\t\tcolor: function() {\n\t\t\tsetLum(sr, sg, sb, getLum(br, bg, bb));\n\t\t},\n\n\t\tadd: function() {\n\t\t\tdr = min(br + sr, 255);\n\t\t\tdg = min(bg + sg, 255);\n\t\t\tdb = min(bb + sb, 255);\n\t\t},\n\n\t\tsubtract: function() {\n\t\t\tdr = max(br - sr, 0);\n\t\t\tdg = max(bg - sg, 0);\n\t\t\tdb = max(bb - sb, 0);\n\t\t},\n\n\t\taverage: function() {\n\t\t\tdr = (br + sr) / 2;\n\t\t\tdg = (bg + sg) / 2;\n\t\t\tdb = (bb + sb) / 2;\n\t\t},\n\n\t\tnegation: function() {\n\t\t\tdr = 255 - abs(255 - sr - br);\n\t\t\tdg = 255 - abs(255 - sg - bg);\n\t\t\tdb = 255 - abs(255 - sb - bb);\n\t\t}\n\t};\n\n\tvar nativeModes = this.nativeModes = Base.each([\n\t\t'source-over', 'source-in', 'source-out', 'source-atop',\n\t\t'destination-over', 'destination-in', 'destination-out',\n\t\t'destination-atop', 'lighter', 'darker', 'copy', 'xor'\n\t], function(mode) {\n\t\tthis[mode] = true;\n\t}, {});\n\n\tvar ctx = CanvasProvider.getContext(1, 1);\n\tif (ctx) {\n\t\tBase.each(modes, function(func, mode) {\n\t\t\tvar darken = mode === 'darken',\n\t\t\t\tok = false;\n\t\t\tctx.save();\n\t\t\ttry {\n\t\t\t\tctx.fillStyle = darken ? '#300' : '#a00';\n\t\t\t\tctx.fillRect(0, 0, 1, 1);\n\t\t\t\tctx.globalCompositeOperation = mode;\n\t\t\t\tif (ctx.globalCompositeOperation === mode) {\n\t\t\t\t\tctx.fillStyle = darken ? '#a00' : '#300';\n\t\t\t\t\tctx.fillRect(0, 0, 1, 1);\n\t\t\t\t\tok = ctx.getImageData(0, 0, 1, 1).data[0] !== darken\n\t\t\t\t\t\t\t? 170 : 51;\n\t\t\t\t}\n\t\t\t} catch (e) {}\n\t\t\tctx.restore();\n\t\t\tnativeModes[mode] = ok;\n\t\t});\n\t\tCanvasProvider.release(ctx);\n\t}\n\n\tthis.process = function(mode, srcContext, dstContext, alpha, offset) {\n\t\tvar srcCanvas = srcContext.canvas,\n\t\t\tnormal = mode === 'normal';\n\t\tif (normal || nativeModes[mode]) {\n\t\t\tdstContext.save();\n\t\t\tdstContext.setTransform(1, 0, 0, 1, 0, 0);\n\t\t\tdstContext.globalAlpha = alpha;\n\t\t\tif (!normal)\n\t\t\t\tdstContext.globalCompositeOperation = mode;\n\t\t\tdstContext.drawImage(srcCanvas, offset.x, offset.y);\n\t\t\tdstContext.restore();\n\t\t} else {\n\t\t\tvar process = modes[mode];\n\t\t\tif (!process)\n\t\t\t\treturn;\n\t\t\tvar dstData = dstContext.getImageData(offset.x, offset.y,\n\t\t\t\t\tsrcCanvas.width, srcCanvas.height),\n\t\t\t\tdst = dstData.data,\n\t\t\t\tsrc = srcContext.getImageData(0, 0,\n\t\t\t\t\tsrcCanvas.width, srcCanvas.height).data;\n\t\t\tfor (var i = 0, l = dst.length; i < l; i += 4) {\n\t\t\t\tsr = src[i];\n\t\t\t\tbr = dst[i];\n\t\t\t\tsg = src[i + 1];\n\t\t\t\tbg = dst[i + 1];\n\t\t\t\tsb = src[i + 2];\n\t\t\t\tbb = dst[i + 2];\n\t\t\t\tsa = src[i + 3];\n\t\t\t\tba = dst[i + 3];\n\t\t\t\tprocess();\n\t\t\t\tvar a1 = sa * alpha / 255,\n\t\t\t\t\ta2 = 1 - a1;\n\t\t\t\tdst[i] = a1 * dr + a2 * br;\n\t\t\t\tdst[i + 1] = a1 * dg + a2 * bg;\n\t\t\t\tdst[i + 2] = a1 * db + a2 * bb;\n\t\t\t\tdst[i + 3] = sa * alpha + a2 * ba;\n\t\t\t}\n\t\t\tdstContext.putImageData(dstData, offset.x, offset.y);\n\t\t}\n\t};\n};\n\nvar SvgElement = new function() {\n\tvar svg = 'http://www.w3.org/2000/svg',\n\t\txmlns = 'http://www.w3.org/2000/xmlns',\n\t\txlink = 'http://www.w3.org/1999/xlink',\n\t\tattributeNamespace = {\n\t\t\thref: xlink,\n\t\t\txlink: xmlns,\n\t\t\txmlns: xmlns + '/',\n\t\t\t'xmlns:xlink': xmlns + '/'\n\t\t};\n\n\tfunction create(tag, attributes, formatter) {\n\t\treturn set(document.createElementNS(svg, tag), attributes, formatter);\n\t}\n\n\tfunction get(node, name) {\n\t\tvar namespace = attributeNamespace[name],\n\t\t\tvalue = namespace\n\t\t\t\t? node.getAttributeNS(namespace, name)\n\t\t\t\t: node.getAttribute(name);\n\t\treturn value === 'null' ? null : value;\n\t}\n\n\tfunction set(node, attributes, formatter) {\n\t\tfor (var name in attributes) {\n\t\t\tvar value = attributes[name],\n\t\t\t\tnamespace = attributeNamespace[name];\n\t\t\tif (typeof value === 'number' && formatter)\n\t\t\t\tvalue = formatter.number(value);\n\t\t\tif (namespace) {\n\t\t\t\tnode.setAttributeNS(namespace, name, value);\n\t\t\t} else {\n\t\t\t\tnode.setAttribute(name, value);\n\t\t\t}\n\t\t}\n\t\treturn node;\n\t}\n\n\treturn {\n\t\tsvg: svg,\n\t\txmlns: xmlns,\n\t\txlink: xlink,\n\n\t\tcreate: create,\n\t\tget: get,\n\t\tset: set\n\t};\n};\n\nvar SvgStyles = Base.each({\n\tfillColor: ['fill', 'color'],\n\tfillRule: ['fill-rule', 'string'],\n\tstrokeColor: ['stroke', 'color'],\n\tstrokeWidth: ['stroke-width', 'number'],\n\tstrokeCap: ['stroke-linecap', 'string'],\n\tstrokeJoin: ['stroke-linejoin', 'string'],\n\tstrokeScaling: ['vector-effect', 'lookup', {\n\t\ttrue: 'none',\n\t\tfalse: 'non-scaling-stroke'\n\t}, function(item, value) {\n\t\treturn !value\n\t\t\t\t&& (item instanceof PathItem\n\t\t\t\t\t|| item instanceof Shape\n\t\t\t\t\t|| item instanceof TextItem);\n\t}],\n\tmiterLimit: ['stroke-miterlimit', 'number'],\n\tdashArray: ['stroke-dasharray', 'array'],\n\tdashOffset: ['stroke-dashoffset', 'number'],\n\tfontFamily: ['font-family', 'string'],\n\tfontWeight: ['font-weight', 'string'],\n\tfontSize: ['font-size', 'number'],\n\tjustification: ['text-anchor', 'lookup', {\n\t\tleft: 'start',\n\t\tcenter: 'middle',\n\t\tright: 'end'\n\t}],\n\topacity: ['opacity', 'number'],\n\tblendMode: ['mix-blend-mode', 'style']\n}, function(entry, key) {\n\tvar part = Base.capitalize(key),\n\t\tlookup = entry[2];\n\tthis[key] = {\n\t\ttype: entry[1],\n\t\tproperty: key,\n\t\tattribute: entry[0],\n\t\ttoSVG: lookup,\n\t\tfromSVG: lookup && Base.each(lookup, function(value, name) {\n\t\t\tthis[value] = name;\n\t\t}, {}),\n\t\texportFilter: entry[3],\n\t\tget: 'get' + part,\n\t\tset: 'set' + part\n\t};\n}, {});\n\nnew function() {\n\tvar formatter;\n\n\tfunction getTransform(matrix, coordinates, center) {\n\t\tvar attrs = new Base(),\n\t\t\ttrans = matrix.getTranslation();\n\t\tif (coordinates) {\n\t\t\tmatrix = matrix._shiftless();\n\t\t\tvar point = matrix._inverseTransform(trans);\n\t\t\tattrs[center ? 'cx' : 'x'] = point.x;\n\t\t\tattrs[center ? 'cy' : 'y'] = point.y;\n\t\t\ttrans = null;\n\t\t}\n\t\tif (!matrix.isIdentity()) {\n\t\t\tvar decomposed = matrix.decompose();\n\t\t\tif (decomposed) {\n\t\t\t\tvar parts = [],\n\t\t\t\t\tangle = decomposed.rotation,\n\t\t\t\t\tscale = decomposed.scaling,\n\t\t\t\t\tskew = decomposed.skewing;\n\t\t\t\tif (trans && !trans.isZero())\n\t\t\t\t\tparts.push('translate(' + formatter.point(trans) + ')');\n\t\t\t\tif (angle)\n\t\t\t\t\tparts.push('rotate(' + formatter.number(angle) + ')');\n\t\t\t\tif (!Numerical.isZero(scale.x - 1)\n\t\t\t\t\t\t|| !Numerical.isZero(scale.y - 1))\n\t\t\t\t\tparts.push('scale(' + formatter.point(scale) +')');\n\t\t\t\tif (skew.x)\n\t\t\t\t\tparts.push('skewX(' + formatter.number(skew.x) + ')');\n\t\t\t\tif (skew.y)\n\t\t\t\t\tparts.push('skewY(' + formatter.number(skew.y) + ')');\n\t\t\t\tattrs.transform = parts.join(' ');\n\t\t\t} else {\n\t\t\t\tattrs.transform = 'matrix(' + matrix.getValues().join(',') + ')';\n\t\t\t}\n\t\t}\n\t\treturn attrs;\n\t}\n\n\tfunction exportGroup(item, options) {\n\t\tvar attrs = getTransform(item._matrix),\n\t\t\tchildren = item._children;\n\t\tvar node = SvgElement.create('g', attrs, formatter);\n\t\tfor (var i = 0, l = children.length; i < l; i++) {\n\t\t\tvar child = children[i];\n\t\t\tvar childNode = exportSVG(child, options);\n\t\t\tif (childNode) {\n\t\t\t\tif (child.isClipMask()) {\n\t\t\t\t\tvar clip = SvgElement.create('clipPath');\n\t\t\t\t\tclip.appendChild(childNode);\n\t\t\t\t\tsetDefinition(child, clip, 'clip');\n\t\t\t\t\tSvgElement.set(node, {\n\t\t\t\t\t\t'clip-path': 'url(#' + clip.id + ')'\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tnode.appendChild(childNode);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn node;\n\t}\n\n\tfunction exportRaster(item, options) {\n\t\tvar attrs = getTransform(item._matrix, true),\n\t\t\tsize = item.getSize(),\n\t\t\timage = item.getImage();\n\t\tattrs.x -= size.width / 2;\n\t\tattrs.y -= size.height / 2;\n\t\tattrs.width = size.width;\n\t\tattrs.height = size.height;\n\t\tattrs.href = options.embedImages == false && image && image.src\n\t\t\t\t|| item.toDataURL();\n\t\treturn SvgElement.create('image', attrs, formatter);\n\t}\n\n\tfunction exportPath(item, options) {\n\t\tvar matchShapes = options.matchShapes;\n\t\tif (matchShapes) {\n\t\t\tvar shape = item.toShape(false);\n\t\t\tif (shape)\n\t\t\t\treturn exportShape(shape, options);\n\t\t}\n\t\tvar segments = item._segments,\n\t\t\tlength = segments.length,\n\t\t\ttype,\n\t\t\tattrs = getTransform(item._matrix);\n\t\tif (matchShapes && length >= 2 && !item.hasHandles()) {\n\t\t\tif (length > 2) {\n\t\t\t\ttype = item._closed ? 'polygon' : 'polyline';\n\t\t\t\tvar parts = [];\n\t\t\t\tfor (var i = 0; i < length; i++) {\n\t\t\t\t\tparts.push(formatter.point(segments[i]._point));\n\t\t\t\t}\n\t\t\t\tattrs.points = parts.join(' ');\n\t\t\t} else {\n\t\t\t\ttype = 'line';\n\t\t\t\tvar start = segments[0]._point,\n\t\t\t\t\tend = segments[1]._point;\n\t\t\t\tattrs.set({\n\t\t\t\t\tx1: start.x,\n\t\t\t\t\ty1: start.y,\n\t\t\t\t\tx2: end.x,\n\t\t\t\t\ty2: end.y\n\t\t\t\t});\n\t\t\t}\n\t\t} else {\n\t\t\ttype = 'path';\n\t\t\tattrs.d = item.getPathData(null, options.precision);\n\t\t}\n\t\treturn SvgElement.create(type, attrs, formatter);\n\t}\n\n\tfunction exportShape(item) {\n\t\tvar type = item._type,\n\t\t\tradius = item._radius,\n\t\t\tattrs = getTransform(item._matrix, true, type !== 'rectangle');\n\t\tif (type === 'rectangle') {\n\t\t\ttype = 'rect';\n\t\t\tvar size = item._size,\n\t\t\t\twidth = size.width,\n\t\t\t\theight = size.height;\n\t\t\tattrs.x -= width / 2;\n\t\t\tattrs.y -= height / 2;\n\t\t\tattrs.width = width;\n\t\t\tattrs.height = height;\n\t\t\tif (radius.isZero())\n\t\t\t\tradius = null;\n\t\t}\n\t\tif (radius) {\n\t\t\tif (type === 'circle') {\n\t\t\t\tattrs.r = radius;\n\t\t\t} else {\n\t\t\t\tattrs.rx = radius.width;\n\t\t\t\tattrs.ry = radius.height;\n\t\t\t}\n\t\t}\n\t\treturn SvgElement.create(type, attrs, formatter);\n\t}\n\n\tfunction exportCompoundPath(item, options) {\n\t\tvar attrs = getTransform(item._matrix);\n\t\tvar data = item.getPathData(null, options.precision);\n\t\tif (data)\n\t\t\tattrs.d = data;\n\t\treturn SvgElement.create('path', attrs, formatter);\n\t}\n\n\tfunction exportSymbolItem(item, options) {\n\t\tvar attrs = getTransform(item._matrix, true),\n\t\t\tdefinition = item._definition,\n\t\t\tnode = getDefinition(definition, 'symbol'),\n\t\t\tdefinitionItem = definition._item,\n\t\t\tbounds = definitionItem.getBounds();\n\t\tif (!node) {\n\t\t\tnode = SvgElement.create('symbol', {\n\t\t\t\tviewBox: formatter.rectangle(bounds)\n\t\t\t});\n\t\t\tnode.appendChild(exportSVG(definitionItem, options));\n\t\t\tsetDefinition(definition, node, 'symbol');\n\t\t}\n\t\tattrs.href = '#' + node.id;\n\t\tattrs.x += bounds.x;\n\t\tattrs.y += bounds.y;\n\t\tattrs.width = bounds.width;\n\t\tattrs.height = bounds.height;\n\t\tattrs.overflow = 'visible';\n\t\treturn SvgElement.create('use', attrs, formatter);\n\t}\n\n\tfunction exportGradient(color) {\n\t\tvar gradientNode = getDefinition(color, 'color');\n\t\tif (!gradientNode) {\n\t\t\tvar gradient = color.getGradient(),\n\t\t\t\tradial = gradient._radial,\n\t\t\t\torigin = color.getOrigin(),\n\t\t\t\tdestination = color.getDestination(),\n\t\t\t\tattrs;\n\t\t\tif (radial) {\n\t\t\t\tattrs = {\n\t\t\t\t\tcx: origin.x,\n\t\t\t\t\tcy: origin.y,\n\t\t\t\t\tr: origin.getDistance(destination)\n\t\t\t\t};\n\t\t\t\tvar highlight = color.getHighlight();\n\t\t\t\tif (highlight) {\n\t\t\t\t\tattrs.fx = highlight.x;\n\t\t\t\t\tattrs.fy = highlight.y;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tattrs = {\n\t\t\t\t\tx1: origin.x,\n\t\t\t\t\ty1: origin.y,\n\t\t\t\t\tx2: destination.x,\n\t\t\t\t\ty2: destination.y\n\t\t\t\t};\n\t\t\t}\n\t\t\tattrs.gradientUnits = 'userSpaceOnUse';\n\t\t\tgradientNode = SvgElement.create((radial ? 'radial' : 'linear')\n\t\t\t\t\t+ 'Gradient', attrs, formatter);\n\t\t\tvar stops = gradient._stops;\n\t\t\tfor (var i = 0, l = stops.length; i < l; i++) {\n\t\t\t\tvar stop = stops[i],\n\t\t\t\t\tstopColor = stop._color,\n\t\t\t\t\talpha = stopColor.getAlpha(),\n\t\t\t\t\toffset = stop._offset;\n\t\t\t\tattrs = {\n\t\t\t\t\toffset: offset == null ? i / (l - 1) : offset\n\t\t\t\t};\n\t\t\t\tif (stopColor)\n\t\t\t\t\tattrs['stop-color'] = stopColor.toCSS(true);\n\t\t\t\tif (alpha < 1)\n\t\t\t\t\tattrs['stop-opacity'] = alpha;\n\t\t\t\tgradientNode.appendChild(\n\t\t\t\t\t\tSvgElement.create('stop', attrs, formatter));\n\t\t\t}\n\t\t\tsetDefinition(color, gradientNode, 'color');\n\t\t}\n\t\treturn 'url(#' + gradientNode.id + ')';\n\t}\n\n\tfunction exportText(item) {\n\t\tvar node = SvgElement.create('text', getTransform(item._matrix, true),\n\t\t\t\tformatter);\n\t\tnode.textContent = item._content;\n\t\treturn node;\n\t}\n\n\tvar exporters = {\n\t\tGroup: exportGroup,\n\t\tLayer: exportGroup,\n\t\tRaster: exportRaster,\n\t\tPath: exportPath,\n\t\tShape: exportShape,\n\t\tCompoundPath: exportCompoundPath,\n\t\tSymbolItem: exportSymbolItem,\n\t\tPointText: exportText\n\t};\n\n\tfunction applyStyle(item, node, isRoot) {\n\t\tvar attrs = {},\n\t\t\tparent = !isRoot && item.getParent(),\n\t\t\tstyle = [];\n\n\t\tif (item._name != null)\n\t\t\tattrs.id = item._name;\n\n\t\tBase.each(SvgStyles, function(entry) {\n\t\t\tvar get = entry.get,\n\t\t\t\ttype = entry.type,\n\t\t\t\tvalue = item[get]();\n\t\t\tif (entry.exportFilter\n\t\t\t\t\t? entry.exportFilter(item, value)\n\t\t\t\t\t: !parent || !Base.equals(parent[get](), value)) {\n\t\t\t\tif (type === 'color' && value != null) {\n\t\t\t\t\tvar alpha = value.getAlpha();\n\t\t\t\t\tif (alpha < 1)\n\t\t\t\t\t\tattrs[entry.attribute + '-opacity'] = alpha;\n\t\t\t\t}\n\t\t\t\tif (type === 'style') {\n\t\t\t\t\tstyle.push(entry.attribute + ': ' + value);\n\t\t\t\t} else {\n\t\t\t\t\tattrs[entry.attribute] = value == null ? 'none'\n\t\t\t\t\t\t\t: type === 'color' ? value.gradient\n\t\t\t\t\t\t\t\t? exportGradient(value, item)\n\t\t\t\t\t\t\t\t: value.toCSS(true)\n\t\t\t\t\t\t\t: type === 'array' ? value.join(',')\n\t\t\t\t\t\t\t: type === 'lookup' ? entry.toSVG[value]\n\t\t\t\t\t\t\t: value;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tif (style.length)\n\t\t\tattrs.style = style.join(';');\n\n\t\tif (attrs.opacity === 1)\n\t\t\tdelete attrs.opacity;\n\n\t\tif (!item._visible)\n\t\t\tattrs.visibility = 'hidden';\n\n\t\treturn SvgElement.set(node, attrs, formatter);\n\t}\n\n\tvar definitions;\n\tfunction getDefinition(item, type) {\n\t\tif (!definitions)\n\t\t\tdefinitions = { ids: {}, svgs: {} };\n\t\treturn item && definitions.svgs[type + '-'\n\t\t\t\t+ (item._id || item.__id || (item.__id = UID.get('svg')))];\n\t}\n\n\tfunction setDefinition(item, node, type) {\n\t\tif (!definitions)\n\t\t\tgetDefinition();\n\t\tvar typeId = definitions.ids[type] = (definitions.ids[type] || 0) + 1;\n\t\tnode.id = type + '-' + typeId;\n\t\tdefinitions.svgs[type + '-' + (item._id || item.__id)] = node;\n\t}\n\n\tfunction exportDefinitions(node, options) {\n\t\tvar svg = node,\n\t\t\tdefs = null;\n\t\tif (definitions) {\n\t\t\tsvg = node.nodeName.toLowerCase() === 'svg' && node;\n\t\t\tfor (var i in definitions.svgs) {\n\t\t\t\tif (!defs) {\n\t\t\t\t\tif (!svg) {\n\t\t\t\t\t\tsvg = SvgElement.create('svg');\n\t\t\t\t\t\tsvg.appendChild(node);\n\t\t\t\t\t}\n\t\t\t\t\tdefs = svg.insertBefore(SvgElement.create('defs'),\n\t\t\t\t\t\t\tsvg.firstChild);\n\t\t\t\t}\n\t\t\t\tdefs.appendChild(definitions.svgs[i]);\n\t\t\t}\n\t\t\tdefinitions = null;\n\t\t}\n\t\treturn options.asString\n\t\t\t\t? new self.XMLSerializer().serializeToString(svg)\n\t\t\t\t: svg;\n\t}\n\n\tfunction exportSVG(item, options, isRoot) {\n\t\tvar exporter = exporters[item._class],\n\t\t\tnode = exporter && exporter(item, options);\n\t\tif (node) {\n\t\t\tvar onExport = options.onExport;\n\t\t\tif (onExport)\n\t\t\t\tnode = onExport(item, node, options) || node;\n\t\t\tvar data = JSON.stringify(item._data);\n\t\t\tif (data && data !== '{}' && data !== 'null')\n\t\t\t\tnode.setAttribute('data-paper-data', data);\n\t\t}\n\t\treturn node && applyStyle(item, node, isRoot);\n\t}\n\n\tfunction setOptions(options) {\n\t\tif (!options)\n\t\t\toptions = {};\n\t\tformatter = new Formatter(options.precision);\n\t\treturn options;\n\t}\n\n\tItem.inject({\n\t\texportSVG: function(options) {\n\t\t\toptions = setOptions(options);\n\t\t\treturn exportDefinitions(exportSVG(this, options, true), options);\n\t\t}\n\t});\n\n\tProject.inject({\n\t\texportSVG: function(options) {\n\t\t\toptions = setOptions(options);\n\t\t\tvar children = this._children,\n\t\t\t\tview = this.getView(),\n\t\t\t\tbounds = Base.pick(options.bounds, 'view'),\n\t\t\t\tmx = options.matrix || bounds === 'view' && view._matrix,\n\t\t\t\tmatrix = mx && Matrix.read([mx]),\n\t\t\t\trect = bounds === 'view'\n\t\t\t\t\t? new Rectangle([0, 0], view.getViewSize())\n\t\t\t\t\t: bounds === 'content'\n\t\t\t\t\t\t? Item._getBounds(children, matrix, { stroke: true })\n\t\t\t\t\t\t\t.rect\n\t\t\t\t\t\t: Rectangle.read([bounds], 0, { readNull: true }),\n\t\t\t\tattrs = {\n\t\t\t\t\tversion: '1.1',\n\t\t\t\t\txmlns: SvgElement.svg,\n\t\t\t\t\t'xmlns:xlink': SvgElement.xlink,\n\t\t\t\t};\n\t\t\tif (rect) {\n\t\t\t\tattrs.width = rect.width;\n\t\t\t\tattrs.height = rect.height;\n\t\t\t\tif (rect.x || rect.y)\n\t\t\t\t\tattrs.viewBox = formatter.rectangle(rect);\n\t\t\t}\n\t\t\tvar node = SvgElement.create('svg', attrs, formatter),\n\t\t\t\tparent = node;\n\t\t\tif (matrix && !matrix.isIdentity()) {\n\t\t\t\tparent = node.appendChild(SvgElement.create('g',\n\t\t\t\t\t\tgetTransform(matrix), formatter));\n\t\t\t}\n\t\t\tfor (var i = 0, l = children.length; i < l; i++) {\n\t\t\t\tparent.appendChild(exportSVG(children[i], options, true));\n\t\t\t}\n\t\t\treturn exportDefinitions(node, options);\n\t\t}\n\t});\n};\n\nnew function() {\n\n\tvar definitions = {},\n\t\trootSize;\n\n\tfunction getValue(node, name, isString, allowNull, allowPercent) {\n\t\tvar value = SvgElement.get(node, name),\n\t\t\tres = value == null\n\t\t\t\t? allowNull\n\t\t\t\t\t? null\n\t\t\t\t\t: isString ? '' : 0\n\t\t\t\t: isString\n\t\t\t\t\t? value\n\t\t\t\t\t: parseFloat(value);\n\t\treturn /%\\s*$/.test(value)\n\t\t\t? (res / 100) * (allowPercent ? 1\n\t\t\t\t: rootSize[/x|^width/.test(name) ? 'width' : 'height'])\n\t\t\t: res;\n\t}\n\n\tfunction getPoint(node, x, y, allowNull, allowPercent) {\n\t\tx = getValue(node, x || 'x', false, allowNull, allowPercent);\n\t\ty = getValue(node, y || 'y', false, allowNull, allowPercent);\n\t\treturn allowNull && (x == null || y == null) ? null\n\t\t\t\t: new Point(x, y);\n\t}\n\n\tfunction getSize(node, w, h, allowNull, allowPercent) {\n\t\tw = getValue(node, w || 'width', false, allowNull, allowPercent);\n\t\th = getValue(node, h || 'height', false, allowNull, allowPercent);\n\t\treturn allowNull && (w == null || h == null) ? null\n\t\t\t\t: new Size(w, h);\n\t}\n\n\tfunction convertValue(value, type, lookup) {\n\t\treturn value === 'none' ? null\n\t\t\t\t: type === 'number' ? parseFloat(value)\n\t\t\t\t: type === 'array' ?\n\t\t\t\t\tvalue ? value.split(/[\\s,]+/g).map(parseFloat) : []\n\t\t\t\t: type === 'color' ? getDefinition(value) || value\n\t\t\t\t: type === 'lookup' ? lookup[value]\n\t\t\t\t: value;\n\t}\n\n\tfunction importGroup(node, type, options, isRoot) {\n\t\tvar nodes = node.childNodes,\n\t\t\tisClip = type === 'clippath',\n\t\t\tisDefs = type === 'defs',\n\t\t\titem = new Group(),\n\t\t\tproject = item._project,\n\t\t\tcurrentStyle = project._currentStyle,\n\t\t\tchildren = [];\n\t\tif (!isClip && !isDefs) {\n\t\t\titem = applyAttributes(item, node, isRoot);\n\t\t\tproject._currentStyle = item._style.clone();\n\t\t}\n\t\tif (isRoot) {\n\t\t\tvar defs = node.querySelectorAll('defs');\n\t\t\tfor (var i = 0, l = defs.length; i < l; i++) {\n\t\t\t\timportNode(defs[i], options, false);\n\t\t\t}\n\t\t}\n\t\tfor (var i = 0, l = nodes.length; i < l; i++) {\n\t\t\tvar childNode = nodes[i],\n\t\t\t\tchild;\n\t\t\tif (childNode.nodeType === 1\n\t\t\t\t\t&& !/^defs$/i.test(childNode.nodeName)\n\t\t\t\t\t&& (child = importNode(childNode, options, false))\n\t\t\t\t\t&& !(child instanceof SymbolDefinition))\n\t\t\t\tchildren.push(child);\n\t\t}\n\t\titem.addChildren(children);\n\t\tif (isClip)\n\t\t\titem = applyAttributes(item.reduce(), node, isRoot);\n\t\tproject._currentStyle = currentStyle;\n\t\tif (isClip || isDefs) {\n\t\t\titem.remove();\n\t\t\titem = null;\n\t\t}\n\t\treturn item;\n\t}\n\n\tfunction importPoly(node, type) {\n\t\tvar coords = node.getAttribute('points').match(\n\t\t\t\t\t/[+-]?(?:\\d*\\.\\d+|\\d+\\.?)(?:[eE][+-]?\\d+)?/g),\n\t\t\tpoints = [];\n\t\tfor (var i = 0, l = coords.length; i < l; i += 2)\n\t\t\tpoints.push(new Point(\n\t\t\t\t\tparseFloat(coords[i]),\n\t\t\t\t\tparseFloat(coords[i + 1])));\n\t\tvar path = new Path(points);\n\t\tif (type === 'polygon')\n\t\t\tpath.closePath();\n\t\treturn path;\n\t}\n\n\tfunction importPath(node) {\n\t\treturn PathItem.create(node.getAttribute('d'));\n\t}\n\n\tfunction importGradient(node, type) {\n\t\tvar id = (getValue(node, 'href', true) || '').substring(1),\n\t\t\tradial = type === 'radialgradient',\n\t\t\tgradient;\n\t\tif (id) {\n\t\t\tgradient = definitions[id].getGradient();\n\t\t\tif (gradient._radial ^ radial) {\n\t\t\t\tgradient = gradient.clone();\n\t\t\t\tgradient._radial = radial;\n\t\t\t}\n\t\t} else {\n\t\t\tvar nodes = node.childNodes,\n\t\t\t\tstops = [];\n\t\t\tfor (var i = 0, l = nodes.length; i < l; i++) {\n\t\t\t\tvar child = nodes[i];\n\t\t\t\tif (child.nodeType === 1)\n\t\t\t\t\tstops.push(applyAttributes(new GradientStop(), child));\n\t\t\t}\n\t\t\tgradient = new Gradient(stops, radial);\n\t\t}\n\t\tvar origin, destination, highlight,\n\t\t\tscaleToBounds = getValue(node, 'gradientUnits', true) !==\n\t\t\t\t'userSpaceOnUse';\n\t\tif (radial) {\n\t\t\torigin = getPoint(node, 'cx', 'cy', false, scaleToBounds);\n\t\t\tdestination = origin.add(\n\t\t\t\t\tgetValue(node, 'r', false, false, scaleToBounds), 0);\n\t\t\thighlight = getPoint(node, 'fx', 'fy', true, scaleToBounds);\n\t\t} else {\n\t\t\torigin = getPoint(node, 'x1', 'y1', false, scaleToBounds);\n\t\t\tdestination = getPoint(node, 'x2', 'y2', false, scaleToBounds);\n\t\t}\n\t\tvar color = applyAttributes(\n\t\t\t\tnew Color(gradient, origin, destination, highlight), node);\n\t\tcolor._scaleToBounds = scaleToBounds;\n\t\treturn null;\n\t}\n\n\tvar importers = {\n\t\t'#document': function (node, type, options, isRoot) {\n\t\t\tvar nodes = node.childNodes;\n\t\t\tfor (var i = 0, l = nodes.length; i < l; i++) {\n\t\t\t\tvar child = nodes[i];\n\t\t\t\tif (child.nodeType === 1)\n\t\t\t\t\treturn importNode(child, options, isRoot);\n\t\t\t}\n\t\t},\n\t\tg: importGroup,\n\t\tsvg: importGroup,\n\t\tclippath: importGroup,\n\t\tpolygon: importPoly,\n\t\tpolyline: importPoly,\n\t\tpath: importPath,\n\t\tlineargradient: importGradient,\n\t\tradialgradient: importGradient,\n\n\t\timage: function (node) {\n\t\t\tvar raster = new Raster(getValue(node, 'href', true));\n\t\t\traster.on('load', function() {\n\t\t\t\tvar size = getSize(node);\n\t\t\t\tthis.setSize(size);\n\t\t\t\tvar center = getPoint(node).add(size.divide(2));\n\t\t\t\tthis._matrix.append(new Matrix().translate(center));\n\t\t\t});\n\t\t\treturn raster;\n\t\t},\n\n\t\tsymbol: function(node, type, options, isRoot) {\n\t\t\treturn new SymbolDefinition(\n\t\t\t\t\timportGroup(node, type, options, isRoot), true);\n\t\t},\n\n\t\tdefs: importGroup,\n\n\t\tuse: function(node) {\n\t\t\tvar id = (getValue(node, 'href', true) || '').substring(1),\n\t\t\t\tdefinition = definitions[id],\n\t\t\t\tpoint = getPoint(node);\n\t\t\treturn definition\n\t\t\t\t\t? definition instanceof SymbolDefinition\n\t\t\t\t\t\t? definition.place(point)\n\t\t\t\t\t\t: definition.clone().translate(point)\n\t\t\t\t\t: null;\n\t\t},\n\n\t\tcircle: function(node) {\n\t\t\treturn new Shape.Circle(\n\t\t\t\t\tgetPoint(node, 'cx', 'cy'),\n\t\t\t\t\tgetValue(node, 'r'));\n\t\t},\n\n\t\tellipse: function(node) {\n\t\t\treturn new Shape.Ellipse({\n\t\t\t\tcenter: getPoint(node, 'cx', 'cy'),\n\t\t\t\tradius: getSize(node, 'rx', 'ry')\n\t\t\t});\n\t\t},\n\n\t\trect: function(node) {\n\t\t\treturn new Shape.Rectangle(new Rectangle(\n\t\t\t\t\t\tgetPoint(node),\n\t\t\t\t\t\tgetSize(node)\n\t\t\t\t\t), getSize(node, 'rx', 'ry'));\n\t\t\t},\n\n\t\tline: function(node) {\n\t\t\treturn new Path.Line(\n\t\t\t\t\tgetPoint(node, 'x1', 'y1'),\n\t\t\t\t\tgetPoint(node, 'x2', 'y2'));\n\t\t},\n\n\t\ttext: function(node) {\n\t\t\tvar text = new PointText(getPoint(node).add(\n\t\t\t\t\tgetPoint(node, 'dx', 'dy')));\n\t\t\ttext.setContent(node.textContent.trim() || '');\n\t\t\treturn text;\n\t\t}\n\t};\n\n\tfunction applyTransform(item, value, name, node) {\n\t\tif (item.transform) {\n\t\t\tvar transforms = (node.getAttribute(name) || '').split(/\\)\\s*/g),\n\t\t\t\tmatrix = new Matrix();\n\t\t\tfor (var i = 0, l = transforms.length; i < l; i++) {\n\t\t\t\tvar transform = transforms[i];\n\t\t\t\tif (!transform)\n\t\t\t\t\tbreak;\n\t\t\t\tvar parts = transform.split(/\\(\\s*/),\n\t\t\t\t\tcommand = parts[0],\n\t\t\t\t\tv = parts[1].split(/[\\s,]+/g);\n\t\t\t\tfor (var j = 0, m = v.length; j < m; j++)\n\t\t\t\t\tv[j] = parseFloat(v[j]);\n\t\t\t\tswitch (command) {\n\t\t\t\tcase 'matrix':\n\t\t\t\t\tmatrix.append(\n\t\t\t\t\t\t\tnew Matrix(v[0], v[1], v[2], v[3], v[4], v[5]));\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'rotate':\n\t\t\t\t\tmatrix.rotate(v[0], v[1] || 0, v[2] || 0);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'translate':\n\t\t\t\t\tmatrix.translate(v[0], v[1] || 0);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'scale':\n\t\t\t\t\tmatrix.scale(v);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'skewX':\n\t\t\t\t\tmatrix.skew(v[0], 0);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'skewY':\n\t\t\t\t\tmatrix.skew(0, v[0]);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\titem.transform(matrix);\n\t\t}\n\t}\n\n\tfunction applyOpacity(item, value, name) {\n\t\tvar key = name === 'fill-opacity' ? 'getFillColor' : 'getStrokeColor',\n\t\t\tcolor = item[key] && item[key]();\n\t\tif (color)\n\t\t\tcolor.setAlpha(parseFloat(value));\n\t}\n\n\tvar attributes = Base.set(Base.each(SvgStyles, function(entry) {\n\t\tthis[entry.attribute] = function(item, value) {\n\t\t\tif (item[entry.set]) {\n\t\t\t\titem[entry.set](convertValue(value, entry.type, entry.fromSVG));\n\t\t\t\tif (entry.type === 'color') {\n\t\t\t\t\tvar color = item[entry.get]();\n\t\t\t\t\tif (color) {\n\t\t\t\t\t\tif (color._scaleToBounds) {\n\t\t\t\t\t\t\tvar bounds = item.getBounds();\n\t\t\t\t\t\t\tcolor.transform(new Matrix()\n\t\t\t\t\t\t\t\t.translate(bounds.getPoint())\n\t\t\t\t\t\t\t\t.scale(bounds.getSize()));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t}, {}), {\n\t\tid: function(item, value) {\n\t\t\tdefinitions[value] = item;\n\t\t\tif (item.setName)\n\t\t\t\titem.setName(value);\n\t\t},\n\n\t\t'clip-path': function(item, value) {\n\t\t\tvar clip = getDefinition(value);\n\t\t\tif (clip) {\n\t\t\t\tclip = clip.clone();\n\t\t\t\tclip.setClipMask(true);\n\t\t\t\tif (item instanceof Group) {\n\t\t\t\t\titem.insertChild(0, clip);\n\t\t\t\t} else {\n\t\t\t\t\treturn new Group(clip, item);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\tgradientTransform: applyTransform,\n\t\ttransform: applyTransform,\n\n\t\t'fill-opacity': applyOpacity,\n\t\t'stroke-opacity': applyOpacity,\n\n\t\tvisibility: function(item, value) {\n\t\t\tif (item.setVisible)\n\t\t\t\titem.setVisible(value === 'visible');\n\t\t},\n\n\t\tdisplay: function(item, value) {\n\t\t\tif (item.setVisible)\n\t\t\t\titem.setVisible(value !== null);\n\t\t},\n\n\t\t'stop-color': function(item, value) {\n\t\t\tif (item.setColor)\n\t\t\t\titem.setColor(value);\n\t\t},\n\n\t\t'stop-opacity': function(item, value) {\n\t\t\tif (item._color)\n\t\t\t\titem._color.setAlpha(parseFloat(value));\n\t\t},\n\n\t\toffset: function(item, value) {\n\t\t\tif (item.setOffset) {\n\t\t\t\tvar percent = value.match(/(.*)%$/);\n\t\t\t\titem.setOffset(percent ? percent[1] / 100 : parseFloat(value));\n\t\t\t}\n\t\t},\n\n\t\tviewBox: function(item, value, name, node, styles) {\n\t\t\tvar rect = new Rectangle(convertValue(value, 'array')),\n\t\t\t\tsize = getSize(node, null, null, true),\n\t\t\t\tgroup,\n\t\t\t\tmatrix;\n\t\t\tif (item instanceof Group) {\n\t\t\t\tvar scale = size ? size.divide(rect.getSize()) : 1,\n\t\t\t\tmatrix = new Matrix().scale(scale)\n\t\t\t\t\t\t.translate(rect.getPoint().negate());\n\t\t\t\tgroup = item;\n\t\t\t} else if (item instanceof SymbolDefinition) {\n\t\t\t\tif (size)\n\t\t\t\t\trect.setSize(size);\n\t\t\t\tgroup = item._item;\n\t\t\t}\n\t\t\tif (group)  {\n\t\t\t\tif (getAttribute(node, 'overflow', styles) !== 'visible') {\n\t\t\t\t\tvar clip = new Shape.Rectangle(rect);\n\t\t\t\t\tclip.setClipMask(true);\n\t\t\t\t\tgroup.addChild(clip);\n\t\t\t\t}\n\t\t\t\tif (matrix)\n\t\t\t\t\tgroup.transform(matrix);\n\t\t\t}\n\t\t}\n\t});\n\n\tfunction getAttribute(node, name, styles) {\n\t\tvar attr = node.attributes[name],\n\t\t\tvalue = attr && attr.value;\n\t\tif (!value && node.style) {\n\t\t\tvar style = Base.camelize(name);\n\t\t\tvalue = node.style[style];\n\t\t\tif (!value && styles.node[style] !== styles.parent[style])\n\t\t\t\tvalue = styles.node[style];\n\t\t}\n\t\treturn !value ? undefined\n\t\t\t\t: value === 'none' ? null\n\t\t\t\t: value;\n\t}\n\n\tfunction applyAttributes(item, node, isRoot) {\n\t\tvar parent = node.parentNode,\n\t\t\tstyles = {\n\t\t\t\tnode: DomElement.getStyles(node) || {},\n\t\t\t\tparent: !isRoot && !/^defs$/i.test(parent.tagName)\n\t\t\t\t\t\t&& DomElement.getStyles(parent) || {}\n\t\t\t};\n\t\tBase.each(attributes, function(apply, name) {\n\t\t\tvar value = getAttribute(node, name, styles);\n\t\t\titem = value !== undefined\n\t\t\t\t\t&& apply(item, value, name, node, styles) || item;\n\t\t});\n\t\treturn item;\n\t}\n\n\tfunction getDefinition(value) {\n\t\tvar match = value && value.match(/\\((?:[\"'#]*)([^\"')]+)/),\n\t\t\tname = match && match[1],\n\t\t\tres = name && definitions[window\n\t\t\t\t\t? name.replace(window.location.href.split('#')[0] + '#', '')\n\t\t\t\t\t: name];\n\t\tif (res && res._scaleToBounds) {\n\t\t\tres = res.clone();\n\t\t\tres._scaleToBounds = true;\n\t\t}\n\t\treturn res;\n\t}\n\n\tfunction importNode(node, options, isRoot) {\n\t\tvar type = node.nodeName.toLowerCase(),\n\t\t\tisElement = type !== '#document',\n\t\t\tbody = document.body,\n\t\t\tcontainer,\n\t\t\tparent,\n\t\t\tnext;\n\t\tif (isRoot && isElement) {\n\t\t\trootSize = paper.getView().getSize();\n\t\t\trootSize = getSize(node, null, null, true) || rootSize;\n\t\t\tcontainer = SvgElement.create('svg', {\n\t\t\t\tstyle: 'stroke-width: 1px; stroke-miterlimit: 10'\n\t\t\t});\n\t\t\tparent = node.parentNode;\n\t\t\tnext = node.nextSibling;\n\t\t\tcontainer.appendChild(node);\n\t\t\tbody.appendChild(container);\n\t\t}\n\t\tvar settings = paper.settings,\n\t\t\tapplyMatrix = settings.applyMatrix,\n\t\t\tinsertItems = settings.insertItems;\n\t\tsettings.applyMatrix = false;\n\t\tsettings.insertItems = false;\n\t\tvar importer = importers[type],\n\t\t\titem = importer && importer(node, type, options, isRoot) || null;\n\t\tsettings.insertItems = insertItems;\n\t\tsettings.applyMatrix = applyMatrix;\n\t\tif (item) {\n\t\t\tif (isElement && !(item instanceof Group))\n\t\t\t\titem = applyAttributes(item, node, isRoot);\n\t\t\tvar onImport = options.onImport,\n\t\t\t\tdata = isElement && node.getAttribute('data-paper-data');\n\t\t\tif (onImport)\n\t\t\t\titem = onImport(node, item, options) || item;\n\t\t\tif (options.expandShapes && item instanceof Shape) {\n\t\t\t\titem.remove();\n\t\t\t\titem = item.toPath();\n\t\t\t}\n\t\t\tif (data)\n\t\t\t\titem._data = JSON.parse(data);\n\t\t}\n\t\tif (container) {\n\t\t\tbody.removeChild(container);\n\t\t\tif (parent) {\n\t\t\t\tif (next) {\n\t\t\t\t\tparent.insertBefore(node, next);\n\t\t\t\t} else {\n\t\t\t\t\tparent.appendChild(node);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (isRoot) {\n\t\t\tdefinitions = {};\n\t\t\tif (item && Base.pick(options.applyMatrix, applyMatrix))\n\t\t\t\titem.matrix.apply(true, true);\n\t\t}\n\t\treturn item;\n\t}\n\n\tfunction importSVG(source, options, owner) {\n\t\tif (!source)\n\t\t\treturn null;\n\t\toptions = typeof options === 'function' ? { onLoad: options }\n\t\t\t\t: options || {};\n\t\tvar scope = paper,\n\t\t\titem = null;\n\n\t\tfunction onLoad(svg) {\n\t\t\ttry {\n\t\t\t\tvar node = typeof svg === 'object' ? svg : new self.DOMParser()\n\t\t\t\t\t\t.parseFromString(svg, 'image/svg+xml');\n\t\t\t\tif (!node.nodeName) {\n\t\t\t\t\tnode = null;\n\t\t\t\t\tthrow new Error('Unsupported SVG source: ' + source);\n\t\t\t\t}\n\t\t\t\tpaper = scope;\n\t\t\t\titem = importNode(node, options, true);\n\t\t\t\tif (!options || options.insert !== false) {\n\t\t\t\t\towner._insertItem(undefined, item);\n\t\t\t\t}\n\t\t\t\tvar onLoad = options.onLoad;\n\t\t\t\tif (onLoad)\n\t\t\t\t\tonLoad(item, svg);\n\t\t\t} catch (e) {\n\t\t\t\tonError(e);\n\t\t\t}\n\t\t}\n\n\t\tfunction onError(message, status) {\n\t\t\tvar onError = options.onError;\n\t\t\tif (onError) {\n\t\t\t\tonError(message, status);\n\t\t\t} else {\n\t\t\t\tthrow new Error(message);\n\t\t\t}\n\t\t}\n\n\t\tif (typeof source === 'string' && !/^.*</.test(source)) {\n\t\t\tvar node = document.getElementById(source);\n\t\t\tif (node) {\n\t\t\t\tonLoad(node);\n\t\t\t} else {\n\t\t\t\tHttp.request({\n\t\t\t\t\turl: source,\n\t\t\t\t\tasync: true,\n\t\t\t\t\tonLoad: onLoad,\n\t\t\t\t\tonError: onError\n\t\t\t\t});\n\t\t\t}\n\t\t} else if (typeof File !== 'undefined' && source instanceof File) {\n\t\t\tvar reader = new FileReader();\n\t\t\treader.onload = function() {\n\t\t\t\tonLoad(reader.result);\n\t\t\t};\n\t\t\treader.onerror = function() {\n\t\t\t\tonError(reader.error);\n\t\t\t};\n\t\t\treturn reader.readAsText(source);\n\t\t} else {\n\t\t\tonLoad(source);\n\t\t}\n\n\t\treturn item;\n\t}\n\n\tItem.inject({\n\t\timportSVG: function(node, options) {\n\t\t\treturn importSVG(node, options, this);\n\t\t}\n\t});\n\n\tProject.inject({\n\t\timportSVG: function(node, options) {\n\t\t\tthis.activate();\n\t\t\treturn importSVG(node, options, this);\n\t\t}\n\t});\n};\n\nBase.exports.PaperScript = function() {\n\tvar global = this,\n\t\tacorn = global.acorn;\n\tif (!acorn && typeof require !== 'undefined') {\n\t\ttry { acorn = require('acorn'); } catch(e) {}\n\t}\n\tif (!acorn) {\n\t\tvar exports, module;\n\t\tacorn = exports = module = {};\n\n(function(root, mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") return mod(exports);\n  if (typeof define == \"function\" && define.amd) return define([\"exports\"], mod);\n  mod(root.acorn || (root.acorn = {}));\n})(this, function(exports) {\n  \"use strict\";\n\n  exports.version = \"0.5.0\";\n\n  var options, input, inputLen, sourceFile;\n\n  exports.parse = function(inpt, opts) {\n\tinput = String(inpt); inputLen = input.length;\n\tsetOptions(opts);\n\tinitTokenState();\n\treturn parseTopLevel(options.program);\n  };\n\n  var defaultOptions = exports.defaultOptions = {\n\tecmaVersion: 5,\n\tstrictSemicolons: false,\n\tallowTrailingCommas: true,\n\tforbidReserved: false,\n\tallowReturnOutsideFunction: false,\n\tlocations: false,\n\tonComment: null,\n\tranges: false,\n\tprogram: null,\n\tsourceFile: null,\n\tdirectSourceFile: null\n  };\n\n  function setOptions(opts) {\n\toptions = opts || {};\n\tfor (var opt in defaultOptions) if (!Object.prototype.hasOwnProperty.call(options, opt))\n\t  options[opt] = defaultOptions[opt];\n\tsourceFile = options.sourceFile || null;\n  }\n\n  var getLineInfo = exports.getLineInfo = function(input, offset) {\n\tfor (var line = 1, cur = 0;;) {\n\t  lineBreak.lastIndex = cur;\n\t  var match = lineBreak.exec(input);\n\t  if (match && match.index < offset) {\n\t\t++line;\n\t\tcur = match.index + match[0].length;\n\t  } else break;\n\t}\n\treturn {line: line, column: offset - cur};\n  };\n\n  exports.tokenize = function(inpt, opts) {\n\tinput = String(inpt); inputLen = input.length;\n\tsetOptions(opts);\n\tinitTokenState();\n\n\tvar t = {};\n\tfunction getToken(forceRegexp) {\n\t  lastEnd = tokEnd;\n\t  readToken(forceRegexp);\n\t  t.start = tokStart; t.end = tokEnd;\n\t  t.startLoc = tokStartLoc; t.endLoc = tokEndLoc;\n\t  t.type = tokType; t.value = tokVal;\n\t  return t;\n\t}\n\tgetToken.jumpTo = function(pos, reAllowed) {\n\t  tokPos = pos;\n\t  if (options.locations) {\n\t\ttokCurLine = 1;\n\t\ttokLineStart = lineBreak.lastIndex = 0;\n\t\tvar match;\n\t\twhile ((match = lineBreak.exec(input)) && match.index < pos) {\n\t\t  ++tokCurLine;\n\t\t  tokLineStart = match.index + match[0].length;\n\t\t}\n\t  }\n\t  tokRegexpAllowed = reAllowed;\n\t  skipSpace();\n\t};\n\treturn getToken;\n  };\n\n  var tokPos;\n\n  var tokStart, tokEnd;\n\n  var tokStartLoc, tokEndLoc;\n\n  var tokType, tokVal;\n\n  var tokRegexpAllowed;\n\n  var tokCurLine, tokLineStart;\n\n  var lastStart, lastEnd, lastEndLoc;\n\n  var inFunction, labels, strict;\n\n  function raise(pos, message) {\n\tvar loc = getLineInfo(input, pos);\n\tmessage += \" (\" + loc.line + \":\" + loc.column + \")\";\n\tvar err = new SyntaxError(message);\n\terr.pos = pos; err.loc = loc; err.raisedAt = tokPos;\n\tthrow err;\n  }\n\n  var empty = [];\n\n  var _num = {type: \"num\"}, _regexp = {type: \"regexp\"}, _string = {type: \"string\"};\n  var _name = {type: \"name\"}, _eof = {type: \"eof\"};\n\n  var _break = {keyword: \"break\"}, _case = {keyword: \"case\", beforeExpr: true}, _catch = {keyword: \"catch\"};\n  var _continue = {keyword: \"continue\"}, _debugger = {keyword: \"debugger\"}, _default = {keyword: \"default\"};\n  var _do = {keyword: \"do\", isLoop: true}, _else = {keyword: \"else\", beforeExpr: true};\n  var _finally = {keyword: \"finally\"}, _for = {keyword: \"for\", isLoop: true}, _function = {keyword: \"function\"};\n  var _if = {keyword: \"if\"}, _return = {keyword: \"return\", beforeExpr: true}, _switch = {keyword: \"switch\"};\n  var _throw = {keyword: \"throw\", beforeExpr: true}, _try = {keyword: \"try\"}, _var = {keyword: \"var\"};\n  var _while = {keyword: \"while\", isLoop: true}, _with = {keyword: \"with\"}, _new = {keyword: \"new\", beforeExpr: true};\n  var _this = {keyword: \"this\"};\n\n  var _null = {keyword: \"null\", atomValue: null}, _true = {keyword: \"true\", atomValue: true};\n  var _false = {keyword: \"false\", atomValue: false};\n\n  var _in = {keyword: \"in\", binop: 7, beforeExpr: true};\n\n  var keywordTypes = {\"break\": _break, \"case\": _case, \"catch\": _catch,\n\t\t\t\t\t  \"continue\": _continue, \"debugger\": _debugger, \"default\": _default,\n\t\t\t\t\t  \"do\": _do, \"else\": _else, \"finally\": _finally, \"for\": _for,\n\t\t\t\t\t  \"function\": _function, \"if\": _if, \"return\": _return, \"switch\": _switch,\n\t\t\t\t\t  \"throw\": _throw, \"try\": _try, \"var\": _var, \"while\": _while, \"with\": _with,\n\t\t\t\t\t  \"null\": _null, \"true\": _true, \"false\": _false, \"new\": _new, \"in\": _in,\n\t\t\t\t\t  \"instanceof\": {keyword: \"instanceof\", binop: 7, beforeExpr: true}, \"this\": _this,\n\t\t\t\t\t  \"typeof\": {keyword: \"typeof\", prefix: true, beforeExpr: true},\n\t\t\t\t\t  \"void\": {keyword: \"void\", prefix: true, beforeExpr: true},\n\t\t\t\t\t  \"delete\": {keyword: \"delete\", prefix: true, beforeExpr: true}};\n\n  var _bracketL = {type: \"[\", beforeExpr: true}, _bracketR = {type: \"]\"}, _braceL = {type: \"{\", beforeExpr: true};\n  var _braceR = {type: \"}\"}, _parenL = {type: \"(\", beforeExpr: true}, _parenR = {type: \")\"};\n  var _comma = {type: \",\", beforeExpr: true}, _semi = {type: \";\", beforeExpr: true};\n  var _colon = {type: \":\", beforeExpr: true}, _dot = {type: \".\"}, _question = {type: \"?\", beforeExpr: true};\n\n  var _slash = {binop: 10, beforeExpr: true}, _eq = {isAssign: true, beforeExpr: true};\n  var _assign = {isAssign: true, beforeExpr: true};\n  var _incDec = {postfix: true, prefix: true, isUpdate: true}, _prefix = {prefix: true, beforeExpr: true};\n  var _logicalOR = {binop: 1, beforeExpr: true};\n  var _logicalAND = {binop: 2, beforeExpr: true};\n  var _bitwiseOR = {binop: 3, beforeExpr: true};\n  var _bitwiseXOR = {binop: 4, beforeExpr: true};\n  var _bitwiseAND = {binop: 5, beforeExpr: true};\n  var _equality = {binop: 6, beforeExpr: true};\n  var _relational = {binop: 7, beforeExpr: true};\n  var _bitShift = {binop: 8, beforeExpr: true};\n  var _plusMin = {binop: 9, prefix: true, beforeExpr: true};\n  var _multiplyModulo = {binop: 10, beforeExpr: true};\n\n  exports.tokTypes = {bracketL: _bracketL, bracketR: _bracketR, braceL: _braceL, braceR: _braceR,\n\t\t\t\t\t  parenL: _parenL, parenR: _parenR, comma: _comma, semi: _semi, colon: _colon,\n\t\t\t\t\t  dot: _dot, question: _question, slash: _slash, eq: _eq, name: _name, eof: _eof,\n\t\t\t\t\t  num: _num, regexp: _regexp, string: _string};\n  for (var kw in keywordTypes) exports.tokTypes[\"_\" + kw] = keywordTypes[kw];\n\n  function makePredicate(words) {\n\twords = words.split(\" \");\n\tvar f = \"\", cats = [];\n\tout: for (var i = 0; i < words.length; ++i) {\n\t  for (var j = 0; j < cats.length; ++j)\n\t\tif (cats[j][0].length == words[i].length) {\n\t\t  cats[j].push(words[i]);\n\t\t  continue out;\n\t\t}\n\t  cats.push([words[i]]);\n\t}\n\tfunction compareTo(arr) {\n\t  if (arr.length == 1) return f += \"return str === \" + JSON.stringify(arr[0]) + \";\";\n\t  f += \"switch(str){\";\n\t  for (var i = 0; i < arr.length; ++i) f += \"case \" + JSON.stringify(arr[i]) + \":\";\n\t  f += \"return true}return false;\";\n\t}\n\n\tif (cats.length > 3) {\n\t  cats.sort(function(a, b) {return b.length - a.length;});\n\t  f += \"switch(str.length){\";\n\t  for (var i = 0; i < cats.length; ++i) {\n\t\tvar cat = cats[i];\n\t\tf += \"case \" + cat[0].length + \":\";\n\t\tcompareTo(cat);\n\t  }\n\t  f += \"}\";\n\n\t} else {\n\t  compareTo(words);\n\t}\n\treturn new Function(\"str\", f);\n  }\n\n  var isReservedWord3 = makePredicate(\"abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile\");\n\n  var isReservedWord5 = makePredicate(\"class enum extends super const export import\");\n\n  var isStrictReservedWord = makePredicate(\"implements interface let package private protected public static yield\");\n\n  var isStrictBadIdWord = makePredicate(\"eval arguments\");\n\n  var isKeyword = makePredicate(\"break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this\");\n\n  var nonASCIIwhitespace = /[\\u1680\\u180e\\u2000-\\u200a\\u202f\\u205f\\u3000\\ufeff]/;\n  var nonASCIIidentifierStartChars = \"\\xaa\\xb5\\xba\\xc0-\\xd6\\xd8-\\xf6\\xf8-\\u02c1\\u02c6-\\u02d1\\u02e0-\\u02e4\\u02ec\\u02ee\\u0370-\\u0374\\u0376\\u0377\\u037a-\\u037d\\u0386\\u0388-\\u038a\\u038c\\u038e-\\u03a1\\u03a3-\\u03f5\\u03f7-\\u0481\\u048a-\\u0527\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05d0-\\u05ea\\u05f0-\\u05f2\\u0620-\\u064a\\u066e\\u066f\\u0671-\\u06d3\\u06d5\\u06e5\\u06e6\\u06ee\\u06ef\\u06fa-\\u06fc\\u06ff\\u0710\\u0712-\\u072f\\u074d-\\u07a5\\u07b1\\u07ca-\\u07ea\\u07f4\\u07f5\\u07fa\\u0800-\\u0815\\u081a\\u0824\\u0828\\u0840-\\u0858\\u08a0\\u08a2-\\u08ac\\u0904-\\u0939\\u093d\\u0950\\u0958-\\u0961\\u0971-\\u0977\\u0979-\\u097f\\u0985-\\u098c\\u098f\\u0990\\u0993-\\u09a8\\u09aa-\\u09b0\\u09b2\\u09b6-\\u09b9\\u09bd\\u09ce\\u09dc\\u09dd\\u09df-\\u09e1\\u09f0\\u09f1\\u0a05-\\u0a0a\\u0a0f\\u0a10\\u0a13-\\u0a28\\u0a2a-\\u0a30\\u0a32\\u0a33\\u0a35\\u0a36\\u0a38\\u0a39\\u0a59-\\u0a5c\\u0a5e\\u0a72-\\u0a74\\u0a85-\\u0a8d\\u0a8f-\\u0a91\\u0a93-\\u0aa8\\u0aaa-\\u0ab0\\u0ab2\\u0ab3\\u0ab5-\\u0ab9\\u0abd\\u0ad0\\u0ae0\\u0ae1\\u0b05-\\u0b0c\\u0b0f\\u0b10\\u0b13-\\u0b28\\u0b2a-\\u0b30\\u0b32\\u0b33\\u0b35-\\u0b39\\u0b3d\\u0b5c\\u0b5d\\u0b5f-\\u0b61\\u0b71\\u0b83\\u0b85-\\u0b8a\\u0b8e-\\u0b90\\u0b92-\\u0b95\\u0b99\\u0b9a\\u0b9c\\u0b9e\\u0b9f\\u0ba3\\u0ba4\\u0ba8-\\u0baa\\u0bae-\\u0bb9\\u0bd0\\u0c05-\\u0c0c\\u0c0e-\\u0c10\\u0c12-\\u0c28\\u0c2a-\\u0c33\\u0c35-\\u0c39\\u0c3d\\u0c58\\u0c59\\u0c60\\u0c61\\u0c85-\\u0c8c\\u0c8e-\\u0c90\\u0c92-\\u0ca8\\u0caa-\\u0cb3\\u0cb5-\\u0cb9\\u0cbd\\u0cde\\u0ce0\\u0ce1\\u0cf1\\u0cf2\\u0d05-\\u0d0c\\u0d0e-\\u0d10\\u0d12-\\u0d3a\\u0d3d\\u0d4e\\u0d60\\u0d61\\u0d7a-\\u0d7f\\u0d85-\\u0d96\\u0d9a-\\u0db1\\u0db3-\\u0dbb\\u0dbd\\u0dc0-\\u0dc6\\u0e01-\\u0e30\\u0e32\\u0e33\\u0e40-\\u0e46\\u0e81\\u0e82\\u0e84\\u0e87\\u0e88\\u0e8a\\u0e8d\\u0e94-\\u0e97\\u0e99-\\u0e9f\\u0ea1-\\u0ea3\\u0ea5\\u0ea7\\u0eaa\\u0eab\\u0ead-\\u0eb0\\u0eb2\\u0eb3\\u0ebd\\u0ec0-\\u0ec4\\u0ec6\\u0edc-\\u0edf\\u0f00\\u0f40-\\u0f47\\u0f49-\\u0f6c\\u0f88-\\u0f8c\\u1000-\\u102a\\u103f\\u1050-\\u1055\\u105a-\\u105d\\u1061\\u1065\\u1066\\u106e-\\u1070\\u1075-\\u1081\\u108e\\u10a0-\\u10c5\\u10c7\\u10cd\\u10d0-\\u10fa\\u10fc-\\u1248\\u124a-\\u124d\\u1250-\\u1256\\u1258\\u125a-\\u125d\\u1260-\\u1288\\u128a-\\u128d\\u1290-\\u12b0\\u12b2-\\u12b5\\u12b8-\\u12be\\u12c0\\u12c2-\\u12c5\\u12c8-\\u12d6\\u12d8-\\u1310\\u1312-\\u1315\\u1318-\\u135a\\u1380-\\u138f\\u13a0-\\u13f4\\u1401-\\u166c\\u166f-\\u167f\\u1681-\\u169a\\u16a0-\\u16ea\\u16ee-\\u16f0\\u1700-\\u170c\\u170e-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176c\\u176e-\\u1770\\u1780-\\u17b3\\u17d7\\u17dc\\u1820-\\u1877\\u1880-\\u18a8\\u18aa\\u18b0-\\u18f5\\u1900-\\u191c\\u1950-\\u196d\\u1970-\\u1974\\u1980-\\u19ab\\u19c1-\\u19c7\\u1a00-\\u1a16\\u1a20-\\u1a54\\u1aa7\\u1b05-\\u1b33\\u1b45-\\u1b4b\\u1b83-\\u1ba0\\u1bae\\u1baf\\u1bba-\\u1be5\\u1c00-\\u1c23\\u1c4d-\\u1c4f\\u1c5a-\\u1c7d\\u1ce9-\\u1cec\\u1cee-\\u1cf1\\u1cf5\\u1cf6\\u1d00-\\u1dbf\\u1e00-\\u1f15\\u1f18-\\u1f1d\\u1f20-\\u1f45\\u1f48-\\u1f4d\\u1f50-\\u1f57\\u1f59\\u1f5b\\u1f5d\\u1f5f-\\u1f7d\\u1f80-\\u1fb4\\u1fb6-\\u1fbc\\u1fbe\\u1fc2-\\u1fc4\\u1fc6-\\u1fcc\\u1fd0-\\u1fd3\\u1fd6-\\u1fdb\\u1fe0-\\u1fec\\u1ff2-\\u1ff4\\u1ff6-\\u1ffc\\u2071\\u207f\\u2090-\\u209c\\u2102\\u2107\\u210a-\\u2113\\u2115\\u2119-\\u211d\\u2124\\u2126\\u2128\\u212a-\\u212d\\u212f-\\u2139\\u213c-\\u213f\\u2145-\\u2149\\u214e\\u2160-\\u2188\\u2c00-\\u2c2e\\u2c30-\\u2c5e\\u2c60-\\u2ce4\\u2ceb-\\u2cee\\u2cf2\\u2cf3\\u2d00-\\u2d25\\u2d27\\u2d2d\\u2d30-\\u2d67\\u2d6f\\u2d80-\\u2d96\\u2da0-\\u2da6\\u2da8-\\u2dae\\u2db0-\\u2db6\\u2db8-\\u2dbe\\u2dc0-\\u2dc6\\u2dc8-\\u2dce\\u2dd0-\\u2dd6\\u2dd8-\\u2dde\\u2e2f\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303c\\u3041-\\u3096\\u309d-\\u309f\\u30a1-\\u30fa\\u30fc-\\u30ff\\u3105-\\u312d\\u3131-\\u318e\\u31a0-\\u31ba\\u31f0-\\u31ff\\u3400-\\u4db5\\u4e00-\\u9fcc\\ua000-\\ua48c\\ua4d0-\\ua4fd\\ua500-\\ua60c\\ua610-\\ua61f\\ua62a\\ua62b\\ua640-\\ua66e\\ua67f-\\ua697\\ua6a0-\\ua6ef\\ua717-\\ua71f\\ua722-\\ua788\\ua78b-\\ua78e\\ua790-\\ua793\\ua7a0-\\ua7aa\\ua7f8-\\ua801\\ua803-\\ua805\\ua807-\\ua80a\\ua80c-\\ua822\\ua840-\\ua873\\ua882-\\ua8b3\\ua8f2-\\ua8f7\\ua8fb\\ua90a-\\ua925\\ua930-\\ua946\\ua960-\\ua97c\\ua984-\\ua9b2\\ua9cf\\uaa00-\\uaa28\\uaa40-\\uaa42\\uaa44-\\uaa4b\\uaa60-\\uaa76\\uaa7a\\uaa80-\\uaaaf\\uaab1\\uaab5\\uaab6\\uaab9-\\uaabd\\uaac0\\uaac2\\uaadb-\\uaadd\\uaae0-\\uaaea\\uaaf2-\\uaaf4\\uab01-\\uab06\\uab09-\\uab0e\\uab11-\\uab16\\uab20-\\uab26\\uab28-\\uab2e\\uabc0-\\uabe2\\uac00-\\ud7a3\\ud7b0-\\ud7c6\\ud7cb-\\ud7fb\\uf900-\\ufa6d\\ufa70-\\ufad9\\ufb00-\\ufb06\\ufb13-\\ufb17\\ufb1d\\ufb1f-\\ufb28\\ufb2a-\\ufb36\\ufb38-\\ufb3c\\ufb3e\\ufb40\\ufb41\\ufb43\\ufb44\\ufb46-\\ufbb1\\ufbd3-\\ufd3d\\ufd50-\\ufd8f\\ufd92-\\ufdc7\\ufdf0-\\ufdfb\\ufe70-\\ufe74\\ufe76-\\ufefc\\uff21-\\uff3a\\uff41-\\uff5a\\uff66-\\uffbe\\uffc2-\\uffc7\\uffca-\\uffcf\\uffd2-\\uffd7\\uffda-\\uffdc\";\n  var nonASCIIidentifierChars = \"\\u0300-\\u036f\\u0483-\\u0487\\u0591-\\u05bd\\u05bf\\u05c1\\u05c2\\u05c4\\u05c5\\u05c7\\u0610-\\u061a\\u0620-\\u0649\\u0672-\\u06d3\\u06e7-\\u06e8\\u06fb-\\u06fc\\u0730-\\u074a\\u0800-\\u0814\\u081b-\\u0823\\u0825-\\u0827\\u0829-\\u082d\\u0840-\\u0857\\u08e4-\\u08fe\\u0900-\\u0903\\u093a-\\u093c\\u093e-\\u094f\\u0951-\\u0957\\u0962-\\u0963\\u0966-\\u096f\\u0981-\\u0983\\u09bc\\u09be-\\u09c4\\u09c7\\u09c8\\u09d7\\u09df-\\u09e0\\u0a01-\\u0a03\\u0a3c\\u0a3e-\\u0a42\\u0a47\\u0a48\\u0a4b-\\u0a4d\\u0a51\\u0a66-\\u0a71\\u0a75\\u0a81-\\u0a83\\u0abc\\u0abe-\\u0ac5\\u0ac7-\\u0ac9\\u0acb-\\u0acd\\u0ae2-\\u0ae3\\u0ae6-\\u0aef\\u0b01-\\u0b03\\u0b3c\\u0b3e-\\u0b44\\u0b47\\u0b48\\u0b4b-\\u0b4d\\u0b56\\u0b57\\u0b5f-\\u0b60\\u0b66-\\u0b6f\\u0b82\\u0bbe-\\u0bc2\\u0bc6-\\u0bc8\\u0bca-\\u0bcd\\u0bd7\\u0be6-\\u0bef\\u0c01-\\u0c03\\u0c46-\\u0c48\\u0c4a-\\u0c4d\\u0c55\\u0c56\\u0c62-\\u0c63\\u0c66-\\u0c6f\\u0c82\\u0c83\\u0cbc\\u0cbe-\\u0cc4\\u0cc6-\\u0cc8\\u0cca-\\u0ccd\\u0cd5\\u0cd6\\u0ce2-\\u0ce3\\u0ce6-\\u0cef\\u0d02\\u0d03\\u0d46-\\u0d48\\u0d57\\u0d62-\\u0d63\\u0d66-\\u0d6f\\u0d82\\u0d83\\u0dca\\u0dcf-\\u0dd4\\u0dd6\\u0dd8-\\u0ddf\\u0df2\\u0df3\\u0e34-\\u0e3a\\u0e40-\\u0e45\\u0e50-\\u0e59\\u0eb4-\\u0eb9\\u0ec8-\\u0ecd\\u0ed0-\\u0ed9\\u0f18\\u0f19\\u0f20-\\u0f29\\u0f35\\u0f37\\u0f39\\u0f41-\\u0f47\\u0f71-\\u0f84\\u0f86-\\u0f87\\u0f8d-\\u0f97\\u0f99-\\u0fbc\\u0fc6\\u1000-\\u1029\\u1040-\\u1049\\u1067-\\u106d\\u1071-\\u1074\\u1082-\\u108d\\u108f-\\u109d\\u135d-\\u135f\\u170e-\\u1710\\u1720-\\u1730\\u1740-\\u1750\\u1772\\u1773\\u1780-\\u17b2\\u17dd\\u17e0-\\u17e9\\u180b-\\u180d\\u1810-\\u1819\\u1920-\\u192b\\u1930-\\u193b\\u1951-\\u196d\\u19b0-\\u19c0\\u19c8-\\u19c9\\u19d0-\\u19d9\\u1a00-\\u1a15\\u1a20-\\u1a53\\u1a60-\\u1a7c\\u1a7f-\\u1a89\\u1a90-\\u1a99\\u1b46-\\u1b4b\\u1b50-\\u1b59\\u1b6b-\\u1b73\\u1bb0-\\u1bb9\\u1be6-\\u1bf3\\u1c00-\\u1c22\\u1c40-\\u1c49\\u1c5b-\\u1c7d\\u1cd0-\\u1cd2\\u1d00-\\u1dbe\\u1e01-\\u1f15\\u200c\\u200d\\u203f\\u2040\\u2054\\u20d0-\\u20dc\\u20e1\\u20e5-\\u20f0\\u2d81-\\u2d96\\u2de0-\\u2dff\\u3021-\\u3028\\u3099\\u309a\\ua640-\\ua66d\\ua674-\\ua67d\\ua69f\\ua6f0-\\ua6f1\\ua7f8-\\ua800\\ua806\\ua80b\\ua823-\\ua827\\ua880-\\ua881\\ua8b4-\\ua8c4\\ua8d0-\\ua8d9\\ua8f3-\\ua8f7\\ua900-\\ua909\\ua926-\\ua92d\\ua930-\\ua945\\ua980-\\ua983\\ua9b3-\\ua9c0\\uaa00-\\uaa27\\uaa40-\\uaa41\\uaa4c-\\uaa4d\\uaa50-\\uaa59\\uaa7b\\uaae0-\\uaae9\\uaaf2-\\uaaf3\\uabc0-\\uabe1\\uabec\\uabed\\uabf0-\\uabf9\\ufb20-\\ufb28\\ufe00-\\ufe0f\\ufe20-\\ufe26\\ufe33\\ufe34\\ufe4d-\\ufe4f\\uff10-\\uff19\\uff3f\";\n  var nonASCIIidentifierStart = new RegExp(\"[\" + nonASCIIidentifierStartChars + \"]\");\n  var nonASCIIidentifier = new RegExp(\"[\" + nonASCIIidentifierStartChars + nonASCIIidentifierChars + \"]\");\n\n  var newline = /[\\n\\r\\u2028\\u2029]/;\n\n  var lineBreak = /\\r\\n|[\\n\\r\\u2028\\u2029]/g;\n\n  var isIdentifierStart = exports.isIdentifierStart = function(code) {\n\tif (code < 65) return code === 36;\n\tif (code < 91) return true;\n\tif (code < 97) return code === 95;\n\tif (code < 123)return true;\n\treturn code >= 0xaa && nonASCIIidentifierStart.test(String.fromCharCode(code));\n  };\n\n  var isIdentifierChar = exports.isIdentifierChar = function(code) {\n\tif (code < 48) return code === 36;\n\tif (code < 58) return true;\n\tif (code < 65) return false;\n\tif (code < 91) return true;\n\tif (code < 97) return code === 95;\n\tif (code < 123)return true;\n\treturn code >= 0xaa && nonASCIIidentifier.test(String.fromCharCode(code));\n  };\n\n  function line_loc_t() {\n\tthis.line = tokCurLine;\n\tthis.column = tokPos - tokLineStart;\n  }\n\n  function initTokenState() {\n\ttokCurLine = 1;\n\ttokPos = tokLineStart = 0;\n\ttokRegexpAllowed = true;\n\tskipSpace();\n  }\n\n  function finishToken(type, val) {\n\ttokEnd = tokPos;\n\tif (options.locations) tokEndLoc = new line_loc_t;\n\ttokType = type;\n\tskipSpace();\n\ttokVal = val;\n\ttokRegexpAllowed = type.beforeExpr;\n  }\n\n  function skipBlockComment() {\n\tvar startLoc = options.onComment && options.locations && new line_loc_t;\n\tvar start = tokPos, end = input.indexOf(\"*/\", tokPos += 2);\n\tif (end === -1) raise(tokPos - 2, \"Unterminated comment\");\n\ttokPos = end + 2;\n\tif (options.locations) {\n\t  lineBreak.lastIndex = start;\n\t  var match;\n\t  while ((match = lineBreak.exec(input)) && match.index < tokPos) {\n\t\t++tokCurLine;\n\t\ttokLineStart = match.index + match[0].length;\n\t  }\n\t}\n\tif (options.onComment)\n\t  options.onComment(true, input.slice(start + 2, end), start, tokPos,\n\t\t\t\t\t\tstartLoc, options.locations && new line_loc_t);\n  }\n\n  function skipLineComment() {\n\tvar start = tokPos;\n\tvar startLoc = options.onComment && options.locations && new line_loc_t;\n\tvar ch = input.charCodeAt(tokPos+=2);\n\twhile (tokPos < inputLen && ch !== 10 && ch !== 13 && ch !== 8232 && ch !== 8233) {\n\t  ++tokPos;\n\t  ch = input.charCodeAt(tokPos);\n\t}\n\tif (options.onComment)\n\t  options.onComment(false, input.slice(start + 2, tokPos), start, tokPos,\n\t\t\t\t\t\tstartLoc, options.locations && new line_loc_t);\n  }\n\n  function skipSpace() {\n\twhile (tokPos < inputLen) {\n\t  var ch = input.charCodeAt(tokPos);\n\t  if (ch === 32) {\n\t\t++tokPos;\n\t  } else if (ch === 13) {\n\t\t++tokPos;\n\t\tvar next = input.charCodeAt(tokPos);\n\t\tif (next === 10) {\n\t\t  ++tokPos;\n\t\t}\n\t\tif (options.locations) {\n\t\t  ++tokCurLine;\n\t\t  tokLineStart = tokPos;\n\t\t}\n\t  } else if (ch === 10 || ch === 8232 || ch === 8233) {\n\t\t++tokPos;\n\t\tif (options.locations) {\n\t\t  ++tokCurLine;\n\t\t  tokLineStart = tokPos;\n\t\t}\n\t  } else if (ch > 8 && ch < 14) {\n\t\t++tokPos;\n\t  } else if (ch === 47) {\n\t\tvar next = input.charCodeAt(tokPos + 1);\n\t\tif (next === 42) {\n\t\t  skipBlockComment();\n\t\t} else if (next === 47) {\n\t\t  skipLineComment();\n\t\t} else break;\n\t  } else if (ch === 160) {\n\t\t++tokPos;\n\t  } else if (ch >= 5760 && nonASCIIwhitespace.test(String.fromCharCode(ch))) {\n\t\t++tokPos;\n\t  } else {\n\t\tbreak;\n\t  }\n\t}\n  }\n\n  function readToken_dot() {\n\tvar next = input.charCodeAt(tokPos + 1);\n\tif (next >= 48 && next <= 57) return readNumber(true);\n\t++tokPos;\n\treturn finishToken(_dot);\n  }\n\n  function readToken_slash() {\n\tvar next = input.charCodeAt(tokPos + 1);\n\tif (tokRegexpAllowed) {++tokPos; return readRegexp();}\n\tif (next === 61) return finishOp(_assign, 2);\n\treturn finishOp(_slash, 1);\n  }\n\n  function readToken_mult_modulo() {\n\tvar next = input.charCodeAt(tokPos + 1);\n\tif (next === 61) return finishOp(_assign, 2);\n\treturn finishOp(_multiplyModulo, 1);\n  }\n\n  function readToken_pipe_amp(code) {\n\tvar next = input.charCodeAt(tokPos + 1);\n\tif (next === code) return finishOp(code === 124 ? _logicalOR : _logicalAND, 2);\n\tif (next === 61) return finishOp(_assign, 2);\n\treturn finishOp(code === 124 ? _bitwiseOR : _bitwiseAND, 1);\n  }\n\n  function readToken_caret() {\n\tvar next = input.charCodeAt(tokPos + 1);\n\tif (next === 61) return finishOp(_assign, 2);\n\treturn finishOp(_bitwiseXOR, 1);\n  }\n\n  function readToken_plus_min(code) {\n\tvar next = input.charCodeAt(tokPos + 1);\n\tif (next === code) {\n\t  if (next == 45 && input.charCodeAt(tokPos + 2) == 62 &&\n\t\t  newline.test(input.slice(lastEnd, tokPos))) {\n\t\ttokPos += 3;\n\t\tskipLineComment();\n\t\tskipSpace();\n\t\treturn readToken();\n\t  }\n\t  return finishOp(_incDec, 2);\n\t}\n\tif (next === 61) return finishOp(_assign, 2);\n\treturn finishOp(_plusMin, 1);\n  }\n\n  function readToken_lt_gt(code) {\n\tvar next = input.charCodeAt(tokPos + 1);\n\tvar size = 1;\n\tif (next === code) {\n\t  size = code === 62 && input.charCodeAt(tokPos + 2) === 62 ? 3 : 2;\n\t  if (input.charCodeAt(tokPos + size) === 61) return finishOp(_assign, size + 1);\n\t  return finishOp(_bitShift, size);\n\t}\n\tif (next == 33 && code == 60 && input.charCodeAt(tokPos + 2) == 45 &&\n\t\tinput.charCodeAt(tokPos + 3) == 45) {\n\t  tokPos += 4;\n\t  skipLineComment();\n\t  skipSpace();\n\t  return readToken();\n\t}\n\tif (next === 61)\n\t  size = input.charCodeAt(tokPos + 2) === 61 ? 3 : 2;\n\treturn finishOp(_relational, size);\n  }\n\n  function readToken_eq_excl(code) {\n\tvar next = input.charCodeAt(tokPos + 1);\n\tif (next === 61) return finishOp(_equality, input.charCodeAt(tokPos + 2) === 61 ? 3 : 2);\n\treturn finishOp(code === 61 ? _eq : _prefix, 1);\n  }\n\n  function getTokenFromCode(code) {\n\tswitch(code) {\n\tcase 46:\n\t  return readToken_dot();\n\n\tcase 40: ++tokPos; return finishToken(_parenL);\n\tcase 41: ++tokPos; return finishToken(_parenR);\n\tcase 59: ++tokPos; return finishToken(_semi);\n\tcase 44: ++tokPos; return finishToken(_comma);\n\tcase 91: ++tokPos; return finishToken(_bracketL);\n\tcase 93: ++tokPos; return finishToken(_bracketR);\n\tcase 123: ++tokPos; return finishToken(_braceL);\n\tcase 125: ++tokPos; return finishToken(_braceR);\n\tcase 58: ++tokPos; return finishToken(_colon);\n\tcase 63: ++tokPos; return finishToken(_question);\n\n\tcase 48:\n\t  var next = input.charCodeAt(tokPos + 1);\n\t  if (next === 120 || next === 88) return readHexNumber();\n\tcase 49: case 50: case 51: case 52: case 53: case 54: case 55: case 56: case 57:\n\t  return readNumber(false);\n\n\tcase 34: case 39:\n\t  return readString(code);\n\n\tcase 47:\n\t  return readToken_slash(code);\n\n\tcase 37: case 42:\n\t  return readToken_mult_modulo();\n\n\tcase 124: case 38:\n\t  return readToken_pipe_amp(code);\n\n\tcase 94:\n\t  return readToken_caret();\n\n\tcase 43: case 45:\n\t  return readToken_plus_min(code);\n\n\tcase 60: case 62:\n\t  return readToken_lt_gt(code);\n\n\tcase 61: case 33:\n\t  return readToken_eq_excl(code);\n\n\tcase 126:\n\t  return finishOp(_prefix, 1);\n\t}\n\n\treturn false;\n  }\n\n  function readToken(forceRegexp) {\n\tif (!forceRegexp) tokStart = tokPos;\n\telse tokPos = tokStart + 1;\n\tif (options.locations) tokStartLoc = new line_loc_t;\n\tif (forceRegexp) return readRegexp();\n\tif (tokPos >= inputLen) return finishToken(_eof);\n\n\tvar code = input.charCodeAt(tokPos);\n\tif (isIdentifierStart(code) || code === 92 ) return readWord();\n\n\tvar tok = getTokenFromCode(code);\n\n\tif (tok === false) {\n\t  var ch = String.fromCharCode(code);\n\t  if (ch === \"\\\\\" || nonASCIIidentifierStart.test(ch)) return readWord();\n\t  raise(tokPos, \"Unexpected character '\" + ch + \"'\");\n\t}\n\treturn tok;\n  }\n\n  function finishOp(type, size) {\n\tvar str = input.slice(tokPos, tokPos + size);\n\ttokPos += size;\n\tfinishToken(type, str);\n  }\n\n  function readRegexp() {\n\tvar content = \"\", escaped, inClass, start = tokPos;\n\tfor (;;) {\n\t  if (tokPos >= inputLen) raise(start, \"Unterminated regular expression\");\n\t  var ch = input.charAt(tokPos);\n\t  if (newline.test(ch)) raise(start, \"Unterminated regular expression\");\n\t  if (!escaped) {\n\t\tif (ch === \"[\") inClass = true;\n\t\telse if (ch === \"]\" && inClass) inClass = false;\n\t\telse if (ch === \"/\" && !inClass) break;\n\t\tescaped = ch === \"\\\\\";\n\t  } else escaped = false;\n\t  ++tokPos;\n\t}\n\tvar content = input.slice(start, tokPos);\n\t++tokPos;\n\tvar mods = readWord1();\n\tif (mods && !/^[gmsiy]*$/.test(mods)) raise(start, \"Invalid regexp flag\");\n\ttry {\n\t  var value = new RegExp(content, mods);\n\t} catch (e) {\n\t  if (e instanceof SyntaxError) raise(start, e.message);\n\t  raise(e);\n\t}\n\treturn finishToken(_regexp, value);\n  }\n\n  function readInt(radix, len) {\n\tvar start = tokPos, total = 0;\n\tfor (var i = 0, e = len == null ? Infinity : len; i < e; ++i) {\n\t  var code = input.charCodeAt(tokPos), val;\n\t  if (code >= 97) val = code - 97 + 10;\n\t  else if (code >= 65) val = code - 65 + 10;\n\t  else if (code >= 48 && code <= 57) val = code - 48;\n\t  else val = Infinity;\n\t  if (val >= radix) break;\n\t  ++tokPos;\n\t  total = total * radix + val;\n\t}\n\tif (tokPos === start || len != null && tokPos - start !== len) return null;\n\n\treturn total;\n  }\n\n  function readHexNumber() {\n\ttokPos += 2;\n\tvar val = readInt(16);\n\tif (val == null) raise(tokStart + 2, \"Expected hexadecimal number\");\n\tif (isIdentifierStart(input.charCodeAt(tokPos))) raise(tokPos, \"Identifier directly after number\");\n\treturn finishToken(_num, val);\n  }\n\n  function readNumber(startsWithDot) {\n\tvar start = tokPos, isFloat = false, octal = input.charCodeAt(tokPos) === 48;\n\tif (!startsWithDot && readInt(10) === null) raise(start, \"Invalid number\");\n\tif (input.charCodeAt(tokPos) === 46) {\n\t  ++tokPos;\n\t  readInt(10);\n\t  isFloat = true;\n\t}\n\tvar next = input.charCodeAt(tokPos);\n\tif (next === 69 || next === 101) {\n\t  next = input.charCodeAt(++tokPos);\n\t  if (next === 43 || next === 45) ++tokPos;\n\t  if (readInt(10) === null) raise(start, \"Invalid number\");\n\t  isFloat = true;\n\t}\n\tif (isIdentifierStart(input.charCodeAt(tokPos))) raise(tokPos, \"Identifier directly after number\");\n\n\tvar str = input.slice(start, tokPos), val;\n\tif (isFloat) val = parseFloat(str);\n\telse if (!octal || str.length === 1) val = parseInt(str, 10);\n\telse if (/[89]/.test(str) || strict) raise(start, \"Invalid number\");\n\telse val = parseInt(str, 8);\n\treturn finishToken(_num, val);\n  }\n\n  function readString(quote) {\n\ttokPos++;\n\tvar out = \"\";\n\tfor (;;) {\n\t  if (tokPos >= inputLen) raise(tokStart, \"Unterminated string constant\");\n\t  var ch = input.charCodeAt(tokPos);\n\t  if (ch === quote) {\n\t\t++tokPos;\n\t\treturn finishToken(_string, out);\n\t  }\n\t  if (ch === 92) {\n\t\tch = input.charCodeAt(++tokPos);\n\t\tvar octal = /^[0-7]+/.exec(input.slice(tokPos, tokPos + 3));\n\t\tif (octal) octal = octal[0];\n\t\twhile (octal && parseInt(octal, 8) > 255) octal = octal.slice(0, -1);\n\t\tif (octal === \"0\") octal = null;\n\t\t++tokPos;\n\t\tif (octal) {\n\t\t  if (strict) raise(tokPos - 2, \"Octal literal in strict mode\");\n\t\t  out += String.fromCharCode(parseInt(octal, 8));\n\t\t  tokPos += octal.length - 1;\n\t\t} else {\n\t\t  switch (ch) {\n\t\t  case 110: out += \"\\n\"; break;\n\t\t  case 114: out += \"\\r\"; break;\n\t\t  case 120: out += String.fromCharCode(readHexChar(2)); break;\n\t\t  case 117: out += String.fromCharCode(readHexChar(4)); break;\n\t\t  case 85: out += String.fromCharCode(readHexChar(8)); break;\n\t\t  case 116: out += \"\\t\"; break;\n\t\t  case 98: out += \"\\b\"; break;\n\t\t  case 118: out += \"\\u000b\"; break;\n\t\t  case 102: out += \"\\f\"; break;\n\t\t  case 48: out += \"\\0\"; break;\n\t\t  case 13: if (input.charCodeAt(tokPos) === 10) ++tokPos;\n\t\t  case 10:\n\t\t\tif (options.locations) { tokLineStart = tokPos; ++tokCurLine; }\n\t\t\tbreak;\n\t\t  default: out += String.fromCharCode(ch); break;\n\t\t  }\n\t\t}\n\t  } else {\n\t\tif (ch === 13 || ch === 10 || ch === 8232 || ch === 8233) raise(tokStart, \"Unterminated string constant\");\n\t\tout += String.fromCharCode(ch);\n\t\t++tokPos;\n\t  }\n\t}\n  }\n\n  function readHexChar(len) {\n\tvar n = readInt(16, len);\n\tif (n === null) raise(tokStart, \"Bad character escape sequence\");\n\treturn n;\n  }\n\n  var containsEsc;\n\n  function readWord1() {\n\tcontainsEsc = false;\n\tvar word, first = true, start = tokPos;\n\tfor (;;) {\n\t  var ch = input.charCodeAt(tokPos);\n\t  if (isIdentifierChar(ch)) {\n\t\tif (containsEsc) word += input.charAt(tokPos);\n\t\t++tokPos;\n\t  } else if (ch === 92) {\n\t\tif (!containsEsc) word = input.slice(start, tokPos);\n\t\tcontainsEsc = true;\n\t\tif (input.charCodeAt(++tokPos) != 117)\n\t\t  raise(tokPos, \"Expecting Unicode escape sequence \\\\uXXXX\");\n\t\t++tokPos;\n\t\tvar esc = readHexChar(4);\n\t\tvar escStr = String.fromCharCode(esc);\n\t\tif (!escStr) raise(tokPos - 1, \"Invalid Unicode escape\");\n\t\tif (!(first ? isIdentifierStart(esc) : isIdentifierChar(esc)))\n\t\t  raise(tokPos - 4, \"Invalid Unicode escape\");\n\t\tword += escStr;\n\t  } else {\n\t\tbreak;\n\t  }\n\t  first = false;\n\t}\n\treturn containsEsc ? word : input.slice(start, tokPos);\n  }\n\n  function readWord() {\n\tvar word = readWord1();\n\tvar type = _name;\n\tif (!containsEsc && isKeyword(word))\n\t  type = keywordTypes[word];\n\treturn finishToken(type, word);\n  }\n\n  function next() {\n\tlastStart = tokStart;\n\tlastEnd = tokEnd;\n\tlastEndLoc = tokEndLoc;\n\treadToken();\n  }\n\n  function setStrict(strct) {\n\tstrict = strct;\n\ttokPos = tokStart;\n\tif (options.locations) {\n\t  while (tokPos < tokLineStart) {\n\t\ttokLineStart = input.lastIndexOf(\"\\n\", tokLineStart - 2) + 1;\n\t\t--tokCurLine;\n\t  }\n\t}\n\tskipSpace();\n\treadToken();\n  }\n\n  function node_t() {\n\tthis.type = null;\n\tthis.start = tokStart;\n\tthis.end = null;\n  }\n\n  function node_loc_t() {\n\tthis.start = tokStartLoc;\n\tthis.end = null;\n\tif (sourceFile !== null) this.source = sourceFile;\n  }\n\n  function startNode() {\n\tvar node = new node_t();\n\tif (options.locations)\n\t  node.loc = new node_loc_t();\n\tif (options.directSourceFile)\n\t  node.sourceFile = options.directSourceFile;\n\tif (options.ranges)\n\t  node.range = [tokStart, 0];\n\treturn node;\n  }\n\n  function startNodeFrom(other) {\n\tvar node = new node_t();\n\tnode.start = other.start;\n\tif (options.locations) {\n\t  node.loc = new node_loc_t();\n\t  node.loc.start = other.loc.start;\n\t}\n\tif (options.ranges)\n\t  node.range = [other.range[0], 0];\n\n\treturn node;\n  }\n\n  function finishNode(node, type) {\n\tnode.type = type;\n\tnode.end = lastEnd;\n\tif (options.locations)\n\t  node.loc.end = lastEndLoc;\n\tif (options.ranges)\n\t  node.range[1] = lastEnd;\n\treturn node;\n  }\n\n  function isUseStrict(stmt) {\n\treturn options.ecmaVersion >= 5 && stmt.type === \"ExpressionStatement\" &&\n\t  stmt.expression.type === \"Literal\" && stmt.expression.value === \"use strict\";\n  }\n\n  function eat(type) {\n\tif (tokType === type) {\n\t  next();\n\t  return true;\n\t}\n  }\n\n  function canInsertSemicolon() {\n\treturn !options.strictSemicolons &&\n\t  (tokType === _eof || tokType === _braceR || newline.test(input.slice(lastEnd, tokStart)));\n  }\n\n  function semicolon() {\n\tif (!eat(_semi) && !canInsertSemicolon()) unexpected();\n  }\n\n  function expect(type) {\n\tif (tokType === type) next();\n\telse unexpected();\n  }\n\n  function unexpected() {\n\traise(tokStart, \"Unexpected token\");\n  }\n\n  function checkLVal(expr) {\n\tif (expr.type !== \"Identifier\" && expr.type !== \"MemberExpression\")\n\t  raise(expr.start, \"Assigning to rvalue\");\n\tif (strict && expr.type === \"Identifier\" && isStrictBadIdWord(expr.name))\n\t  raise(expr.start, \"Assigning to \" + expr.name + \" in strict mode\");\n  }\n\n  function parseTopLevel(program) {\n\tlastStart = lastEnd = tokPos;\n\tif (options.locations) lastEndLoc = new line_loc_t;\n\tinFunction = strict = null;\n\tlabels = [];\n\treadToken();\n\n\tvar node = program || startNode(), first = true;\n\tif (!program) node.body = [];\n\twhile (tokType !== _eof) {\n\t  var stmt = parseStatement();\n\t  node.body.push(stmt);\n\t  if (first && isUseStrict(stmt)) setStrict(true);\n\t  first = false;\n\t}\n\treturn finishNode(node, \"Program\");\n  }\n\n  var loopLabel = {kind: \"loop\"}, switchLabel = {kind: \"switch\"};\n\n  function parseStatement() {\n\tif (tokType === _slash || tokType === _assign && tokVal == \"/=\")\n\t  readToken(true);\n\n\tvar starttype = tokType, node = startNode();\n\n\tswitch (starttype) {\n\tcase _break: case _continue:\n\t  next();\n\t  var isBreak = starttype === _break;\n\t  if (eat(_semi) || canInsertSemicolon()) node.label = null;\n\t  else if (tokType !== _name) unexpected();\n\t  else {\n\t\tnode.label = parseIdent();\n\t\tsemicolon();\n\t  }\n\n\t  for (var i = 0; i < labels.length; ++i) {\n\t\tvar lab = labels[i];\n\t\tif (node.label == null || lab.name === node.label.name) {\n\t\t  if (lab.kind != null && (isBreak || lab.kind === \"loop\")) break;\n\t\t  if (node.label && isBreak) break;\n\t\t}\n\t  }\n\t  if (i === labels.length) raise(node.start, \"Unsyntactic \" + starttype.keyword);\n\t  return finishNode(node, isBreak ? \"BreakStatement\" : \"ContinueStatement\");\n\n\tcase _debugger:\n\t  next();\n\t  semicolon();\n\t  return finishNode(node, \"DebuggerStatement\");\n\n\tcase _do:\n\t  next();\n\t  labels.push(loopLabel);\n\t  node.body = parseStatement();\n\t  labels.pop();\n\t  expect(_while);\n\t  node.test = parseParenExpression();\n\t  semicolon();\n\t  return finishNode(node, \"DoWhileStatement\");\n\n\tcase _for:\n\t  next();\n\t  labels.push(loopLabel);\n\t  expect(_parenL);\n\t  if (tokType === _semi) return parseFor(node, null);\n\t  if (tokType === _var) {\n\t\tvar init = startNode();\n\t\tnext();\n\t\tparseVar(init, true);\n\t\tfinishNode(init, \"VariableDeclaration\");\n\t\tif (init.declarations.length === 1 && eat(_in))\n\t\t  return parseForIn(node, init);\n\t\treturn parseFor(node, init);\n\t  }\n\t  var init = parseExpression(false, true);\n\t  if (eat(_in)) {checkLVal(init); return parseForIn(node, init);}\n\t  return parseFor(node, init);\n\n\tcase _function:\n\t  next();\n\t  return parseFunction(node, true);\n\n\tcase _if:\n\t  next();\n\t  node.test = parseParenExpression();\n\t  node.consequent = parseStatement();\n\t  node.alternate = eat(_else) ? parseStatement() : null;\n\t  return finishNode(node, \"IfStatement\");\n\n\tcase _return:\n\t  if (!inFunction && !options.allowReturnOutsideFunction)\n\t\traise(tokStart, \"'return' outside of function\");\n\t  next();\n\n\t  if (eat(_semi) || canInsertSemicolon()) node.argument = null;\n\t  else { node.argument = parseExpression(); semicolon(); }\n\t  return finishNode(node, \"ReturnStatement\");\n\n\tcase _switch:\n\t  next();\n\t  node.discriminant = parseParenExpression();\n\t  node.cases = [];\n\t  expect(_braceL);\n\t  labels.push(switchLabel);\n\n\t  for (var cur, sawDefault; tokType != _braceR;) {\n\t\tif (tokType === _case || tokType === _default) {\n\t\t  var isCase = tokType === _case;\n\t\t  if (cur) finishNode(cur, \"SwitchCase\");\n\t\t  node.cases.push(cur = startNode());\n\t\t  cur.consequent = [];\n\t\t  next();\n\t\t  if (isCase) cur.test = parseExpression();\n\t\t  else {\n\t\t\tif (sawDefault) raise(lastStart, \"Multiple default clauses\"); sawDefault = true;\n\t\t\tcur.test = null;\n\t\t  }\n\t\t  expect(_colon);\n\t\t} else {\n\t\t  if (!cur) unexpected();\n\t\t  cur.consequent.push(parseStatement());\n\t\t}\n\t  }\n\t  if (cur) finishNode(cur, \"SwitchCase\");\n\t  next();\n\t  labels.pop();\n\t  return finishNode(node, \"SwitchStatement\");\n\n\tcase _throw:\n\t  next();\n\t  if (newline.test(input.slice(lastEnd, tokStart)))\n\t\traise(lastEnd, \"Illegal newline after throw\");\n\t  node.argument = parseExpression();\n\t  semicolon();\n\t  return finishNode(node, \"ThrowStatement\");\n\n\tcase _try:\n\t  next();\n\t  node.block = parseBlock();\n\t  node.handler = null;\n\t  if (tokType === _catch) {\n\t\tvar clause = startNode();\n\t\tnext();\n\t\texpect(_parenL);\n\t\tclause.param = parseIdent();\n\t\tif (strict && isStrictBadIdWord(clause.param.name))\n\t\t  raise(clause.param.start, \"Binding \" + clause.param.name + \" in strict mode\");\n\t\texpect(_parenR);\n\t\tclause.guard = null;\n\t\tclause.body = parseBlock();\n\t\tnode.handler = finishNode(clause, \"CatchClause\");\n\t  }\n\t  node.guardedHandlers = empty;\n\t  node.finalizer = eat(_finally) ? parseBlock() : null;\n\t  if (!node.handler && !node.finalizer)\n\t\traise(node.start, \"Missing catch or finally clause\");\n\t  return finishNode(node, \"TryStatement\");\n\n\tcase _var:\n\t  next();\n\t  parseVar(node);\n\t  semicolon();\n\t  return finishNode(node, \"VariableDeclaration\");\n\n\tcase _while:\n\t  next();\n\t  node.test = parseParenExpression();\n\t  labels.push(loopLabel);\n\t  node.body = parseStatement();\n\t  labels.pop();\n\t  return finishNode(node, \"WhileStatement\");\n\n\tcase _with:\n\t  if (strict) raise(tokStart, \"'with' in strict mode\");\n\t  next();\n\t  node.object = parseParenExpression();\n\t  node.body = parseStatement();\n\t  return finishNode(node, \"WithStatement\");\n\n\tcase _braceL:\n\t  return parseBlock();\n\n\tcase _semi:\n\t  next();\n\t  return finishNode(node, \"EmptyStatement\");\n\n\tdefault:\n\t  var maybeName = tokVal, expr = parseExpression();\n\t  if (starttype === _name && expr.type === \"Identifier\" && eat(_colon)) {\n\t\tfor (var i = 0; i < labels.length; ++i)\n\t\t  if (labels[i].name === maybeName) raise(expr.start, \"Label '\" + maybeName + \"' is already declared\");\n\t\tvar kind = tokType.isLoop ? \"loop\" : tokType === _switch ? \"switch\" : null;\n\t\tlabels.push({name: maybeName, kind: kind});\n\t\tnode.body = parseStatement();\n\t\tlabels.pop();\n\t\tnode.label = expr;\n\t\treturn finishNode(node, \"LabeledStatement\");\n\t  } else {\n\t\tnode.expression = expr;\n\t\tsemicolon();\n\t\treturn finishNode(node, \"ExpressionStatement\");\n\t  }\n\t}\n  }\n\n  function parseParenExpression() {\n\texpect(_parenL);\n\tvar val = parseExpression();\n\texpect(_parenR);\n\treturn val;\n  }\n\n  function parseBlock(allowStrict) {\n\tvar node = startNode(), first = true, strict = false, oldStrict;\n\tnode.body = [];\n\texpect(_braceL);\n\twhile (!eat(_braceR)) {\n\t  var stmt = parseStatement();\n\t  node.body.push(stmt);\n\t  if (first && allowStrict && isUseStrict(stmt)) {\n\t\toldStrict = strict;\n\t\tsetStrict(strict = true);\n\t  }\n\t  first = false;\n\t}\n\tif (strict && !oldStrict) setStrict(false);\n\treturn finishNode(node, \"BlockStatement\");\n  }\n\n  function parseFor(node, init) {\n\tnode.init = init;\n\texpect(_semi);\n\tnode.test = tokType === _semi ? null : parseExpression();\n\texpect(_semi);\n\tnode.update = tokType === _parenR ? null : parseExpression();\n\texpect(_parenR);\n\tnode.body = parseStatement();\n\tlabels.pop();\n\treturn finishNode(node, \"ForStatement\");\n  }\n\n  function parseForIn(node, init) {\n\tnode.left = init;\n\tnode.right = parseExpression();\n\texpect(_parenR);\n\tnode.body = parseStatement();\n\tlabels.pop();\n\treturn finishNode(node, \"ForInStatement\");\n  }\n\n  function parseVar(node, noIn) {\n\tnode.declarations = [];\n\tnode.kind = \"var\";\n\tfor (;;) {\n\t  var decl = startNode();\n\t  decl.id = parseIdent();\n\t  if (strict && isStrictBadIdWord(decl.id.name))\n\t\traise(decl.id.start, \"Binding \" + decl.id.name + \" in strict mode\");\n\t  decl.init = eat(_eq) ? parseExpression(true, noIn) : null;\n\t  node.declarations.push(finishNode(decl, \"VariableDeclarator\"));\n\t  if (!eat(_comma)) break;\n\t}\n\treturn node;\n  }\n\n  function parseExpression(noComma, noIn) {\n\tvar expr = parseMaybeAssign(noIn);\n\tif (!noComma && tokType === _comma) {\n\t  var node = startNodeFrom(expr);\n\t  node.expressions = [expr];\n\t  while (eat(_comma)) node.expressions.push(parseMaybeAssign(noIn));\n\t  return finishNode(node, \"SequenceExpression\");\n\t}\n\treturn expr;\n  }\n\n  function parseMaybeAssign(noIn) {\n\tvar left = parseMaybeConditional(noIn);\n\tif (tokType.isAssign) {\n\t  var node = startNodeFrom(left);\n\t  node.operator = tokVal;\n\t  node.left = left;\n\t  next();\n\t  node.right = parseMaybeAssign(noIn);\n\t  checkLVal(left);\n\t  return finishNode(node, \"AssignmentExpression\");\n\t}\n\treturn left;\n  }\n\n  function parseMaybeConditional(noIn) {\n\tvar expr = parseExprOps(noIn);\n\tif (eat(_question)) {\n\t  var node = startNodeFrom(expr);\n\t  node.test = expr;\n\t  node.consequent = parseExpression(true);\n\t  expect(_colon);\n\t  node.alternate = parseExpression(true, noIn);\n\t  return finishNode(node, \"ConditionalExpression\");\n\t}\n\treturn expr;\n  }\n\n  function parseExprOps(noIn) {\n\treturn parseExprOp(parseMaybeUnary(), -1, noIn);\n  }\n\n  function parseExprOp(left, minPrec, noIn) {\n\tvar prec = tokType.binop;\n\tif (prec != null && (!noIn || tokType !== _in)) {\n\t  if (prec > minPrec) {\n\t\tvar node = startNodeFrom(left);\n\t\tnode.left = left;\n\t\tnode.operator = tokVal;\n\t\tvar op = tokType;\n\t\tnext();\n\t\tnode.right = parseExprOp(parseMaybeUnary(), prec, noIn);\n\t\tvar exprNode = finishNode(node, (op === _logicalOR || op === _logicalAND) ? \"LogicalExpression\" : \"BinaryExpression\");\n\t\treturn parseExprOp(exprNode, minPrec, noIn);\n\t  }\n\t}\n\treturn left;\n  }\n\n  function parseMaybeUnary() {\n\tif (tokType.prefix) {\n\t  var node = startNode(), update = tokType.isUpdate;\n\t  node.operator = tokVal;\n\t  node.prefix = true;\n\t  tokRegexpAllowed = true;\n\t  next();\n\t  node.argument = parseMaybeUnary();\n\t  if (update) checkLVal(node.argument);\n\t  else if (strict && node.operator === \"delete\" &&\n\t\t\t   node.argument.type === \"Identifier\")\n\t\traise(node.start, \"Deleting local variable in strict mode\");\n\t  return finishNode(node, update ? \"UpdateExpression\" : \"UnaryExpression\");\n\t}\n\tvar expr = parseExprSubscripts();\n\twhile (tokType.postfix && !canInsertSemicolon()) {\n\t  var node = startNodeFrom(expr);\n\t  node.operator = tokVal;\n\t  node.prefix = false;\n\t  node.argument = expr;\n\t  checkLVal(expr);\n\t  next();\n\t  expr = finishNode(node, \"UpdateExpression\");\n\t}\n\treturn expr;\n  }\n\n  function parseExprSubscripts() {\n\treturn parseSubscripts(parseExprAtom());\n  }\n\n  function parseSubscripts(base, noCalls) {\n\tif (eat(_dot)) {\n\t  var node = startNodeFrom(base);\n\t  node.object = base;\n\t  node.property = parseIdent(true);\n\t  node.computed = false;\n\t  return parseSubscripts(finishNode(node, \"MemberExpression\"), noCalls);\n\t} else if (eat(_bracketL)) {\n\t  var node = startNodeFrom(base);\n\t  node.object = base;\n\t  node.property = parseExpression();\n\t  node.computed = true;\n\t  expect(_bracketR);\n\t  return parseSubscripts(finishNode(node, \"MemberExpression\"), noCalls);\n\t} else if (!noCalls && eat(_parenL)) {\n\t  var node = startNodeFrom(base);\n\t  node.callee = base;\n\t  node.arguments = parseExprList(_parenR, false);\n\t  return parseSubscripts(finishNode(node, \"CallExpression\"), noCalls);\n\t} else return base;\n  }\n\n  function parseExprAtom() {\n\tswitch (tokType) {\n\tcase _this:\n\t  var node = startNode();\n\t  next();\n\t  return finishNode(node, \"ThisExpression\");\n\tcase _name:\n\t  return parseIdent();\n\tcase _num: case _string: case _regexp:\n\t  var node = startNode();\n\t  node.value = tokVal;\n\t  node.raw = input.slice(tokStart, tokEnd);\n\t  next();\n\t  return finishNode(node, \"Literal\");\n\n\tcase _null: case _true: case _false:\n\t  var node = startNode();\n\t  node.value = tokType.atomValue;\n\t  node.raw = tokType.keyword;\n\t  next();\n\t  return finishNode(node, \"Literal\");\n\n\tcase _parenL:\n\t  var tokStartLoc1 = tokStartLoc, tokStart1 = tokStart;\n\t  next();\n\t  var val = parseExpression();\n\t  val.start = tokStart1;\n\t  val.end = tokEnd;\n\t  if (options.locations) {\n\t\tval.loc.start = tokStartLoc1;\n\t\tval.loc.end = tokEndLoc;\n\t  }\n\t  if (options.ranges)\n\t\tval.range = [tokStart1, tokEnd];\n\t  expect(_parenR);\n\t  return val;\n\n\tcase _bracketL:\n\t  var node = startNode();\n\t  next();\n\t  node.elements = parseExprList(_bracketR, true, true);\n\t  return finishNode(node, \"ArrayExpression\");\n\n\tcase _braceL:\n\t  return parseObj();\n\n\tcase _function:\n\t  var node = startNode();\n\t  next();\n\t  return parseFunction(node, false);\n\n\tcase _new:\n\t  return parseNew();\n\n\tdefault:\n\t  unexpected();\n\t}\n  }\n\n  function parseNew() {\n\tvar node = startNode();\n\tnext();\n\tnode.callee = parseSubscripts(parseExprAtom(), true);\n\tif (eat(_parenL)) node.arguments = parseExprList(_parenR, false);\n\telse node.arguments = empty;\n\treturn finishNode(node, \"NewExpression\");\n  }\n\n  function parseObj() {\n\tvar node = startNode(), first = true, sawGetSet = false;\n\tnode.properties = [];\n\tnext();\n\twhile (!eat(_braceR)) {\n\t  if (!first) {\n\t\texpect(_comma);\n\t\tif (options.allowTrailingCommas && eat(_braceR)) break;\n\t  } else first = false;\n\n\t  var prop = {key: parsePropertyName()}, isGetSet = false, kind;\n\t  if (eat(_colon)) {\n\t\tprop.value = parseExpression(true);\n\t\tkind = prop.kind = \"init\";\n\t  } else if (options.ecmaVersion >= 5 && prop.key.type === \"Identifier\" &&\n\t\t\t\t (prop.key.name === \"get\" || prop.key.name === \"set\")) {\n\t\tisGetSet = sawGetSet = true;\n\t\tkind = prop.kind = prop.key.name;\n\t\tprop.key = parsePropertyName();\n\t\tif (tokType !== _parenL) unexpected();\n\t\tprop.value = parseFunction(startNode(), false);\n\t  } else unexpected();\n\n\t  if (prop.key.type === \"Identifier\" && (strict || sawGetSet)) {\n\t\tfor (var i = 0; i < node.properties.length; ++i) {\n\t\t  var other = node.properties[i];\n\t\t  if (other.key.name === prop.key.name) {\n\t\t\tvar conflict = kind == other.kind || isGetSet && other.kind === \"init\" ||\n\t\t\t  kind === \"init\" && (other.kind === \"get\" || other.kind === \"set\");\n\t\t\tif (conflict && !strict && kind === \"init\" && other.kind === \"init\") conflict = false;\n\t\t\tif (conflict) raise(prop.key.start, \"Redefinition of property\");\n\t\t  }\n\t\t}\n\t  }\n\t  node.properties.push(prop);\n\t}\n\treturn finishNode(node, \"ObjectExpression\");\n  }\n\n  function parsePropertyName() {\n\tif (tokType === _num || tokType === _string) return parseExprAtom();\n\treturn parseIdent(true);\n  }\n\n  function parseFunction(node, isStatement) {\n\tif (tokType === _name) node.id = parseIdent();\n\telse if (isStatement) unexpected();\n\telse node.id = null;\n\tnode.params = [];\n\tvar first = true;\n\texpect(_parenL);\n\twhile (!eat(_parenR)) {\n\t  if (!first) expect(_comma); else first = false;\n\t  node.params.push(parseIdent());\n\t}\n\n\tvar oldInFunc = inFunction, oldLabels = labels;\n\tinFunction = true; labels = [];\n\tnode.body = parseBlock(true);\n\tinFunction = oldInFunc; labels = oldLabels;\n\n\tif (strict || node.body.body.length && isUseStrict(node.body.body[0])) {\n\t  for (var i = node.id ? -1 : 0; i < node.params.length; ++i) {\n\t\tvar id = i < 0 ? node.id : node.params[i];\n\t\tif (isStrictReservedWord(id.name) || isStrictBadIdWord(id.name))\n\t\t  raise(id.start, \"Defining '\" + id.name + \"' in strict mode\");\n\t\tif (i >= 0) for (var j = 0; j < i; ++j) if (id.name === node.params[j].name)\n\t\t  raise(id.start, \"Argument name clash in strict mode\");\n\t  }\n\t}\n\n\treturn finishNode(node, isStatement ? \"FunctionDeclaration\" : \"FunctionExpression\");\n  }\n\n  function parseExprList(close, allowTrailingComma, allowEmpty) {\n\tvar elts = [], first = true;\n\twhile (!eat(close)) {\n\t  if (!first) {\n\t\texpect(_comma);\n\t\tif (allowTrailingComma && options.allowTrailingCommas && eat(close)) break;\n\t  } else first = false;\n\n\t  if (allowEmpty && tokType === _comma) elts.push(null);\n\t  else elts.push(parseExpression(true));\n\t}\n\treturn elts;\n  }\n\n  function parseIdent(liberal) {\n\tvar node = startNode();\n\tif (liberal && options.forbidReserved == \"everywhere\") liberal = false;\n\tif (tokType === _name) {\n\t  if (!liberal &&\n\t\t  (options.forbidReserved &&\n\t\t   (options.ecmaVersion === 3 ? isReservedWord3 : isReservedWord5)(tokVal) ||\n\t\t   strict && isStrictReservedWord(tokVal)) &&\n\t\t  input.slice(tokStart, tokEnd).indexOf(\"\\\\\") == -1)\n\t\traise(tokStart, \"The keyword '\" + tokVal + \"' is reserved\");\n\t  node.name = tokVal;\n\t} else if (liberal && tokType.keyword) {\n\t  node.name = tokType.keyword;\n\t} else {\n\t  unexpected();\n\t}\n\ttokRegexpAllowed = false;\n\tnext();\n\treturn finishNode(node, \"Identifier\");\n  }\n\n});\n\n\t\tif (!acorn.version)\n\t\t\tacorn = null;\n\t}\n\n\tfunction parse(code, options) {\n\t\treturn (global.acorn || acorn).parse(code, options);\n\t}\n\n\tvar binaryOperators = {\n\t\t'+': '__add',\n\t\t'-': '__subtract',\n\t\t'*': '__multiply',\n\t\t'/': '__divide',\n\t\t'%': '__modulo',\n\t\t'==': '__equals',\n\t\t'!=': '__equals'\n\t};\n\n\tvar unaryOperators = {\n\t\t'-': '__negate',\n\t\t'+': '__self'\n\t};\n\n\tvar fields = Base.each(\n\t\t['add', 'subtract', 'multiply', 'divide', 'modulo', 'equals', 'negate'],\n\t\tfunction(name) {\n\t\t\tthis['__' + name] = '#' + name;\n\t\t},\n\t\t{\n\t\t\t__self: function() {\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}\n\t);\n\tPoint.inject(fields);\n\tSize.inject(fields);\n\tColor.inject(fields);\n\n\tfunction __$__(left, operator, right) {\n\t\tvar handler = binaryOperators[operator];\n\t\tif (left && left[handler]) {\n\t\t\tvar res = left[handler](right);\n\t\t\treturn operator === '!=' ? !res : res;\n\t\t}\n\t\tswitch (operator) {\n\t\tcase '+': return left + right;\n\t\tcase '-': return left - right;\n\t\tcase '*': return left * right;\n\t\tcase '/': return left / right;\n\t\tcase '%': return left % right;\n\t\tcase '==': return left == right;\n\t\tcase '!=': return left != right;\n\t\t}\n\t}\n\n\tfunction $__(operator, value) {\n\t\tvar handler = unaryOperators[operator];\n\t\tif (value && value[handler])\n\t\t\treturn value[handler]();\n\t\tswitch (operator) {\n\t\tcase '+': return +value;\n\t\tcase '-': return -value;\n\t\t}\n\t}\n\n\tfunction compile(code, options) {\n\t\tif (!code)\n\t\t\treturn '';\n\t\toptions = options || {};\n\n\t\tvar insertions = [];\n\n\t\tfunction getOffset(offset) {\n\t\t\tfor (var i = 0, l = insertions.length; i < l; i++) {\n\t\t\t\tvar insertion = insertions[i];\n\t\t\t\tif (insertion[0] >= offset)\n\t\t\t\t\tbreak;\n\t\t\t\toffset += insertion[1];\n\t\t\t}\n\t\t\treturn offset;\n\t\t}\n\n\t\tfunction getCode(node) {\n\t\t\treturn code.substring(getOffset(node.range[0]),\n\t\t\t\t\tgetOffset(node.range[1]));\n\t\t}\n\n\t\tfunction getBetween(left, right) {\n\t\t\treturn code.substring(getOffset(left.range[1]),\n\t\t\t\t\tgetOffset(right.range[0]));\n\t\t}\n\n\t\tfunction replaceCode(node, str) {\n\t\t\tvar start = getOffset(node.range[0]),\n\t\t\t\tend = getOffset(node.range[1]),\n\t\t\t\tinsert = 0;\n\t\t\tfor (var i = insertions.length - 1; i >= 0; i--) {\n\t\t\t\tif (start > insertions[i][0]) {\n\t\t\t\t\tinsert = i + 1;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tinsertions.splice(insert, 0, [start, str.length - end + start]);\n\t\t\tcode = code.substring(0, start) + str + code.substring(end);\n\t\t}\n\n\t\tfunction walkAST(node, parent) {\n\t\t\tif (!node)\n\t\t\t\treturn;\n\t\t\tfor (var key in node) {\n\t\t\t\tif (key === 'range' || key === 'loc')\n\t\t\t\t\tcontinue;\n\t\t\t\tvar value = node[key];\n\t\t\t\tif (Array.isArray(value)) {\n\t\t\t\t\tfor (var i = 0, l = value.length; i < l; i++)\n\t\t\t\t\t\twalkAST(value[i], node);\n\t\t\t\t} else if (value && typeof value === 'object') {\n\t\t\t\t\twalkAST(value, node);\n\t\t\t\t}\n\t\t\t}\n\t\t\tswitch (node.type) {\n\t\t\tcase 'UnaryExpression':\n\t\t\t\tif (node.operator in unaryOperators\n\t\t\t\t\t\t&& node.argument.type !== 'Literal') {\n\t\t\t\t\tvar arg = getCode(node.argument);\n\t\t\t\t\treplaceCode(node, '$__(\"' + node.operator + '\", '\n\t\t\t\t\t\t\t+ arg + ')');\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'BinaryExpression':\n\t\t\t\tif (node.operator in binaryOperators\n\t\t\t\t\t\t&& node.left.type !== 'Literal') {\n\t\t\t\t\tvar left = getCode(node.left),\n\t\t\t\t\t\tright = getCode(node.right),\n\t\t\t\t\t\tbetween = getBetween(node.left, node.right),\n\t\t\t\t\t\toperator = node.operator;\n\t\t\t\t\treplaceCode(node, '__$__(' + left + ','\n\t\t\t\t\t\t\t+ between.replace(new RegExp('\\\\' + operator),\n\t\t\t\t\t\t\t\t'\"' + operator + '\"')\n\t\t\t\t\t\t\t+ ', ' + right + ')');\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'UpdateExpression':\n\t\t\tcase 'AssignmentExpression':\n\t\t\t\tvar parentType = parent && parent.type;\n\t\t\t\tif (!(\n\t\t\t\t\t\tparentType === 'ForStatement'\n\t\t\t\t\t\t|| parentType === 'BinaryExpression'\n\t\t\t\t\t\t\t&& /^[=!<>]/.test(parent.operator)\n\t\t\t\t\t\t|| parentType === 'MemberExpression' && parent.computed\n\t\t\t\t)) {\n\t\t\t\t\tif (node.type === 'UpdateExpression') {\n\t\t\t\t\t\tvar arg = getCode(node.argument),\n\t\t\t\t\t\t\texp = '__$__(' + arg + ', \"' + node.operator[0]\n\t\t\t\t\t\t\t\t\t+ '\", 1)',\n\t\t\t\t\t\t\tstr = arg + ' = ' + exp;\n\t\t\t\t\t\tif (!node.prefix\n\t\t\t\t\t\t\t\t&& (parentType === 'AssignmentExpression'\n\t\t\t\t\t\t\t\t\t|| parentType === 'VariableDeclarator')) {\n\t\t\t\t\t\t\tif (getCode(parent.left || parent.id) === arg)\n\t\t\t\t\t\t\t\tstr = exp;\n\t\t\t\t\t\t\tstr = arg + '; ' + str;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treplaceCode(node, str);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (/^.=$/.test(node.operator)\n\t\t\t\t\t\t\t\t&& node.left.type !== 'Literal') {\n\t\t\t\t\t\t\tvar left = getCode(node.left),\n\t\t\t\t\t\t\t\tright = getCode(node.right),\n\t\t\t\t\t\t\t\texp = left + ' = __$__(' + left + ', \"'\n\t\t\t\t\t\t\t\t\t+ node.operator[0] + '\", ' + right + ')';\n\t\t\t\t\t\t\treplaceCode(node, /^\\(.*\\)$/.test(getCode(node))\n\t\t\t\t\t\t\t\t\t? '(' + exp + ')' : exp);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'ExportDefaultDeclaration':\n\t\t\t\treplaceCode({\n\t\t\t\t\trange: [node.start, node.declaration.start]\n\t\t\t\t}, 'module.exports = ');\n\t\t\t\tbreak;\n\t\t\tcase 'ExportNamedDeclaration':\n\t\t\t\tvar declaration = node.declaration;\n\t\t\t\tvar specifiers = node.specifiers;\n\t\t\t\tif (declaration) {\n\t\t\t\t\tvar declarations = declaration.declarations;\n\t\t\t\t\tif (declarations) {\n\t\t\t\t\t\tdeclarations.forEach(function(dec) {\n\t\t\t\t\t\t\treplaceCode(dec, 'module.exports.' + getCode(dec));\n\t\t\t\t\t\t});\n\t\t\t\t\t\treplaceCode({\n\t\t\t\t\t\t\trange: [\n\t\t\t\t\t\t\t\tnode.start,\n\t\t\t\t\t\t\t\tdeclaration.start + declaration.kind.length\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t}, '');\n\t\t\t\t\t}\n\t\t\t\t} else if (specifiers) {\n\t\t\t\t\tvar exports = specifiers.map(function(specifier) {\n\t\t\t\t\t\tvar name = getCode(specifier);\n\t\t\t\t\t\treturn 'module.exports.' + name + ' = ' + name + '; ';\n\t\t\t\t\t}).join('');\n\t\t\t\t\tif (exports) {\n\t\t\t\t\t\treplaceCode(node, exports);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tfunction encodeVLQ(value) {\n\t\t\tvar res = '',\n\t\t\t\tbase64 = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';\n\t\t\tvalue = (Math.abs(value) << 1) + (value < 0 ? 1 : 0);\n\t\t\twhile (value || !res) {\n\t\t\t\tvar next = value & (32 - 1);\n\t\t\t\tvalue >>= 5;\n\t\t\t\tif (value)\n\t\t\t\t\tnext |= 32;\n\t\t\t\tres += base64[next];\n\t\t\t}\n\t\t\treturn res;\n\t\t}\n\n\t\tvar url = options.url || '',\n\t\t\tagent = paper.agent,\n\t\t\tversion = agent.versionNumber,\n\t\t\toffsetCode = false,\n\t\t\tsourceMaps = options.sourceMaps,\n\t\t\tsource = options.source || code,\n\t\t\tlineBreaks = /\\r\\n|\\n|\\r/mg,\n\t\t\toffset = options.offset || 0,\n\t\t\tmap;\n\t\tif (sourceMaps && (agent.chrome && version >= 30\n\t\t\t\t|| agent.webkit && version >= 537.76\n\t\t\t\t|| agent.firefox && version >= 23\n\t\t\t\t|| agent.node)) {\n\t\t\tif (agent.node) {\n\t\t\t\toffset -= 2;\n\t\t\t} else if (window && url && !window.location.href.indexOf(url)) {\n\t\t\t\tvar html = document.getElementsByTagName('html')[0].innerHTML;\n\t\t\t\toffset = html.substr(0, html.indexOf(code) + 1).match(\n\t\t\t\t\t\tlineBreaks).length + 1;\n\t\t\t}\n\t\t\toffsetCode = offset > 0 && !(\n\t\t\t\t\tagent.chrome && version >= 36 ||\n\t\t\t\t\tagent.safari && version >= 600 ||\n\t\t\t\t\tagent.firefox && version >= 40 ||\n\t\t\t\t\tagent.node);\n\t\t\tvar mappings = ['AA' + encodeVLQ(offsetCode ? 0 : offset) + 'A'];\n\t\t\tmappings.length = (code.match(lineBreaks) || []).length + 1\n\t\t\t\t\t+ (offsetCode ? offset : 0);\n\t\t\tmap = {\n\t\t\t\tversion: 3,\n\t\t\t\tfile: url,\n\t\t\t\tnames:[],\n\t\t\t\tmappings: mappings.join(';AACA'),\n\t\t\t\tsourceRoot: '',\n\t\t\t\tsources: [url],\n\t\t\t\tsourcesContent: [source]\n\t\t\t};\n\t\t}\n\t\twalkAST(parse(code, {\n\t\t\tranges: true,\n\t\t\tpreserveParens: true,\n\t\t\tsourceType: 'module'\n\t\t}));\n\t\tif (map) {\n\t\t\tif (offsetCode) {\n\t\t\t\tcode = new Array(offset + 1).join('\\n') + code;\n\t\t\t}\n\t\t\tif (/^(inline|both)$/.test(sourceMaps)) {\n\t\t\t\tcode += \"\\n//# sourceMappingURL=data:application/json;base64,\"\n\t\t\t\t\t\t+ self.btoa(unescape(encodeURIComponent(\n\t\t\t\t\t\t\tJSON.stringify(map))));\n\t\t\t}\n\t\t\tcode += \"\\n//# sourceURL=\" + (url || 'paperscript');\n\t\t}\n\t\treturn {\n\t\t\turl: url,\n\t\t\tsource: source,\n\t\t\tcode: code,\n\t\t\tmap: map\n\t\t};\n\t}\n\n\tfunction execute(code, scope, options) {\n\t\tpaper = scope;\n\t\tvar view = scope.getView(),\n\t\t\ttool = /\\btool\\.\\w+|\\s+on(?:Key|Mouse)(?:Up|Down|Move|Drag)\\b/\n\t\t\t\t\t.test(code) && !/\\bnew\\s+Tool\\b/.test(code)\n\t\t\t\t\t\t? new Tool() : null,\n\t\t\ttoolHandlers = tool ? tool._events : [],\n\t\t\thandlers = ['onFrame', 'onResize'].concat(toolHandlers),\n\t\t\tparams = [],\n\t\t\targs = [],\n\t\t\tfunc,\n\t\t\tcompiled = typeof code === 'object' ? code : compile(code, options);\n\t\tcode = compiled.code;\n\t\tfunction expose(scope, hidden) {\n\t\t\tfor (var key in scope) {\n\t\t\t\tif ((hidden || !/^_/.test(key)) && new RegExp('([\\\\b\\\\s\\\\W]|^)'\n\t\t\t\t\t\t+ key.replace(/\\$/g, '\\\\$') + '\\\\b').test(code)) {\n\t\t\t\t\tparams.push(key);\n\t\t\t\t\targs.push(scope[key]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\texpose({ __$__: __$__, $__: $__, paper: scope, view: view, tool: tool },\n\t\t\t\ttrue);\n\t\texpose(scope);\n\t\tcode = 'var module = { exports: {} }; ' + code;\n\t\tvar exports = Base.each(handlers, function(key) {\n\t\t\tif (new RegExp('\\\\s+' + key + '\\\\b').test(code)) {\n\t\t\t\tparams.push(key);\n\t\t\t\tthis.push('module.exports.' + key + ' = ' + key + ';');\n\t\t\t}\n\t\t}, []).join('\\n');\n\t\tif (exports) {\n\t\t\tcode += '\\n' + exports;\n\t\t}\n\t\tcode += '\\nreturn module.exports;';\n\t\tvar agent = paper.agent;\n\t\tif (document && (agent.chrome\n\t\t\t\t|| agent.firefox && agent.versionNumber < 40)) {\n\t\t\tvar script = document.createElement('script'),\n\t\t\t\thead = document.head || document.getElementsByTagName('head')[0];\n\t\t\tif (agent.firefox)\n\t\t\t\tcode = '\\n' + code;\n\t\t\tscript.appendChild(document.createTextNode(\n\t\t\t\t'document.__paperscript__ = function(' + params + ') {' +\n\t\t\t\t\tcode +\n\t\t\t\t'\\n}'\n\t\t\t));\n\t\t\thead.appendChild(script);\n\t\t\tfunc = document.__paperscript__;\n\t\t\tdelete document.__paperscript__;\n\t\t\thead.removeChild(script);\n\t\t} else {\n\t\t\tfunc = Function(params, code);\n\t\t}\n\t\tvar exports = func && func.apply(scope, args);\n\t\tvar obj = exports || {};\n\t\tBase.each(toolHandlers, function(key) {\n\t\t\tvar value = obj[key];\n\t\t\tif (value)\n\t\t\t\ttool[key] = value;\n\t\t});\n\t\tif (view) {\n\t\t\tif (obj.onResize)\n\t\t\t\tview.setOnResize(obj.onResize);\n\t\t\tview.emit('resize', {\n\t\t\t\tsize: view.size,\n\t\t\t\tdelta: new Point()\n\t\t\t});\n\t\t\tif (obj.onFrame)\n\t\t\t\tview.setOnFrame(obj.onFrame);\n\t\t\tview.requestUpdate();\n\t\t}\n\t\treturn exports;\n\t}\n\n\tfunction loadScript(script) {\n\t\tif (/^text\\/(?:x-|)paperscript$/.test(script.type)\n\t\t\t\t&& PaperScope.getAttribute(script, 'ignore') !== 'true') {\n\t\t\tvar canvasId = PaperScope.getAttribute(script, 'canvas'),\n\t\t\t\tcanvas = document.getElementById(canvasId),\n\t\t\t\tsrc = script.src || script.getAttribute('data-src'),\n\t\t\t\tasync = PaperScope.hasAttribute(script, 'async'),\n\t\t\t\tscopeAttribute = 'data-paper-scope';\n\t\t\tif (!canvas)\n\t\t\t\tthrow new Error('Unable to find canvas with id \"'\n\t\t\t\t\t\t+ canvasId + '\"');\n\t\t\tvar scope = PaperScope.get(canvas.getAttribute(scopeAttribute))\n\t\t\t\t\t\t|| new PaperScope().setup(canvas);\n\t\t\tcanvas.setAttribute(scopeAttribute, scope._id);\n\t\t\tif (src) {\n\t\t\t\tHttp.request({\n\t\t\t\t\turl: src,\n\t\t\t\t\tasync: async,\n\t\t\t\t\tmimeType: 'text/plain',\n\t\t\t\t\tonLoad: function(code) {\n\t\t\t\t\t\texecute(code, scope, src);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\texecute(script.innerHTML, scope, script.baseURI);\n\t\t\t}\n\t\t\tscript.setAttribute('data-paper-ignore', 'true');\n\t\t\treturn scope;\n\t\t}\n\t}\n\n\tfunction loadAll() {\n\t\tBase.each(document && document.getElementsByTagName('script'),\n\t\t\t\tloadScript);\n\t}\n\n\tfunction load(script) {\n\t\treturn script ? loadScript(script) : loadAll();\n\t}\n\n\tif (window) {\n\t\tif (document.readyState === 'complete') {\n\t\t\tsetTimeout(loadAll);\n\t\t} else {\n\t\t\tDomEvent.add(window, { load: loadAll });\n\t\t}\n\t}\n\n\treturn {\n\t\tcompile: compile,\n\t\texecute: execute,\n\t\tload: load,\n\t\tparse: parse,\n\t\tcalculateBinary: __$__,\n\t\tcalculateUnary: $__\n\t};\n\n}.call(this);\n\nvar paper = new (PaperScope.inject(Base.exports, {\n\tBase: Base,\n\tNumerical: Numerical,\n\tKey: Key,\n\tDomEvent: DomEvent,\n\tDomElement: DomElement,\n\tdocument: document,\n\twindow: window,\n\tSymbol: SymbolDefinition,\n\tPlacedSymbol: SymbolItem\n}))();\n\nif (paper.agent.node) {\n\trequire('./node/extend.js')(paper);\n}\n\nif (typeof define === 'function' && define.amd) {\n\tdefine('paper', paper);\n} else if (typeof module === 'object' && module) {\n\tmodule.exports = paper;\n}\n\nreturn paper;\n}.call(this, typeof self === 'object' ? self : null);\n"]}]}