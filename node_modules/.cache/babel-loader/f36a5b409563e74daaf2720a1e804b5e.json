{"remainingRequest":"D:\\GitHub\\Vectory\\node_modules\\babel-loader\\lib\\index.js!D:\\GitHub\\Vectory\\node_modules\\eslint-loader\\index.js??ref--13-0!D:\\GitHub\\Vectory\\src\\store.js","dependencies":[{"path":"D:\\GitHub\\Vectory\\src\\store.js","mtime":1555925752647},{"path":"D:\\GitHub\\Vectory\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\GitHub\\Vectory\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\GitHub\\Vectory\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.array.find-index\";\nimport Vue from 'vue';\nimport Vuex from 'vuex';\nimport { bus } from '@/main.js';\nVue.use(Vuex);\nexport default new Vuex.Store({\n  state: {\n    ACTIVE: 'select',\n    TOOLSELECT: null,\n    TOOLPOINTER: null,\n    TOOLPEN: null,\n    TOOLCIRCLE: null,\n    TOOLSHAPEBUILDER: null,\n    TOOLLINE: null,\n    OBJECTS: [],\n    SELECTED: [],\n    ACTIONS: [],\n    COLORPICKER_ACTIVE: false,\n    PEN_WIDTH: 1,\n    PEN_OPACITY: 1,\n    PEN_STROKECOLOR: 'black',\n    PEN_FILLCOLOR: 'transparent',\n    CIRCLE_WIDTH: 1,\n    CIRCLE_OPACITY: 1,\n    CIRCLE_STROKECOLOR: 'black',\n    CIRCLE_FILLCOLOR: 'transparent',\n    LINE_WIDTH: 1,\n    LINE_OPACITY: 1,\n    LINE_STROKECOLOR: 'black'\n  },\n  mutations: {\n    // --- Tools ---\n    SET_ACTIVE: function SET_ACTIVE(state, type) {\n      var old = state.ACTIVE;\n      state.ACTIVE = type;\n\n      if (old == \"select\" && type != \"select\") {\n        bus.$emit(\"deactivate-select\");\n      }\n\n      if (old == \"pointer\" && type != \"pointer\") {\n        bus.$emit(\"deactivate-pointer\");\n      }\n    },\n    SET_TOOLSELECT: function SET_TOOLSELECT(state, tool) {\n      state.TOOLSELECT = tool;\n    },\n    SET_TOOLPOINTER: function SET_TOOLPOINTER(state, tool) {\n      state.TOOLPOINTER = tool;\n    },\n    SET_TOOLPEN: function SET_TOOLPEN(state, tool) {\n      state.TOOLPEN = tool;\n    },\n    SET_TOOLCIRCLE: function SET_TOOLCIRCLE(state, tool) {\n      state.TOOLCIRCLE = tool;\n    },\n    SET_TOOLSHAPEBUILDER: function SET_TOOLSHAPEBUILDER(state, tool) {\n      state.TOOLSHAPEBUILDER = tool;\n    },\n    SET_TOOLLINE: function SET_TOOLLINE(state, tool) {\n      state.TOOLLINE = tool;\n    },\n    // --- Shapes ---\n    ADD_SHAPE: function ADD_SHAPE(state, shape) {\n      state.OBJECTS.push(shape);\n    },\n    // --- Selection ---\n    ADD_SELECT: function ADD_SELECT(state, shape) {\n      state.SELECTED.push(shape);\n    },\n    CLEAR_SELECT: function CLEAR_SELECT(state) {\n      state.SELECTED = [];\n    },\n    DELETE_SELECT: function DELETE_SELECT(state) {\n      // Count from end to begin to allow pop()\n      for (var i = state.SELECTED.length - 1; i >= 0; i--) {\n        // Destroy the shape (it's still in the objects and the selection array)\n        state.SELECTED[i].remove(); // Find the shape in the objects array\n\n        var index = state.OBJECTS.findIndex(function (x) {\n          return x === state.SELECTED[i];\n        }); // Remove it\n\n        state.OBJECTS.splice(index, 1); // Remove the shape from the selection array\n\n        state.SELECTED.pop();\n      }\n    },\n    SELECTION_SET_STROKECOLOR: function SELECTION_SET_STROKECOLOR(state, value) {\n      bus.$emit('set_color_stroke', value);\n    },\n    SELECTION_SET_FILLCOLOR: function SELECTION_SET_FILLCOLOR(state, value) {\n      bus.$emit('set_color_fill', value);\n    },\n    PEN_SET_WIDTH: function PEN_SET_WIDTH(state, value) {\n      state.PEN_WIDTH = value;\n    },\n    PEN_SET_OPACITY: function PEN_SET_OPACITY(state, value) {\n      state.PEN_OPACITY = value;\n    },\n    PEN_SET_STROKECOLOR: function PEN_SET_STROKECOLOR(state, value) {\n      state.PEN_STROKECOLOR = value;\n    },\n    PEN_SET_FILLCOLOR: function PEN_SET_FILLCOLOR(state, value) {\n      state.PEN_FILLCOLOR = value;\n    },\n    CIRCLE_SET_WIDTH: function CIRCLE_SET_WIDTH(state, value) {\n      state.CIRCLE_WIDTH = value;\n    },\n    CIRCLE_SET_OPACITY: function CIRCLE_SET_OPACITY(state, value) {\n      state.CIRCLE_OPACITY = value;\n    },\n    CIRCLE_SET_STROKECOLOR: function CIRCLE_SET_STROKECOLOR(state, value) {\n      state.CIRCLE_STROKECOLOR = value;\n    },\n    CIRCLE_SET_FILLCOLOR: function CIRCLE_SET_FILLCOLOR(state, value) {\n      state.CIRCLE_FILLCOLOR = value;\n    },\n    LINE_SET_WIDTH: function LINE_SET_WIDTH(state, value) {\n      state.LINE_WIDTH = value;\n    },\n    LINE_SET_OPACITY: function LINE_SET_OPACITY(state, value) {\n      state.LINE_OPACITY = value;\n    },\n    LINE_SET_STROKECOLOR: function LINE_SET_STROKECOLOR(state, value) {\n      state.LINE_STROKECOLOR = value;\n    },\n    // Add an action to the undo list\n    ADD_ACTION: function ADD_ACTION(state, action) {\n      state.ACTIONS.push(action);\n    },\n    UNDO: function UNDO(state) {\n      if (state.ACTIONS.length <= 0) {\n        return;\n      }\n\n      var action = state.ACTIONS.pop();\n\n      switch (action.type) {\n        case 'move':\n          var delta = action.data.startPos.subtract(action.data.endPos);\n\n          for (var i = 0; i < action.data.paths.length; i++) {\n            action.data.paths[i].translate(delta);\n          }\n\n          state.SELECTED = action.data.paths;\n          break;\n\n        case 'scale':\n          var pivot = action.data.pivot;\n          var init = action.data.handle_init;\n          var end = action.data.handle_end;\n          var relH = 1;\n          var relW = 1;\n\n          if (!action.data.lockY) {\n            relH = init.subtract(pivot).y / end.subtract(pivot).y;\n          }\n\n          if (!action.data.lockX) {\n            relW = init.subtract(pivot).x / end.subtract(pivot).x;\n          }\n\n          if (action.data.shift) {\n            if (action.data.lockY) {\n              relH = relW;\n            } else if (action.data.lockX) {\n              relW = relH;\n            }\n          }\n\n          for (var i = 0; i < action.data.paths.length; i++) {\n            action.data.paths[i].scale(relW, relH, pivot);\n          }\n\n          state.SELECTED = action.data.paths;\n          break;\n      }\n    },\n    HIDE_COLORPICKER: function HIDE_COLORPICKER(state) {\n      state.COLORPICKER_ACTIVE = false;\n    },\n    SHOW_COLORPICKER: function SHOW_COLORPICKER(state) {\n      state.COLORPICKER_ACTIVE = true;\n    }\n  },\n  getters: {\n    clamp: function clamp() {\n      return function (value, min, max) {\n        if (value < min) {\n          return min;\n        } else if (value > max) {\n          return max;\n        }\n\n        return value;\n      };\n    }\n  }\n});",{"version":3,"sources":["D:\\GitHub\\Vectory\\src\\store.js"],"names":["Vue","Vuex","bus","use","Store","state","ACTIVE","TOOLSELECT","TOOLPOINTER","TOOLPEN","TOOLCIRCLE","TOOLSHAPEBUILDER","TOOLLINE","OBJECTS","SELECTED","ACTIONS","COLORPICKER_ACTIVE","PEN_WIDTH","PEN_OPACITY","PEN_STROKECOLOR","PEN_FILLCOLOR","CIRCLE_WIDTH","CIRCLE_OPACITY","CIRCLE_STROKECOLOR","CIRCLE_FILLCOLOR","LINE_WIDTH","LINE_OPACITY","LINE_STROKECOLOR","mutations","SET_ACTIVE","type","old","$emit","SET_TOOLSELECT","tool","SET_TOOLPOINTER","SET_TOOLPEN","SET_TOOLCIRCLE","SET_TOOLSHAPEBUILDER","SET_TOOLLINE","ADD_SHAPE","shape","push","ADD_SELECT","CLEAR_SELECT","DELETE_SELECT","i","length","remove","index","findIndex","x","splice","pop","SELECTION_SET_STROKECOLOR","value","SELECTION_SET_FILLCOLOR","PEN_SET_WIDTH","PEN_SET_OPACITY","PEN_SET_STROKECOLOR","PEN_SET_FILLCOLOR","CIRCLE_SET_WIDTH","CIRCLE_SET_OPACITY","CIRCLE_SET_STROKECOLOR","CIRCLE_SET_FILLCOLOR","LINE_SET_WIDTH","LINE_SET_OPACITY","LINE_SET_STROKECOLOR","ADD_ACTION","action","UNDO","delta","data","startPos","subtract","endPos","paths","translate","pivot","init","handle_init","end","handle_end","relH","relW","lockY","y","lockX","shift","scale","HIDE_COLORPICKER","SHOW_COLORPICKER","getters","clamp","min","max"],"mappings":"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","sourcesContent":["import Vue from 'vue'\r\nimport Vuex from 'vuex'\r\nimport { bus } from '@/main.js'\r\n\r\nVue.use(Vuex)\r\n\r\nexport default new Vuex.Store({\r\n  state: {\r\n    ACTIVE: 'select',\r\n\r\n    TOOLSELECT: null,\r\n    TOOLPOINTER: null,\r\n    TOOLPEN: null,\r\n    TOOLCIRCLE: null,\r\n    TOOLSHAPEBUILDER: null,\r\n    TOOLLINE: null,\r\n\r\n    OBJECTS: [],\r\n    SELECTED: [],\r\n\r\n    ACTIONS: [],\r\n\r\n    COLORPICKER_ACTIVE: false,\r\n\r\n    PEN_WIDTH: 1,\r\n    PEN_OPACITY: 1,\r\n    PEN_STROKECOLOR: 'black',\r\n    PEN_FILLCOLOR: 'transparent',\r\n\r\n    CIRCLE_WIDTH: 1,\r\n    CIRCLE_OPACITY: 1,\r\n    CIRCLE_STROKECOLOR: 'black',\r\n    CIRCLE_FILLCOLOR: 'transparent',\r\n\r\n    LINE_WIDTH: 1,\r\n    LINE_OPACITY: 1,\r\n    LINE_STROKECOLOR: 'black',\r\n  },\r\n  mutations: {\r\n    // --- Tools ---\r\n    SET_ACTIVE: function(state, type) {\r\n      var old = state.ACTIVE\r\n      state.ACTIVE = type;\r\n\r\n      if(old == \"select\" && type != \"select\") {\r\n        bus.$emit(\"deactivate-select\");\r\n      }\r\n      if(old == \"pointer\" && type != \"pointer\") {\r\n        bus.$emit(\"deactivate-pointer\")\r\n      }\r\n    },\r\n\r\n    SET_TOOLSELECT: (state, tool) => {\r\n      state.TOOLSELECT = tool;\r\n    },\r\n    SET_TOOLPOINTER: (state, tool) => {\r\n      state.TOOLPOINTER = tool;\r\n    },\r\n    SET_TOOLPEN: (state, tool) => {\r\n      state.TOOLPEN = tool;\r\n    },\r\n    SET_TOOLCIRCLE: (state, tool) => {\r\n      state.TOOLCIRCLE = tool;\r\n    },\r\n    SET_TOOLSHAPEBUILDER: (state, tool) => {\r\n      state.TOOLSHAPEBUILDER = tool\r\n    },\r\n    SET_TOOLLINE: (state, tool) => {\r\n      state.TOOLLINE = tool\r\n    },\r\n\r\n    // --- Shapes ---\r\n    ADD_SHAPE: (state, shape) => {\r\n      state.OBJECTS.push(shape);\r\n    },\r\n\r\n    // --- Selection ---\r\n    ADD_SELECT: (state, shape) => {\r\n      state.SELECTED.push(shape);\r\n    },\r\n    CLEAR_SELECT: (state) => {\r\n      state.SELECTED = [];\r\n    },\r\n    DELETE_SELECT: (state) => {\r\n      // Count from end to begin to allow pop()\r\n      for(var i=state.SELECTED.length-1; i>=0; i--) {\r\n        // Destroy the shape (it's still in the objects and the selection array)\r\n        state.SELECTED[i].remove();\r\n\r\n        // Find the shape in the objects array\r\n        var index = state.OBJECTS.findIndex(x => x === state.SELECTED[i]);\r\n        // Remove it\r\n        state.OBJECTS.splice(index, 1);\r\n\r\n        // Remove the shape from the selection array\r\n        state.SELECTED.pop();\r\n\r\n      }\r\n    },\r\n\r\n    SELECTION_SET_STROKECOLOR(state, value) {\r\n      bus.$emit('set_color_stroke', value)\r\n    },\r\n    SELECTION_SET_FILLCOLOR(state, value) {\r\n      bus.$emit('set_color_fill', value)\r\n    },\r\n\r\n    PEN_SET_WIDTH(state, value) {\r\n      state.PEN_WIDTH = value\r\n    },\r\n    PEN_SET_OPACITY(state, value) {\r\n      state.PEN_OPACITY = value\r\n    },\r\n    PEN_SET_STROKECOLOR(state, value) {\r\n      state.PEN_STROKECOLOR = value\r\n    },\r\n    PEN_SET_FILLCOLOR(state, value) {\r\n      state.PEN_FILLCOLOR = value\r\n    },\r\n\r\n    CIRCLE_SET_WIDTH(state, value) {\r\n      state.CIRCLE_WIDTH = value\r\n    },\r\n    CIRCLE_SET_OPACITY(state, value) {\r\n      state.CIRCLE_OPACITY = value\r\n    },\r\n    CIRCLE_SET_STROKECOLOR(state, value) {\r\n      state.CIRCLE_STROKECOLOR = value\r\n    },\r\n    CIRCLE_SET_FILLCOLOR(state, value) {\r\n      state.CIRCLE_FILLCOLOR = value\r\n    },\r\n\r\n    LINE_SET_WIDTH(state, value) {\r\n      state.LINE_WIDTH = value\r\n    },\r\n    LINE_SET_OPACITY(state, value) {\r\n      state.LINE_OPACITY = value\r\n    },\r\n    LINE_SET_STROKECOLOR(state, value) {\r\n      state.LINE_STROKECOLOR = value\r\n    },\r\n\r\n    // Add an action to the undo list\r\n    ADD_ACTION(state, action) {\r\n      state.ACTIONS.push(action);\r\n    },\r\n    UNDO(state) {\r\n      if(state.ACTIONS.length <= 0) {\r\n        return;\r\n      }\r\n      var action = state.ACTIONS.pop();\r\n      \r\n      switch(action.type) {\r\n        case 'move':\r\n          var delta = action.data.startPos.subtract(action.data.endPos);\r\n\r\n          for(var i=0; i<action.data.paths.length; i++) {\r\n            action.data.paths[i].translate(delta);\r\n          }\r\n\r\n          state.SELECTED = action.data.paths;\r\n          break;\r\n\r\n        case 'scale':\r\n          var pivot = action.data.pivot;\r\n          var init = action.data.handle_init;\r\n          var end = action.data.handle_end;\r\n\r\n          var relH = 1;\r\n          var relW = 1;\r\n\r\n          if(!action.data.lockY) {\r\n            relH = init.subtract(pivot).y / end.subtract(pivot).y;\r\n          }\r\n          if (!action.data.lockX) {\r\n            relW = init.subtract(pivot).x / end.subtract(pivot).x;\r\n          }\r\n\r\n          if(action.data.shift) {\r\n            if(action.data.lockY) {\r\n              relH = relW;\r\n            }\r\n            else if(action.data.lockX) {\r\n              relW = relH;\r\n            }\r\n          }\r\n\r\n          for(var i=0; i<action.data.paths.length; i++) {\r\n            action.data.paths[i].scale(relW, relH, pivot);\r\n          }\r\n\r\n          state.SELECTED = action.data.paths;\r\n          break;\r\n      }\r\n    },\r\n\r\n    HIDE_COLORPICKER(state) {\r\n      state.COLORPICKER_ACTIVE = false\r\n    },\r\n    SHOW_COLORPICKER(state) {\r\n      state.COLORPICKER_ACTIVE = true\r\n    }\r\n  },\r\n  getters: {\r\n    clamp: () => (value, min, max) => {\r\n      if(value < min){\r\n        return min;\r\n      } else if(value > max){\r\n        return max;\r\n      }\r\n      return value;\r\n    }\r\n  }\r\n})\r\n"]}]}