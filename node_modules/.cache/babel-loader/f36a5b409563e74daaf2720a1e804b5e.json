{"remainingRequest":"D:\\GitHub\\Vectory\\node_modules\\babel-loader\\lib\\index.js!D:\\GitHub\\Vectory\\node_modules\\eslint-loader\\index.js??ref--13-0!D:\\GitHub\\Vectory\\src\\store.js","dependencies":[{"path":"D:\\GitHub\\Vectory\\src\\store.js","mtime":1569451771790},{"path":"D:\\GitHub\\Vectory\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\GitHub\\Vectory\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\GitHub\\Vectory\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _toConsumableArray from \"D:\\\\GitHub\\\\Vectory\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/toConsumableArray\";\nimport \"core-js/modules/es6.array.find-index\";\nimport Vue from 'vue';\nimport Vuex from 'vuex';\nimport { bus, Layer, ShapeGroup } from '@/main.js';\nimport { project } from 'paper';\nVue.use(Vuex);\nexport default new Vuex.Store({\n  state: {\n    ACTIVE_TOOL: 'select',\n    LAYER_ACTIVE: false,\n    TOOLSELECT: null,\n    TOOLPOINTER: null,\n    TOOLPEN: null,\n    TOOLCIRCLE: null,\n    TOOLRECTANGLE: null,\n    TOOLSHAPEBUILDER: null,\n    TOOLLINE: null,\n    OBJECTS: [],\n    SELECTED: [],\n    ACTIONS: [],\n    // Window toggles\n    COLORPICKER_ACTIVE: false,\n    FILEDROPDOWN_ACTIVE: false,\n    // Tools settings\n    PEN_WIDTH: 1,\n    PEN_OPACITY: 1,\n    PEN_STROKECOLOR: 'black',\n    PEN_FILLCOLOR: 'transparent',\n    CIRCLE_WIDTH: 1,\n    CIRCLE_OPACITY: 1,\n    CIRCLE_STROKECOLOR: 'black',\n    CIRCLE_FILLCOLOR: 'transparent',\n    RECTANGLE_WIDTH: 1,\n    RECTANGLE_OPACITY: 1,\n    RECTANGLE_STROKECOLOR: 'black',\n    RECTANGLE_FILLCOLOR: 'transparent',\n    LINE_WIDTH: 1,\n    LINE_OPACITY: 1,\n    LINE_STROKECOLOR: 'black',\n    // General\n    LAYERS: [],\n    LAYER_INDEX: 0,\n    SELECTED_LAYER_INDEX: 0\n  },\n  mutations: {\n    // --- Tools ---\n    SET_ACTIVE: function SET_ACTIVE(state, type) {\n      var old = state.ACTIVE_TOOL;\n      state.ACTIVE_TOOL = type;\n\n      if (old == \"select\" && type != \"select\") {\n        bus.$emit(\"deactivate-select\");\n      }\n\n      if (old == \"pointer\" && type != \"pointer\") {\n        bus.$emit(\"deactivate-pointer\");\n      }\n    },\n    SET_LAYER_ACTIVE: function SET_LAYER_ACTIVE(state, value) {\n      state.LAYER_ACTIVE = value;\n    },\n    SET_TOOLSELECT: function SET_TOOLSELECT(state, tool) {\n      state.TOOLSELECT = tool;\n    },\n    SET_TOOLPOINTER: function SET_TOOLPOINTER(state, tool) {\n      state.TOOLPOINTER = tool;\n    },\n    SET_TOOLPEN: function SET_TOOLPEN(state, tool) {\n      state.TOOLPEN = tool;\n    },\n    SET_TOOLCIRCLE: function SET_TOOLCIRCLE(state, tool) {\n      state.TOOLCIRCLE = tool;\n    },\n    SET_TOOLRECTANGLE: function SET_TOOLRECTANGLE(state, tool) {\n      state.TOOLRECTANGLE = tool;\n    },\n    SET_TOOLSHAPEBUILDER: function SET_TOOLSHAPEBUILDER(state, tool) {\n      state.TOOLSHAPEBUILDER = tool;\n    },\n    SET_TOOLLINE: function SET_TOOLLINE(state, tool) {\n      state.TOOLLINE = tool;\n    },\n    // --- Shapes ---\n    ADD_SHAPE: function ADD_SHAPE(state, shape) {\n      state.OBJECTS.push(shape);\n    },\n    // --- Selection ---\n    ADD_SELECT: function ADD_SELECT(state, shape) {\n      state.SELECTED.push(shape);\n    },\n    CLEAR_SELECT: function CLEAR_SELECT(state) {\n      state.SELECTED = [];\n    },\n    DELETE_SHAPES: function DELETE_SHAPES(state) {\n      var shapes = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : state.SELECTED;\n\n      // Count from end to begin to allow pop()\n      for (var i = shapes.length - 1; i >= 0; i--) {\n        // Destroy the shape (it's still in the objects and the selection array)\n        shapes[i].remove(); // Find the shape in the objects array\n\n        var index = state.OBJECTS.findIndex(function (x) {\n          return x === shapes[i];\n        }); // Remove it\n\n        state.OBJECTS.splice(index, 1); // Remove the shape from the selection array\n\n        shapes.pop();\n      }\n    },\n    DISCARD_SHAPES: function DISCARD_SHAPES(state) {\n      var shapes = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : _toConsumableArray(state.SELECTED);\n\n      // Count from end to begin to allow pop()\n      for (var i = shapes.length - 1; i >= 0; i--) {\n        // Find the shape in the objects array\n        var index = state.OBJECTS.findIndex(function (x) {\n          return x === shapes[i];\n        }); // Remove it\n\n        state.OBJECTS.splice(index, 1); // Remove the shape from the selection array\n\n        shapes.pop();\n      }\n    },\n    SELECTION_SET_STROKECOLOR: function SELECTION_SET_STROKECOLOR(state, value) {\n      bus.$emit('set_color_stroke', value);\n    },\n    SELECTION_SET_STROKEWIDTH: function SELECTION_SET_STROKEWIDTH(state, value) {\n      bus.$emit('set_width_stroke', value);\n    },\n    SELECTION_SET_CAPSTYLE: function SELECTION_SET_CAPSTYLE(state, value) {\n      bus.$emit('set_cap_style', value);\n    },\n    SELECTION_SET_FILLCOLOR: function SELECTION_SET_FILLCOLOR(state, value) {\n      bus.$emit('set_color_fill', value);\n    },\n    PEN_SET_WIDTH: function PEN_SET_WIDTH(state, value) {\n      state.PEN_WIDTH = value;\n    },\n    PEN_SET_OPACITY: function PEN_SET_OPACITY(state, value) {\n      state.PEN_OPACITY = value;\n    },\n    PEN_SET_STROKECOLOR: function PEN_SET_STROKECOLOR(state, value) {\n      state.PEN_STROKECOLOR = value;\n    },\n    PEN_SET_FILLCOLOR: function PEN_SET_FILLCOLOR(state, value) {\n      state.PEN_FILLCOLOR = value;\n    },\n    CIRCLE_SET_WIDTH: function CIRCLE_SET_WIDTH(state, value) {\n      state.CIRCLE_WIDTH = value;\n    },\n    CIRCLE_SET_OPACITY: function CIRCLE_SET_OPACITY(state, value) {\n      state.CIRCLE_OPACITY = value;\n    },\n    CIRCLE_SET_STROKECOLOR: function CIRCLE_SET_STROKECOLOR(state, value) {\n      state.CIRCLE_STROKECOLOR = value;\n    },\n    CIRCLE_SET_FILLCOLOR: function CIRCLE_SET_FILLCOLOR(state, value) {\n      state.CIRCLE_FILLCOLOR = value;\n    },\n    RECTANGLE_SET_WIDTH: function RECTANGLE_SET_WIDTH(state, value) {\n      state.RECTANGLE_WIDTH = value;\n    },\n    RECTANGLE_SET_OPACITY: function RECTANGLE_SET_OPACITY(state, value) {\n      state.RECTANGLE_OPACITY = value;\n    },\n    RECTANGLE_SET_STROKECOLOR: function RECTANGLE_SET_STROKECOLOR(state, value) {\n      state.RECTANGLE_STROKECOLOR = value;\n    },\n    RECTANGLE_SET_FILLCOLOR: function RECTANGLE_SET_FILLCOLOR(state, value) {\n      state.RECTANGLE_FILLCOLOR = value;\n    },\n    LINE_SET_WIDTH: function LINE_SET_WIDTH(state, value) {\n      state.LINE_WIDTH = value;\n    },\n    LINE_SET_OPACITY: function LINE_SET_OPACITY(state, value) {\n      state.LINE_OPACITY = value;\n    },\n    LINE_SET_STROKECOLOR: function LINE_SET_STROKECOLOR(state, value) {\n      state.LINE_STROKECOLOR = value;\n    },\n    // Add an action to the undo list\n    ADD_ACTION: function ADD_ACTION(state, action) {\n      state.ACTIONS.push(action);\n    },\n    UNDO: function UNDO(state) {\n      if (state.ACTIONS.length <= 0) {\n        return;\n      }\n\n      var action = state.ACTIONS.pop();\n\n      switch (action.type) {\n        case 'move':\n          var delta = action.data.startPos.subtract(action.data.endPos);\n\n          for (var i = 0; i < action.data.paths.length; i++) {\n            action.data.paths[i].translate(delta);\n          }\n\n          state.SELECTED = action.data.paths;\n          break;\n\n        case 'scale':\n          var pivot = action.data.pivot;\n          var init = action.data.handle_init;\n          var end = action.data.handle_end;\n          var relH = 1;\n          var relW = 1;\n\n          if (!action.data.lockY) {\n            relH = init.subtract(pivot).y / end.subtract(pivot).y;\n          }\n\n          if (!action.data.lockX) {\n            relW = init.subtract(pivot).x / end.subtract(pivot).x;\n          }\n\n          if (action.data.shift) {\n            if (action.data.lockY) {\n              relH = relW;\n            } else if (action.data.lockX) {\n              relW = relH;\n            }\n          }\n\n          for (var i = 0; i < action.data.paths.length; i++) {\n            action.data.paths[i].scale(relW, relH, pivot);\n          }\n\n          state.SELECTED = action.data.paths;\n          break;\n      }\n    },\n    // Toggle windows\n    HIDE_COLORPICKER: function HIDE_COLORPICKER(state) {\n      state.COLORPICKER_ACTIVE = false;\n    },\n    SHOW_COLORPICKER: function SHOW_COLORPICKER(state) {\n      state.COLORPICKER_ACTIVE = true;\n    },\n    TRIGGER_FILEDROPDOWN: function TRIGGER_FILEDROPDOWN(state) {\n      state.FILEDROPDOWN_ACTIVE = !state.FILEDROPDOWN_ACTIVE;\n    },\n    //Layers\n    ADD_LAYER: function ADD_LAYER(state) {\n      state.LAYER_INDEX++;\n\n      var _newLayer = new Layer(state.LAYER_INDEX, \"Layer \" + state.LAYER_INDEX);\n\n      state.LAYERS.push(_newLayer);\n      state.SELECTED_LAYER_INDEX = state.LAYERS.length - 1;\n      bus.$emit('add-layer');\n    },\n    SELECT_LAYER: function SELECT_LAYER(state, index) {\n      state.SELECTED_LAYER_INDEX = index;\n      bus.$emit('update-active-layer', index);\n    },\n    REMOVE_LAYER: function REMOVE_LAYER(state) {\n      state.LAYERS.splice(state.SELECTED_LAYER_INDEX, 1);\n      state.SELECTED_LAYER_INDEX = state.SELECTED_LAYER_INDEX == 0 ? 0 : state.SELECTED_LAYER_INDEX - 1;\n      state.SELECTED = [];\n      bus.$emit('hide-transformbox');\n      bus.$emit('remove-layer');\n    }\n  },\n  getters: {\n    clamp: function clamp() {\n      return function (value, min, max) {\n        if (value < min) {\n          return min;\n        } else if (value > max) {\n          return max;\n        }\n\n        return value;\n      };\n    }\n  }\n});",{"version":3,"sources":["D:\\GitHub\\Vectory\\src\\store.js"],"names":["Vue","Vuex","bus","Layer","ShapeGroup","project","use","Store","state","ACTIVE_TOOL","LAYER_ACTIVE","TOOLSELECT","TOOLPOINTER","TOOLPEN","TOOLCIRCLE","TOOLRECTANGLE","TOOLSHAPEBUILDER","TOOLLINE","OBJECTS","SELECTED","ACTIONS","COLORPICKER_ACTIVE","FILEDROPDOWN_ACTIVE","PEN_WIDTH","PEN_OPACITY","PEN_STROKECOLOR","PEN_FILLCOLOR","CIRCLE_WIDTH","CIRCLE_OPACITY","CIRCLE_STROKECOLOR","CIRCLE_FILLCOLOR","RECTANGLE_WIDTH","RECTANGLE_OPACITY","RECTANGLE_STROKECOLOR","RECTANGLE_FILLCOLOR","LINE_WIDTH","LINE_OPACITY","LINE_STROKECOLOR","LAYERS","LAYER_INDEX","SELECTED_LAYER_INDEX","mutations","SET_ACTIVE","type","old","$emit","SET_LAYER_ACTIVE","value","SET_TOOLSELECT","tool","SET_TOOLPOINTER","SET_TOOLPEN","SET_TOOLCIRCLE","SET_TOOLRECTANGLE","SET_TOOLSHAPEBUILDER","SET_TOOLLINE","ADD_SHAPE","shape","push","ADD_SELECT","CLEAR_SELECT","DELETE_SHAPES","shapes","i","length","remove","index","findIndex","x","splice","pop","DISCARD_SHAPES","SELECTION_SET_STROKECOLOR","SELECTION_SET_STROKEWIDTH","SELECTION_SET_CAPSTYLE","SELECTION_SET_FILLCOLOR","PEN_SET_WIDTH","PEN_SET_OPACITY","PEN_SET_STROKECOLOR","PEN_SET_FILLCOLOR","CIRCLE_SET_WIDTH","CIRCLE_SET_OPACITY","CIRCLE_SET_STROKECOLOR","CIRCLE_SET_FILLCOLOR","RECTANGLE_SET_WIDTH","RECTANGLE_SET_OPACITY","RECTANGLE_SET_STROKECOLOR","RECTANGLE_SET_FILLCOLOR","LINE_SET_WIDTH","LINE_SET_OPACITY","LINE_SET_STROKECOLOR","ADD_ACTION","action","UNDO","delta","data","startPos","subtract","endPos","paths","translate","pivot","init","handle_init","end","handle_end","relH","relW","lockY","y","lockX","shift","scale","HIDE_COLORPICKER","SHOW_COLORPICKER","TRIGGER_FILEDROPDOWN","ADD_LAYER","_newLayer","SELECT_LAYER","REMOVE_LAYER","getters","clamp","min","max"],"mappings":"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","sourcesContent":["import Vue from 'vue'\r\nimport Vuex from 'vuex'\r\nimport { bus, Layer, ShapeGroup } from '@/main.js'\r\nimport { project } from 'paper';\r\n\r\nVue.use(Vuex)\r\n\r\nexport default new Vuex.Store({\r\n  state: {\r\n    ACTIVE_TOOL: 'select',\r\n\r\n    LAYER_ACTIVE: false,\r\n\r\n    TOOLSELECT: null,\r\n    TOOLPOINTER: null,\r\n    TOOLPEN: null,\r\n    TOOLCIRCLE: null,\r\n    TOOLRECTANGLE: null,\r\n    TOOLSHAPEBUILDER: null,\r\n    TOOLLINE: null,\r\n\r\n    OBJECTS: [],\r\n    SELECTED: [],\r\n\r\n    ACTIONS: [],\r\n\r\n    // Window toggles\r\n    COLORPICKER_ACTIVE: false,\r\n    FILEDROPDOWN_ACTIVE: false,\r\n\r\n\r\n    // Tools settings\r\n    PEN_WIDTH: 1,\r\n    PEN_OPACITY: 1,\r\n    PEN_STROKECOLOR: 'black',\r\n    PEN_FILLCOLOR: 'transparent',\r\n\r\n    CIRCLE_WIDTH: 1,\r\n    CIRCLE_OPACITY: 1,\r\n    CIRCLE_STROKECOLOR: 'black',\r\n    CIRCLE_FILLCOLOR: 'transparent',\r\n\r\n    RECTANGLE_WIDTH: 1,\r\n    RECTANGLE_OPACITY: 1,\r\n    RECTANGLE_STROKECOLOR: 'black',\r\n    RECTANGLE_FILLCOLOR: 'transparent',\r\n\r\n    LINE_WIDTH: 1,\r\n    LINE_OPACITY: 1,\r\n    LINE_STROKECOLOR: 'black',\r\n\r\n    // General\r\n    LAYERS: [],\r\n    LAYER_INDEX: 0,\r\n    SELECTED_LAYER_INDEX: 0\r\n  },\r\n  mutations: {\r\n    // --- Tools ---\r\n    SET_ACTIVE: function(state, type) {\r\n      var old = state.ACTIVE_TOOL\r\n      state.ACTIVE_TOOL = type;\r\n\r\n      if(old == \"select\" && type != \"select\") {\r\n        bus.$emit(\"deactivate-select\");\r\n      }\r\n      if(old == \"pointer\" && type != \"pointer\") {\r\n        bus.$emit(\"deactivate-pointer\")\r\n      }\r\n    },\r\n\r\n    SET_LAYER_ACTIVE: function(state, value) {\r\n      state.LAYER_ACTIVE = value;\r\n    },\r\n\r\n    SET_TOOLSELECT: (state, tool) => {\r\n      state.TOOLSELECT = tool;\r\n    },\r\n    SET_TOOLPOINTER: (state, tool) => {\r\n      state.TOOLPOINTER = tool;\r\n    },\r\n    SET_TOOLPEN: (state, tool) => {\r\n      state.TOOLPEN = tool;\r\n    },\r\n    SET_TOOLCIRCLE: (state, tool) => {\r\n      state.TOOLCIRCLE = tool;\r\n    },\r\n    SET_TOOLRECTANGLE: (state, tool) => {\r\n      state.TOOLRECTANGLE = tool;\r\n    },\r\n    SET_TOOLSHAPEBUILDER: (state, tool) => {\r\n      state.TOOLSHAPEBUILDER = tool\r\n    },\r\n    SET_TOOLLINE: (state, tool) => {\r\n      state.TOOLLINE = tool\r\n    },\r\n\r\n    // --- Shapes ---\r\n    ADD_SHAPE: (state, shape) => {\r\n      state.OBJECTS.push(shape);\r\n    },\r\n\r\n    // --- Selection ---\r\n    ADD_SELECT: (state, shape) => {\r\n      state.SELECTED.push(shape);\r\n    },\r\n    CLEAR_SELECT: (state) => {\r\n        state.SELECTED = [];\r\n    },\r\n    DELETE_SHAPES: (state, shapes=state.SELECTED) => {\r\n      // Count from end to begin to allow pop()\r\n      for(var i=shapes.length-1; i>=0; i--) {\r\n        // Destroy the shape (it's still in the objects and the selection array)\r\n        shapes[i].remove();\r\n\r\n        // Find the shape in the objects array\r\n        var index = state.OBJECTS.findIndex(x => x === shapes[i]);\r\n        // Remove it\r\n        state.OBJECTS.splice(index, 1);\r\n\r\n        // Remove the shape from the selection array\r\n        shapes.pop();\r\n      }\r\n    },\r\n    DISCARD_SHAPES(state, shapes=[...state.SELECTED]) {\r\n      // Count from end to begin to allow pop()\r\n      for(var i=shapes.length-1; i>=0; i--) {\r\n        // Find the shape in the objects array\r\n        var index = state.OBJECTS.findIndex(x => x === shapes[i]);\r\n        // Remove it\r\n        state.OBJECTS.splice(index, 1);\r\n\r\n        // Remove the shape from the selection array\r\n        shapes.pop();\r\n      }\r\n    },\r\n\r\n    SELECTION_SET_STROKECOLOR(state, value) {\r\n      bus.$emit('set_color_stroke', value);\r\n    },\r\n    SELECTION_SET_STROKEWIDTH(state, value) {\r\n      bus.$emit('set_width_stroke', value);\r\n    },\r\n    SELECTION_SET_CAPSTYLE(state, value) {\r\n      bus.$emit('set_cap_style', value);\r\n    },\r\n    SELECTION_SET_FILLCOLOR(state, value) {\r\n      bus.$emit('set_color_fill', value);\r\n    },\r\n\r\n    PEN_SET_WIDTH(state, value) {\r\n      state.PEN_WIDTH = value\r\n    },\r\n    PEN_SET_OPACITY(state, value) {\r\n      state.PEN_OPACITY = value\r\n    },\r\n    PEN_SET_STROKECOLOR(state, value) {\r\n      state.PEN_STROKECOLOR = value\r\n    },\r\n    PEN_SET_FILLCOLOR(state, value) {\r\n      state.PEN_FILLCOLOR = value\r\n    },\r\n\r\n    CIRCLE_SET_WIDTH(state, value) {\r\n      state.CIRCLE_WIDTH = value\r\n    },\r\n    CIRCLE_SET_OPACITY(state, value) {\r\n      state.CIRCLE_OPACITY = value\r\n    },\r\n    CIRCLE_SET_STROKECOLOR(state, value) {\r\n      state.CIRCLE_STROKECOLOR = value\r\n    },\r\n    CIRCLE_SET_FILLCOLOR(state, value) {\r\n      state.CIRCLE_FILLCOLOR = value\r\n    },\r\n\r\n    RECTANGLE_SET_WIDTH(state, value) {\r\n      state.RECTANGLE_WIDTH = value\r\n    },\r\n    RECTANGLE_SET_OPACITY(state, value) {\r\n      state.RECTANGLE_OPACITY = value\r\n    },\r\n    RECTANGLE_SET_STROKECOLOR(state, value) {\r\n      state.RECTANGLE_STROKECOLOR = value\r\n    },\r\n    RECTANGLE_SET_FILLCOLOR(state, value) {\r\n      state.RECTANGLE_FILLCOLOR = value\r\n    },\r\n\r\n    LINE_SET_WIDTH(state, value) {\r\n      state.LINE_WIDTH = value\r\n    },\r\n    LINE_SET_OPACITY(state, value) {\r\n      state.LINE_OPACITY = value\r\n    },\r\n    LINE_SET_STROKECOLOR(state, value) {\r\n      state.LINE_STROKECOLOR = value\r\n    },\r\n\r\n    // Add an action to the undo list\r\n    ADD_ACTION(state, action) {\r\n      state.ACTIONS.push(action);\r\n    },\r\n    UNDO(state) {\r\n      if(state.ACTIONS.length <= 0) {\r\n        return;\r\n      }\r\n      var action = state.ACTIONS.pop();\r\n      \r\n      switch(action.type) {\r\n        case 'move':\r\n          var delta = action.data.startPos.subtract(action.data.endPos);\r\n\r\n          for(var i=0; i<action.data.paths.length; i++) {\r\n            action.data.paths[i].translate(delta);\r\n          }\r\n\r\n          state.SELECTED = action.data.paths;\r\n          break;\r\n\r\n        case 'scale':\r\n          var pivot = action.data.pivot;\r\n          var init = action.data.handle_init;\r\n          var end = action.data.handle_end;\r\n\r\n          var relH = 1;\r\n          var relW = 1;\r\n\r\n          if(!action.data.lockY) {\r\n            relH = init.subtract(pivot).y / end.subtract(pivot).y;\r\n          }\r\n          if (!action.data.lockX) {\r\n            relW = init.subtract(pivot).x / end.subtract(pivot).x;\r\n          }\r\n\r\n          if(action.data.shift) {\r\n            if(action.data.lockY) {\r\n              relH = relW;\r\n            }\r\n            else if(action.data.lockX) {\r\n              relW = relH;\r\n            }\r\n          }\r\n\r\n          for(var i=0; i<action.data.paths.length; i++) {\r\n            action.data.paths[i].scale(relW, relH, pivot);\r\n          }\r\n\r\n          state.SELECTED = action.data.paths;\r\n          break;\r\n      }\r\n    },\r\n\r\n\r\n    // Toggle windows\r\n    HIDE_COLORPICKER(state) {\r\n      state.COLORPICKER_ACTIVE = false\r\n    },\r\n    SHOW_COLORPICKER(state) {\r\n      state.COLORPICKER_ACTIVE = true\r\n    },\r\n    TRIGGER_FILEDROPDOWN(state) {\r\n      state.FILEDROPDOWN_ACTIVE = !state.FILEDROPDOWN_ACTIVE;\r\n    },\r\n\r\n    //Layers\r\n    ADD_LAYER(state) {\r\n      state.LAYER_INDEX++;\r\n      var _newLayer = new Layer(state.LAYER_INDEX, \"Layer \" + state.LAYER_INDEX);\r\n      state.LAYERS.push(_newLayer);\r\n      state.SELECTED_LAYER_INDEX = state.LAYERS.length-1;\r\n\r\n      bus.$emit('add-layer');\r\n    },\r\n    SELECT_LAYER(state, index) {\r\n      state.SELECTED_LAYER_INDEX = index;\r\n\r\n      bus.$emit('update-active-layer', index);\r\n    },\r\n    REMOVE_LAYER(state) {\r\n      state.LAYERS.splice(state.SELECTED_LAYER_INDEX, 1);\r\n      state.SELECTED_LAYER_INDEX = state.SELECTED_LAYER_INDEX == 0 ? 0 : state.SELECTED_LAYER_INDEX-1;\r\n      state.SELECTED = [];\r\n\r\n      bus.$emit('hide-transformbox');\r\n      bus.$emit('remove-layer');\r\n    }\r\n  },\r\n  getters: {\r\n    clamp: () => (value, min, max) => {\r\n      if(value < min){\r\n        return min;\r\n      } else if(value > max){\r\n        return max;\r\n      }\r\n      return value;\r\n    }\r\n  }\r\n})\r\n"]}]}