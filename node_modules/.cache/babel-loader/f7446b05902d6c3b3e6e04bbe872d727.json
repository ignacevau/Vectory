{"remainingRequest":"D:\\GitHub\\Vectory\\vectory\\node_modules\\babel-loader\\lib\\index.js!D:\\GitHub\\Vectory\\vectory\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\GitHub\\Vectory\\vectory\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\GitHub\\Vectory\\vectory\\src\\components\\ArtBoard.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\GitHub\\Vectory\\vectory\\src\\components\\ArtBoard.vue","mtime":1554757000682},{"path":"D:\\GitHub\\Vectory\\vectory\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\GitHub\\Vectory\\vectory\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\GitHub\\Vectory\\vectory\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\GitHub\\Vectory\\vectory\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _slicedToArray from \"D:\\\\GitHub\\\\Vectory\\\\vectory\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/slicedToArray\";\nimport \"core-js/modules/es6.number.constructor\";\nimport _objectSpread from \"D:\\\\GitHub\\\\Vectory\\\\vectory\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/objectSpread\";\n//\n//\n//\n//\n//\n//\nimport paper from 'paper';\nimport { mapMutations } from 'vuex';\nimport { bus } from '@/main.js';\nexport default {\n  name: 'ArtBoard',\n  methods: _objectSpread({}, mapMutations(['SET_TOOLSELECT', 'SET_TOOLPOINTER', 'SET_TOOLPEN', 'SET_TOOLCIRCLE', 'DELETE_SELECT'])),\n  mounted: function mounted() {\n    // Setting up PaperJS and settings\n    Number.prototype.clamp = function (min, max) {\n      return Math.min(Math.max(this, min), max);\n    };\n\n    paper.install(window);\n    paper.setup('canvas');\n    settings.handleSize = 6; // Value is not static (updated with zoom)\n\n    settings.hitTolerance = 7;\n    var self = this;\n    var toolSelect = new Tool();\n    var toolPointer = new Tool();\n    var toolPen = new Tool();\n    var toolCircle = new Tool();\n    self.SET_TOOLSELECT(toolSelect);\n    self.SET_TOOLPOINTER(toolPointer);\n    self.SET_TOOLPEN(toolPen);\n    self.SET_TOOLCIRCLE(toolCircle);\n    var view = paper.view;\n    var offset = 0;\n    var canvas = document.querySelector('#canvas'); // --- Zoom ---\n    // Firefox\n\n    canvas.onwheel = function (e) {\n      bus.$emit('zoom');\n      e.preventDefault();\n      var mousePos = new Point(e.clientX, e.clientY);\n      updateZoom(e.deltaY, mousePos);\n    };\n\n    function updateZoom(delta, mousePos) {\n      var mouseViewPos = view.viewToProject(mousePos);\n\n      var _changeZoomStable = changeZoomStable(view.zoom, delta, view.center, mouseViewPos);\n\n      var _changeZoomStable2 = _slicedToArray(_changeZoomStable, 2);\n\n      view.zoom = _changeZoomStable2[0];\n      offset = _changeZoomStable2[1];\n      view.center = view.center.add(offset);\n      view.draw(); // Pretty much hardcoded, this is to adjust the hitTolerance in respect to the zoom\n\n      settings.hitTolerance = (7 / view.zoom).clamp(0, 17);\n    }\n\n    function getNewZoom(oldZoom, delta) {\n      var factor = 1.05;\n\n      if (delta > 0) {\n        return oldZoom / factor;\n      } else if (delta < 0) {\n        return oldZoom * factor;\n      }\n    }\n\n    function changeZoomStable(oldZoom, delta, c, p) {\n      var newZoom = getNewZoom(oldZoom, delta).clamp(0.2, 10);\n      var beta = oldZoom / newZoom;\n      var pc = p.subtract(c);\n      var a = p.subtract(pc.multiply(beta)).subtract(c);\n      return [newZoom, a];\n    } // --- Key checks ---\n\n\n    document.onkeydown = function (e) {\n      if (e.code == 'Delete') {\n        self.DELETE_SELECT(); // Let other components know (ToolSelect -> transform box must disappear)\n\n        bus.$emit('delete_selection');\n      }\n    };\n  }\n};",{"version":3,"sources":["ArtBoard.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n  <div class=\"art-board\">\r\n    <canvas id=\"canvas\" class=\"canvas\" resize></canvas>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport paper from 'paper'\r\nimport { mapMutations } from 'vuex'\r\nimport { bus } from '@/main.js'\r\n\r\nexport default {\r\n  name: 'ArtBoard',\r\n  methods: {\r\n    ...mapMutations([\r\n      'SET_TOOLSELECT',\r\n      'SET_TOOLPOINTER',\r\n      'SET_TOOLPEN',\r\n      'SET_TOOLCIRCLE',\r\n      'DELETE_SELECT'\r\n    ])\r\n  },\r\n  mounted: function() {\r\n    // Setting up PaperJS and settings\r\n    Number.prototype.clamp = function(min, max) {\r\n      return Math.min(Math.max(this, min), max);\r\n    };\r\n\r\n    paper.install(window);\r\n    paper.setup('canvas');\r\n\r\n    settings.handleSize = 6;\r\n    // Value is not static (updated with zoom)\r\n    settings.hitTolerance = 7;\r\n\r\n    var self = this;\r\n\r\n    var toolSelect = new Tool();\r\n    var toolPointer = new Tool();\r\n    var toolPen = new Tool();\r\n    var toolCircle = new Tool();\r\n\r\n    self.SET_TOOLSELECT(toolSelect);\r\n    self.SET_TOOLPOINTER(toolPointer);\r\n    self.SET_TOOLPEN(toolPen);\r\n    self.SET_TOOLCIRCLE(toolCircle);\r\n\r\n    var view = paper.view;\r\n    var offset = 0\r\n    var canvas = document.querySelector('#canvas');\r\n\r\n\r\n\r\n\r\n\r\n    // --- Zoom ---\r\n\r\n    // Firefox\r\n    canvas.onwheel = function(e) {\r\n      bus.$emit('zoom');\r\n      e.preventDefault();\r\n\r\n      var mousePos = new Point(e.clientX, e.clientY);\r\n      updateZoom(e.deltaY, mousePos);\r\n    }\r\n\r\n    function updateZoom(delta, mousePos) {\r\n        var mouseViewPos = view.viewToProject(mousePos);\r\n        [view.zoom, offset] = changeZoomStable(view.zoom, delta, view.center, mouseViewPos);\r\n        view.center = view.center.add(offset);\r\n        view.draw();\r\n\r\n        // Pretty much hardcoded, this is to adjust the hitTolerance in respect to the zoom\r\n        settings.hitTolerance = (7 / (view.zoom)).clamp(0, 17);\r\n    }\r\n\r\n    function getNewZoom(oldZoom, delta) {\r\n        var factor = 1.05;\r\n\r\n        if (delta > 0) {\r\n            return oldZoom / factor;\r\n        }\r\n        else if (delta < 0) {\r\n            return oldZoom * factor;\r\n        }\r\n    }\r\n\r\n    function changeZoomStable(oldZoom, delta, c, p) {\r\n        var newZoom = getNewZoom(oldZoom, delta).clamp(0.2, 10);\r\n        var beta = oldZoom / newZoom;\r\n        var pc = p.subtract(c);\r\n        var a = p.subtract(pc.multiply(beta)).subtract(c);\r\n\r\n        return [newZoom, a];\r\n    }\r\n\r\n\r\n\r\n\r\n\r\n    // --- Key checks ---\r\n    document.onkeydown = (e) => {\r\n      if(e.code == 'Delete') {\r\n        self.DELETE_SELECT();\r\n\r\n        // Let other components know (ToolSelect -> transform box must disappear)\r\n        bus.$emit('delete_selection');\r\n      }\r\n    };\r\n  }\r\n}\r\n</script>\r\n\r\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\r\n<style scoped>\r\n.canvas {\r\n  width: 100%;\r\n  height: 100%;\r\n  position: absolute;\r\n  z-index: 0;\r\n}\r\n</style>\r\n"],"sourceRoot":"src/components"}]}